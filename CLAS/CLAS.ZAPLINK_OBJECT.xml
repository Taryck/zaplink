<?xml version="1.0" encoding="utf-16"?>
<ZL_OBJECT CHECKSUM="D79B83865075FBEC7BB1860755A753FF" CODE_SIGNATURE="E99C2A7E73BC4E910E704190E8B65DBC" CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_OBJECT" TYPE="CLAS" VERSION="1.01">
 <DEPENDENCIES>
  <ITEM TYPE="CLAS" NAME="ZAPLINK_CONNECTOR_"/>
 </DEPENDENCIES>
 <DIRECTORY DEVCLASS="ZAPLINK-CONNECTORS-MAIN" MASTERLANG="E"/>
 <RAW>
  <A0_MAINDATA VERSION="1" LANGU="E" EXPOSURE="2" STATE="1" CLSCCINCL="X" FIXPT="X" UNICODE="X" MSG_ID="ZAPLINK_OBJECT">
   <INHERITANCE REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" STATE="1"/>
   <TEXTS>
    <ITEM LANGU="E" DESCRIPT="ZAPLink Class &amp; Interface connector">
     <DOCUMENTATION TDFRELES="700" TDLRELES="700" TDLINESIZE="072">U1&amp;FUNCTIONALITY&amp;
ASConnector for :
AS,,- CLAS : ABAP Object classes
AS,,- INTF : ABAP Object interfaces
U1&amp;RELATIONS&amp;
ASIs part of ZAP Link Framework as Official Connector.
U1&amp;EXAMPLE&amp;
AS
U1&amp;HINTS&amp;
AS
U1&amp;FURTHER_SOURCES_OF_INF&amp;
AShttps://code.google.com/p/zaplink/wiki/Connector
U1History
ASVersion 1.00 :
AS,,Full handle of class and interface ABAP Object
ASVersion 1.01 :
AS,,Documentation Sgment removed.
AS,,Introducing : Screen &amp; Menu data</DOCUMENTATION>
    </ITEM>
   </TEXTS>
  </A0_MAINDATA>
  <ATTRIBUTS>
   <ITEM CMPNAME="BALLOG_SUBOBJECT" VERSION="1" STATE="1" EDITORDER="3 " ATTDECLTYP="2" ATTVALUE="&apos;CNX_OBJECT&apos;" TYPTYPE="1" TYPE="BALSUBOBJ">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Application Log: Subobject"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="_UUID" VERSION="1" STATE="1" EDITORDER="1 " ATTDECLTYP="2" ATTVALUE="&apos;39AC0A4B07A5A05AE1000000AC120173&apos;" TYPTYPE="1" TYPE="TD_CONNUUID">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="UUID for connector Object"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="_VER" VERSION="1" STATE="1" EDITORDER="2 " ATTDECLTYP="2" ATTVALUE="&apos;1.01&apos;" TYPTYPE="1" TYPE="TD_CONNVER">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Connector Version"/>
    </TEXTS>
   </ITEM>
  </ATTRIBUTS>
  <DEFERRED>
   <CLASSES>
    <ITEM TYPEGROUP="ZAPLINK_OBJECT_DATA" VERSION="1" TPUTYPE="1" IMPLICIT="X"/>
   </CLASSES>
  </DEFERRED>
  <FRIENDS>
   <ITEM REFCLSNAME="ZAPLINK_OBJECT_DATA" VERSION="1" STATE="1"/>
  </FRIENDS>
  <LOCAL>
   <TYPES>`
*&quot;* USE THIS SOURCE FILE FOR ANY TYPE DECLARATIONS (CLASS
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* IMPLEMENTATION OR PRIVATE METHOD&apos;S SIGNATURE</TYPES>
   <IMPLEMENTATIONS>`
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* use this source file for the implementation part of
*&quot;* LOCAL HELPER CLASSES</IMPLEMENTATIONS>
   <MACROS>`
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS

INCLUDE zaplink_macros.</MACROS>
  </LOCAL>
  <METHODS>
   <ITEM CMPNAME="CONSTRUCTOR" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="3 " MTDTYPE="2">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="CONSTRUCTOR"/>
    </TEXTS>
    <SOURCE>`
  DATA type LIKE LINE OF supported_types.

  CALL METHOD super-&gt;constructor.
  mac_create_log application_log ballog_subobject space.
  type-type = zaplink_object_data=&gt;object_types-class.       INSERT type INTO TABLE supported_types.
  type-type = zaplink_object_data=&gt;object_types-interface.    INSERT type INTO TABLE supported_types.

  uuid = _uuid.
  version = _ver.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="EXPORT_FROM_SAP_CLASS" VERSION="1" STATE="1" EDITORDER="2 " MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Export Class from SAP System"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="COMPONENT" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TO_COMPONENT">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Component key"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="OBJECT" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TO_CLASS">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class data"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_CONNECTOR" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink ROOT Exception for Connectors"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA obj_mask   TYPE doku_obj.
  DATA docu_key   TYPE zaplink_object_data=&gt;ts_doc_key.
  DATA classkey   TYPE seoclskey.
  DATA _d         TYPE t_fm_data.

  TRY.
      CHECK component-&gt;get_type( ) = zaplink_object_data=&gt;object_types-class.

*  _objtype = COMPONENT-type.
      classkey-clsname = component-&gt;get_name( ).
      CALL FUNCTION &apos;SEO_CLASS_TYPEINFO_GET&apos;
        EXPORTING
          clskey                              = classkey
*     VERSION                             = SEOC_VERSION_INACTIVE
*     STATE                               = &apos;1&apos;
*     WITH_DESCRIPTIONS                   = SEOX_TRUE
          resolve_eventhandler_typeinfo       = seox_true
          with_master_language                = seox_true
          with_enhancements                   = seox_true
*     READ_ACTIVE_ENHA                    = SEOX_FALSE
        IMPORTING
          class                               = _d-class
          attributes                          = _d-attributes
          methods                             = _d-methods
          events                              = _d-events
          types                               = _d-types
          PARAMETERS                          = _d-parameters
          exceps                              = _d-exceps
          implementings                       = _d-implementings
          inheritance                         = _d-inheritance
          redefinitions                       = _d-redefinitions
          impl_details                        = _d-impl_details
          friendships                         = _d-friendships
          typepusages                         = _d-typeusages
          clsdeferrds                         = _d-clsdeferrds
          intdeferrds                         = _d-intdeferrds
          explore_inheritance                 = _d-explore_inheritance
          explore_implementings               = _d-explore_implementings
          aliases                             = _d-aliases
          enhancement_methods                 = _d-enhancement_methods
          enhancement_attributes              = _d-enhancement_attributes
          enhancement_events                  = _d-enhancement_events
          enhancement_implementings           = _d-enhancement_implementings
        EXCEPTIONS
          not_existing                        = 1
          is_interface                        = 2
          model_only                          = 3
          OTHERS                              = 4.
      IF sy-subrc &lt;&gt; 0.
        o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_CLASS_TYPEINFO_GET&apos;
                                                    subrc = sy-subrc
                                                classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
        application_log-&gt;add_symsg( ).
        RAISE EXCEPTION o_mycx.
      ENDIF.

* Documentations
      docu_key-name = component-&gt;get_name( ).
      docu_key-other = &apos;*&apos;.
      obj_mask = docu_key.

      _d-documentation = zaplink_documentation=&gt;get( ids = zaplink_object_data=&gt;r_doc_ids-class
                                                  object = obj_mask ).

      CREATE OBJECT object.
      object-&gt;complete_data( CHANGING fm_data = _d ).
      _d-dynpros = get_dynpros( _d-includes-classpool ).    &quot; Issue 8
      _d-menupainter = get_menus( _d-includes-classpool ).  &quot; Issue 9
      _d-textspool = get_prog_textpool( _d-includes-classpool ). &quot; Issue 1
      object-&gt;from_data( _d ).
      object-&gt;_code_signature = get_class_signature( classkey ).

    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="EXPORT_FROM_SAP_INTERFACE" VERSION="1" STATE="1" EDITORDER="3 " MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Export Interface from SAP System"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="COMPONENT" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TO_COMPONENT">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Component key"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="OBJECT" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TO_INTERFACE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class data"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_CONNECTOR" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink ROOT Exception for Connectors"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA obj_mask       TYPE doku_obj.
  DATA docu_key       TYPE zaplink_object_data=&gt;ts_doc_key.
  DATA classkey TYPE seoclskey.
  DATA _d       TYPE t_fm_data.

  TRY.

      CHECK component-&gt;get_type( ) = zaplink_object_data=&gt;object_types-interface.

      classkey-clsname = component-&gt;get_name( ).
      CALL FUNCTION &apos;SEO_INTERFACE_TYPEINFO_GET&apos;
        EXPORTING
          intkey                        = classkey
*     VERSION                       = SEOC_VERSION_INACTIVE
*     STATE                         = &apos;1&apos;
          with_master_language          = seox_true
          with_enhancements             = seox_true
*     READ_ACTIVE_ENHA              = SEOX_FALSE
        IMPORTING
          interface                     = _d-interface
          attributes                    = _d-attributes
          methods                       = _d-methods
          events                        = _d-events
          PARAMETERS                    = _d-parameters
          exceps                        = _d-exceps
          comprisings                   = _d-comprisings
          typepusages                   = _d-typeusages
          clsdeferrds                   = _d-clsdeferrds
          intdeferrds                   = _d-intdeferrds
          explore_comprisings           = _d-explore_comprisings
          aliases                       = _d-aliases
          types                         = _d-types
          enhancement_methods           = _d-enhancement_methods
          enhancement_attributes        = _d-enhancement_attributes
          enhancement_events            = _d-enhancement_events
          enhancement_comprisings       = _d-enhancement_comprisings
        EXCEPTIONS
          not_existing                  = 1
          is_class                      = 2
          model_only                    = 3
          OTHERS                        = 4.
      IF sy-subrc &lt;&gt; 0.
        o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_INTERFACE_TYPEINFO_GET&apos;
                                                    subrc = sy-subrc
                                                classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
        application_log-&gt;add_symsg( ).
        RAISE EXCEPTION o_mycx.
      ENDIF.

* Documentations
      docu_key-name = component-&gt;get_name( ).
      docu_key-other = &apos;*&apos;.
      obj_mask = docu_key.

      _d-documentation = zaplink_documentation=&gt;get( ids = zaplink_object_data=&gt;r_doc_ids-interface
                                                  object = obj_mask ).

      CREATE OBJECT object.
      object-&gt;complete_data( CHANGING fm_data = _d ).
      object-&gt;from_data( _d ).
      object-&gt;_code_signature = get_interface_signature( classkey ).


    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_CLASS_GLOBALSOURCE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="5 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Provide Global source of a class"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CLASS_NAME" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="SEOCLSKEY">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Key structure of a class"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="NOT_A_CLASS" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="The specified object is not a Class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA t_upcode    TYPE td_sourcecode.
  DATA _line       LIKE LINE OF t_upcode.

  CALL FUNCTION &apos;SEO_CLASS_GET&apos;
    EXPORTING
      clskey       = class_name
      version      = seoc_version_inactive
      state        = &apos;0&apos;
    EXCEPTIONS
      not_existing = 1
      deleted      = 2
      is_interface = 3
      model_only   = 4
      OTHERS       = 5.
  IF sy-subrc &lt;&gt; 0.
    RAISE not_a_class.
  ENDIF.
  result = get_class_globalsource_( class_name ).
  result = pretty_printer( result ).
  zaplink_tools=&gt;condense_abap_source( CHANGING table = result ).
  t_upcode = result.
  zaplink_tools=&gt;conv_table_2upcase( CHANGING table = t_upcode ).

*Remove text before CLASS Zxxx DEFINITION
  CONCATENATE &apos;CLASS&apos; class_name &apos;DEFINITION&apos; INTO _line SEPARATED BY space.
  READ TABLE t_upcode TRANSPORTING NO FIELDS  FROM _line.
  CHECK sy-subrc = 0.
  SUBTRACT 1 FROM sy-tabix.   CHECK sy-tabix &gt;= 1.    DELETE result TO sy-tabix.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_CLASS_GLOBALSOURCE_" VERSION="1" STATE="1" EDITORDER="5 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Provide Global source of a class copy of CL_OO_SOURCE"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CLASS_NAME" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="SEOCLSKEY">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Key structure of a class"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
*  DATA d_size TYPE i.
*  FIELD-SYMBOLS &lt;line&gt; TYPE string.
* Copy of CL_OO_SOURCE-&gt;CONSTRUCTOR
  DATA cpool TYPE seo_section_source.
  DATA pubsec TYPE seo_section_source.
  DATA prisec TYPE seo_section_source.
  DATA prosec TYPE seo_section_source.
  DATA cl TYPE seo_section_source.
  DATA ccdef TYPE seop_source_string.
  DATA ccimp TYPE seop_source_string.
  DATA ccmac TYPE seop_source_string.

  DATA incname TYPE program.
  DATA pubsec_incname TYPE program.
  DATA prisec_incname TYPE program.
  DATA prosec_incname TYPE program.
  DATA cl_incname TYPE program.
  DATA ccdef_incname TYPE program.
  DATA ccimp_incname TYPE program.
  DATA ccmac_incname TYPE program.

  DATA meth_inc TYPE seop_method_w_include.
  DATA meth_incs TYPE seop_methods_w_include.
  DATA source_tmp TYPE seop_source_string.

  FIELD-SYMBOLS &lt;source_line&gt; TYPE seo_section_source_line.

  incname = cl_oo_classname_service=&gt;get_classpool_name( class_name-clsname ).
  READ REPORT incname INTO cpool STATE &apos;I&apos;.
  IF sy-subrc &lt;&gt; 0.
    READ REPORT incname INTO cpool STATE &apos;A&apos;.
  ENDIF.

  pubsec_incname = cl_oo_classname_service=&gt;get_pubsec_name( class_name-clsname ).
  READ REPORT pubsec_incname INTO pubsec STATE &apos;I&apos;.
  IF sy-subrc &lt;&gt; 0.
    READ REPORT pubsec_incname INTO pubsec STATE &apos;A&apos;.
  ENDIF.

  prosec_incname = cl_oo_classname_service=&gt;get_prosec_name( class_name-clsname ).
  READ REPORT prosec_incname INTO prosec STATE &apos;I&apos;.
  IF sy-subrc &lt;&gt; 0.
    READ REPORT prosec_incname INTO prosec STATE &apos;A&apos;.
  ENDIF.

  prisec_incname = cl_oo_classname_service=&gt;get_prisec_name( class_name-clsname ).
  READ REPORT prisec_incname INTO prisec STATE &apos;I&apos;.
  IF sy-subrc &lt;&gt; 0.
    READ REPORT prisec_incname INTO prisec STATE &apos;A&apos;.
  ENDIF.

  cl_incname = cl_oo_classname_service=&gt;get_cl_name( class_name-clsname ).
  READ REPORT cl_incname INTO cl STATE &apos;I&apos;.
  IF sy-subrc &lt;&gt; 0.
    READ REPORT cl_incname INTO cl STATE &apos;A&apos;.
  ENDIF.

  ccdef_incname = cl_oo_classname_service=&gt;get_ccdef_name( class_name-clsname ).
  READ REPORT ccdef_incname INTO ccdef STATE &apos;I&apos;.
  IF sy-subrc &lt;&gt; 0.
    READ REPORT ccdef_incname INTO ccdef STATE &apos;A&apos;.
  ENDIF.

  ccimp_incname = cl_oo_classname_service=&gt;get_ccimp_name( class_name-clsname ).
  READ REPORT ccimp_incname INTO ccimp STATE &apos;I&apos;.
  IF sy-subrc &lt;&gt; 0.
    READ REPORT ccimp_incname INTO ccimp STATE &apos;A&apos;.
  ENDIF.

  ccmac_incname = cl_oo_classname_service=&gt;get_ccmac_name( class_name-clsname ).
  READ REPORT ccmac_incname INTO ccmac STATE &apos;I&apos;.
  IF sy-subrc &lt;&gt; 0.
    READ REPORT ccmac_incname INTO ccmac STATE &apos;A&apos;.
  ENDIF.

  meth_incs = cl_oo_classname_service=&gt;get_all_method_includes( class_name-clsname ).

* Issue 68 : Methods are in historical order on the development system and in alphabetic order on a fresh install system
  SORT meth_incs BY cpdkey.         &quot; Issue 68 : Force alphabetic order
* End of change in Copy of CL_OO_SOURCE-&gt;CONSTRUCTOR

  LOOP AT cpool ASSIGNING &lt;source_line&gt;.
    IF &lt;source_line&gt; CS pubsec_incname.
      APPEND LINES OF pubsec TO result.
    ELSEIF &lt;source_line&gt; CS prosec_incname.
      APPEND LINES OF prosec TO result.
    ELSEIF &lt;source_line&gt; CS prisec_incname.
      APPEND LINES OF prisec TO result.
    ELSEIF &lt;source_line&gt; CS cl_incname.
      APPEND LINES OF cl TO result.
    ELSEIF &lt;source_line&gt; CS ccdef_incname.
      APPEND LINES OF ccdef TO result.
    ELSEIF &lt;source_line&gt; CS ccimp_incname.
      APPEND LINES OF ccimp TO result.
    ELSEIF &lt;source_line&gt; CS ccmac_incname.
      APPEND LINES OF ccmac TO result.
    ELSEIF &lt;source_line&gt; CS &apos;include methods&apos;.
      LOOP AT meth_incs INTO meth_inc.
        READ REPORT meth_inc-incname INTO source_tmp STATE &apos;I&apos;.
        IF sy-subrc &lt;&gt; 0.
          READ REPORT meth_inc-incname INTO source_tmp STATE &apos;A&apos;.
        ENDIF.
        IF sy-subrc = 0.
** Issue 68 : Method (and endmethod) declaration is not case sensible, but when using pretty printer method and endmethod could change from default (method MY_METHOD.) =&gt; UPCASE
*          READ TABLE source_tmp ASSIGNING &lt;line&gt; INDEX 1.
*          TRANSLATE &lt;line&gt; TO UPPER CASE.
*          d_size = LINES( source_tmp ).
*          READ TABLE source_tmp ASSIGNING &lt;line&gt; INDEX d_size.
*          TRANSLATE &lt;line&gt; TO UPPER CASE.
** End of change in Copy of CL_OO_SOURCE-&gt;CONSTRUCTOR
          APPEND LINES OF source_tmp TO result.
        ENDIF.
      ENDLOOP.
    ELSE.
      APPEND &lt;source_line&gt; TO result.
    ENDIF .
  ENDLOOP.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_CLASS_SIGNATURE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="2 " MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Get Source code Signature of class">
      <DOCUMENTATION TDFRELES="700" TDLINESIZE="072">U1&amp;FUNCTIONALITY&amp;
ASRetrieve MD5 Hash from ABAP Class source code. After removing :
B1Blank lines
B1Comment lines
U1&amp;PRECONDITION&amp;
AS
U1&amp;RESULT&amp;
AS
U1&amp;PARAMETERS&amp;
AS
U1&amp;EXCEPTIONS&amp;
AS
U1&amp;HINTS&amp;
AS</DOCUMENTATION>
     </ITEM>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="CLASS_NAME" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="SEOCLSKEY">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Key structure of a class"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="ZAPLINK_DATATYPES~TD_CHECKSUM">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Source Code Signature (Checksum)"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_CONNECTOR" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink ROOT Exception for Connectors"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA d_type    TYPE td_comptype.
  DATA t_code    TYPE td_sourcecode.
  DATA d_src     TYPE string.

  t_code = get_class_globalsource( class_name ).
  d_src = zaplink_tools=&gt;table_2_string( t_code ).
  d_src = zaplink_tools=&gt;clean_abap_string( d_src ).
  result = zaplink_tools=&gt;calculate_md5_hash( d_src ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_INTERFACE_GLOBALSOURCE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="4 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Provide Global source of a interface"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="INTERFACE_NAME" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="SEOCLSKEY">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Key structure of a class"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="FAILED" VERSION="1" LANGU="E" EDITORDER="2 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Other system errors"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="NOT_A_CLASS" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="The specified object is not a Class"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA d_prog     TYPE program.
  DATA t_upcode   TYPE td_sourcecode.
  DATA _line      LIKE LINE OF t_upcode.

  d_prog = cl_oo_classname_service=&gt;get_intfsec_name( interface_name-clsname ).

  READ REPORT d_prog INTO result.
  zaplink_tools=&gt;condense_abap_source( CHANGING table = result ).
  t_upcode = result.    zaplink_tools=&gt;conv_table_2upcase( CHANGING table = t_upcode ).

*Remove text before CLASS Zxxx DEFINITION
  CONCATENATE &apos;INTERFACE&apos; interface_name INTO _line SEPARATED BY space.
  READ TABLE t_upcode TRANSPORTING NO FIELDS  FROM _line.
  CHECK sy-subrc = 0.
  SUBTRACT 1 FROM sy-tabix.   CHECK sy-tabix &gt;= 1.   DELETE result TO sy-tabix.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_INTERFACE_SIGNATURE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " MTDDECLTYP="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Get Source code Signature of interface">
      <DOCUMENTATION TDFRELES="700" TDLINESIZE="072">U1&amp;FUNCTIONALITY&amp;
ASRetrieve MD5 Hash from ABAP Class source code. After removing :
B1Blank lines
B1Comment lines
U1&amp;PRECONDITION&amp;
AS
U1&amp;RESULT&amp;
AS
U1&amp;PARAMETERS&amp;
AS
U1&amp;EXCEPTIONS&amp;
AS
U1&amp;HINTS&amp;
AS</DOCUMENTATION>
     </ITEM>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="INTERFACE_NAME" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="SEOCLSKEY">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Key structure of a class"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="ZAPLINK_DATATYPES~TD_CHECKSUM">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Source Code Signature (Checksum)"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_CONNECTOR" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink ROOT Exception for Connectors"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA d_type    TYPE td_comptype.
  DATA t_code    TYPE td_sourcecode.
  DATA d_src     TYPE string.

  t_code = get_interface_globalsource( interface_name ).
  d_src = zaplink_tools=&gt;table_2_string( t_code ).
  d_src = zaplink_tools=&gt;clean_abap_string( d_src ).
  result = zaplink_tools=&gt;calculate_md5_hash( d_src ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="IMPORT_TO_SAP_CLASS" VERSION="1" STATE="1" EDITORDER="1 " MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Import Class into SAP system"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="COMPONENTS" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TO_LIST">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Components"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="O_DATA" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TO_CLASS">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Class data"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_CONNECTOR" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink ROOT Exception for Connectors"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _d               TYPE t_fm_data.
  DATA i_korrnr         TYPE trkorr.              &quot;#EC NEEDED for debug
  DATA _component       TYPE to_component.
  DATA _name            TYPE td_compname.

  TRY.

      _d = o_data-&gt;to_data( ).

* Exceptions texts
      IF NOT _d-exceptions_texts IS INITIAL.
        zaplink_clas_data=&gt;update_concept( EXPORTING msg_col = application_log
                                           CHANGING  fm_data = _d ).
      ENDIF.

      CALL FUNCTION &apos;SEO_BUFFER_INIT&apos;.
      CALL FUNCTION &apos;SEO_CLASS_CREATE_COMPLETE&apos;
       EXPORTING
*     corrnr                             = e_corrnr
*     devclass                           = &apos;$TMP&apos;                &quot;devclass
*     version                            = e_version
*     genflag                            = e_genflag
*     authority_check                    = e_authority_check
         overwrite                          = &apos;X&apos;                   &quot;overwrite
*   SUPPRESS_METHOD_GENERATION         = e_suppress_meth_gen
*   SUPPRESS_REFACTORING_SUPPORT       = e_suppress_refac_gen
         method_sources                     = _d-method_sources    &quot; Methods source
         locals_def                         = _d-locals_def        &quot; LOCAL_TYPES
         locals_imp                         = _d-locals_imp        &quot; LOCAL_IMP
         locals_mac                         = _d-locals_mac        &quot; MACROS
*   SUPPRESS_INDEX_UPDATE              = e_suppress_ind_update
       IMPORTING
         korrnr                             = i_korrnr
       TABLES
         class_descriptions                 = _d-class_desc
         component_descriptions             = _d-component_desc
         subcomponent_descriptions          = _d-subcomponent_desc
       CHANGING
         class                              = _d-class
         inheritance                        = _d-inheritance
         redefinitions                      = _d-redefinitions
         implementings                      = _d-implementings
         impl_details                       = _d-impl_details
         attributes                         = _d-attributes
         methods                            = _d-methods
         events                             = _d-events
         types                              = _d-types
*   TYPE_SOURCE                        = ch_type_source &quot;???
         PARAMETERS                         = _d-parameters
         exceps                             = _d-exceps
         aliases                            = _d-aliases
         typepusages                        = _d-typeusages
         clsdeferrds                        = _d-clsdeferrds
         intdeferrds                        = _d-intdeferrds
         friendships                        = _d-friendships
       EXCEPTIONS
         existing                           = 1
         is_interface                       = 2
         db_error                           = 3
         component_error                    = 4
         no_access                          = 5
         other                              = 6
         OTHERS                             = 7.
      CASE sy-subrc.
        WHEN 0.
** i guess if we made it this far, we will assume success
** successful install
        WHEN OTHERS.
          o_mycx ?= zaplink_cx=&gt;create_from_mf_cx( funcname = &apos;SEO_CLASS_CREATE_COMPLETE&apos;
                                                      subrc = sy-subrc
                                                  classname = &apos;ZAPLINK_CX_CONNECTOR&apos; ).
          application_log-&gt;add_symsg( ).
          RAISE EXCEPTION o_mycx.
      ENDCASE.

      _d-includes = zaplink_object_data=&gt;get_includes( _d-class-clsname ).
      set_dynpros( program = _d-includes-classpool          &quot; Issue 8
                   dynpros = _d-dynpros ).
      set_menus( program = _d-includes-classpool            &quot; Issue 9
                   menus = _d-menupainter ).
      set_prog_textpool( program = _d-includes-classpool    &quot; Issue 1
                        textpool = _d-textspool ).

      zaplink_documentation=&gt;set( _d-documentation ).

      CREATE OBJECT _component.
      _component-&gt;set_type( zaplink_object_data=&gt;object_types-class ).
      _name = _d-class-clsname.
      _component-&gt;set_name( _name ).
      CREATE OBJECT components.
      components-&gt;add( _component ).

    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="IMPORT_TO_SAP_INTERFACE" VERSION="1" STATE="1" EDITORDER="4 " MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Import Interface into SAP system"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="COMPONENTS" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARDECLTYP="3" TYPTYPE="1" TYPE="TO_LIST">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Components"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="O_DATA" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TO_INTERFACE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Interface data"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_CONNECTOR" VERSION="1" LANGU="E" EDITORDER="1 ">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink ROOT Exception for Connectors"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA _d           TYPE t_fm_data.
  DATA i_korrnr     TYPE trkorr.                  &quot;#EC NEEDED for debug
  DATA _component   TYPE to_component.
  DATA _name        TYPE td_compname.

  TRY.

      _d = o_data-&gt;to_data( ).

      CALL FUNCTION &apos;SEO_BUFFER_INIT&apos;.
      CALL FUNCTION &apos;SEO_INTERFACE_CREATE_COMPLETE&apos;
        EXPORTING
*     CORRNR                             =
*     devclass                           = &apos;$TMP&apos;
*     VERSION                            = SEOC_VERSION_INACTIVE
*     GENFLAG                            = &apos; &apos;
*     AUTHORITY_CHECK                    = SEOX_TRUE
          overwrite                          = seox_true
*     SUPPRESS_REFACTORING_SUPPORT       = SEOX_TRUE
        IMPORTING
          korrnr                             = i_korrnr
        TABLES
          class_descriptions                 = _d-class_desc
          component_descriptions             = _d-component_desc
          subcomponent_descriptions          = _d-subcomponent_desc
        CHANGING
          interface                          = _d-interface
          comprisings                        = _d-comprisings
          attributes                         = _d-attributes
          methods                            = _d-methods
          events                             = _d-events
          PARAMETERS                         = _d-parameters
          exceps                             = _d-exceps
          aliases                            = _d-aliases
          typepusages                        = _d-typeusages
          clsdeferrds                        = _d-clsdeferrds
          intdeferrds                        = _d-intdeferrds
          types                              = _d-types
        EXCEPTIONS
          existing                           = 1
          is_class                           = 2
          db_error                           = 3
          component_error                    = 4
          no_access                          = 5
          other                              = 6
          OTHERS                             = 7.
      CASE sy-subrc.
        WHEN &apos;0&apos;.
** i guess if we made it this far, we will assume success
** successful install
        WHEN OTHERS.
          RAISE EXCEPTION TYPE zaplink_cx_connector
            EXPORTING textid = zaplink_cx_connector=&gt;system_error.
      ENDCASE.

* Patch SAP do not create type alias.
      DATA  intkey TYPE seoclskey.
      DATA  type   TYPE vseotype.
      FIELD-SYMBOLS &lt;alias&gt; LIKE LINE OF _d-aliases.

      LOOP AT _d-aliases ASSIGNING &lt;alias&gt;
              WHERE cmptype = seoo_cmptype_type.
        MOVE-CORRESPONDING &lt;alias&gt; TO type.
        type-alias = seox_true.
        type-state = seoc_state_implemented.
        CALL FUNCTION &apos;SEO_TYPE_CREATE_F_DATA&apos;
          EXPORTING
            save   = seox_false
          CHANGING
            type   = type
          EXCEPTIONS
            OTHERS = 1.
        IF sy-subrc &lt;&gt; 0.
          CALL METHOD application_log-&gt;add_symsg
            EXPORTING
              id_msgty = &apos;W&apos;.
        ENDIF.
      ENDLOOP.
      MOVE-CORRESPONDING _d-interface TO intkey.
      CALL FUNCTION &apos;SEO_CLIF_SAVE_ALL&apos;
        EXPORTING
          cifkey                        = intkey
          suppress_refactoring_entries  = seox_true
          suppress_modification_support = seox_true
*    CHANGING
*      corrnr                        = corrnr
*      devclass                      = devclass
*      genflag                       = genflag
        EXCEPTIONS
          db_error                      = 1
          OTHERS                        = 2.
      IF sy-subrc &lt;&gt; 0.
        CALL METHOD application_log-&gt;add_symsg
          EXPORTING
            id_msgty = &apos;W&apos;.
      ENDIF.

      zaplink_documentation=&gt;set( o_data-&gt;documentation ).

      CREATE OBJECT _component.
      _component-&gt;set_type( zaplink_object_data=&gt;object_types-interface ).
      _name = _d-interface-clsname.
      _component-&gt;set_name( _name ).
      CREATE OBJECT components.
      components-&gt;add( _component ).

    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
    CATCH zaplink_cx INTO o_cx.
      mac_cascade_raise o_mycx o_cx.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="PRETTY_PRINTER" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="6 " MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Applie Pretty Printer to Source code"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="INDENT" VERSION="1" CMPTYPE="1" EDITORDER="2 " PARPASSTYP="1" TYPTYPE="1" TYPE="ABAP_BOOL" PAROPTIONL="X">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Indent while Pretty Printer"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="3 " PARDECLTYP="3" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="SOURCECODE" VERSION="1" CMPTYPE="1" EDITORDER="1 " PARPASSTYP="1" TYPTYPE="1" TYPE="TD_SOURCECODE">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  FIELD-SYMBOLS &lt;a&gt;   TYPE ANY.
  DATA d_remotedata   TYPE string.
  DATA v_extend_mod   TYPE char255.
  DATA v_komprmode(1) TYPE c VALUE &apos;0&apos;.
  DATA v_edit_control TYPE c.
  DATA v_status_flag  TYPE char255.
  DATA v_convert_mode	TYPE rseumod.
  DATA v_source_id    TYPE sy-repid.
  DATA v_overflow_area TYPE char255.
  DATA v_content_fill TYPE sy-index.
  DATA v_msg          TYPE char255.
  DATA v_incl         TYPE char255.
  DATA v_row          TYPE char255.
  DATA v_col          TYPE char255.
  DATA v_wrd(30)      TYPE c.
  DATA v_scanned      TYPE char255.
  DATA t_mod_tab      TYPE smodi_mod_tab.
  DATA t_lineindex    TYPE STANDARD TABLE OF edlineindx.
  DATA t_tk           TYPE sedi_tk.
  DATA t_stm          TYPE STANDARD TABLE OF sstmnt.

  DEFINE mac_assign.
    d_remotedata = &amp;1.
    assign (d_remotedata) to &lt;a&gt;.
    if sy-subrc = 0. &lt;a&gt; = &amp;2. endif.
  END-OF-DEFINITION.

* To load Funtion Group in memory
  CALL FUNCTION &apos;CONVERT_EDITOR_SOURCE&apos;
    EXPORTING
      convert_mode        = v_convert_mode
      source_id           = v_source_id
      extend_mod          = v_extend_mod
      komprmode           = v_komprmode
      edit_control        = v_edit_control
      status_flag         = v_status_flag
*     C_EDITOR            =
    TABLES
      content             = result
      tk                  = t_tk
      stm                 = t_stm
      lineindex           = t_lineindex
      mod_tab             = t_mod_tab
    CHANGING
      overflow_area       = v_overflow_area
      content_fill        = v_content_fill
      msg                 = v_msg
      incl                = v_incl
      row                 = v_row
      col                 = v_col
      wrd                 = v_wrd
      scanned             = v_scanned.

  result = sourcecode.
  IF indent &lt;&gt; abap_true.   v_convert_mode-indent = &apos;0&apos;.    ENDIF.
* From FUNCTION &apos;CONVERT_EDITOR_SOURCE&apos;
*  IF RSEUMOD-LOWERCASE = &apos;X&apos; AND RSEUMOD-STYLE NE SPACE.
*    CASE_MODE = &apos;LOWER&apos;.
*  ELSEIF RSEUMOD-LOWERCASE = &apos;G&apos; AND RSEUMOD-STYLE NE SPACE.
*    CASE_MODE = &apos;HIKEY&apos;.
*  ELSEIF RSEUMOD-STYLE NE SPACE.
*    CASE_MODE = &apos;UPPER&apos;.
*  ELSE.
*    CASE_MODE = &apos;EMPTY&apos;.
*  ENDIF.
  mac_assign &apos;(SAPLLOCAL_EDT1)RSEUMOD-STYLE&apos; abap_true.   &quot; Change code to ....
  mac_assign &apos;(SAPLLOCAL_EDT1)RSEUMOD-LOWERCASE&apos; space.   &quot; UPPER CASE
  mac_assign &apos;(SAPLLOCAL_EDT1)EDIT-APP_ABAP&apos; abap_true.   &quot; ABAP Editor
  mac_assign &apos;(SAPLLOCAL_EDT1)EDIT-LINE_SIZE&apos; swbse_c_max_line_width.       &quot; Line Size

  CALL FUNCTION &apos;CONVERT_EDITOR_SOURCE&apos;
    EXPORTING
      convert_mode        = v_convert_mode
      source_id           = v_source_id
      extend_mod          = v_extend_mod
      komprmode           = v_komprmode
      edit_control        = v_edit_control
      status_flag         = v_status_flag
*     C_EDITOR            =
    TABLES
      content             = result
      tk                  = t_tk
      stm                 = t_stm
      lineindex           = t_lineindex
      mod_tab             = t_mod_tab
    CHANGING
      overflow_area       = v_overflow_area
      content_fill        = v_content_fill
      msg                 = v_msg
      incl                = v_incl
      row                 = v_row
      col                 = v_col
      wrd                 = v_wrd
      scanned             = v_scanned.
*     ENH_INSTANCE        =

* Old way
*  DATA t_step TYPE STANDARD TABLE OF edstep.
*  DATA t_lineindex  TYPE STANDARD TABLE OF edlineindx.
*  DATA t_usercom  TYPE STANDARD TABLE OF edusercoms.
*  DATA t_page  TYPE rswsourcet.
*  DATA t_tk  TYPE sedi_tk.
*  DATA t_stm  TYPE STANDARD TABLE OF sstmnt.
*  DATA t_linenum TYPE STANDARD TABLE OF edlinenum.
*  DATA t_linecoms TYPE STANDARD TABLE OF edlinecoms.
*  DATA t_delete_tab TYPE smodi_src_tab.
*  DATA t_smodisrc_tab TYPE smodi_src_tab.
**&quot;     VALUE(CALLBACK_USERCOM) TYPE  RSTXP-TDOBJECT DEFAULT SPACE
**&quot;     VALUE(CALLBACK_CHECK) TYPE  RSTXP-TDOBJECT DEFAULT SPACE
**&quot;     VALUE(CALLBACK_SAVE) TYPE  RSTXP-TDOBJECT DEFAULT SPACE
**&quot;     VALUE(CALLBACK_PROGRAM) LIKE  TRDIR-NAME DEFAULT SPACE
**&quot;     VALUE(CALLBACK_SET_PFKEY) TYPE  RSTXP-TDOBJECT DEFAULT SPACE
**&quot;     VALUE(CALLBACK_BEFORE_FUNCTION) TYPE  RSTXP-TDOBJECT DEFAULT
**&quot;       SPACE
**&quot;     VALUE(CALLBACK_AFTER_FUNCTION) TYPE  RSTXP-TDOBJECT DEFAULT
**&quot;       SPACE
*  DATA v_editor_mode TYPE editormode.
*  DATA v_case_mode(5) TYPE c VALUE &apos;UPPER&apos;.
*  DATA v_komprmode(1) TYPE c VALUE &apos;0&apos;.
*  DATA v_edit_control TYPE c.
*  DATA v_cursor_i TYPE sedi_cursor.
*  DATA v_control_content TYPE cxtab_control.
*  DATA v_content_display TYPE sy-index.
*  DATA v_content_fill TYPE sy-index.
*  DATA v_content_fill_c TYPE sy-index.
*  DATA v_linecom_shift_places TYPE sy-index.
*  DATA v_fcode_i TYPE tse02-progfun VALUE &apos;PGPP&apos;.
*  DATA v_flag_replconf TYPE boolean.
*  DATA v_flag_auto_scroll TYPE boolean.
*  DATA v_linecom_was_executed TYPE char255.
*  DATA v_edit TYPE s38e.
*  DATA v_new_content_display TYPE sy-index.
*  DATA v_pcmode TYPE string VALUE &apos;2&apos;.
*  DATA v_tdcommline TYPE  rstxp-tdcommline.
*  DATA v_tdparam TYPE  rstxp-tdparam.
*  DATA v_tdparam2 TYPE  rstxp-tdparam.
*  DATA v_tdattach TYPE  rstxp-tdattach.
*  DATA v_flag_linecom_reset TYPE char255.
*  DATA v_undo_exported TYPE char255.
*  DATA v_s_modified TYPE char255.
*  DATA v_editor_content_modified TYPE char255.
*  DATA:  BEGIN OF v_remember_i,
*           index1 LIKE sy-tabix,
*           offset1 LIKE sy-fdpos,
*           linecom1(2),
*           index2 LIKE sy-tabix,
*           offset2 LIKE sy-fdpos,
*           linecom2(2),
*           content_display1 TYPE i,        &quot;CONTENT_DISPLAY zu INDEX1
*           content_display2 TYPE i,        &quot;CONTENT_DISPLAY zu INDEX2
*           side,
*        END OF v_remember_i.
**  DATA v_remember_i TYPE char255.
*  DATA v_scanned TYPE char255.
*  DATA v_new_source TYPE char255.
*  DATA v_h TYPE d020s.
*  DATA v_dynpro_language_import TYPE sy-langu.
*  DATA v_dynpro_text TYPE char255.
*  DATA v_motif TYPE char255.
*  DATA v_content_app_id TYPE s38e-app_id VALUE &apos;PG&apos;.
*  DATA v_status_flag TYPE char255.
*  DATA v_lines_appended TYPE sy-index.
*  DATA v_mark_flag TYPE char255.
*  DATA v_lineal_mode TYPE char255.
*  DATA v_auto_correct TYPE c.
*  DATA v_suppress_dialog_flag TYPE string VALUE abap_true.
*  DATA v_title TYPE char255.
*  DATA v_content_display_new TYPE sy-index.
*  DATA v_change_mod_flag TYPE char255.
*  DATA v_dynpro_lines TYPE sy-index.
*  DATA v_usercom_filled TYPE char255.
*  DATA v_exclude_filled TYPE char255.
*  DATA v_extend_mod TYPE char255.
*  DATA v_dynpro_mod TYPE char255.
*  DATA v_content_save_flag TYPE char255.
*  DATA v_in_linenumber_field TYPE char255.
*  DATA v_scrp_edtr_interface_flag TYPE char255.
*  DATA v_with_next TYPE char255.
*  DATA v_overflow_area TYPE char255.
*  DATA v_msg TYPE char255.
*  DATA v_incl TYPE char255.
*  DATA v_row TYPE char255.
*  DATA v_col TYPE char255.
*  DATA v_wrd(30) TYPE c.
*  DATA v_korrnum TYPE e070-trkorr.
*  DATA v_f1_flag TYPE char255.
**&quot;     VALUE(DYNPRO_IS_GENERATED) DEFAULT SPACE
**&quot;     VALUE(DYNPRO_IS_IN_WA) DEFAULT SPACE
**&quot;     VALUE(DYNPRO_IS_IN_FOREIGN_WA) DEFAULT SPACE
**&quot;     VALUE(WITH_ACTIVE_SOURCES) DEFAULT SPACE
*  DATA v_changed_max_line_neu TYPE sy-index VALUE 99999.
*  DATA v_changed_max_line_neu_c TYPE sy-index VALUE 99999.
*  DATA v_changed_min_line_neu TYPE sy-index.
*  DATA v_changed_min_line_neu_c TYPE sy-index.
*  DATA v_changed_min_line_alt TYPE sy-index.
*  DATA v_changed_min_line_alt_c TYPE sy-index.
*  DATA v_changed_max_line_alt TYPE sy-index VALUE 99999.
*  DATA v_changed_max_line_alt_c TYPE sy-index VALUE 99999.
*  DATA v_diff_altneu TYPE sy-index.
*  DATA v_diff_altneu_c TYPE sy-index.
*  DATA v_fb_name TYPE rs38l-name.
*  DATA v_enter_w TYPE tse04-linecomtxt.
**&quot;     VALUE(TRDIR_INF) LIKE  TRDIR STRUCTURE  TRDIR DEFAULT SPACE
**&quot;     VALUE(FIND_LEN) LIKE  SY-FDPOS OPTIONAL
**&quot;     VALUE(REPLACE_LEN) LIKE  SY-FDPOS OPTIONAL
**&quot;     VALUE(C_EDITOR) TYPE REF TO  OBJECT OPTIONAL
**&quot;     VALUE(CONTAINER_NEW) TYPE REF TO  CL_GUI_CUSTOM_CONTAINER OPTIONAL
**data v_CONTAINER_NEW1) TYPE REF TO  CL_GUI_CONTAINER OPTIONAL
**&quot;     VALUE(C1_EDITOR) TYPE REF TO  C_TEXTEDIT_CONTROL OPTIONAL
**&quot;     VALUE(ERROR_HANDLE) TYPE  CNTL_HANDLE OPTIONAL
**&quot;     VALUE(OLD_FCODE) LIKE  TSE02-PROGFUN OPTIONAL
**&quot;     VALUE(IDENT_FLAG) TYPE  CHAR1 OPTIONAL
**&quot;     VALUE(TRANSPORT_KEY) LIKE  TRKEY STRUCTURE  TRKEY OPTIONAL
**&quot;     VALUE(P_DOCU_CONTAINER) TYPE REF TO  CL_GUI_CONTROL OPTIONAL
**&quot;     REFERENCE(MOD_INSTANCE) TYPE REF TO  CL_CLM_TOOL_LOG OPTIONAL
**&quot;     VALUE(CONTROL_TYPE) TYPE  C DEFAULT SPACE
**&quot;     REFERENCE(ENH_INSTANCE) TYPE REF TO  CL_ENH_HOOK_CONTAINER
**&quot;       OPTIONAL
**&quot;     REFERENCE(SUBCONTAINER_TAB) TYPE  SEDI_SUB_CONT_TAB OPTIONAL
*  mac_assign &apos;(SAPLLOCAL_EDT1)RSEUMOD-STYLE&apos; &apos;X&apos;.
*  v_edit-app_id = &apos;PG&apos;.
*  v_edit-app_disp = &apos;A&apos;.
*  v_edit-app_obj  = &apos;ABAP&apos;.
*  v_edit-app_abap = abap_true.
**  v_edit-BUF_NAME                                      ZAPLINK_OBJECT================CM00P
**                                     BUF_CULINE                                      000001
**                                     BUF_SCLINE                                      000001
**                                     BUF_CUOFFS                                      000
**                                     BUF_CUWORD
**                                     BUF_CUSTRG
*  v_edit-line_size = 1024.
*  v_edit-app_prog = abap_true.
*
*  CALL FUNCTION &apos;USERCOM_INPUT&apos;
**   EXPORTING
**     LINE_NAME                      = &apos;RSTXP-TDLINE&apos;
**     FIRST_NAME                     = &apos;RSTXP-TDFIRST&apos;
**     LAST_NAME                      = &apos;RSTXP-TDLAST&apos;
**     TOTAL_NAME                     = &apos;RSTXP-TDTOTAL&apos;
**     MARK_NAME                      = &apos;RSTXP-TDMARK&apos;
**     MARK1_NAME                     = &apos;RSTXP-TDMARK1&apos;
**     COMMLINE_NAME                  = &apos;RSTXP-TDCOMMLINE&apos;
**     LINECOM_NAME                   = &apos;RSTXP-TDLINECOM&apos;
**     SPLIT_CALL                     = &apos; &apos;
**     INITIALIZE_EDIT_CONTROL        = &apos;X&apos;
**     C_HANDLE                       =
*    TABLES
*      step                           = t_step
*      content                        = sourcecode
*      content_c                      = result
*      lineindex                      = t_lineindex
*      usercom                        = t_usercom
*      page                           = t_page
*      tk                             = t_tk
*      stm                            = t_stm
**     E                              =
**     F                              =
**     M                              =
**     SMODILOG_ABAP                  =
**     MOD_TAB                        =
*      linenum                        = t_linenum
*      linecoms                       = t_linecoms
**     BUFFER                         =
**     BUFFER_C                       =
**     MESSAGE_TAB_I                  =
*      delete_tab                     = t_delete_tab
*      smodisrc_tab                   = t_smodisrc_tab
*    CHANGING
**     CALLBACK_USERCOM               = &apos; &apos;
**     CALLBACK_CHECK                 = &apos; &apos;
**     CALLBACK_SAVE                  = &apos; &apos;
**     CALLBACK_PROGRAM               = &apos; &apos;
**     CALLBACK_SET_PFKEY             = &apos; &apos;
**     CALLBACK_BEFORE_FUNCTION       = &apos; &apos;
**     CALLBACK_AFTER_FUNCTION        = &apos; &apos;
*      editor_mode                    = v_editor_mode
*      case_mode                      = v_case_mode
*      komprmode                      = v_komprmode
*      edit_control                   = v_edit_control
*      cursor_i                       = v_cursor_i
*      control_content                = v_control_content
*      content_display                = v_content_display
*      content_fill                   = v_content_fill
*      content_fill_c                 = v_content_fill_c
*      linecom_shift_places           = v_linecom_shift_places
*      fcode_i                        = v_fcode_i
*      flag_replconf                  = v_flag_replconf
*      flag_auto_scroll               = v_flag_auto_scroll
*      linecom_was_executed           = v_linecom_was_executed
*      edit                           = v_edit
*      new_content_display            = v_new_content_display
*      pcmode                         = v_pcmode
*      tdcommline                     = v_tdcommline
*      tdparam                        = v_tdparam
*      tdparam2                       = v_tdparam2
*      tdattach                       = v_tdattach
*      flag_linecom_reset             = v_flag_linecom_reset
*      undo_exported                  = v_undo_exported
*      s_modified                     = v_s_modified
*      editor_content_modified        = v_editor_content_modified
*      remember_i                     = v_remember_i
*      scanned                        = v_scanned
*      new_source                     = v_new_source
*      h                              = v_h
*      dynpro_language_import         = v_dynpro_language_import
*      dynpro_text                    = v_dynpro_text
*      motif                          = v_motif
*      content_app_id                 = v_content_app_id
*      status_flag                    = v_status_flag
*      lines_appended                 = v_lines_appended
*      mark_flag                      = v_mark_flag
*      lineal_mode                    = v_lineal_mode
*      auto_correct                   = v_auto_correct
*      suppress_dialog_flag           = v_suppress_dialog_flag
*      title                          = v_title
*      content_display_new            = v_content_display_new
*      change_mod_flag                = v_change_mod_flag
*      dynpro_lines                   = v_dynpro_lines
*      usercom_filled                 = v_usercom_filled
*      exclude_filled                 = v_exclude_filled
*      extend_mod                     = v_extend_mod
*      dynpro_mod                     = v_dynpro_mod
*      content_save_flag              = v_content_save_flag
*      in_linenumber_field            = v_in_linenumber_field
*      scrp_edtr_interface_flag       = v_scrp_edtr_interface_flag
*      with_next                      = v_with_next
*      overflow_area                  = v_overflow_area
*      msg                            = v_msg
*      incl                           = v_incl
*      row                            = v_row
*      col                            = v_col
*      wrd                            = v_wrd
*      korrnum                        = v_korrnum
*      f1_flag                        = v_f1_flag
**DYNPRO_IS_GENERATED = v_DYNPRO_IS_GENERATED
**DYNPRO_IS_IN_WA = v_DYNPRO_IS_IN_WA
**DYNPRO_IS_IN_FOREIGN_WA = v_DYNPRO_IS_IN_FOREIGN_WA
**WITH_ACTIVE_SOURCES = v_WITH_ACTIVE_SOURCES
*      changed_max_line_neu           = v_changed_max_line_neu
*      changed_max_line_neu_c         = v_changed_max_line_neu_c
*      changed_min_line_neu           = v_changed_min_line_neu
*      changed_min_line_neu_c         = v_changed_min_line_neu_c
*      changed_min_line_alt           = v_changed_min_line_alt
*      changed_min_line_alt_c         = v_changed_min_line_alt_c
*      changed_max_line_alt           = v_changed_max_line_alt
*      changed_max_line_alt_c         = v_changed_max_line_alt_c
*      diff_altneu                    = v_diff_altneu
*      diff_altneu_c                  = v_diff_altneu_c
*      fb_name                        = v_fb_name
*      enter_w                        = v_enter_w.
**     TRDIR_INF                      = &apos; &apos;
**     FIND_LEN                       =
**     REPLACE_LEN                    =
**     C_EDITOR                       =
**     CONTAINER_NEW                  =
**     CONTAINER_NEW1                 =
**     C1_EDITOR                      =
**     ERROR_HANDLE                   =
**     OLD_FCODE                      =
**     IDENT_FLAG                     =
**     TRANSPORT_KEY                  =
**     P_DOCU_CONTAINER               =
**     MOD_INSTANCE                   =
**     CONTROL_TYPE                   = &apos; &apos;
**     ENH_INSTANCE                   =
**     SUBCONTAINER_TAB               =</SOURCE>
   </ITEM>
  </METHODS>
  <REDEFINITIONS>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CNX_EXT_CLEANER~ANONYMIZE">
    <SOURCE>`
  DATA _o_class       TYPE to_class.
  DATA _o_interface   TYPE to_interface.

  TRY.
      super-&gt;zaplink_cnx_ext_cleaner~anonymize( object ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.

  CASE object-&gt;type.
    WHEN zaplink_object_data=&gt;object_types-class.
      _o_class ?= object-&gt;raw.
      _o_class-&gt;anonymize( ).
    WHEN zaplink_object_data=&gt;object_types-interface.
      _o_interface ?= object-&gt;raw.
      _o_interface-&gt;anonymize( ).
    WHEN OTHERS.
  ENDCASE.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CNX_EXT_CLEANER~UNANONYMIZE">
    <SOURCE>`
  DATA _o_class       TYPE to_class.
  DATA _o_interface   TYPE to_interface.

  TRY.
      super-&gt;zaplink_cnx_ext_cleaner~unanonymize( object ).
    CATCH zaplink_cx_connector INTO o_mycx.
      RAISE EXCEPTION o_mycx.
  ENDTRY.

  CASE object-&gt;type.
    WHEN zaplink_object_data=&gt;object_types-class.
      _o_class ?= object-&gt;raw.
      _o_class-&gt;unanonymize( ).
    WHEN zaplink_object_data=&gt;object_types-interface.
      _o_interface ?= object-&gt;raw.
      _o_interface-&gt;unanonymize( ).
    WHEN OTHERS.
  ENDCASE.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CNX_EXT_CODE_SIGNATURE~GET_SIGNATURE">
    <SOURCE>`
  DATA clskey TYPE seoclskey.
  DATA d_type TYPE td_comptype.

  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN zaplink_object_data=&gt;object_types-class.
        clskey-clsname = component-&gt;get_name( ).
        result = get_class_signature( clskey ).
      WHEN zaplink_object_data=&gt;object_types-interface.
        clskey-clsname = component-&gt;get_name( ).
        result = get_interface_signature( clskey ).
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_OBJECT&apos; d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CONNECTOR~CREATE_NEW_RAW">
    <SOURCE>`
  DATA o_clas TYPE to_class.
  DATA o_intf TYPE to_interface.

  CREATE OBJECT object.
  CASE type.
    WHEN zaplink_object_data=&gt;object_types-class.
      CREATE OBJECT o_clas.
      object-&gt;raw = o_clas.
*      create object object type TO_CLASS.
    WHEN zaplink_object_data=&gt;object_types-interface.
      CREATE OBJECT o_intf.
      object-&gt;raw = o_intf.
*      create object object type TO_CLASS.
    WHEN OTHERS.
      CLEAR object.
      mac_raise_type_not_supported &apos;ZAPLINK_OBJECT&apos; type.
  ENDCASE.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CONNECTOR~DELETE_FROM_SAP">
    <SOURCE>`
  DATA clskey TYPE seoclskey.
  DATA d_type TYPE td_comptype.

  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN zaplink_object_data=&gt;object_types-class.
        clskey-clsname = component-&gt;get_name( ).
        CALL FUNCTION &apos;SEO_CLASS_DELETE_W_DEPS&apos;
          EXPORTING
            clskey       = clskey
          EXCEPTIONS
            not_existing = 1
            is_interface = 2
            not_deleted  = 3
            db_error     = 4
            OTHERS       = 5.
        IF sy-subrc &lt;&gt; 0.
          CASE sy-subrc.
            WHEN 1.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;not_found.
            WHEN OTHERS.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;system_error.
          ENDCASE.
        ENDIF.
      WHEN zaplink_object_data=&gt;object_types-interface.
        clskey-clsname = component-&gt;get_name( ).
* Not working
*      CALL FUNCTION &apos;SEO_INTERFACE_DELETE_W_DEPS&apos;
*        EXPORTING
*          intkey       = clskey
*          save         = seox_true
*        EXCEPTIONS
*          not_existing = 1
*          is_class     = 2
*          not_deleted  = 3
*          db_error     = 4
*          OTHERS       = 5.
        CALL FUNCTION &apos;SEO_INTERFACE_DELETE_COMPLETE&apos;
          EXPORTING
            intkey                     = clskey
*         GENFLAG                    = &apos; &apos;
            authority_check            = seox_true
            suppress_docu_delete       = seox_true
*         SUPPRESS_COMMIT            = SEOX_FALSE
*       CHANGING
*         CORRNR                     =
          EXCEPTIONS
            not_existing               = 1
            is_class                   = 2
            db_error                   = 3
            no_access                  = 4
            other                      = 5
            OTHERS                     = 6
                  .
        IF sy-subrc &lt;&gt; 0.
          CASE sy-subrc.
            WHEN 1.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;not_found.
            WHEN OTHERS.
              RAISE EXCEPTION TYPE zaplink_cx_connector
                EXPORTING textid = zaplink_cx_connector=&gt;system_error.
          ENDCASE.
        ENDIF.
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_OBJECT&apos; d_type.
    ENDCASE.

    mac_def_catch zaplink_cx_connector.
  ENDTRY.
  result = abap_true.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CONNECTOR~DO_EXISTS">
    <SOURCE>`
  DATA clskey TYPE seoclskey.
  DATA d_type TYPE td_comptype.

  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN zaplink_object_data=&gt;object_types-class.
        clskey-clsname = component-&gt;get_name( ).

        CALL FUNCTION &apos;SEO_CLASS_EXISTENCE_CHECK&apos;
          EXPORTING
            clskey        = clskey
*        IMPORTING
*          not_active    = not_active
          EXCEPTIONS
            not_specified = 1
            not_existing  = 2
            is_interface  = 3
            no_text       = 4
            inconsistent  = 5
            OTHERS        = 6.

        IF sy-subrc = 0.
          exists = &apos;X&apos;.
        ENDIF.
      WHEN zaplink_object_data=&gt;object_types-interface.
        clskey-clsname = component-&gt;get_name( ).

        CALL FUNCTION &apos;SEO_INTERFACE_EXISTENCE_CHECK&apos;
          EXPORTING
            intkey              = clskey
*       IMPORTING
*         NOT_ACTIVE          =
         EXCEPTIONS
           not_specified       = 1
           not_existing        = 2
           is_class            = 3
           no_text             = 4
           inconsistent        = 5
           OTHERS              = 6.

        IF sy-subrc = 0.
          exists = &apos;X&apos;.
        ENDIF.
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_OBJECT&apos; d_type.
    ENDCASE.

    mac_def_catch zaplink_cx_connector.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION">
    <SOURCE>`
  result = abap_false.
  if version = _ver OR version = &apos;1.0&apos;.   &quot; version 1.01 is downward compatible with version 1.0
    result = abap_true.
  endif.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CONNECTOR~READ_FROM_SAP">
    <SOURCE>`
  DATA o_clas TYPE to_class.
  DATA o_intf TYPE to_interface.
  DATA d_type TYPE td_comptype.

  TRY.

    CREATE OBJECT object.
    object-&gt;set_component( component ).
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN zaplink_object_data=&gt;object_types-class.
        TRY.
            o_clas = export_from_sap_class( component ).
          CATCH zaplink_cx_connector INTO o_mycx.
            IF NOT o_mycx-&gt;messages IS BOUND.
              o_mycx-&gt;messages = application_log.
              o_mycx-&gt;update( ).
            ENDIF.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
        CLEAR o_clas-&gt;a0_maindata-clsname.
        object-&gt;raw = o_clas.
      WHEN zaplink_object_data=&gt;object_types-interface.
        TRY.
            o_intf = export_from_sap_interface( component ).
          CATCH zaplink_cx_connector INTO o_mycx.
            IF NOT o_mycx-&gt;messages IS BOUND.
              o_mycx-&gt;messages = application_log.
              o_mycx-&gt;update( ).
            ENDIF.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
        CLEAR o_intf-&gt;a0_maindata-clsname.
        object-&gt;raw = o_intf.
      WHEN OTHERS.
        CLEAR object.
        mac_raise_type_not_supported &apos;ZAPLINK_OBJECT&apos; d_type.
    ENDCASE.
    object-&gt;update_connector_data( me ).                    &quot; Issue 66
    mac_def_catch zaplink_cx_connector.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" VERSION="1" MTDNAME="ZAPLINK_CONNECTOR~WRITE_TO_SAP">
    <SOURCE>`
  DATA _o_class       TYPE to_class.
  DATA _o_interface   TYPE to_interface.

  TRY.
    CASE object-&gt;type.
      WHEN zaplink_object_data=&gt;object_types-class.
        _o_class ?= object-&gt;raw.
        _o_class-&gt;a0_maindata-clsname = object-&gt;name.
        TRY.
            components = import_to_sap_class( _o_class ).
          CATCH zaplink_cx_connector INTO o_mycx.
            IF NOT o_mycx-&gt;messages IS BOUND.
              o_mycx-&gt;messages = application_log.
              o_mycx-&gt;update( ).
            ENDIF.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
      WHEN zaplink_object_data=&gt;object_types-interface.
        _o_interface ?= object-&gt;raw.
        _o_interface-&gt;a0_maindata-clsname = object-&gt;name.
        TRY.
            components = import_to_sap_interface( _o_interface ).
          CATCH zaplink_cx_connector INTO o_mycx.
            IF NOT o_mycx-&gt;messages IS BOUND.
              o_mycx-&gt;messages = application_log.
              o_mycx-&gt;update( ).
            ENDIF.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
      WHEN OTHERS.
        mac_raise_type_not_supported &apos;ZAPLINK_OBJECT&apos; object-&gt;type.
    ENDCASE.

    mac_def_catch zaplink_cx_connector.
  ENDTRY.</SOURCE>
   </ITEM>
  </REDEFINITIONS>
  <TYPEGROUPS>
   <ITEM TYPEGROUP="ABAP" VERSION="1" IMPLICIT="X"/>
   <ITEM TYPEGROUP="CXTAB" VERSION="1" EXPLICIT="X"/>
   <ITEM TYPEGROUP="SEDI" VERSION="1" EXPLICIT="X"/>
   <ITEM TYPEGROUP="SEOF" VERSION="1" EXPLICIT="X"/>
   <ITEM TYPEGROUP="SEOK" VERSION="1" EXPLICIT="X"/>
   <ITEM TYPEGROUP="SEOP" VERSION="1" EXPLICIT="X"/>
   <ITEM TYPEGROUP="SEOR" VERSION="1" EXPLICIT="X"/>
   <ITEM TYPEGROUP="SEOS" VERSION="1" EXPLICIT="X"/>
   <ITEM TYPEGROUP="SEOT" VERSION="1" EXPLICIT="X"/>
   <ITEM TYPEGROUP="SEOX" VERSION="1" EXPLICIT="X"/>
   <ITEM TYPEGROUP="SWBSE" VERSION="1" EXPLICIT="X"/>
  </TYPEGROUPS>
  <TYPES>
   <ITEM CMPNAME="TD_SOURCECODE" VERSION="1" EXPOSURE="2" STATE="1" TYPTYPE="1" TYPE="SEOP_SOURCE_STRING">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="ABAP Source Code"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TO_CLASS" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="2 " TYPTYPE="3" TYPE="ZAPLINK_CLAS_DATA">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Class data"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TO_INTERFACE" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="3 " TYPTYPE="3" TYPE="ZAPLINK_INTF_DATA">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Interface data"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TS_BAPI_DATA" VERSION="1" STATE="1" EDITORDER="1 " TYPTYPE="4">
    BEGIN OF ts_bapi_data,
    class                       TYPE  vseoclass,
    attributes                  TYPE  seoo_attributes_r,
    methods                     TYPE  seoo_methods_r,
    events                      TYPE  seoo_events_r,
    types                       TYPE  seoo_types_r,
    parameters                  TYPE  seos_parameters_r,
    exceps                      TYPE  seos_exceptions_r,
    implementings               TYPE  seor_implementings_r,
    inheritance                 TYPE  vseoextend,
    redefinitions               TYPE  seor_redefinitions_r,
    impl_details                TYPE  seor_redefinitions_r,
    friendships                 TYPE  seof_friendships_r,
    typepusages                 TYPE  seot_typepusages_r,
    clsdeferrds                 TYPE  seot_clsdeferrds_r,
    intdeferrds                 TYPE  seot_intdeferrds_r,
    explore_inheritance         TYPE  seok_cls_typeinfos,
    explore_implementings       TYPE  seok_int_typeinfos,
    aliases                     TYPE  seoo_aliases_r,
    enhancement_methods         TYPE  enhmeth_tabheader,
    enhancement_attributes      TYPE  enhclasstabattrib,
    enhancement_events          TYPE  enhclasstabevent,
    enhancement_implementings   TYPE enhclasstabimplementing,
  END OF ts_bapi_data
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="All Data for BAPI call of class creation"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TS_CLAS_ATTR" VERSION="1" STATE="1" EDITORDER="2 " TYPTYPE="4">
    BEGIN OF ts_clas_attr.
  INCLUDE TYPE ts_base_attributs AS base.
  TYPES:
    END OF ts_clas_attr
`
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Root attributs for CLAS"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="T_FM_DATA" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " TYPTYPE="1" TYPE="ZAPLINK_OBJECT_DATA=&gt;T_FM_DATA"/>
  </TYPES>
 </RAW>
</ZL_OBJECT>
