<?xml version="1.0" encoding="utf-16"?>
<ZL_OBJECT CHECKSUM="FC1133B095333A84D87790A9DBCA6E18" CODE_SIGNATURE="43888D293AE5EB7AB4F9490399136D39" CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_ENHANCEMENT" TYPE="CLAS" VERSION="1.01">
 <DEPENDENCIES>
  <ITEM TYPE="CLAS" NAME="ZAPLINK_CONNECTOR_"/>
 </DEPENDENCIES>
 <DIRECTORY DEVCLASS="ZAPLINK-CONNECTORS-MAIN" MASTERLANG="E"/>
 <RAW>
  <A0_MAINDATA VERSION="1" LANGU="E" EXPOSURE="2" STATE="1" CLSCCINCL="X" FIXPT="X" UNICODE="X">
   <INHERITANCE REFCLSNAME="ZAPLINK_CONNECTOR_" STATE="1"/>
   <TEXTS>
    <ITEM LANG="E" TEXT="ZAP Link Connector : BADI Definitions &amp; Implementations">U1&amp;FUNCTIONALITY&amp;
ASIs a connector for :
AS- SXSD : BADI Definition
AS- SXCI : BADI Implementation
U1&amp;RELATIONS&amp;
ASIs part of ZAP Link Framework as Official Connector.
ASRequire Official connector for Object types (CLAS &amp; INTF).
U1&amp;EXAMPLE&amp;
AS
U1&amp;HINTS&amp;
AS
U1&amp;FURTHER_SOURCES_OF_INF&amp;
AShttps://code.google.com/p/zaplink/wiki/Connector
U1Memories
ASThis application is dedicated to the memories of :
B2My father : Lamri BENSIALI (1940-2004) without whom I never started
  programming
B2My uncle : Jacky BEDU (1934-2009) who died during the completion of this
  application</ITEM>
   </TEXTS>
  </A0_MAINDATA>
  <ATTRIBUTS>
   <ITEM CMPNAME="BALLOG_SUBOBJECT" EXPOSURE="2" STATE="1" ATTDECLTYP="2" ATTVALUE="&apos;CNX_ENHENCEMENT&apos;" TYPTYPE="1" TYPE="BALSUBOBJ">
    <TEXTS>
     <ITEM LANG="E" TEXT="Application Log: Subobject"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="R_DOC_ID_DEFINITION" STATE="1" ATTDECLTYP="1" TYPTYPE="1" TYPE="TR_DOCID"/>
   <ITEM CMPNAME="R_DOC_ID_IMPLEMENTATION" STATE="1" ATTDECLTYP="1" TYPTYPE="1" TYPE="TR_DOCID"/>
   <ITEM CMPNAME="ST_COMP_ENH_SPOT" EXPOSURE="2" STATE="1" ATTDECLTYP="2" ATTVALUE="&apos;ENSC&apos;" TYPTYPE="1" TYPE="TD_COMPTYPE">
    <TEXTS>
     <ITEM LANG="E" TEXT="Transport category : Compisit Enhancement Spot"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="ST_ENH_IMPL" EXPOSURE="2" STATE="1" ATTDECLTYP="2" ATTVALUE="&apos;ENHO&apos;" TYPTYPE="1" TYPE="TD_COMPTYPE">
    <TEXTS>
     <ITEM LANG="E" TEXT="Transport category : Enhancement Implementation"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="ST_ENH_SPOT" EXPOSURE="2" STATE="1" ATTDECLTYP="2" ATTVALUE="&apos;ENHS&apos;" TYPTYPE="1" TYPE="TD_COMPTYPE">
    <TEXTS>
     <ITEM LANG="E" TEXT="Transport category : Enhancement Spot"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="_UUID" STATE="1" ATTDECLTYP="2" ATTVALUE="&apos;4181014E2AC27D33E1000000AC1201D6&apos;" TYPTYPE="1" TYPE="TD_CONNUUID">
    <TEXTS>
     <ITEM LANG="E" TEXT="UUID for connector BADI"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="_VER" STATE="1" ATTDECLTYP="2" ATTVALUE="&apos;0.0&apos;" TYPTYPE="1" TYPE="TD_CONNVER">
    <TEXTS>
     <ITEM LANG="E" TEXT="Connector Version"/>
    </TEXTS>
   </ITEM>
  </ATTRIBUTS>
  <LOCAL>
   <TYPES>`
*&quot;* USE THIS SOURCE FILE FOR ANY TYPE DECLARATIONS (CLASS
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* IMPLEMENTATION OR PRIVATE METHOD&apos;S SIGNATURE</TYPES>
   <IMPLEMENTATIONS>`
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* use this source file for the implementation part of
*&quot;* LOCAL HELPER CLASSES</IMPLEMENTATIONS>
   <MACROS>`
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS

INCLUDE zaplink_macros.</MACROS>
  </LOCAL>
  <METHODS>
   <ITEM CMPNAME="CLASS_CONSTRUCTOR" EXPOSURE="2" STATE="1" MTDTYPE="2" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="CLASS_CONSTRUCTOR"/>
    </TEXTS>
    <SOURCE>`
*table TDCLT
*DOKCLASS DOKTITEL
*BI       Business Add-Ins: Implementations
  DATA _id LIKE LINE OF r_doc_id_definition.

  _id-sign = &apos;I&apos;.
  _id-option = &apos;EQ&apos;.
  _id-low = &apos;HY&apos;. APPEND _id TO r_doc_id_definition.

  _id-low = &apos;BI&apos;. APPEND _id TO r_doc_id_implementation.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CONSTRUCTOR" EXPOSURE="2" STATE="1" MTDTYPE="2">
    <TEXTS>
     <ITEM LANG="E" TEXT="CONSTRUCTOR"/>
    </TEXTS>
    <SOURCE>`
  DATA type LIKE LINE OF supported_types.

  CALL METHOD super-&gt;constructor.
  mac_create_log application_log ballog_subobject space.
  type-type = st_comp_enh_spot.   INSERT type INTO TABLE supported_types.
  type-type = st_enh_spot.        INSERT type INTO TABLE supported_types.
  type-type = st_enh_impl.        INSERT type INTO TABLE supported_types.

  uuid = _uuid.
  version = _ver.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CONVERT_COMP_ENH_SPOT" STATE="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Convert Composit Enhancement Spot (SAP object) to RAW data"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="COMPONENTS_LIST" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_LIST"/>
     <ITEM SCONAME="RAW_OBJECT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TO_COMP_ENH_SPOT">
      <TEXTS>
       <ITEM LANG="E" TEXT="Data for Composit Enhancement Spot"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="SAP_OBJECT" CMPTYPE="1" TYPTYPE="1" TYPE="TO_COMP_ENH_SPOT_SAP">
      <TEXTS>
       <ITEM LANG="E" TEXT="Enhancement Composite"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="SUB_COMPONENTS" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_WITH_SUBCOMP">
      <TEXTS>
       <ITEM LANG="E" TEXT="Composite Enhancement Spot"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  DATA s_comp         TYPE zaplink_ensc_data=&gt;ts_fm_data.
  DATA o_sap_ces      TYPE to_comp_enh_spot_sap.
  DATA o_sap_es       TYPE to_enh_spot_sap.
  DATA o_ces          TYPE to_comp_enh_spot.
  DATA o_es           TYPE to_comp_enh_spot.
  DATA version        TYPE r3state.
  DATA short_id       TYPE sotr_conc.
  DATA long_id        TYPE sotr_conc.
  DATA t_ces_list     TYPE enhspotcompositename_it.
  DATA s_ces          LIKE LINE OF s_comp-comp_enh.
  FIELD-SYMBOLS:
    &lt;ces&gt;       LIKE LINE OF raw_object-&gt;composit_enhancement_spots,
    &lt;es&gt;        LIKE LINE OF raw_object-&gt;enhancement_spots,
    &lt;sap_ces&gt;   LIKE LINE OF t_ces_list.

  ASSERT sap_object IS BOUND.
  CREATE OBJECT raw_object.
  get_version( sap_object ).
  s_comp-header = sap_object-&gt;get_enhspotcomphead( version ).
  short_id = s_comp-header-shorttextid.
  long_id = s_comp-header-docuid.
  CLEAR: s_comp-header-shorttextid, s_comp-header-docuid.
*  loop at .
*   data-&gt;text_repository-&gt;if_wb_text_repository~get_text( otr_id = otr_id
*                                                           langu = sy-langu ).
*  endloop.

*  s_comp-comp_enh = sap_object-&gt;if_enh_spot_composite~get_composite_childs( version ).
  t_ces_list = sap_object-&gt;if_enh_spot_composite~get_composite_childs( version ).
  LOOP AT t_ces_list ASSIGNING &lt;sap_ces&gt;.
    CLEAR s_ces.
    s_ces-name = &lt;sap_ces&gt;.
    APPEND s_ces TO s_comp-comp_enh.
  ENDLOOP.

  s_comp-enh = sap_object-&gt;if_enh_spot_composite~get_enh_spot_childs( version ).

  CREATE OBJECT raw_object.
  raw_object-&gt;from_data( s_comp ).

  IF sub_components = abap_true.
    LOOP AT raw_object-&gt;composit_enhancement_spots ASSIGNING &lt;ces&gt;.
      o_sap_ces = load_comp_enh_spot( &lt;ces&gt;-name ).

      o_es = convert_comp_enh_spot( sap_object = o_sap_ces
                                      sub_components = sub_components
                                     components_list = components_list ).
      IF o_ces IS BOUND.
        CREATE OBJECT &lt;ces&gt;-zl_object.
        &lt;ces&gt;-zl_object-&gt;raw = o_ces.
      ENDIF.
      IF &lt;ces&gt;-zl_object IS BOUND.
        CLEAR &lt;ces&gt;-name.
      ENDIF.
    ENDLOOP.

    LOOP AT raw_object-&gt;enhancement_spots ASSIGNING &lt;es&gt;.
*      o_sap_es = load_enh_spot( &lt;es&gt; ). &quot; -name
*
*      &lt;ces&gt;-zl_object = convert_comp_enh_spot( sap_object = o_sap_es
*                                           sub_components = sub_components
*                                          components_list = components_list ).
*      IF o_ces IS BOUND.
*        CREATE OBJECT &lt;ces&gt;-zl_object.
*        &lt;ces&gt;-zl_object-&gt;raw = o_ces.
*      ENDIF.
*      IF &lt;ces&gt;-zl_object IS BOUND.
*        CLEAR &lt;ces&gt;-name.
*      ENDIF.
    ENDLOOP.
  ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="CONVERT_ENH_SPOT" STATE="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Convert Enhancement Spot (SAP object) to RAW data"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="COMPONENTS_LIST" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_LIST"/>
     <ITEM SCONAME="RAW_OBJECT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TO_ENH_SPOT">
      <TEXTS>
       <ITEM LANG="E" TEXT="Data for Composit Enhancement Spot"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="SAP_OBJECT" CMPTYPE="1" TYPTYPE="1" TYPE="TO_COMP_ENH_SPOT_SAP">
      <TEXTS>
       <ITEM LANG="E" TEXT="Enhancement Composite"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="SUB_COMPONENTS" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_WITH_SUBCOMP">
      <TEXTS>
       <ITEM LANG="E" TEXT="Composite Enhancement Spot"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
*  DATA s_comp         TYPE zaplink_ensc_data=&gt;ts_fm_data.
*  DATA o_sap_intf     TYPE to_comp_enh_spot_sap.
*  DATA o_object       TYPE to_comp_enh_spot.
*  DATA version        TYPE r3state.
*  DATA short_id       TYPE sotr_conc.
*  DATA long_id        TYPE sotr_conc.
*  DATA t_ces_list     TYPE enhspotcompositename_it.
*  DATA s_ces          LIKE LINE OF s_comp-comp_enh.
*  FIELD-SYMBOLS:
*    &lt;ces&gt;       LIKE LINE OF raw_object-&gt;composit_enhancement_spots,
*    &lt;sap_ces&gt;   LIKE LINE OF t_ces_list.
*
*  ASSERT sap_object IS BOUND.
*  CREATE OBJECT raw_object.
*  get_version( sap_object ).
*  s_comp-header = sap_object-&gt;get_enhspotcomphead( version ).
*  short_id = s_comp-header-shorttextid.
*  long_id = s_comp-header-docuid.
*  CLEAR: s_comp-header-shorttextid, s_comp-header-docuid.
**  loop at .
**   data-&gt;text_repository-&gt;if_wb_text_repository~get_text( otr_id = otr_id
**                                                           langu = sy-langu ).
**  endloop.
*
**  s_comp-comp_enh = sap_object-&gt;if_enh_spot_composite~get_composite_childs( version ).
*  t_ces_list = sap_object-&gt;if_enh_spot_composite~get_composite_childs( version ).
*  LOOP AT t_ces_list ASSIGNING &lt;sap_ces&gt;.
*    CLEAR s_ces.
*    s_ces-name = &lt;sap_ces&gt;.
*    APPEND s_ces TO s_comp-comp_enh.
*  ENDLOOP.
*
*  s_comp-enh = sap_object-&gt;if_enh_spot_composite~get_enh_spot_childs( version ).
*
*  CREATE OBJECT raw_object.
*  raw_object-&gt;from_data( s_comp ).
*
*  IF sub_components = abap_true.
*    LOOP AT raw_object-&gt;composit_enhancement_spots ASSIGNING &lt;ces&gt;.
*      o_sap_intf = load_comp_enh_spot( &lt;ces&gt;-name ).
*
*      o_object = convert_comp_enh_spot( sap_object = o_sap_intf
*                                    sub_components = sub_components
*                                   components_list = components_list ).
*      IF o_object IS BOUND.
*        CREATE OBJECT &lt;ces&gt;-zl_object.
*        &lt;ces&gt;-zl_object-&gt;raw = o_object.
*      ENDIF.
*      IF &lt;ces&gt;-zl_object IS BOUND.
*        CLEAR &lt;ces&gt;-name.
*      ENDIF.
*    ENDLOOP.
*
**    LOOP AT raw_object-&gt;enhancement_spots ASSIGNING &lt;ces&gt;.
**      o_sap_intf = load_comp_enh_spot( &lt;ces&gt;-name ).
**
**      &lt;ces&gt;-zl_object = convert_comp_enh_spot( sap_object = o_sap_intf
**                                           sub_components = sub_components
**                                          components_list = components_list ).
**      IF &lt;ces&gt;-zl_object IS BOUND.
**        CLEAR &lt;ces&gt;-name.
**      ENDIF.
**    ENDLOOP.
*  ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="EXPORT_FROM_COMP_ENH_SPOT" STATE="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Export Composit Enhancement Spot from SAP"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="COMPONENT" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_COMPONENT">
      <TEXTS>
       <ITEM LANG="E" TEXT="Component to export"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="OBJECT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TO_COMP_ENH_SPOT">
      <TEXTS>
       <ITEM LANG="E" TEXT="Data for Composit Enhancement Spot"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_CONNECTOR" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="ZAPlink ROOT Exception for Connectors"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA f_subcomp  TYPE td_with_subcomp.
  DATA _name      TYPE td_comp_enh_spot_name.
  DATA o_list     TYPE to_list.
  DATA o_sap_intf TYPE to_comp_enh_spot_sap.

  TRY.

    CHECK component-&gt;get_type( ) = st_comp_enh_spot.
    f_subcomp = component-&gt;get_with_subcomp( ).

    _name = component-&gt;get_name( ).

    CREATE OBJECT o_list.
    component-&gt;set_subcomponents( o_list ).

    o_sap_intf = load_comp_enh_spot( _name ).

    object = convert_comp_enh_spot( sap_object = o_sap_intf
                                sub_components = f_subcomp
                               components_list = o_list ).

    TRY.
        o_list-&gt;remove( component ).
      CATCH zaplink_cx_list.
    ENDTRY.

    mac_def_catch zaplink_cx_connector.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="EXPORT_FROM_ENH_SPOT" STATE="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Export Enhancement Spot from SAP"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="COMPONENT" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_COMPONENT">
      <TEXTS>
       <ITEM LANG="E" TEXT="Component to export"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="OBJECT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TO_ENH_SPOT">
      <TEXTS>
       <ITEM LANG="E" TEXT="Data for Enhancement Spot"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_CONNECTOR" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="ZAPlink ROOT Exception for Connectors"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA f_subcomp  TYPE td_with_subcomp.
  DATA _name      TYPE td_comp_enh_spot_name.
  DATA o_list     TYPE to_list.
  DATA o_sap_intf TYPE to_comp_enh_spot_sap.

  TRY.

    CHECK component-&gt;get_type( ) = st_comp_enh_spot.
    f_subcomp = component-&gt;get_with_subcomp( ).

    _name = component-&gt;get_name( ).

    CREATE OBJECT o_list.
    component-&gt;set_subcomponents( o_list ).

    o_sap_intf = load_comp_enh_spot( _name ).

    object = convert_enh_spot( sap_object = o_sap_intf
                           sub_components = f_subcomp
                          components_list = o_list ).

    TRY.
        o_list-&gt;remove( component ).
      CATCH zaplink_cx_list.
    ENDTRY.

    mac_def_catch zaplink_cx_connector.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_VERSION" STATE="1" MTDDECLTYP="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Get Version of Enhancement (from SAP Object)"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="ENHANCEMENT" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="3" TYPE="IF_ENH_OBJECT">
      <TEXTS>
       <ITEM LANG="E" TEXT="General Methods for Enhancement Objects"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="VERSION" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="R3STATE">
      <TEXTS>
       <ITEM LANG="E" TEXT="ABAP: Program Status (Active, Saved, Transported...)"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  IF enhancement-&gt;has_active_version( ) = abap_true.
    version = &apos;A&apos;.
  ELSE.
    version = &apos;I&apos;.
  ENDIF.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="IMPORT_TO_COMP_ENH_SPOT" STATE="1" MTDNEWEXC="X">
    <TEXTS>
     <ITEM LANG="E" TEXT="Import Composit Enhancement Spot to SAP"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="COMPONENTS" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TO_LIST"/>
     <ITEM SCONAME="O_DATA" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_COMP_ENH_SPOT">
      <TEXTS>
       <ITEM LANG="E" TEXT="Data for Composit Enhancement Spot"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_CONNECTOR" LANGU="E">
      <TEXTS>
       <ITEM LANG="E" TEXT="ZAPlink ROOT Exception for Connectors"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>`
  DATA s_comp     TYPE zaplink_ensc_data=&gt;ts_fm_data.
  DATA o_comp     TYPE REF TO if_enh_spot_composite.    &quot;cl_enh_spot_composite.

  s_comp = o_data-&gt;to_data( ).
  CALL METHOD cl_r3standard_persistence=&gt;create_spot_composite
    EXPORTING
      name      = o_data-&gt;a0_maindata-enhspotcomposite
      scwb_call = abap_false
      run_dark  = abap_true
    IMPORTING
      composite = o_comp
*          CHANGING
*            trkorr    = trkorr
*            devclass  = devclass
    .
*  o_comp-&gt;set_shorttext( l_text ).
*  o_comp-&gt;add_composite_child( enhspotcompcreate-enhspotcomposite ).
*  o_comp-&gt;add_enh_spot_child( ).
  o_comp-&gt;if_enh_object~save( ).</SOURCE>
   </ITEM>
   <ITEM CMPNAME="LOAD_COMP_ENH_SPOT" STATE="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Load Composit Enhancement Spot as SAP object"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="NAME" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_COMP_ENH_SPOT_NAME">
      <TEXTS>
       <ITEM LANG="E" TEXT="Composite Enhancement Spot"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="OBJECT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TO_COMP_ENH_SPOT_SAP">
      <TEXTS>
       <ITEM LANG="E" TEXT="Enhancement Composite"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  TRY.
      object ?= cl_enh_factory=&gt;load_enhancement_spot_comp( name = name
                                                            lock = abap_false ).
    CATCH cx_enh_io_error.              &quot; Do not exists =&gt; Object is null
*    CATCH cx_enh_is_locked .           &quot; Should not happend =&gt; leave exception
*    CATCH cx_enh_permission_denied .
*    CATCH cx_enh_canceled .
*    CATCH cx_enh_internal_error .
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="LOAD_ENH_SPOT" STATE="1">
    <TEXTS>
     <ITEM LANG="E" TEXT="Load Enhancement Spot as SAP object"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="NAME" CMPTYPE="1" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_ENH_SPOT_NAME">
      <TEXTS>
       <ITEM LANG="E" TEXT="Composite Enhancement Spot"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="OBJECT" CMPTYPE="1" PARDECLTYP="3" TYPTYPE="1" TYPE="TO_ENH_SPOT_SAP">
      <TEXTS>
       <ITEM LANG="E" TEXT="Enhancement Composite"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <SOURCE>`
  TRY.
      object ?= cl_enh_factory=&gt;get_enhancement_spot( spot_name = name
                                                           lock = abap_false ).
    CATCH cx_enh_io_error.              &quot; Do not exists =&gt; Object is null
*    CATCH cx_enh_is_locked .           &quot; Should not happend =&gt; leave exception
*    CATCH cx_enh_permission_denied .
*    CATCH cx_enh_canceled .
*    CATCH cx_enh_internal_error .
  ENDTRY.</SOURCE>
   </ITEM>
  </METHODS>
  <REDEFINITIONS>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" MTDNAME="ZAPLINK_CNX_EXT_CLEANER~ANONYMIZE">
    <SOURCE>`
*  DATA o_bdef TYPE to_badi_def.
*  DATA o_impl TYPE to_badi_impl.
*
*  CHECK object IS BOUND.
*
*  CASE object-&gt;type.
*    WHEN st_badi_def.
*      o_bdef ?= object-&gt;raw.
*      o_bdef-&gt;anonymize( ).
*    WHEN st_badi_impl.
*      o_impl ?= object-&gt;raw.
*      o_impl-&gt;anonymize( ).
*    WHEN OTHERS.
*      mac_raise_type_not_supported me-&gt;class_name object-&gt;type.
*  ENDCASE.
*
*  TRY.
*      super-&gt;zaplink_cnx_ext_cleaner~anonymize( object ).
*    CATCH zaplink_cx_connector INTO o_mycx.
*      RAISE EXCEPTION o_mycx.
*  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" MTDNAME="ZAPLINK_CONNECTOR~CREATE_NEW_RAW">
    <SOURCE>`
  DATA o_conn   TYPE to_connector.
  DATA o_ensc   TYPE to_comp_enh_spot.
*  DATA o_sxci   TYPE to_badi_impl.
  DATA _type    TYPE td_comptype.

  CREATE OBJECT object.
  CASE type.
    WHEN st_comp_enh_spot.
      CREATE OBJECT o_ensc.
      object-&gt;raw = o_ensc.
    WHEN st_enh_impl.
    WHEN st_enh_spot.
    WHEN OTHERS.
      CLEAR object.
      mac_raise_type_not_supported me-&gt;class_name type.
  ENDCASE.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" MTDNAME="ZAPLINK_CONNECTOR~DELETE_FROM_SAP">
    <SOURCE>`
  DATA d_type         TYPE td_comptype.
  DATA enh_name       TYPE enhspotname.
  DATA enh_comp_name  TYPE td_comp_enh_spot_name.
  DATA o_comp         TYPE REF TO if_enh_spot_composite.
  DATA o_spot         TYPE REF TO if_enh_spot_tool.

  TRY.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN st_comp_enh_spot.
        enh_comp_name = component-&gt;get_name( ).
        TRY.
            o_comp = cl_enh_factory=&gt;load_enhancement_spot_comp( name = enh_comp_name
                                                                 lock = abap_false ).
            IF o_comp IS BOUND.
              o_comp-&gt;if_enh_object~delete( run_dark = abap_true ).
            ENDIF.
          CATCH cx_enh_io_error.      &quot; Do not exists
*          CATCH cx_enh_is_locked .    &quot; Should not happend
*           CATCH cx_enh_permission_denied .
*           CATCH cx_enh_canceled .
*           CATCH cx_enh_internal_error .
        ENDTRY.
      WHEN st_enh_impl.
      WHEN st_enh_spot.
        enh_name = component-&gt;get_name( ).
        TRY.
            o_spot = cl_enh_factory=&gt;get_enhancement_spot( enh_name ).
            IF o_spot IS BOUND.
              o_spot-&gt;if_enh_object~delete( run_dark = abap_true ).
            ENDIF.
          CATCH cx_enh_io_error.      &quot; Do not exists
*          CATCH cx_enh_is_locked .    &quot; Should not happend
*           CATCH cx_enh_permission_denied .
*           CATCH cx_enh_canceled .
*           CATCH cx_enh_internal_error .
        ENDTRY.
      WHEN OTHERS.
        mac_raise_type_not_supported me-&gt;class_name d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.
  result = abap_true.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" MTDNAME="ZAPLINK_CONNECTOR~DO_EXISTS">
    <SOURCE>`
  DATA d_type         TYPE td_comptype.
  DATA enh_spot_name  TYPE enhspotname.
  DATA enh_name       TYPE enhname.
  DATA enh_comp_name  TYPE td_comp_enh_spot_name.
  DATA o_spot         TYPE REF TO if_enh_spot_tool.
  DATA o_comp         TYPE REF TO if_enh_spot_composite.
  DATA o_enh          TYPE REF TO if_enh_tool. &quot;CL_ENH_TOOL_BADI_IMPL.

  TRY.
    exists = me-&gt;exists-not_exists.
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN st_comp_enh_spot.
        enh_comp_name = component-&gt;get_name( ).
        TRY.
            o_comp = cl_enh_factory=&gt;load_enhancement_spot_comp( name = enh_comp_name
                                                                 lock = abap_false ).
            IF o_comp IS BOUND.
              exists = me-&gt;exists-exists.
            ENDIF.
          CATCH cx_enh_io_error.      &quot; Do not exists
          CATCH cx_enh_is_locked .    &quot; Should not happend
            exists = me-&gt;exists-exists.
*           CATCH cx_enh_permission_denied .
*           CATCH cx_enh_canceled .
*           CATCH cx_enh_internal_error .
        ENDTRY.
      WHEN st_enh_impl.
        enh_name = component-&gt;get_name( ).
        TRY.
            o_enh = cl_enh_factory=&gt;get_enhancement( enh_name ).
            IF o_enh IS BOUND.
              exists = me-&gt;exists-exists.
            ENDIF.
          CATCH cx_enh_io_error.      &quot; Do not exists
          CATCH cx_enh_is_locked .    &quot; Should not happend
            exists = me-&gt;exists-exists.
*           CATCH cx_enh_permission_denied .
*           CATCH cx_enh_canceled .
*           CATCH cx_enh_internal_error .
        ENDTRY.
      WHEN st_enh_spot.
        enh_spot_name = component-&gt;get_name( ).
        TRY.
            o_spot = cl_enh_factory=&gt;get_enhancement_spot( enh_spot_name ).
            IF o_spot IS BOUND.
              exists = me-&gt;exists-exists.
            ENDIF.
          CATCH cx_enh_io_error.      &quot; Do not exists
          CATCH cx_enh_is_locked .    &quot; Should not happend
            exists = me-&gt;exists-exists.
*           CATCH cx_enh_permission_denied .
*           CATCH cx_enh_canceled .
*           CATCH cx_enh_internal_error .
        ENDTRY.
      WHEN OTHERS.
        mac_raise_type_not_supported me-&gt;class_name d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" MTDNAME="ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION">
    <SOURCE>`
  result = abap_false.
  if version = _ver.    result = abap_true.   endif.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" MTDNAME="ZAPLINK_CONNECTOR~READ_FROM_SAP">
    <SOURCE>`
  DATA d_type         TYPE td_comptype.
  DATA enh_name       TYPE enhspotname.
  DATA o_spot         TYPE REF TO if_enh_spot_tool.
  DATA o_ensc         TYPE to_comp_enh_spot.

  TRY.
    CREATE OBJECT object.
    object-&gt;set_component( component ).
    d_type = component-&gt;get_type( ).
    CASE d_type.
      WHEN st_comp_enh_spot.
        o_ensc = export_from_comp_enh_spot( component ).
        object-&gt;raw = o_ensc.
      WHEN st_enh_impl.
      WHEN st_enh_spot.
        enh_name = component-&gt;get_name( ).
        TRY.
            o_spot = cl_enh_factory=&gt;get_enhancement_spot( enh_name ).
            IF o_spot IS BOUND.
            ENDIF.
          CATCH cx_enh_io_error.      &quot; Do not exists
*          CATCH cx_enh_is_locked .    &quot; Should not happend
*           CATCH cx_enh_permission_denied .
*           CATCH cx_enh_canceled .
*           CATCH cx_enh_internal_error .
        ENDTRY.
      WHEN OTHERS.
        mac_raise_type_not_supported me-&gt;class_name d_type.
    ENDCASE.
    mac_def_catch zaplink_cx_connector.
  ENDTRY.</SOURCE>
   </ITEM>
   <ITEM REFCLSNAME="ZAPLINK_CONNECTOR_" MTDNAME="ZAPLINK_CONNECTOR~WRITE_TO_SAP">
    <SOURCE>`
  DATA o_ensc         TYPE to_comp_enh_spot.
*  DATA o_impl         TYPE to_badi_impl.
  DATA d_type         TYPE td_comptype.
  DATA o_comp         TYPE to_component.                    &quot; Issue 92

  TRY.
    d_type = object-&gt;type.
    CASE d_type.
      WHEN st_comp_enh_spot.
        o_ensc ?= object-&gt;raw.
        o_ensc-&gt;a0_maindata-enhspotcomposite = object-&gt;name.
        TRY.
            components = import_to_comp_enh_spot( o_ensc ).
          CATCH zaplink_cx_connector INTO o_mycx.
            IF NOT o_mycx-&gt;messages IS BOUND.
              o_mycx-&gt;messages = application_log.
              o_mycx-&gt;update( ).
            ENDIF.
            RAISE EXCEPTION o_mycx.
        ENDTRY.
      WHEN st_enh_impl.
      WHEN st_enh_spot.
      WHEN OTHERS.
        mac_raise_type_not_supported me-&gt;class_name d_type.
    ENDCASE.
    check_component_list( EXPORTING     object = object
                           CHANGING components = components ).
    mac_def_catch zaplink_cx_connector.
  ENDTRY.</SOURCE>
   </ITEM>
  </REDEFINITIONS>
  <TYPEGROUPS>
   <ITEM TYPEGROUP="SEEX" EXPLICIT="X"/>
  </TYPEGROUPS>
  <TYPES>
   <ITEM CMPNAME="TD_COMP_ENH_SPOT_NAME" STATE="1" EDITORDER="6 " TYPTYPE="1" TYPE="ENHSPOTCOMPOSITENAME">
    <TEXTS>
     <ITEM LANG="E" TEXT="Composite Enhancement Spot"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TD_ENH_SPOT_NAME" STATE="1" EDITORDER="8 " TYPTYPE="1" TYPE="ENHSPOTNAME"/>
   <ITEM CMPNAME="TO_BADI_IMPL" STATE="1" EDITORDER="5 " TYPTYPE="3" TYPE="ZAPLINK_SXCI_DATA">
    <TEXTS>
     <ITEM LANG="E" TEXT="Badi Implémentation Data"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TO_COMP_ENH_SPOT" STATE="1" EDITORDER="1 " TYPTYPE="3" TYPE="ZAPLINK_ENSC_DATA">
    <TEXTS>
     <ITEM LANG="E" TEXT="Data for Composit Enhancement Spot"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TO_COMP_ENH_SPOT_SAP" STATE="1" EDITORDER="7 " TYPTYPE="3" TYPE="CL_ENH_SPOT_COMPOSITE">
    <TEXTS>
     <ITEM LANG="E" TEXT="Enhancement Composite"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TO_ENH_SPOT" STATE="1" EDITORDER="2 " TYPTYPE="3" TYPE="ZAPLINK_ENHS_DATA">
    <TEXTS>
     <ITEM LANG="E" TEXT="Data for Enhancement Spot"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TO_ENH_SPOT_SAP" STATE="1" EDITORDER="9 " TYPTYPE="3" TYPE="CL_ENH_TOOL_BADI_DEF"/>
   <ITEM CMPNAME="TS_CLAS_ATTR" STATE="1" EDITORDER="4 " TYPTYPE="4">
    BEGIN OF ts_clas_attr.
  INCLUDE TYPE ts_base_attributs AS base.
  TYPES:
    END OF ts_clas_attr
`
    <TEXTS>
     <ITEM LANG="E" TEXT="Root attributs for CLAS"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TS_DOC_KEY" STATE="1" EDITORDER="3 " TYPTYPE="4">
    BEGIN OF ts_doc_key,                                    &quot; equiv DOKU_OBJ = CHAR 60
      simg(4)    TYPE c,     &quot;SIMG
      name       TYPE rsexscrn-exit_name,                   &quot; CHAR 30
    END OF ts_doc_key
`
    <TEXTS>
     <ITEM LANG="E" TEXT="DOCU key structure"/>
    </TEXTS>
   </ITEM>
  </TYPES>
 </RAW>
</ZL_OBJECT>
