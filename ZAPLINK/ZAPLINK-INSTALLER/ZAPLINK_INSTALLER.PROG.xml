<?xml version="1.0" encoding="utf-16"?>
<ZL_EXTRACT CONNECTOR="AAAD0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_INSTALLER" TYPE="PROG">
 <DIRECTORY SRCSYSTEM="NSP" AUTHOR="TARYCK" DEVCLASS="ZAPLINK-INSTALLER" MASTERLANG="E"/>
 <RAW SOURCE="*&amp;amp;---------------------------------------------------------------------*
*&amp;amp; Report  ZAPLINK_INSTALLER_MASTER
*&amp;amp;
*&amp;amp;---------------------------------------------------------------------*
*&amp;amp;
*&amp;amp;
*&amp;amp;---------------------------------------------------------------------*

REPORT  zaplink_installer_master MESSAGE-ID zaplink_cx.

TYPE-POOLS ABAP .
TYPE-POOLS ICON .
TYPE-POOLS SEOF .
TYPE-POOLS SEOK .
TYPE-POOLS SEOO .
TYPE-POOLS SEOP .
TYPE-POOLS SEOR .
TYPE-POOLS SEOS .
TYPE-POOLS SEOT .
TYPE-POOLS SEOX .
TYPE-POOLS SLIS .
CLASS ZAPLINK_CLAS_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_COMPONENT DEFINITION DEFERRED.
INTERFACE ZAPLINK_CONNECTOR DEFERRED.
CLASS ZAPLINK_CONNECTORS DEFINITION DEFERRED.
CLASS ZAPLINK_CONNECTOR_ DEFINITION DEFERRED.
CLASS ZAPLINK_CONTAINER_4INST DEFINITION DEFERRED.
CLASS ZAPLINK_CX DEFINITION DEFERRED.
CLASS ZAPLINK_CX_COMPONENT DEFINITION DEFERRED.
CLASS ZAPLINK_CX_CONNECTOR DEFINITION DEFERRED.
CLASS ZAPLINK_CX_CONTAINER DEFINITION DEFERRED.
CLASS ZAPLINK_CX_FILE DEFINITION DEFERRED.
CLASS ZAPLINK_CX_LIST DEFINITION DEFERRED.
CLASS ZAPLINK_CX_OPTIONS DEFINITION DEFERRED.
CLASS ZAPLINK_CX_OPT_DEVCLASS DEFINITION DEFERRED.
INTERFACE ZAPLINK_DATATYPES DEFERRED.
CLASS ZAPLINK_DEVC_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_DEVC_RAW DEFINITION DEFERRED.
CLASS ZAPLINK_DOCUMENTATION DEFINITION DEFERRED.
CLASS ZAPLINK_DOC_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_EASYXML DEFINITION DEFERRED.
CLASS ZAPLINK_FILE DEFINITION DEFERRED.
CLASS ZAPLINK_INTF_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_LIST DEFINITION DEFERRED.
CLASS ZAPLINK_LIST_ DEFINITION DEFERRED.
CLASS ZAPLINK_MESSAGE DEFINITION DEFERRED.
CLASS ZAPLINK_MESSAGE_COLLECTOR DEFINITION DEFERRED.
CLASS ZAPLINK_MSAG_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_OBJECT DEFINITION DEFERRED.
CLASS ZAPLINK_OBJECT_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_OPTIONS DEFINITION DEFERRED.
CLASS ZAPLINK_OPT_DEVCLASS DEFINITION DEFERRED.
CLASS ZAPLINK_OPT_DIRECTORY DEFINITION DEFERRED.
CLASS ZAPLINK_OPT_TRANSPORT_REQUEST DEFINITION DEFERRED.
CLASS ZAPLINK_PACKAGE DEFINITION DEFERRED.
CLASS ZAPLINK_PINF_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_PINF_RAW DEFINITION DEFERRED.
CLASS ZAPLINK_PROGRAM DEFINITION DEFERRED.
CLASS ZAPLINK_PROG_DATA DEFINITION DEFERRED.
CLASS ZAPLINK_RAW DEFINITION DEFERRED.
CLASS ZAPLINK_CX DEFINITION
  INHERITING FROM CX_STATIC_CHECK
  CREATE PUBLIC

  FRIENDS ZAPLINK_CX .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_CX
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.
  TYPE-POOLS ICON .

  TYPES:
    BEGIN OF TS_SOURCE_DEF,
        TYPE_TXT TYPE EUOBJT-SINGULAR,
        NAME TYPE SEU_OBJKEY,
        STR TYPE STRING,
      END OF TS_SOURCE_DEF .
  TYPES E_TXT_ID TYPE SOTR_CONC .
  TYPES O_MSG_COLL TYPE REF TO ZAPLINK_MESSAGE_COLLECTOR .
  TYPES:
    BEGIN OF TS_SOURCE_POS,
        PROGRAM_NAME  TYPE  SYREPID,
        INCLUDE_NAME  TYPE  SYREPID,
        SOURCE_LINE   TYPE  I,
      END OF TS_SOURCE_POS .

  CONSTANTS BAL_LOG TYPE SOTR_CONC VALUE &apos;8A01044B27B3115BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS SYSTEM_ERROR TYPE SOTR_CONC VALUE &apos;8B01044B27B3115BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS ZAPLINK_CX TYPE SOTR_CONC VALUE &apos;8901044B27B3115BE1000000AC120173&apos;. &quot;#EC NOTEXT
  DATA MSG TYPE STRING VALUE &apos;44F7518323DB08BC02000000A7E42BB6&apos;. &quot;#EC NOTEXT .
  DATA MESSAGES TYPE O_MSG_COLL .
  DATA OBJECT TYPE BALOBJ_D .
  DATA SUBOBJECT TYPE BALSUBOBJ .
  DATA PREV_CX TYPE REF TO ZAPLINK_CX .
  DATA EXT_ID TYPE BALNREXT .
  DATA CX_NAME TYPE STRING .

  METHODS CONSTRUCTOR
    IMPORTING
      !TEXTID LIKE TEXTID OPTIONAL
      !PREVIOUS LIKE PREVIOUS OPTIONAL
      !MSG TYPE STRING DEFAULT &apos;44F7518323DB08BC02000000A7E42BB6&apos;
      !MESSAGES TYPE O_MSG_COLL OPTIONAL
      !OBJECT TYPE BALOBJ_D OPTIONAL
      !SUBOBJECT TYPE BALSUBOBJ OPTIONAL
      !PREV_CX TYPE REF TO ZAPLINK_CX OPTIONAL
      !EXT_ID TYPE BALNREXT OPTIONAL
      !CX_NAME TYPE STRING OPTIONAL .
  METHODS UPDATE .
  CLASS-METHODS NEW_WITH_BALLOG
    IMPORTING
      !MESSAGE_COLLECTOR TYPE O_MSG_COLL
      !TEXTID TYPE E_TXT_ID OPTIONAL
      !PREV_CX TYPE REF TO ZAPLINK_CX OPTIONAL
    RETURNING
      VALUE(EXCEPTION) TYPE REF TO ZAPLINK_CX .
  METHODS WRITE .
  METHODS GET_SOURCE_POSITION_AS_STRING
    RETURNING
      VALUE(STR) TYPE STRING .
  CLASS-METHODS SOURCE_POSITION_AS_STRING
    IMPORTING
      !EXCEPTION TYPE REF TO CX_ROOT
    RETURNING
      VALUE(STR) TYPE STRING .
  CLASS-METHODS CREATE_FROM_MF_CX
    IMPORTING
      !FUNCNAME TYPE RS38L-NAME
      !SUBRC TYPE SY-SUBRC
      !CLASSNAME TYPE STRING OPTIONAL
      !TEXTID TYPE SOTR_CONC DEFAULT SYSTEM_ERROR
    RETURNING
      VALUE(RESULT) TYPE REF TO ZAPLINK_CX
    RAISING
      ZAPLINK_CX .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_CX
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  CLASS-METHODS CONV_PROGNAME
    IMPORTING
      !OBJECT_NAME TYPE SEU_OBJKEY
      !CONTEXT TYPE SEU_OBJKEY OPTIONAL
    RETURNING
      VALUE(SOURCE) TYPE TS_SOURCE_DEF .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_CX
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_CX DEFINITION
CLASS ZAPLINK_MESSAGE_COLLECTOR DEFINITION
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_MESSAGE_COLLECTOR
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.
  TYPE-POOLS ABAP .

  TYPES:
    T_MSG TYPE STANDARD TABLE OF BAL_S_MSG WITH NON-UNIQUE DEFAULT KEY .

  DATA OBJECT TYPE BALOBJ_D READ-ONLY .
  DATA MD_EXTNUMBER TYPE BALNREXT READ-ONLY .
  DATA MD_LEVEL TYPE BALLEVEL READ-ONLY .
  DATA SUBOBJECT TYPE BALSUBOBJ READ-ONLY .
  DATA EXT_ID TYPE BALNREXT READ-ONLY .
  CONSTANTS:
    BEGIN OF ACTIONS,
      CREATE    TYPE BU_AKTYP VALUE &apos;01&apos;, &quot;#EC NOTEXT
      CHANGE    TYPE BU_AKTYP VALUE &apos;02&apos;, &quot;#EC NOTEXT
      DISPLAY   TYPE BU_AKTYP VALUE &apos;03&apos;, &quot;#EC NOTEXT
    END OF ACTIONS .
  CONSTANTS ACT_CREATE TYPE BU_AKTYP VALUE &apos;01&apos;. &quot;#EC NOTEXT
  CONSTANTS ACT_CHANGE TYPE BU_AKTYP VALUE &apos;02&apos;. &quot;#EC NOTEXT
  CONSTANTS ACT_DISPLAY TYPE BU_AKTYP VALUE &apos;03&apos;. &quot;#EC NOTEXT
  DATA MSGID TYPE SYMSGID .
  CONSTANTS:
    BEGIN OF PROBCL,
        VERY_IMP    TYPE BALPROBCL VALUE &apos;1&apos;,               &quot;#EC NOTEXT
        IMPORTANT   TYPE BALPROBCL VALUE &apos;2&apos;,               &quot;#EC NOTEXT
        MEDIUM      TYPE BALPROBCL VALUE &apos;3&apos;,               &quot;#EC NOTEXT
        FOR_INFO    TYPE BALPROBCL VALUE &apos;4&apos;,               &quot;#EC NOTEXT
        OTHER       TYPE BALPROBCL VALUE SPACE,
      END OF PROBCL .

  METHODS ADD
    IMPORTING
      !IS_MESSAGE TYPE BAL_S_MSG OPTIONAL
      !ID_MSGTY TYPE SYMSGTY OPTIONAL
      !ID_MSGID TYPE SYMSGID OPTIONAL
      !ID_MSGNO TYPE SYMSGNO OPTIONAL
      !ID_MSGV1 TYPE CLIKE OPTIONAL
      !ID_MSGV2 TYPE CLIKE OPTIONAL
      !ID_MSGV3 TYPE CLIKE OPTIONAL
      !ID_MSGV4 TYPE CLIKE OPTIONAL
      !ID_MSGD1 TYPE SYDATUM OPTIONAL
      !ID_MSGD2 TYPE SYDATUM OPTIONAL
      !ID_MSGD3 TYPE SYDATUM OPTIONAL
      !ID_MSGD4 TYPE SYDATUM OPTIONAL
      !ID_DETLEVEL TYPE BALLEVEL OPTIONAL
      !IF_CUMULATE TYPE ABAP_BOOL OPTIONAL
      !ID_PROBCLASS TYPE BALPROBCL OPTIONAL
      !ID_INDEX TYPE NUMERIC OPTIONAL
      !ID_SUBLOG TYPE BALLOGHNDL OPTIONAL
    EXPORTING
      VALUE(ES_MESSAGE) TYPE BAL_S_MSG .
  METHODS ADD_ABEND
    IMPORTING
      !ID_MSGID TYPE SYMSGID OPTIONAL
      !ID_MSGNO TYPE SYMSGNO
      !ID_MSGV1 TYPE CLIKE OPTIONAL
      !ID_MSGV2 TYPE CLIKE OPTIONAL
      !ID_MSGV3 TYPE CLIKE OPTIONAL
      !ID_MSGV4 TYPE CLIKE OPTIONAL
      !ID_DETLEVEL TYPE BALLEVEL OPTIONAL
      !ID_PROBCLASS TYPE BALPROBCL OPTIONAL .
  METHODS ADD_ERROR
    IMPORTING
      !ID_MSGID TYPE SYMSGID OPTIONAL
      !ID_MSGNO TYPE SYMSGNO
      !ID_MSGV1 TYPE CLIKE OPTIONAL
      !ID_MSGV2 TYPE CLIKE OPTIONAL
      !ID_MSGV3 TYPE CLIKE OPTIONAL
      !ID_MSGV4 TYPE CLIKE OPTIONAL
      !ID_DETLEVEL TYPE BALLEVEL OPTIONAL
      !ID_PROBCLASS TYPE BALPROBCL OPTIONAL .
  METHODS ADD_EXCEPTION
    IMPORTING
      !EXCEPTION TYPE REF TO CX_ROOT
      !ID_DETLEVEL TYPE BALLEVEL OPTIONAL
      !ID_PROBCLASS TYPE BALPROBCL OPTIONAL .
  METHODS ADD_FROM_BAPI
    IMPORTING
      !IT_BAPIRET TYPE BAPIRETTAB OPTIONAL
      !IS_BAPIRET TYPE BAPIRET2 OPTIONAL
      !IF_CUMULATE TYPE ABAP_BOOL OPTIONAL
    EXPORTING
      !EF_ADD_ERROR TYPE ABAP_BOOL
      !EF_ADD_WARNING TYPE ABAP_BOOL .
  METHODS ADD_FROM_INSTANCE
    IMPORTING
      !IO_MSGLIST TYPE REF TO ZAPLINK_MESSAGE_COLLECTOR
      !IF_ADD_AS_SUBNODE TYPE ABAP_BOOL DEFAULT ABAP_FALSE
      !IF_CUMULATE TYPE ABAP_BOOL OPTIONAL .
  METHODS ADD_INFO
    IMPORTING
      !ID_MSGID TYPE SYMSGID OPTIONAL
      !ID_MSGNO TYPE SYMSGNO
      !ID_MSGV1 TYPE CLIKE OPTIONAL
      !ID_MSGV2 TYPE CLIKE OPTIONAL
      !ID_MSGV3 TYPE CLIKE OPTIONAL
      !ID_MSGV4 TYPE CLIKE OPTIONAL
      !ID_DETLEVEL TYPE BALLEVEL OPTIONAL
      !ID_PROBCLASS TYPE BALPROBCL OPTIONAL .
  METHODS ADD_SUCCESS
    IMPORTING
      !ID_MSGID TYPE SYMSGID OPTIONAL
      !ID_MSGNO TYPE SYMSGNO
      !ID_MSGV1 TYPE CLIKE OPTIONAL
      !ID_MSGV2 TYPE CLIKE OPTIONAL
      !ID_MSGV3 TYPE CLIKE OPTIONAL
      !ID_MSGV4 TYPE CLIKE OPTIONAL
      !ID_DETLEVEL TYPE BALLEVEL OPTIONAL
      !ID_PROBCLASS TYPE BALPROBCL OPTIONAL .
  METHODS ADD_SYMSG
    IMPORTING
      !ID_MSGTY TYPE SYMSGTY DEFAULT SY-MSGTY
      !ID_DETLEVEL TYPE BALLEVEL OPTIONAL
      !IF_CUMULATE TYPE ABAP_BOOL OPTIONAL
      !ID_PROBCLASS TYPE BALPROBCL OPTIONAL
      !ID_INDEX TYPE NUMERIC OPTIONAL
    EXPORTING
      VALUE(ES_MESSAGE) TYPE BAL_S_MSG .
  METHODS ADD_WARNING
    IMPORTING
      !ID_MSGID TYPE SYMSGID OPTIONAL
      !ID_MSGNO TYPE SYMSGNO
      !ID_MSGV1 TYPE CLIKE OPTIONAL
      !ID_MSGV2 TYPE CLIKE OPTIONAL
      !ID_MSGV3 TYPE CLIKE OPTIONAL
      !ID_MSGV4 TYPE CLIKE OPTIONAL
      !ID_DETLEVEL TYPE BALLEVEL OPTIONAL
      !ID_PROBCLASS TYPE BALPROBCL OPTIONAL .
  CLASS-METHODS AS_CHAR
    IMPORTING
      !ID_DATE TYPE SYDATUM
    RETURNING
      VALUE(RD_DATE) TYPE CHAR10 .
  METHODS CHANGE_MSG_TYPE
    IMPORTING
      !ID_MSGTY_SRC TYPE SYMSGTY OPTIONAL
      !ID_MSGTY_TRG TYPE SYMSGTY
    RETURNING
      VALUE(RD_CHANGED) TYPE I .
  METHODS CHECK_CUSTO
    IMPORTING
      !ID_OBJECT TYPE BALOBJ_D
      !ID_SUBOBJECT TYPE BALSUBOBJ
    EXCEPTIONS
      ERROR .
  METHODS CLEAR .
  CLASS-METHODS CONVERT_DATE_TO_STRING
    IMPORTING
      !ID_DATE TYPE SYDATUM
    EXPORTING
      !ED_DATE_STRING TYPE CSEQUENCE .
  METHODS COUNT
    RETURNING
      VALUE(RD_COUNT) TYPE I .
  METHODS DELETE_MESSAGE
    IMPORTING
      !ID_MSGNUMBER TYPE BALMNR
    EXCEPTIONS
      NOT_FOUND .
  METHODS FREE .
  METHODS GET_FIRST_MESSAGE
    IMPORTING
      !ID_MSGTY TYPE SYMSGTY DEFAULT &apos;I&apos;
      !IF_OR_HIGHER TYPE ABAP_BOOL DEFAULT ABAP_TRUE
    EXPORTING
      !ES_MESSAGE TYPE BAL_S_MSG
    EXCEPTIONS
      NOT_FOUND .
  METHODS GET_HANDLE
    RETURNING
      VALUE(RD_HANDLE) TYPE BALLOGHNDL .
  METHODS GET_LAST_MESSAGE
    IMPORTING
      !ID_MSGTY TYPE SYMSGTY DEFAULT &apos;I&apos;
      !IF_OR_HIGHER TYPE ABAP_BOOL DEFAULT ABAP_TRUE
    EXPORTING
      !ES_MESSAGE TYPE BAL_S_MSG
    EXCEPTIONS
      NOT_FOUND .
  METHODS GET_LIST
    RETURNING
      VALUE(ET_LIST) TYPE T_MSG .
  METHODS GET_LIST_AS_BAPIRET
    RETURNING
      VALUE(ET_LIST) TYPE BAPIRETTAB .
  CLASS-METHODS GET_REF_TYPE
    IMPORTING
      !TYPEDESC TYPE REF TO CL_ABAP_TYPEDESCR
    RETURNING
      VALUE(REF_TYPE) TYPE REF TO CL_ABAP_TYPEDESCR .
  METHODS GET_STATISTICS
    RETURNING
      VALUE(RS_STATISTICS) TYPE BAL_S_SCNT .
  METHODS GET_STATISTICS_AS_TE
    IMPORTING
      !IF_OUTPUT_E_MESSAGES TYPE ABAP_BOOL DEFAULT ABAP_TRUE
      !IF_OUTPUT_W_MESSAGES TYPE ABAP_BOOL DEFAULT ABAP_TRUE
      !IF_OUTPUT_I_MESSAGES TYPE ABAP_BOOL DEFAULT ABAP_FALSE
      !IF_OUTPUT_HIGHEST_ONLY TYPE ABAP_BOOL DEFAULT ABAP_TRUE
    EXPORTING
      VALUE(ED_TEXT) TYPE CSEQUENCE .
  METHODS HAS_MESSAGES_OF_MSGT
    IMPORTING
      !ID_MSGTY TYPE SYMSGTY
      !IF_OR_HIGHER TYPE ABAP_BOOL DEFAULT ABAP_TRUE
    RETURNING
      VALUE(RF_EXISTS) TYPE ABAP_BOOL .
  METHODS INIT
    IMPORTING
      !ID_OBJECT TYPE BALOBJ_D
      !ID_SUBOBJECT TYPE BALSUBOBJ
      !ID_EXTNUMBER TYPE BALNREXT OPTIONAL
      !AUTO_UPD_CUSTO TYPE FLAG DEFAULT ABAP_FALSE
      !ID_ACTIVITY TYPE BU_AKTYP DEFAULT ACT_CREATE
    EXCEPTIONS
      ERROR .
  METHODS INIT_BY_HANDLE
    IMPORTING
      !ID_HANDLE TYPE BALLOGHNDL
    EXCEPTIONS
      ERROR .
  METHODS INSERT
    IMPORTING
      !ID_INSERT_INDEX TYPE I
      !IF_SET_FOLLOWING_AS_SUBNODE TYPE ABAP_BOOL DEFAULT ABAP_FALSE
      !IS_MESSAGE TYPE BAL_S_MSG OPTIONAL
      !ID_MSGTY TYPE SYMSGTY OPTIONAL
      !ID_MSGID TYPE SYMSGID OPTIONAL
      !ID_MSGNO TYPE SYMSGNO OPTIONAL
      !ID_MSGV1 TYPE CLIKE OPTIONAL
      !ID_MSGV2 TYPE CLIKE OPTIONAL
      !ID_MSGV3 TYPE CLIKE OPTIONAL
      !ID_MSGV4 TYPE CLIKE OPTIONAL
      !ID_MSGD1 TYPE SYDATUM OPTIONAL
      !ID_MSGD2 TYPE SYDATUM OPTIONAL
      !ID_MSGD3 TYPE SYDATUM OPTIONAL
      !ID_MSGD4 TYPE SYDATUM OPTIONAL
      !ID_DETLEVEL TYPE BALLEVEL OPTIONAL
      !ID_PROBCLASS TYPE BALPROBCL OPTIONAL
      !ID_INDEX TYPE NUMERIC OPTIONAL
    EXPORTING
      VALUE(ES_MESSAGE) TYPE BAL_S_MSG .
  CLASS-METHODS IS_DATE_INITIAL
    IMPORTING
      !ID_DATE TYPE SY-DATUM
    RETURNING
      VALUE(RF_INITIAL) TYPE ABAP_BOOL .
  METHODS IS_EMPTY
    RETURNING
      VALUE(RF_EMPTY) TYPE ABAP_BOOL .
  CLASS-METHODS NEW
    RETURNING
      VALUE(OBJ) TYPE REF TO ZAPLINK_MESSAGE_COLLECTOR .
  METHODS RAISE_FIRST_MESSAGE
    IMPORTING
      !ID_MSGTY TYPE SYMSGTY DEFAULT &apos;E&apos;
      !IF_OR_HIGHER TYPE ABAP_BOOL DEFAULT ABAP_TRUE
    EXCEPTIONS
      FIRST_MESSAGE .
  METHODS RAISE_ON_ERROR
    RAISING
      ZAPLINK_CX .
  METHODS SET_DETAIL_LEVEL
    IMPORTING
      !ID_ABSOLUTE TYPE BALLEVEL OPTIONAL
      !ID_RELATIVE TYPE INT4 OPTIONAL .
  METHODS SET_EXTNUMBER
    IMPORTING
      !ID_EXTNUMBER TYPE BALNREXT .
  METHODS STORE
    IMPORTING
      !IF_IN_UPDATE_TASK TYPE ABAP_BOOL DEFAULT ABAP_FALSE
    EXCEPTIONS
      ERROR .
  METHODS WRITE
    IMPORTING
      !_OFFSET TYPE STRING OPTIONAL .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_MESSAGE_COLLECTOR
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  TYPES:
    BEGIN OF MSG_X .
    INCLUDE TYPE BAL_S_MSG AS MSG.
TYPES:
    MSGNUMBER TYPE BALMNR,
  END OF MSG_X .
  TYPES:
    T_MSG_X TYPE STANDARD TABLE OF MSG_X WITH NON-UNIQUE DEFAULT KEY .

  CONSTANTS MC_MIN_LEVEL TYPE N VALUE &apos;1&apos;. &quot;#EC NOTEXT
  CONSTANTS MC_MAX_LEVEL TYPE N VALUE &apos;9&apos;. &quot;#EC NOTEXT
  DATA MD_HANDLE TYPE BALLOGHNDL .
  DATA MS_LOG TYPE BAL_S_LOG .
  DATA MR_SUP_CALLSTACK TYPE REF TO SYS_CALLS .
  DATA MD_SUP_COUNT TYPE SYTABIX .
  DATA MT_SUP_MSG TYPE T_MSG_X .
  DATA MF_LOG_NOT_STORED TYPE ABAP_BOOL VALUE ABAP_FALSE. &quot;#EC NOTEXT .

  METHODS _ADD_ZL_CX
    IMPORTING
      !EXCEPTION TYPE REF TO ZAPLINK_CX
      !ID_DETLEVEL TYPE BALLEVEL OPTIONAL
      !ID_PROBCLASS TYPE BALPROBCL OPTIONAL .
  METHODS GET_LIST_X
    IMPORTING
      !ID_MSGTY TYPE SYMSGTY DEFAULT &apos;I&apos;
    EXPORTING
      !ET_LIST_X TYPE T_MSG_X .
  METHODS GET_MSG_FILTER
    IMPORTING
      VALUE(ID_MSGTY) TYPE SYMSGTY DEFAULT &apos;I&apos;
      VALUE(IF_OR_HIGHER) TYPE ABAP_BOOL DEFAULT ABAP_TRUE
    EXPORTING
      !ES_MSG_FILTER TYPE BAL_S_MFIL .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_MESSAGE_COLLECTOR
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_MESSAGE_COLLECTOR DEFINITION
CLASS ZAPLINK_EASYXML DEFINITION
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_EASYXML
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  DATA BAL_LOG TYPE REF TO ZAPLINK_MESSAGE_COLLECTOR READ-ONLY .

  METHODS ADD_ANY
    IMPORTING
      !XML_NODE TYPE REF TO IF_IXML_ELEMENT
      !NAME TYPE STRING OPTIONAL
      !ANY TYPE ANY
      !XMLDOC TYPE REF TO IF_IXML_DOCUMENT
      !TYPEDESC TYPE REF TO CL_ABAP_TYPEDESCR OPTIONAL .
  METHODS ANY2XML
    IMPORTING
      !ANY TYPE ANY
      !TYPE TYPE STRING
      !ATTRIBUTS TYPE ANY OPTIONAL
    RETURNING
      VALUE(XMLDOC) TYPE REF TO IF_IXML_DOCUMENT
    RAISING
      ZAPLINK_CX .
  CLASS-METHODS CLASS_CONSTRUCTOR .
  METHODS CONSTRUCTOR .
  METHODS GET_ATTRIBUTS
    IMPORTING
      !XMLDOC TYPE REF TO IF_IXML_DOCUMENT
    CHANGING
      !ATTRIBUTS TYPE ANY
    RAISING
      ZAPLINK_CX .
  CLASS-METHODS GET_REF_TYPE
    IMPORTING
      !TYPEDESC TYPE REF TO CL_ABAP_TYPEDESCR
    RETURNING
      VALUE(REF_TYPE) TYPE REF TO CL_ABAP_TYPEDESCR .
  CLASS-METHODS NODE2STRING
    IMPORTING
      !XML_NODE TYPE REF TO IF_IXML_ELEMENT
    RETURNING
      VALUE(STRING) TYPE STRING .
  METHODS RESET .
  METHODS XML2ANY
    IMPORTING
      !XMLDOC TYPE REF TO IF_IXML_DOCUMENT
    CHANGING
      !ANY TYPE ANY
      !ATTRIBUTS TYPE ANY OPTIONAL
    RAISING
      ZAPLINK_CX .
  METHODS _XML2ANY
    IMPORTING
      !XML TYPE REF TO IF_IXML_NODE
    CHANGING
      !ANY TYPE ANY .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_EASYXML
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  DATA IXML TYPE REF TO IF_IXML .

  METHODS READ_ANY
    IMPORTING
      !XML_NODE TYPE REF TO IF_IXML_ELEMENT
      !TYPEDESC TYPE REF TO CL_ABAP_TYPEDESCR OPTIONAL
    CHANGING
      !ANY TYPE ANY .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_EASYXML
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  TYPES:
    BEGIN OF TS_ELE,
    SELECT    TYPE FLAG,
    ELEM_TYPE TYPE TROBJTYPE,
    ELEM_KEY  TYPE ELEMGENKEY,
    TD_PACK   TYPE DEVCLASS,
    ELEM_PACK TYPE DEVCLASS,
  END OF TS_ELE .
  TYPES:
    TT_ELE TYPE STANDARD TABLE OF TS_ELE WITH NON-UNIQUE DEFAULT KEY .
  TYPES:
    BEGIN OF TS_ITF_EL,
    INTERFACE TYPE REF TO IF_PACKAGE_INTERFACE,
    ELEMENTS  TYPE STANDARD TABLE OF SCOMELDTLN WITH NON-UNIQUE DEFAULT KEY, &quot;SCOMELDATA,
    ACLS      TYPE STANDARD TABLE OF SCOMACLSTR WITH NON-UNIQUE DEFAULT KEY, &quot;SCOMACLTAB,
  END OF TS_ITF_EL .
  TYPES:
    TT_ITF_EL TYPE STANDARD TABLE OF TS_ITF_EL WITH NON-UNIQUE DEFAULT KEY .
  TYPES:
    TT_CONTEXT TYPE STANDARD TABLE OF STRING WITH DEFAULT KEY .

  CONSTANTS TN_NAME TYPE STRING VALUE &apos;ZSL_NAME&apos;. &quot;#EC NOTEXT
  CONSTANTS TN_VERSION TYPE STRING VALUE &apos;ZSLPI_VER&apos;. &quot;#EC NOTEXT
  CONSTANTS EN_LINE TYPE STRING VALUE &apos;ITEM&apos;. &quot;#EC NOTEXT
  CONSTANTS MSGID TYPE SYMSGID VALUE &apos;ZAPLINK_EASYXML&apos;. &quot;#EC NOTEXT
  DATA EXCEPTION TYPE REF TO ZAPLINK_CX .
  DATA BAL_LEVEL TYPE BALLEVEL .
  DATA RC TYPE I .
  DATA CRC TYPE STRING .
  CONSTANTS SELF_FIELDNAME TYPE STRING VALUE &apos;_&apos;. &quot;#EC NOTEXT
  DATA CONTEXT TYPE TT_CONTEXT .

  METHODS ADD_OBJECT
    IMPORTING
      !XML_NODE TYPE REF TO IF_IXML_ELEMENT
      !NAME TYPE STRING OPTIONAL
      !OBJECT TYPE REF TO OBJECT
      !XMLDOC TYPE REF TO IF_IXML_DOCUMENT
      !TYPEDESC TYPE REF TO CL_ABAP_TYPEDESCR OPTIONAL .
  METHODS ADD_STRUCTURE
    IMPORTING
      !XML_NODE TYPE REF TO IF_IXML_ELEMENT
      !NAME TYPE STRING OPTIONAL
      !STRUCTURE TYPE DATA
      !XMLDOC TYPE REF TO IF_IXML_DOCUMENT .
  METHODS ADD_TABLE
    IMPORTING
      !XML_NODE TYPE REF TO IF_IXML_ELEMENT
      !NAME TYPE STRING OPTIONAL
      !TABLE TYPE ANY TABLE
      !XMLDOC TYPE REF TO IF_IXML_DOCUMENT .
  METHODS ELEM_2_STRING
    IMPORTING
      !ANY TYPE ANY
      !TYPE_DESC TYPE REF TO CL_ABAP_TYPEDESCR OPTIONAL
    RETURNING
      VALUE(STRING) TYPE STRING .
  TYPE-POOLS ABAP .
  CLASS-METHODS IS_SIMPLE_TYPE_KIND
    IMPORTING
      !TYPE_KIND TYPE ABAP_TYPEKIND
    RETURNING
      VALUE(RESULT) TYPE ABAP_BOOL .
  METHODS READ_OBJECT
    IMPORTING
      !XML_NODE TYPE REF TO IF_IXML_ELEMENT
      !TYPEDESC TYPE REF TO CL_ABAP_TYPEDESCR OPTIONAL
    CHANGING
      !OBJECT TYPE REF TO OBJECT .
  METHODS READ_STRUCTURE
    IMPORTING
      !XML_NODE TYPE REF TO IF_IXML_ELEMENT
    CHANGING
      !STRUCTURE TYPE DATA .
  METHODS READ_TABLE
    IMPORTING
      !XML_NODE TYPE REF TO IF_IXML_ELEMENT
    CHANGING
      !TABLE TYPE ANY TABLE .
  METHODS STACK
    IMPORTING
      !ITEM TYPE STRING .
  METHODS STACK_DESCR
    IMPORTING
      !DESC TYPE REF TO CL_ABAP_TYPEDESCR .
  METHODS STRING_2_ELEM
    IMPORTING
      !TYPE_DESC TYPE REF TO CL_ABAP_TYPEDESCR OPTIONAL
      VALUE(STRING) TYPE STRING
    CHANGING
      !ANY TYPE ANY .
  METHODS UNSTACK .
ENDCLASS. &quot;ZAPLINK_EASYXML DEFINITION
CLASS ZAPLINK_LIST_ DEFINITION
  CREATE PROTECTED .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_LIST_
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_LIST_
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_LIST_
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_LIST_ DEFINITION
*&quot;* COMPONENTS OF INTERFACE ZAPLINK_DATATYPES
INTERFACE ZAPLINK_DATATYPES.

  TYPE-POOLS ABAP .

  TYPES TD_SUBSTITUTIONKIND TYPE CHAR1 .
  TYPES:
    BEGIN OF TS_DIRECTORY,
* TADIR
*      PGMID TYPE TADIR-PGMID,
*      OBJECT TYPE TADIR-OBJECT,
*      OBJ_NAME TYPE TADIR-OBJ_NAME,
      KORRNUM TYPE TADIR-KORRNUM,
      SRCSYSTEM TYPE TADIR-SRCSYSTEM,
      AUTHOR TYPE TADIR-AUTHOR,
      SRCDEP TYPE TADIR-SRCDEP,
      DEVCLASS TYPE TADIR-DEVCLASS,
      GENFLAG TYPE TADIR-GENFLAG,
      EDTFLAG TYPE TADIR-EDTFLAG,
*      CPROJECT TYPE TADIR-CPROJECT,
      MASTERLANG TYPE TADIR-MASTERLANG,
*      VERSID TYPE TADIR-VERSID,
      PAKNOCHECK TYPE TADIR-PAKNOCHECK,
      OBJSTABLTY TYPE TADIR-OBJSTABLTY,
      COMPONENT TYPE TADIR-COMPONENT,
      CRELEASE TYPE TADIR-CRELEASE,
      DELFLAG TYPE TADIR-DELFLAG,
      TRANSLTTXT TYPE TADIR-TRANSLTTXT,
* E071
      TRKORR TYPE E070-TRKORR,
    END OF TS_DIRECTORY .
  TYPES TD_CONNUUID TYPE GUID_16 .
  TYPES TD_TYPE_AS_TEXT TYPE KO100-TEXT .
  TYPES TD_COMPTEXT TYPE KO100-TEXT .
  TYPES TD_CONTNAME TYPE STRING .
  TYPES TD_CONTVER TYPE STRING .
  TYPES TD_FILENAME TYPE STRING .
  TYPES TD_FILETYPE TYPE CHAR1 .
  TYPES TD_TRANSPORT_REQUEST TYPE E070-TRKORR .
  TYPES:
    TR_TR TYPE RANGE OF TD_TRANSPORT_REQUEST .
  TYPES:
    TR_PACKAGES TYPE RANGE OF TADIR-DEVCLASS .
  TYPES:
    TR_DLVUNIT TYPE RANGE OF TDEVC-DLVUNIT .
  TYPES TD_ABAPSOURCE TYPE STRING .
  TYPES TD_PROGNAME TYPE PROGRAMM .
  TYPES TT_ABAPRAWSOURCE TYPE RSWSOURCET .
  TYPES TO_XML TYPE REF TO IF_IXML_DOCUMENT .
  TYPES TD_LIGHT TYPE ICON_L4 .
  TYPES TD_SEL_ACTION TYPE CHAR1 .
  TYPES TD_CONNVER TYPE STRING .
  TYPES TO_RAW_DATA TYPE REF TO OBJECT .
  TYPES TD_EXISTS TYPE ABAP_BOOL .
  TYPES TD_CLASSNAME TYPE SEOCLSNAME .
  TYPES TD_COMPEXISTS TYPE TD_EXISTS .
  TYPES TD_CONNCLASS TYPE TD_CLASSNAME .
  TYPES TD_CONNEXISTS TYPE TD_EXISTS .
  TYPES TD_DEVCLASS TYPE TADIR-DEVCLASS .
  TYPES TD_OBJ_TYPE TYPE ABAP_ABSTYPENAME .
  TYPES TD_COMPNAME TYPE STRING .
  TYPES TD_COMPTYPE TYPE TADIR-OBJECT .
  TYPES:
    BEGIN OF TS_COMPKEY,
      TYPE TYPE TD_COMPTYPE,
      NAME TYPE TD_COMPNAME,
    END OF TS_COMPKEY .
  TYPES:
    TT_COMPKEYS TYPE STANDARD TABLE OF TS_COMPKEY WITH DEFAULT KEY .
  TYPES:
    BEGIN OF TS_BASE_ATTRIBUTS,
        NAME     TYPE TD_COMPNAME,
        CLASS    TYPE TD_CONNCLASS,
        DEVCLASS TYPE TD_DEVCLASS,
        VERSION  TYPE TD_CONNVER,
      END OF TS_BASE_ATTRIBUTS .
  TYPES:
    BEGIN OF TS_CONN_CLASS,
      UUID      TYPE TD_CONNUUID,
      CLASSNAME TYPE TD_CONNCLASS,
      DEVCLASS  TYPE TD_DEVCLASS,
      END OF TS_CONN_CLASS .
  TYPES:
    TT_CONN_CLASSES TYPE SORTED TABLE OF TS_CONN_CLASS WITH UNIQUE KEY UUID .
  TYPES:
    BEGIN OF TS_CONN_DEF,
          OBJECT        TYPE KO100-OBJECT,
          TEXT          TYPE KO100-TEXT,
          DEFAULT_CLASS TYPE TD_CONNCLASS,
          CLASSES       TYPE TT_CONN_CLASSES,
        END OF TS_CONN_DEF .
  TYPES:
    TT_CONNECTORLIST TYPE SORTED TABLE OF TS_CONN_DEF WITH UNIQUE KEY OBJECT .
  TYPES:
    BEGIN OF TS_TYPE,
      TYPE TYPE TD_COMPTYPE,
    END OF TS_TYPE .
  TYPES:
    TT_TYPES TYPE SORTED TABLE OF TS_TYPE WITH UNIQUE KEY TYPE .
  TYPES TD_LANG TYPE SPRAS .
  TYPES TD_TXTP_TEXT TYPE TEXTPOOLTX .
  TYPES TD_TXTP_LEN TYPE TEXTPOOLLN .
  TYPES TD_TXTP_KIND TYPE TEXTPOOLID .
  TYPES TD_TXTP_ID TYPE TEXTPOOLKY .
  TYPES:
    BEGIN OF TS_TXTP_TEXT,
        LANGU   TYPE TD_LANG,
        ENTRY   TYPE TD_TXTP_TEXT,
        LENGTH  TYPE TD_TXTP_LEN,
      END OF TS_TXTP_TEXT .
  TYPES:
    TT_TXTP_TEXTS TYPE SORTED TABLE OF TS_TXTP_TEXT WITH UNIQUE KEY LANGU .
  TYPES:
    BEGIN OF TS_TXTP_TEXTPOOL,
        ID    TYPE  TD_TXTP_KIND,
        KEY   TYPE  TD_TXTP_ID,
        TEXTS TYPE  TT_TXTP_TEXTS,
      END OF TS_TXTP_TEXTPOOL .
  TYPES:
    TT_TXTP_TEXTPOOLS TYPE SORTED TABLE OF TS_TXTP_TEXTPOOL WITH UNIQUE KEY ID KEY .
  TYPES:
    BEGIN OF TS_CONNDATA,
      ZSL_NAME      TYPE TD_COMPNAME,         &quot; COMPONENT NAME
      ZSL_CONNECTOR TYPE TD_CONNCLASS,        &quot; CONNECTOR CLASS NAME
      ZSL_VERSION   TYPE TD_CONNVER,          &quot; CONNECTOR VERSION
    END OF TS_CONNDATA .
  TYPES:
    BEGIN OF TS_CONTDATA,
          NAME TYPE TD_CONTNAME,
*      AUTHOR TYPE TD_NUGNAME,
        END OF TS_CONTDATA .
  TYPES TD_DOC_ID TYPE DOKU_ID .
  TYPES:
    TT_RAWTEXT TYPE STANDARD TABLE OF TLINE WITH DEFAULT KEY .
  TYPES:
    BEGIN OF TS_HEAD,   &quot; FROM DOKHL
        APPLICATION TYPE TDOBJECT,
        ID          TYPE DOKU_ID,
        OBJECT      TYPE DOKU_OBJ,
        LANGU       TYPE DOKU_LANGU,
        MASTERLANG  TYPE DOKIL-MASTERLANG,
        TYP         TYPE DOKU_TYP,
        DOKFORM     TYPE TDFORMNEW,
        DOKSTYLE    TYPE TDSTYLE,
        SELFDEF     TYPE DOKIL-SELFDEF,
      END OF TS_HEAD .
  TYPES:
    BEGIN OF TS_LANG.   &quot; FROM DOKHL
    INCLUDE TYPE THEAD AS HEAD.
    TYPES:
        STATE       TYPE DOKHL-DOKSTATE,
        _           TYPE STRING,      &quot; LONG TEXT
      END OF TS_LANG .
  TYPES:
    BEGIN OF TS_DOC.
    INCLUDE TYPE TS_HEAD AS HEAD.
    TYPES:
        TEXTS TYPE SORTED TABLE OF TS_LANG WITH UNIQUE KEY TDSPRAS,
      END OF TS_DOC .
  TYPES:
    TT_DOCS TYPE STANDARD TABLE OF TS_DOC WITH DEFAULT KEY .
  TYPES:
    TR_DOCID TYPE RANGE OF DOKU_ID .

  CONSTANTS:
    BEGIN OF EXISTS,
      EXISTS     TYPE TD_EXISTS VALUE ABAP_TRUE,
      NOT_EXISTS TYPE TD_EXISTS VALUE ABAP_FALSE,
    END OF EXISTS .
  CONSTANTS:
    BEGIN OF TEXTPOOL_KINDS,
      PROG_TITLE  TYPE TD_TXTP_KIND VALUE &apos;R&apos;, &quot; R - PROGRAM TITLE
      LIST_TITLE  TYPE TD_TXTP_KIND VALUE &apos;T&apos;, &quot; T - LIST TITLE: TITLEBAR
      LIST_HEADER TYPE TD_TXTP_KIND VALUE &apos;H&apos;, &quot; H 001 TO 004 LIST HEADER: COLUMN HEADINGS
      TEXT_SYMBOL TYPE TD_TXTP_KIND VALUE &apos;I&apos;, &quot; I TEXT SYMBOL IDENTIFIER TEXT SYMBOL TEXT
      PARAMETERS  TYPE TD_TXTP_KIND VALUE &apos;S&apos;, &quot; S NAME OF A PARAMETER OR SELECTION CRITERION SELECTION TEXT
    END OF TEXTPOOL_KINDS .
*  CLASS CL_ABAP_CHAR_UTILITIES DEFINITION LOAD .
  CONSTANTS LINE_SEPARATOR TYPE ABAP_CHAR1 VALUE CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE. &quot;#EC NOTEXT
  CONSTANTS BALLOG_OBJECT TYPE BALOBJ_D VALUE &apos;ZAPLINK&apos;. &quot;#EC NOTEXT
  CONSTANTS COMP_NODENAME TYPE STRING VALUE &apos;ZL_OBJECT&apos;. &quot;#EC NOTEXT
ENDINTERFACE.
CLASS ZAPLINK_CX_LIST DEFINITION
  INHERITING FROM ZAPLINK_CX
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_CX_LIST
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES TD_COMPNAME
    FOR ZAPLINK_DATATYPES~TD_COMPNAME .
  ALIASES TD_COMPTYPE
    FOR ZAPLINK_DATATYPES~TD_COMPTYPE .
  ALIASES TD_CONNCLASS
    FOR ZAPLINK_DATATYPES~TD_CONNCLASS .
  ALIASES TD_SEL_ACTION
    FOR ZAPLINK_DATATYPES~TD_SEL_ACTION .

  CONSTANTS ALREADY_EXISTS TYPE SOTR_CONC VALUE &apos;91E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS FAILED TYPE SOTR_CONC VALUE &apos;90E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_ACTION TYPE SOTR_CONC VALUE &apos;8EE7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS ITERATOR_NOT_INITIALIZE TYPE SOTR_CONC VALUE &apos;8FE7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS NOT_FOUND TYPE SOTR_CONC VALUE &apos;92E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS ZAPLINK_CX_LIST TYPE SOTR_CONC VALUE &apos;A2E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  DATA NAME TYPE TD_COMPNAME .
  DATA TYPE TYPE TD_COMPTYPE .
  DATA CONNCLASS TYPE TD_CONNCLASS .
  DATA SEL_ACTION TYPE TD_SEL_ACTION .

  METHODS CONSTRUCTOR
    IMPORTING
      !TEXTID LIKE TEXTID OPTIONAL
      !PREVIOUS LIKE PREVIOUS OPTIONAL
      !MSG TYPE STRING DEFAULT &apos;44F7518323DB08BC02000000A7E42BB6&apos;
      !MESSAGES TYPE O_MSG_COLL OPTIONAL
      !OBJECT TYPE BALOBJ_D OPTIONAL
      !SUBOBJECT TYPE BALSUBOBJ OPTIONAL
      !PREV_CX TYPE REF TO ZAPLINK_CX OPTIONAL
      !EXT_ID TYPE BALNREXT OPTIONAL
      !CX_NAME TYPE STRING OPTIONAL
      !NAME TYPE TD_COMPNAME OPTIONAL
      !TYPE TYPE TD_COMPTYPE OPTIONAL
      !CONNCLASS TYPE TD_CONNCLASS OPTIONAL
      !SEL_ACTION TYPE TD_SEL_ACTION OPTIONAL .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_CX_LIST
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_CX_LIST
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_CX_LIST DEFINITION
CLASS ZAPLINK_CX_COMPONENT DEFINITION
  INHERITING FROM ZAPLINK_CX
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_CX_COMPONENT
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES TD_COMPNAME
    FOR ZAPLINK_DATATYPES~TD_COMPNAME .
  ALIASES TD_COMPTYPE
    FOR ZAPLINK_DATATYPES~TD_COMPTYPE .
  ALIASES TD_CONNCLASS
    FOR ZAPLINK_DATATYPES~TD_CONNCLASS .
  ALIASES TD_OBJ_TYPE
    FOR ZAPLINK_DATATYPES~TD_OBJ_TYPE .

  CONSTANTS ZAPLINK_CX_COMPONENT TYPE SOTR_CONC VALUE &apos;5A3F064B8305545DE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS TWICE_CLASS TYPE SOTR_CONC VALUE &apos;C1E6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_TYPE TYPE SOTR_CONC VALUE &apos;C0E6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_SUBCOMPONENTS TYPE SOTR_CONC VALUE &apos;583F064B8305545DE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_MSG_COLL TYPE SOTR_CONC VALUE &apos;BFE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_EXCEPTION TYPE SOTR_CONC VALUE &apos;BCE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_CONNECTOR TYPE SOTR_CONC VALUE &apos;BEE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_CLASS TYPE SOTR_CONC VALUE &apos;BDE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  DATA NAME TYPE TD_COMPNAME .
  DATA TYPE TYPE TD_COMPTYPE .
  DATA CONNCLASS TYPE TD_CONNCLASS .
  DATA OBJTYPE TYPE TD_OBJ_TYPE .

  METHODS CONSTRUCTOR
    IMPORTING
      !TEXTID LIKE TEXTID OPTIONAL
      !PREVIOUS LIKE PREVIOUS OPTIONAL
      !MSG TYPE STRING DEFAULT &apos;44F7518323DB08BC02000000A7E42BB6&apos;
      !MESSAGES TYPE O_MSG_COLL OPTIONAL
      !OBJECT TYPE BALOBJ_D OPTIONAL
      !SUBOBJECT TYPE BALSUBOBJ OPTIONAL
      !PREV_CX TYPE REF TO ZAPLINK_CX OPTIONAL
      !EXT_ID TYPE BALNREXT OPTIONAL
      !CX_NAME TYPE STRING OPTIONAL
      !NAME TYPE TD_COMPNAME OPTIONAL
      !TYPE TYPE TD_COMPTYPE OPTIONAL
      !CONNCLASS TYPE TD_CONNCLASS OPTIONAL
      !OBJTYPE TYPE TD_OBJ_TYPE OPTIONAL .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_CX_COMPONENT
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_CX_COMPONENT
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_CX_COMPONENT DEFINITION
CLASS ZAPLINK_CX_CONNECTOR DEFINITION
  INHERITING FROM ZAPLINK_CX
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_CX_CONNECTOR
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES TD_COMPNAME
    FOR ZAPLINK_DATATYPES~TD_COMPNAME .
  ALIASES TD_COMPTYPE
    FOR ZAPLINK_DATATYPES~TD_COMPTYPE .
  ALIASES TD_CONNCLASS
    FOR ZAPLINK_DATATYPES~TD_CONNCLASS .
  ALIASES TD_CONNUUID
    FOR ZAPLINK_DATATYPES~TD_CONNUUID .
  ALIASES TD_CONNVER
    FOR ZAPLINK_DATATYPES~TD_CONNVER .
  ALIASES TD_DEVCLASS
    FOR ZAPLINK_DATATYPES~TD_DEVCLASS .

  CONSTANTS FILE_ERROR TYPE SOTR_CONC VALUE &apos;EEE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS NOT_AUTHORIZED TYPE SOTR_CONC VALUE &apos;ECE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS NOT_FOUND TYPE SOTR_CONC VALUE &apos;F33F064B8305545DE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS OBJECT_LOCKED TYPE SOTR_CONC VALUE &apos;F23F064B8305545DE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS ZAPLINK_CX_CONNECTOR TYPE SOTR_CONC VALUE &apos;EBE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS TWICE_CLASS TYPE SOTR_CONC VALUE &apos;A8A50A4B7DA5C45AE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_TYPE TYPE SOTR_CONC VALUE &apos;A9A50A4B7DA5C45AE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_CONNECTOR TYPE SOTR_CONC VALUE &apos;ADA50A4B7DA5C45AE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_UUID TYPE SOTR_CONC VALUE &apos;11A70A4B07A5A05AE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_XML TYPE SOTR_CONC VALUE &apos;3FAE0C4BB69DC72BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS UNSUPORTED_VERSION TYPE SOTR_CONC VALUE &apos;F6B50C4BB69DC72BE1000000AC120173&apos;. &quot;#EC NOTEXT
  DATA NAME TYPE TD_COMPNAME VALUE &apos;[NAME]&apos;. &quot;#EC NOTEXT .
  DATA TYPE TYPE TD_COMPTYPE VALUE &apos;[TY]&apos;. &quot;#EC NOTEXT .
  DATA DEVCLASS TYPE TD_DEVCLASS VALUE &apos;[DEVCLASS]&apos;. &quot;#EC NOTEXT .
  DATA CONNCLASS TYPE TD_CONNCLASS VALUE &apos;[CONNCLASS]&apos;. &quot;#EC NOTEXT .
  DATA CONNUUID TYPE TD_CONNUUID VALUE &apos;00000000000000000000000000000000&apos;. &quot;#EC NOTEXT .
  DATA NODE_NAME TYPE STRING VALUE &apos;[NODE_NAME]&apos;. &quot;#EC NOTEXT .
  DATA CONN_VER TYPE TD_CONNVER .

  METHODS CONSTRUCTOR
    IMPORTING
      !TEXTID LIKE TEXTID OPTIONAL
      !PREVIOUS LIKE PREVIOUS OPTIONAL
      !MSG TYPE STRING DEFAULT &apos;44F7518323DB08BC02000000A7E42BB6&apos;
      !MESSAGES TYPE O_MSG_COLL OPTIONAL
      !OBJECT TYPE BALOBJ_D OPTIONAL
      !SUBOBJECT TYPE BALSUBOBJ OPTIONAL
      !PREV_CX TYPE REF TO ZAPLINK_CX OPTIONAL
      !EXT_ID TYPE BALNREXT OPTIONAL
      !CX_NAME TYPE STRING OPTIONAL
      !NAME TYPE TD_COMPNAME DEFAULT &apos;[NAME]&apos;
      !TYPE TYPE TD_COMPTYPE DEFAULT &apos;[TY]&apos;
      !DEVCLASS TYPE TD_DEVCLASS DEFAULT &apos;[DEVCLASS]&apos;
      !CONNCLASS TYPE TD_CONNCLASS DEFAULT &apos;[CONNCLASS]&apos;
      !CONNUUID TYPE TD_CONNUUID DEFAULT &apos;00000000000000000000000000000000&apos;
      !NODE_NAME TYPE STRING DEFAULT &apos;[NODE_NAME]&apos;
      !CONN_VER TYPE TD_CONNVER OPTIONAL .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_CX_CONNECTOR
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_CX_CONNECTOR
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_CX_CONNECTOR DEFINITION
CLASS ZAPLINK_RAW DEFINITION
  CREATE PUBLIC

  FRIENDS ZAPLINK_EASYXML .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_RAW
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES BALLOG_OBJECT
    FOR ZAPLINK_DATATYPES~BALLOG_OBJECT .
  ALIASES COMP_NODENAME
    FOR ZAPLINK_DATATYPES~COMP_NODENAME .
  ALIASES EXISTS
    FOR ZAPLINK_DATATYPES~EXISTS .
  ALIASES LINE_SEPARATOR
    FOR ZAPLINK_DATATYPES~LINE_SEPARATOR .
  ALIASES TEXTPOOL_KINDS
    FOR ZAPLINK_DATATYPES~TEXTPOOL_KINDS .
  ALIASES TD_ABAPSOURCE
    FOR ZAPLINK_DATATYPES~TD_ABAPSOURCE .
  ALIASES TD_CLASSNAME
    FOR ZAPLINK_DATATYPES~TD_CLASSNAME .
  ALIASES TD_COMPEXISTS
    FOR ZAPLINK_DATATYPES~TD_COMPEXISTS .
  ALIASES TD_COMPNAME
    FOR ZAPLINK_DATATYPES~TD_COMPNAME .
  ALIASES TD_COMPTEXT
    FOR ZAPLINK_DATATYPES~TD_COMPTEXT .
  ALIASES TD_COMPTYPE
    FOR ZAPLINK_DATATYPES~TD_COMPTYPE .
  ALIASES TD_CONNCLASS
    FOR ZAPLINK_DATATYPES~TD_CONNCLASS .
  ALIASES TD_CONNEXISTS
    FOR ZAPLINK_DATATYPES~TD_CONNEXISTS .
  ALIASES TD_CONNUUID
    FOR ZAPLINK_DATATYPES~TD_CONNUUID .
  ALIASES TD_CONNVER
    FOR ZAPLINK_DATATYPES~TD_CONNVER .
  ALIASES TD_CONTNAME
    FOR ZAPLINK_DATATYPES~TD_CONTNAME .
  ALIASES TD_CONTVER
    FOR ZAPLINK_DATATYPES~TD_CONTVER .
  ALIASES TD_DEVCLASS
    FOR ZAPLINK_DATATYPES~TD_DEVCLASS .
  ALIASES TD_EXISTS
    FOR ZAPLINK_DATATYPES~TD_EXISTS .
  ALIASES TD_FILENAME
    FOR ZAPLINK_DATATYPES~TD_FILENAME .
  ALIASES TD_FILETYPE
    FOR ZAPLINK_DATATYPES~TD_FILETYPE .
  ALIASES TD_LANG
    FOR ZAPLINK_DATATYPES~TD_LANG .
  ALIASES TD_LIGHT
    FOR ZAPLINK_DATATYPES~TD_LIGHT .
  ALIASES TD_OBJ_TYPE
    FOR ZAPLINK_DATATYPES~TD_OBJ_TYPE .
  ALIASES TD_PROGNAME
    FOR ZAPLINK_DATATYPES~TD_PROGNAME .
  ALIASES TD_SEL_ACTION
    FOR ZAPLINK_DATATYPES~TD_SEL_ACTION .
  ALIASES TD_TXTP_ID
    FOR ZAPLINK_DATATYPES~TD_TXTP_ID .
  ALIASES TD_TXTP_KIND
    FOR ZAPLINK_DATATYPES~TD_TXTP_KIND .
  ALIASES TD_TXTP_LEN
    FOR ZAPLINK_DATATYPES~TD_TXTP_LEN .
  ALIASES TD_TXTP_TEXT
    FOR ZAPLINK_DATATYPES~TD_TXTP_TEXT .
  ALIASES TD_TYPE_AS_TEXT
    FOR ZAPLINK_DATATYPES~TD_TYPE_AS_TEXT .
  ALIASES TO_RAW_DATA
    FOR ZAPLINK_DATATYPES~TO_RAW_DATA .
  ALIASES TO_XML
    FOR ZAPLINK_DATATYPES~TO_XML .
  ALIASES TR_DLVUNIT
    FOR ZAPLINK_DATATYPES~TR_DLVUNIT .
  ALIASES TR_PACKAGES
    FOR ZAPLINK_DATATYPES~TR_PACKAGES .
  ALIASES TR_TR
    FOR ZAPLINK_DATATYPES~TR_TR .
  ALIASES TS_BASE_ATTRIBUTS
    FOR ZAPLINK_DATATYPES~TS_BASE_ATTRIBUTS .
  ALIASES TS_COMPKEY
    FOR ZAPLINK_DATATYPES~TS_COMPKEY .
  ALIASES TS_CONNDATA
    FOR ZAPLINK_DATATYPES~TS_CONNDATA .
  ALIASES TS_CONN_CLASS
    FOR ZAPLINK_DATATYPES~TS_CONN_CLASS .
  ALIASES TS_CONN_DEF
    FOR ZAPLINK_DATATYPES~TS_CONN_DEF .
  ALIASES TS_CONTDATA
    FOR ZAPLINK_DATATYPES~TS_CONTDATA .
  ALIASES TS_DIRECTORY
    FOR ZAPLINK_DATATYPES~TS_DIRECTORY .
  ALIASES TS_TXTP_TEXT
    FOR ZAPLINK_DATATYPES~TS_TXTP_TEXT .
  ALIASES TS_TXTP_TEXTPOOL
    FOR ZAPLINK_DATATYPES~TS_TXTP_TEXTPOOL .
  ALIASES TS_TYPE
    FOR ZAPLINK_DATATYPES~TS_TYPE .
  ALIASES TT_ABAPRAWSOURCE
    FOR ZAPLINK_DATATYPES~TT_ABAPRAWSOURCE .
  ALIASES TT_COMPKEYS
    FOR ZAPLINK_DATATYPES~TT_COMPKEYS .
  ALIASES TT_CONNECTORLIST
    FOR ZAPLINK_DATATYPES~TT_CONNECTORLIST .
  ALIASES TT_CONN_CLASSES
    FOR ZAPLINK_DATATYPES~TT_CONN_CLASSES .
  ALIASES TT_TXTP_TEXTPOOLS
    FOR ZAPLINK_DATATYPES~TT_TXTP_TEXTPOOLS .
  ALIASES TT_TXTP_TEXTS
    FOR ZAPLINK_DATATYPES~TT_TXTP_TEXTS .
  ALIASES TT_TYPES
    FOR ZAPLINK_DATATYPES~TT_TYPES .

  TYPES TO_COMPONENT TYPE REF TO ZAPLINK_COMPONENT .

  DATA TYPE TYPE TD_COMPTYPE .
  DATA NAME TYPE TD_COMPNAME .
  DATA CONNECTOR TYPE TD_CONNUUID .
  DATA VERSION TYPE TD_CONNVER .
  DATA RAW TYPE TO_RAW_DATA .
  DATA DIRECTORY TYPE TS_DIRECTORY READ-ONLY .

  METHODS CONSTRUCTOR
    IMPORTING
      !O_COMP TYPE TO_COMPONENT OPTIONAL .
  METHODS SET_COMPONENT
    IMPORTING
      !O_COMP TYPE TO_COMPONENT .
  METHODS GET_COMPONENT
    RETURNING
      VALUE(O_COMP) TYPE TO_COMPONENT .
  METHODS GET_TYPE
    RETURNING
      VALUE(RESULT) TYPE TD_COMPTYPE .
  METHODS GET_DEVCLASS_OFF
    RETURNING
      VALUE(RESULT) TYPE TD_DEVCLASS .
  METHODS GET_NAME
    RETURNING
      VALUE(RESULT) TYPE TD_COMPNAME .
  METHODS SET_DEVCLASS_OFF
    IMPORTING
      !DATA TYPE TD_DEVCLASS .
  METHODS SET_NAME
    IMPORTING
      !DATA TYPE ANY .
  METHODS SET_TYPE
    IMPORTING
      !DATA TYPE TD_COMPTYPE .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_RAW
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  DATA DEVCLASS TYPE TD_DEVCLASS .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_RAW
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  METHODS REFRESH_DIRECTORY .
ENDCLASS. &quot;ZAPLINK_RAW DEFINITION
CLASS ZAPLINK_CONNECTORS DEFINITION
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_CONNECTORS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES TD_COMPEXISTS
    FOR ZAPLINK_DATATYPES~TD_COMPEXISTS .
  ALIASES TD_COMPNAME
    FOR ZAPLINK_DATATYPES~TD_COMPNAME .
  ALIASES TD_COMPTEXT
    FOR ZAPLINK_DATATYPES~TD_COMPTEXT .
  ALIASES TD_COMPTYPE
    FOR ZAPLINK_DATATYPES~TD_COMPTYPE .
  ALIASES TD_CONNCLASS
    FOR ZAPLINK_DATATYPES~TD_CONNCLASS .
  ALIASES TD_CONNEXISTS
    FOR ZAPLINK_DATATYPES~TD_CONNEXISTS .
  ALIASES TD_CONNUUID
    FOR ZAPLINK_DATATYPES~TD_CONNUUID .
  ALIASES TD_DEVCLASS
    FOR ZAPLINK_DATATYPES~TD_DEVCLASS .
  ALIASES TD_FILENAME
    FOR ZAPLINK_DATATYPES~TD_FILENAME .
  ALIASES TD_OBJ_TYPE
    FOR ZAPLINK_DATATYPES~TD_OBJ_TYPE .
  ALIASES TD_TYPE_AS_TEXT
    FOR ZAPLINK_DATATYPES~TD_TYPE_AS_TEXT .

  TYPES TO_RAW TYPE REF TO ZAPLINK_RAW .
  TYPES TO_EXCEPTION TYPE REF TO ZAPLINK_CX_CONNECTOR .
  TYPES TO_MSG_COLL TYPE REF TO ZAPLINK_MESSAGE_COLLECTOR .
  TYPES TO_CONNECTOR TYPE REF TO ZAPLINK_CONNECTOR .
  TYPES:
    BEGIN OF TS_COMPONENT,
          TYPE TYPE TD_COMPTYPE,
          NAME TYPE TD_COMPNAME,
        END OF TS_COMPONENT .

  CONSTANTS:
    BEGIN OF EXISTS,
          EXISTS     TYPE TD_CONNEXISTS VALUE ZAPLINK_DATATYPES~EXISTS-EXISTS,
          NOT_EXISTS TYPE TD_CONNEXISTS VALUE ZAPLINK_DATATYPES~EXISTS-NOT_EXISTS,
        END OF EXISTS .

  CLASS-METHODS CLASS_CONSTRUCTOR .
  CLASS-METHODS ADD_LOCAL_CONNECTOR
    IMPORTING
      !LOCAL_CLASS TYPE TD_CONNCLASS
    RAISING
      ZAPLINK_CX_CONNECTOR .
  CLASS-METHODS DO_EXISTS
    IMPORTING
      !TYPE TYPE TD_COMPTYPE
    RETURNING
      VALUE(RESULT) TYPE TD_CONNEXISTS
    RAISING
      ZAPLINK_CX_CONNECTOR .
  CLASS-METHODS CREATE_CONNECTOR
    IMPORTING
      !TYPE TYPE TD_COMPTYPE
      !CONNUUID TYPE TD_CONNUUID OPTIONAL
    RETURNING
      VALUE(RESULT) TYPE TO_CONNECTOR
    RAISING
      ZAPLINK_CX_CONNECTOR .
  CLASS-METHODS GET_VALUES
    CHANGING
      !TYPE TYPE TD_COMPTYPE .
  CLASS-METHODS NODE_2_RAW
    IMPORTING
      !NODE TYPE REF TO IF_IXML_NODE
    RETURNING
      VALUE(RESULT) TYPE TO_RAW
    RAISING
      ZAPLINK_CX_CONNECTOR .
  CLASS-METHODS TYPE2TEXT
    IMPORTING
      !DATA TYPE TD_COMPTYPE
    RETURNING
      VALUE(RESULT) TYPE TD_TYPE_AS_TEXT .
  CLASS-METHODS GET_CLASSNAME
    IMPORTING
      !O_CONN TYPE TO_CONNECTOR
    RETURNING
      VALUE(RESULT) TYPE TD_CONNCLASS
    RAISING
      ZAPLINK_CX_CONNECTOR .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_CONNECTORS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  ALIASES TS_CONN_CLASS
    FOR ZAPLINK_DATATYPES~TS_CONN_CLASS .
  ALIASES TS_CONN_DEF
    FOR ZAPLINK_DATATYPES~TS_CONN_DEF .
  ALIASES TT_CONNECTORLIST
    FOR ZAPLINK_DATATYPES~TT_CONNECTORLIST .
  ALIASES TT_TYPES
    FOR ZAPLINK_DATATYPES~TT_TYPES .

  TYPES:
    BEGIN OF TS_CONNDATA,
          EXISTS TYPE TD_CONNEXISTS,
          CLASSNAME TYPE TD_CONNCLASS,
          O_CONN TYPE TO_CONNECTOR,
        END OF TS_CONNDATA .
  TYPES:
    BEGIN OF TS_CLASS.
INCLUDE TYPE TS_CONN_CLASS.
TYPES:
    TYPES TYPE TT_TYPES,   &quot; SUPPORTED_TYPES
  END OF TS_CLASS .
  TYPES:
    TT_CLASSES TYPE SORTED TABLE OF TS_CLASS WITH UNIQUE KEY UUID .
  TYPES:
    TT_SAPTYPES TYPE HASHED TABLE OF KO100 WITH UNIQUE KEY OBJECT .

  CLASS-DATA CONNECTOR_LIST TYPE TT_CONNECTORLIST .
  CLASS-DATA SAPTYPES TYPE TT_SAPTYPES .
  CLASS-DATA _MSG_COLL TYPE TO_MSG_COLL .
  CLASS-DATA _CLASSES TYPE TT_CLASSES .
  CONSTANTS LOCAL_DEVCLASS TYPE TD_DEVCLASS VALUE &apos;$LOCAL$&apos;. &quot;#EC NOTEXT

  CLASS-METHODS _SEARCH_CONNECTOR
    IMPORTING
      !TYPE TYPE TD_COMPTYPE
    RETURNING
      VALUE(RESULT) TYPE TS_CONN_DEF
    RAISING
      ZAPLINK_CX_CONNECTOR .
  CLASS-METHODS _ADD_CONNECTOR
    IMPORTING
      !CLASS TYPE TD_CONNCLASS
      !DEVCLASS TYPE TD_DEVCLASS OPTIONAL
    RAISING
      ZAPLINK_CX_CONNECTOR .
  CLASS-METHODS _UPDATE_DEF_CLASS
    RAISING
      ZAPLINK_CX_CONNECTOR .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_CONNECTORS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  TYPES:
    BEGIN OF TS_VALUE,
           OBJECT TYPE TD_COMPTYPE,
           TEXT   TYPE TD_COMPTEXT,
         END OF TS_VALUE .
  TYPES:
    TT_VALUES TYPE STANDARD TABLE OF TS_VALUE WITH DEFAULT KEY .

  CLASS-DATA O_MYCX TYPE TO_EXCEPTION .
  CLASS-DATA VALUE_TABLE TYPE TT_VALUES .
  CLASS-DATA XMLENGINE TYPE REF TO IF_IXML .
ENDCLASS. &quot;ZAPLINK_CONNECTORS DEFINITION
CLASS ZAPLINK_LIST DEFINITION
  INHERITING FROM ZAPLINK_LIST_
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_LIST
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.
  TYPE-POOLS SLIS .

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES TD_SEL_ACTION
    FOR ZAPLINK_DATATYPES~TD_SEL_ACTION .
  ALIASES TS_COMPKEY
    FOR ZAPLINK_DATATYPES~TS_COMPKEY .
  ALIASES TT_COMPKEYS
    FOR ZAPLINK_DATATYPES~TT_COMPKEYS .

  TYPES TO_COMPONENT TYPE REF TO ZAPLINK_COMPONENT .
  TYPES TO_ME TYPE REF TO ZAPLINK_LIST .

  CONSTANTS:
    BEGIN OF SEL_ACTIONS,
      EXPORT    TYPE TD_SEL_ACTION VALUE &apos;E&apos;,
      IMPORT    TYPE TD_SEL_ACTION VALUE &apos;I&apos;,
      UNINSTALL TYPE TD_SEL_ACTION VALUE &apos;U&apos;,
    END OF SEL_ACTIONS .
  TYPE-POOLS ABAP .
  DATA DISPLAY_PROGRESS TYPE ABAP_BOOL .

  METHODS ADD
    IMPORTING
      !COMP TYPE TO_COMPONENT
    RAISING
      ZAPLINK_CX_LIST .
  METHODS ADD_KEYS
    IMPORTING
      !DATA TYPE TT_COMPKEYS
    RAISING
      ZAPLINK_CX_LIST .
  METHODS ADD_LIST
    IMPORTING
      !DATA TYPE TO_ME
    RAISING
      ZAPLINK_CX_LIST .
  METHODS CLONE
    RETURNING
      VALUE(RESULT) TYPE TO_ME
    RAISING
      ZAPLINK_CX_LIST .
  METHODS CHANGE_SELECTION
    RAISING
      ZAPLINK_CX_LIST .
  CLASS-METHODS CLASS_CONSTRUCTOR .
  METHODS CLEAR
    RAISING
      ZAPLINK_CX_LIST .
  METHODS GET_COUNT
    RETURNING
      VALUE(RESULT) TYPE I
    RAISING
      ZAPLINK_CX_LIST .
  METHODS GET_NEXT
    RETURNING
      VALUE(RESULT) TYPE TO_COMPONENT
    RAISING
      ZAPLINK_CX_LIST .
  METHODS INIT_ITER
    RAISING
      ZAPLINK_CX_LIST .
  METHODS INIT_SEL_ITER
    RAISING
      ZAPLINK_CX_LIST .
  METHODS KEEP_COMMUN_LIST
    IMPORTING
      !DATA TYPE TO_ME .
  METHODS REMOVE
    IMPORTING
      !COMP TYPE TO_COMPONENT
    RAISING
      ZAPLINK_CX_LIST .
  METHODS REMOVE_LIST
    IMPORTING
      !DATA TYPE TO_ME
    RAISING
      ZAPLINK_CX_LIST .
  METHODS SELECT
    IMPORTING
      !COMP TYPE TO_COMPONENT
    RAISING
      ZAPLINK_CX_LIST .
  METHODS IS_SELECTED
    IMPORTING
      !COMP TYPE TO_COMPONENT
    RETURNING
      VALUE(RESULT) TYPE ABAP_BOOL
    RAISING
      ZAPLINK_CX_LIST .
  METHODS IS_INCLUDED
    IMPORTING
      !LIST TYPE TO_ME
    RETURNING
      VALUE(RESULT) TYPE ABAP_BOOL
    RAISING
      ZAPLINK_CX_LIST .
  METHODS SEARCH
    IMPORTING
      !COMP TYPE TO_COMPONENT
    RETURNING
      VALUE(RESULT) TYPE TO_COMPONENT
    RAISING
      ZAPLINK_CX_LIST .
  METHODS SELECT_DEFAULT
    IMPORTING
      !SEL_ACTION TYPE TD_SEL_ACTION
    RAISING
      ZAPLINK_CX_LIST .
  METHODS UNSELECT
    IMPORTING
      !COMP TYPE TO_COMPONENT
    RAISING
      ZAPLINK_CX_LIST .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_LIST
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  ALIASES TD_COMPNAME
    FOR ZAPLINK_DATATYPES~TD_COMPNAME .
  ALIASES TD_COMPTYPE
    FOR ZAPLINK_DATATYPES~TD_COMPTYPE .
  ALIASES TD_LIGHT
    FOR ZAPLINK_DATATYPES~TD_LIGHT .

  TYPES:
    BEGIN OF TS_COMPLIST,
    KEY      TYPE TS_COMPKEY,
    O_COMP   TYPE TO_COMPONENT,
    SELECTED TYPE ABAP_BOOL,
  END OF TS_COMPLIST .
  TYPES:
    TT_COMPLIST TYPE SORTED TABLE OF TS_COMPLIST WITH UNIQUE KEY KEY .
  TYPES:
    BEGIN OF TS_ALLCOMPLIST,
    KEY      TYPE TS_COMPKEY,
    O_COMP   TYPE TO_COMPONENT,
    AS_SUB   TYPE ABAP_BOOL,
  END OF TS_ALLCOMPLIST .
  TYPES:
    TT_ALLCOMPLIST TYPE SORTED TABLE OF TS_ALLCOMPLIST WITH NON-UNIQUE KEY KEY .
  TYPES:
    BEGIN OF TS_ALV_CONF,
        FIELDS TYPE SLIS_T_FIELDCAT_ALV,
        LAYOUT TYPE SLIS_LAYOUT_ALV,
      END OF TS_ALV_CONF .
  TYPES:
    BEGIN OF TS_ALV,
    SELECT     TYPE FLAG,
    TYPE       TYPE TD_COMPTYPE,
    TYP_TXT    TYPE STRING,
    NAME       TYPE TD_COMPNAME,
    PLUGIN     TYPE TD_LIGHT, &quot;TYPE POOLS ICON
    STATUS     TYPE TD_LIGHT, &quot;TYPE POOLS ICON
    MSG        TYPE STRING,
    DEVCLASS   TYPE TADIR-DEVCLASS,
    SRCSYSTEM  TYPE TADIR-SRCSYSTEM,
  END OF TS_ALV .
  TYPES:
    TT_ALV TYPE STANDARD TABLE OF TS_ALV WITH DEFAULT KEY .

  CONSTANTS:
    BEGIN OF LIGHTS,
      NO       TYPE TD_LIGHT VALUE ICON_LIGHT_OUT,
      RED      TYPE TD_LIGHT VALUE ICON_RED_LIGHT,
      YELLOW   TYPE TD_LIGHT VALUE ICON_YELLOW_LIGHT,
      GREEN    TYPE TD_LIGHT VALUE ICON_GREEN_LIGHT,
    END OF LIGHTS .
  CLASS-DATA ALV_CONF TYPE TS_ALV_CONF .
  DATA _ALLCOMP TYPE TT_ALLCOMPLIST .
  DATA _INDEX TYPE TT_COMPLIST .

  METHODS _SELECT
    IMPORTING
      !COMP TYPE TO_COMPONENT
      !VALUE TYPE ABAP_BOOL
    RAISING
      ZAPLINK_CX_LIST .
  METHODS CONV_TO_ALV
    RETURNING
      VALUE(RESULT) TYPE TT_ALV
    RAISING
      ZAPLINK_CX_LIST .
  METHODS SEARCH_INDEX
    IMPORTING
      !COMP TYPE TO_COMPONENT
    RETURNING
      VALUE(RESULT) TYPE TS_COMPLIST .
  METHODS SELECT_EXPORT
    RAISING
      ZAPLINK_CX_LIST .
  METHODS SELECT_IMPORT
    RAISING
      ZAPLINK_CX_LIST .
  METHODS UPDATE_FROM_ALV
    IMPORTING
      !DATA TYPE TT_ALV
    RAISING
      ZAPLINK_CX_LIST .
  METHODS _ADD_SUBCOMP
    IMPORTING
      !DATA TYPE TO_COMPONENT .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_LIST
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  TYPES TD_ITERATOR_TYPE TYPE CHAR1 .
  TYPES TO_EXCEPTION TYPE REF TO ZAPLINK_CX_LIST .

  CONSTANTS:
    BEGIN OF ITERATOR_TYPES,
      ALL       TYPE TD_ITERATOR_TYPE VALUE &apos;A&apos;,
      SELECTED  TYPE TD_ITERATOR_TYPE VALUE &apos;S&apos;,
    END OF ITERATOR_TYPES .
  DATA O_EXCEPTION TYPE TO_EXCEPTION .
  DATA _IDX_COUNT TYPE SY-TABIX .
  DATA _ITERATOR_END TYPE ABAP_BOOL .
  DATA _ITERATOR_PREV TYPE TO_COMPONENT .
  DATA _ITERATOR_TABIX TYPE SY-TABIX .
  DATA _ITERATOR_TYPE TYPE TD_ITERATOR_TYPE .
ENDCLASS. &quot;ZAPLINK_LIST DEFINITION
CLASS ZAPLINK_CX_OPTIONS DEFINITION
  INHERITING FROM ZAPLINK_CX
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_CX_OPTIONS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  CONSTANTS DIALOG_CANCELED TYPE SOTR_CONC VALUE &apos;D8E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS ZAPLINK_CX_OPTIONS TYPE SOTR_CONC VALUE &apos;D7E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT

  METHODS CONSTRUCTOR
    IMPORTING
      !TEXTID LIKE TEXTID OPTIONAL
      !PREVIOUS LIKE PREVIOUS OPTIONAL
      !MSG TYPE STRING DEFAULT &apos;44F7518323DB08BC02000000A7E42BB6&apos;
      !MESSAGES TYPE O_MSG_COLL OPTIONAL
      !OBJECT TYPE BALOBJ_D OPTIONAL
      !SUBOBJECT TYPE BALSUBOBJ OPTIONAL
      !PREV_CX TYPE REF TO ZAPLINK_CX OPTIONAL
      !EXT_ID TYPE BALNREXT OPTIONAL
      !CX_NAME TYPE STRING OPTIONAL .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_CX_OPTIONS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_CX_OPTIONS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_CX_OPTIONS DEFINITION
CLASS ZAPLINK_CX_OPT_DEVCLASS DEFINITION
  INHERITING FROM ZAPLINK_CX_OPTIONS
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_CX_OPT_DEVCLASS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES TD_DEVCLASS
    FOR ZAPLINK_DATATYPES~TD_DEVCLASS .
  ALIASES TD_SUBSTITUTIONKIND
    FOR ZAPLINK_DATATYPES~TD_SUBSTITUTIONKIND .

  CONSTANTS INVALID_SUBSTITUTIONKIND TYPE SOTR_CONC VALUE &apos;4F40F14A7D29EF55E1000000AC12017F&apos;. &quot;#EC NOTEXT
  CONSTANTS ZAPLINK_CX_OPT_DEVCLASS TYPE SOTR_CONC VALUE &apos;803BF14A7D29EF55E1000000AC12017F&apos;. &quot;#EC NOTEXT
  CONSTANTS MISSING_DEVCLASS TYPE SOTR_CONC VALUE &apos;D335F14A4B29F055E1000000AC12017F&apos;. &quot;#EC NOTEXT
  DATA SUBSTKIND TYPE TD_SUBSTITUTIONKIND .

  METHODS CONSTRUCTOR
    IMPORTING
      !TEXTID LIKE TEXTID OPTIONAL
      !PREVIOUS LIKE PREVIOUS OPTIONAL
      !MSG TYPE STRING DEFAULT &apos;44F7518323DB08BC02000000A7E42BB6&apos;
      !MESSAGES TYPE O_MSG_COLL OPTIONAL
      !OBJECT TYPE BALOBJ_D OPTIONAL
      !SUBOBJECT TYPE BALSUBOBJ OPTIONAL
      !PREV_CX TYPE REF TO ZAPLINK_CX OPTIONAL
      !EXT_ID TYPE BALNREXT OPTIONAL
      !CX_NAME TYPE STRING OPTIONAL
      !SUBSTKIND TYPE TD_SUBSTITUTIONKIND OPTIONAL .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_CX_OPT_DEVCLASS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_CX_OPT_DEVCLASS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_CX_OPT_DEVCLASS DEFINITION
CLASS ZAPLINK_OPT_DEVCLASS DEFINITION
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_OPT_DEVCLASS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES TD_DEVCLASS
    FOR ZAPLINK_DATATYPES~TD_DEVCLASS .
  ALIASES TD_SUBSTITUTIONKIND
    FOR ZAPLINK_DATATYPES~TD_SUBSTITUTIONKIND .

  TYPES TO_COMPONENT TYPE REF TO ZAPLINK_RAW .

  CONSTANTS:
    BEGIN OF SUBSTITUTIONKINDS,
        USE_CONTAINER  TYPE TD_SUBSTITUTIONKIND VALUE &apos;C&apos;,    &quot; KEEP DEV CLASS IN XML FILE
        KEEP_EXISTING  TYPE TD_SUBSTITUTIONKIND VALUE &apos;K&apos;,    &quot; USE DEVCLASS DEFINE IN COMPONENT
        LOCAL          TYPE TD_SUBSTITUTIONKIND VALUE &apos;L&apos;,    &quot; DEVCLASS = $TMP
        FIXED          TYPE TD_SUBSTITUTIONKIND VALUE &apos;F&apos;,    &quot; ASSIGN ALLWAYS THE SAME SPECIFIED DEVCLASS
      END OF SUBSTITUTIONKINDS .

  METHODS CONSTRUCTOR .
  METHODS GET_SUBSTITUTIONKIND
    RETURNING
      VALUE(RESULT) TYPE TD_SUBSTITUTIONKIND
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS SET_SUBSTITUTIONKIND
    IMPORTING
      !DATA TYPE TD_SUBSTITUTIONKIND
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS GET_DEVCLASS
    RETURNING
      VALUE(RESULT) TYPE TD_DEVCLASS
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS SET_DEVCLASS
    IMPORTING
      !DATA TYPE TD_DEVCLASS
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS SUBSTITUTE
    IMPORTING
      !COMPONENT TYPE TO_COMPONENT
    RETURNING
      VALUE(RESULT) TYPE TD_DEVCLASS
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_OPT_DEVCLASS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  DATA _SUBSTITUTION TYPE TD_SUBSTITUTIONKIND .
  DATA _DEVCLASS TYPE TD_DEVCLASS .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_OPT_DEVCLASS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  CONSTANTS LOCAL_DEVCLASS TYPE TD_DEVCLASS VALUE &apos;$TMP&apos;. &quot;#EC NOTEXT
ENDCLASS. &quot;ZAPLINK_OPT_DEVCLASS DEFINITION
CLASS ZAPLINK_OPT_TRANSPORT_REQUEST DEFINITION
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_OPT_TRANSPORT_REQUEST
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES TD_DEVCLASS
    FOR ZAPLINK_DATATYPES~TD_DEVCLASS .
  ALIASES TD_SUBSTITUTIONKIND
    FOR ZAPLINK_DATATYPES~TD_SUBSTITUTIONKIND .
  ALIASES TD_TRANSPORT_REQUEST
    FOR ZAPLINK_DATATYPES~TD_TRANSPORT_REQUEST .

  TYPES TO_COMPONENT TYPE REF TO ZAPLINK_RAW .

  CONSTANTS:
    BEGIN OF SUBSTITUTIONKINDS,
        FIXED             TYPE TD_SUBSTITUTIONKIND VALUE &apos;F&apos;,    &quot; ASSIGN ALLWAYS THE SAME SPECIFIED DEVCLASS
        SAME_AS_CONTAINER TYPE TD_SUBSTITUTIONKIND VALUE &apos;K&apos;,    &quot; KEEP THE SAME SCHEME AS IN CONTAINER
        USER              TYPE TD_SUBSTITUTIONKIND VALUE &apos;U&apos;,    &quot; LET USER SELECT A TRANSPORT REQUEST FOR ALL COMPONENT
        INPUT             TYPE TD_SUBSTITUTIONKIND VALUE &apos;I&apos;,    &quot; LET USER SELECT A TRANSPORT REQUEST FOR EACH COMPONENT
        CUSTOM            TYPE TD_SUBSTITUTIONKIND VALUE &apos;X&apos;,    &quot; USER DEFINE
      END OF SUBSTITUTIONKINDS .

  METHODS CONSTRUCTOR .
  METHODS GET_SUBSTITUTIONKIND
    RETURNING
      VALUE(RESULT) TYPE TD_SUBSTITUTIONKIND
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS SET_SUBSTITUTIONKIND
    IMPORTING
      !DATA TYPE TD_SUBSTITUTIONKIND
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS GET_TRANSPORT_REQUEST
    RETURNING
      VALUE(RESULT) TYPE TD_TRANSPORT_REQUEST
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS SET_TRANSPORT_REQUEST
    IMPORTING
      !DATA TYPE TD_TRANSPORT_REQUEST
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS SUBSTITUTE
    IMPORTING
      !COMPONENT TYPE TO_COMPONENT
    RETURNING
      VALUE(RESULT) TYPE TD_TRANSPORT_REQUEST
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_OPT_TRANSPORT_REQUEST
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  DATA _SUBSTITUTION TYPE TD_SUBSTITUTIONKIND .
  DATA _TRANSPORT_REQUEST TYPE TD_TRANSPORT_REQUEST .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_OPT_TRANSPORT_REQUEST
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  TYPES:
    BEGIN OF TS_TR_SUBSTIT,
     XML_TR TYPE TD_TRANSPORT_REQUEST,
     SAP_TR TYPE TD_TRANSPORT_REQUEST,
   END OF TS_TR_SUBSTIT .
  TYPES:
    TT_TR_SUBSTITS TYPE SORTED TABLE OF TS_TR_SUBSTIT WITH UNIQUE KEY XML_TR .

  DATA _TR_MAPPING TYPE TT_TR_SUBSTITS .
ENDCLASS. &quot;ZAPLINK_OPT_TRANSPORT_REQUEST DEFINITION
CLASS ZAPLINK_OPT_DIRECTORY DEFINITION
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_OPT_DIRECTORY
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES BALLOG_OBJECT
    FOR ZAPLINK_DATATYPES~BALLOG_OBJECT .
  ALIASES TD_DEVCLASS
    FOR ZAPLINK_DATATYPES~TD_DEVCLASS .
  ALIASES TD_SUBSTITUTIONKIND
    FOR ZAPLINK_DATATYPES~TD_SUBSTITUTIONKIND .
  ALIASES TS_DIRECTORY
    FOR ZAPLINK_DATATYPES~TS_DIRECTORY .

  TYPES TO_DEVCLASS TYPE REF TO ZAPLINK_OPT_DEVCLASS .
  TYPES TO_LOG TYPE REF TO ZAPLINK_MESSAGE_COLLECTOR .
  TYPES TO_TR TYPE REF TO ZAPLINK_OPT_TRANSPORT_REQUEST .
  TYPES TO_COMPONENT TYPE REF TO ZAPLINK_RAW .

  CONSTANTS BALLOG_SUBOBJECT TYPE BALSUBOBJ VALUE &apos;DIRECTORY&apos;. &quot;#EC NOTEXT
  CONSTANTS:
    BEGIN OF SUBSTITUTIONKINDS,
        FIXED          TYPE TD_SUBSTITUTIONKIND VALUE &apos;F&apos;,    &quot; ASSIGN ALLWAYS THE SAME SPECIFIED DEVCLASS
        KEEP_CONTAINER TYPE TD_SUBSTITUTIONKIND VALUE &apos;K&apos;,    &quot; KEEP DEV CLASS IN XML FILE
        USE_COMPONENT  TYPE TD_SUBSTITUTIONKIND VALUE &apos;C&apos;,    &quot; USE DEVCLASS DEFINE IN COMPONENT
        LOCAL          TYPE TD_SUBSTITUTIONKIND VALUE &apos;L&apos;,    &quot; DEVCLASS = $TMP
      END OF SUBSTITUTIONKINDS .
  DATA LOG TYPE TO_LOG READ-ONLY .

  METHODS CONSTRUCTOR .
  METHODS GET_SUBSTITUTIONKIND_OFF
    RETURNING
      VALUE(RESULT) TYPE TD_SUBSTITUTIONKIND
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS SET_SUBSTITUTIONKIND_OFF
    IMPORTING
      !DATA TYPE TD_SUBSTITUTIONKIND
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS GET_DEVCLASS
    RETURNING
      VALUE(RESULT) TYPE TO_DEVCLASS
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS SET_DEVCLASS
    IMPORTING
      !DATA TYPE TO_DEVCLASS
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS SET_DIRECTORY
    IMPORTING
      !COMPONENT TYPE TO_COMPONENT
    RETURNING
      VALUE(RESULT) TYPE TS_DIRECTORY
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS GET_TRANSPORT_REQUEST
    RETURNING
      VALUE(RESULT) TYPE TO_TR
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
  METHODS SET_TRANSPORT_REQUEST
    IMPORTING
      !DATA TYPE TO_TR
    RAISING
      ZAPLINK_CX_OPT_DEVCLASS .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_OPT_DIRECTORY
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  DATA _SUBSTITUTION TYPE TD_SUBSTITUTIONKIND .
  DATA _DEVCLASS TYPE TO_DEVCLASS .
  DATA _TR TYPE TO_TR .
  DATA O_MYCX TYPE REF TO ZAPLINK_CX_OPTIONS .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_OPT_DIRECTORY
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_OPT_DIRECTORY DEFINITION
CLASS ZAPLINK_OPTIONS DEFINITION
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_OPTIONS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  TYPES TO_DEVCLASS TYPE REF TO ZAPLINK_OPT_DEVCLASS .
  TYPES TO_DIRECTORY TYPE REF TO ZAPLINK_OPT_DIRECTORY .

  DATA DEVCLASS TYPE TO_DEVCLASS READ-ONLY .
  DATA DIRECTORY TYPE TO_DIRECTORY READ-ONLY .

  METHODS CONSTRUCTOR .
  METHODS GET_DEVCLASS
    RETURNING
      VALUE(RESULT) TYPE TO_DEVCLASS
    RAISING
      ZAPLINK_CX_OPTIONS .
  METHODS SET_DEVCLASS
    IMPORTING
      !DATA TYPE TO_DEVCLASS
    RAISING
      ZAPLINK_CX_OPTIONS .
  METHODS GET_DIRECTORY
    RETURNING
      VALUE(RESULT) TYPE TO_DIRECTORY
    RAISING
      ZAPLINK_CX_OPTIONS .
  METHODS SET_DIRECTORY
    IMPORTING
      !DATA TYPE TO_DIRECTORY
    RAISING
      ZAPLINK_CX_OPTIONS .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_OPTIONS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_OPTIONS
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_OPTIONS DEFINITION
*&quot;* COMPONENTS OF INTERFACE ZAPLINK_CONNECTOR
INTERFACE ZAPLINK_CONNECTOR.

  TYPE-POOLS ABAP .

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES BALLOG_OBJECT
    FOR ZAPLINK_DATATYPES~BALLOG_OBJECT .
  ALIASES COMP_NODENAME
    FOR ZAPLINK_DATATYPES~COMP_NODENAME .
  ALIASES EXISTS
    FOR ZAPLINK_DATATYPES~EXISTS .
  ALIASES TD_COMPEXISTS
    FOR ZAPLINK_DATATYPES~TD_COMPEXISTS .
  ALIASES TD_COMPNAME
    FOR ZAPLINK_DATATYPES~TD_COMPNAME .
  ALIASES TD_COMPTYPE
    FOR ZAPLINK_DATATYPES~TD_COMPTYPE .
  ALIASES TD_CONNCLASS
    FOR ZAPLINK_DATATYPES~TD_CONNCLASS .
  ALIASES TD_CONNEXISTS
    FOR ZAPLINK_DATATYPES~TD_CONNEXISTS .
  ALIASES TD_CONNUUID
    FOR ZAPLINK_DATATYPES~TD_CONNUUID .
  ALIASES TD_CONNVER
    FOR ZAPLINK_DATATYPES~TD_CONNVER .
  ALIASES TO_XML
    FOR ZAPLINK_DATATYPES~TO_XML .
  ALIASES TS_BASE_ATTRIBUTS
    FOR ZAPLINK_DATATYPES~TS_BASE_ATTRIBUTS .
  ALIASES TS_CONNDATA
    FOR ZAPLINK_DATATYPES~TS_CONNDATA .
  ALIASES TT_TYPES
    FOR ZAPLINK_DATATYPES~TT_TYPES .

  TYPES TO_EZ_XML TYPE REF TO ZAPLINK_EASYXML .
  TYPES TO_OPTIONS TYPE REF TO ZAPLINK_OPTIONS .
  TYPES TO_RAW TYPE REF TO ZAPLINK_RAW .
  TYPES TO_LIST TYPE REF TO ZAPLINK_LIST .
  TYPES TO_COMPONENT TYPE REF TO ZAPLINK_COMPONENT .
  TYPES TO_CONNECTOR TYPE REF TO ZAPLINK_CONNECTOR .
  TYPES TO_MSG_COLL TYPE REF TO ZAPLINK_MESSAGE_COLLECTOR .

  CONSTANTS TN_NAME_OFF TYPE STRING VALUE &apos;ZSL_NAME&apos;. &quot;#EC NOTEXT
  CONSTANTS TN_VERSION_OFF TYPE STRING VALUE &apos;ZSL_VERSION&apos;. &quot;#EC NOTEXT
  CONSTANTS TN_CONNECTOR_OFF TYPE STRING VALUE &apos;ZSL_CONNECTOR&apos;. &quot;#EC NOTEXT
  DATA SUPPORTED_TYPES TYPE TT_TYPES READ-ONLY .
  DATA APPLICATION_LOG TYPE TO_MSG_COLL READ-ONLY .
  DATA VERSION TYPE TD_CONNVER READ-ONLY .
  DATA OPTIONS TYPE TO_OPTIONS .
  DATA UUID TYPE TD_CONNUUID READ-ONLY .

  METHODS DO_EXISTS
    IMPORTING
      !COMPONENT TYPE TO_COMPONENT
    RETURNING
      VALUE(EXISTS) TYPE TD_COMPEXISTS
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS GET_VALUES
    IMPORTING
      !TYPE TYPE TD_COMPTYPE
    CHANGING
      !NAME TYPE TD_COMPNAME
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS IMPORT_TO_SAP
    IMPORTING
      !OBJECT TYPE TO_XML
    RETURNING
      VALUE(COMPONENTS) TYPE TO_LIST
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS EXPORT_FROM_SAP
    IMPORTING
      !COMPONENT TYPE TO_COMPONENT
    RETURNING
      VALUE(OBJECT) TYPE TO_XML
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS DELETE_FROM_SAP
    IMPORTING
      !COMPONENT TYPE TO_COMPONENT
    RETURNING
      VALUE(RESULT) TYPE ABAP_BOOL
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS WRITE_TO_SAP
    IMPORTING
      !OBJECT TYPE TO_RAW
    RETURNING
      VALUE(COMPONENTS) TYPE TO_LIST
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS READ_FROM_SAP
    IMPORTING
      !COMPONENT TYPE TO_COMPONENT
    RETURNING
      VALUE(OBJECT) TYPE TO_RAW
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS CREATE_NEW_RAW
    IMPORTING
      !TYPE TYPE TD_COMPTYPE
    RETURNING
      VALUE(OBJECT) TYPE TO_RAW
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS IS_SUPPORTED_VERSION
    IMPORTING
      !VERSION TYPE TD_CONNVER
    RETURNING
      VALUE(RESULT) TYPE ABAP_BOOL
    RAISING
      ZAPLINK_CX_CONNECTOR .
ENDINTERFACE.
CLASS ZAPLINK_COMPONENT DEFINITION
  CREATE PUBLIC

  FRIENDS ZAPLINK_LIST_ .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_COMPONENT
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES TD_COMPEXISTS
    FOR ZAPLINK_DATATYPES~TD_COMPEXISTS .
  ALIASES TD_COMPNAME
    FOR ZAPLINK_DATATYPES~TD_COMPNAME .
  ALIASES TD_COMPTYPE
    FOR ZAPLINK_DATATYPES~TD_COMPTYPE .
  ALIASES TD_CONNCLASS
    FOR ZAPLINK_DATATYPES~TD_CONNCLASS .
  ALIASES TD_CONNEXISTS
    FOR ZAPLINK_DATATYPES~TD_CONNEXISTS .
  ALIASES TD_CONNUUID
    FOR ZAPLINK_DATATYPES~TD_CONNUUID .
  ALIASES TD_DEVCLASS
    FOR ZAPLINK_DATATYPES~TD_DEVCLASS .
  ALIASES TD_OBJ_TYPE
    FOR ZAPLINK_DATATYPES~TD_OBJ_TYPE .
  ALIASES TS_COMPKEY
    FOR ZAPLINK_DATATYPES~TS_COMPKEY .

  TYPES TO_CONN_EXCEPTION TYPE REF TO ZAPLINK_CX_CONNECTOR .
  TYPES TO_LIST TYPE REF TO ZAPLINK_LIST .
  TYPES TO_EXCEPTION TYPE REF TO ZAPLINK_CX_COMPONENT .
  TYPES TO_MSG_COLL TYPE REF TO ZAPLINK_MESSAGE_COLLECTOR .
  TYPES TO_CONNECTOR TYPE REF TO ZAPLINK_CONNECTOR .
  TYPES TO_ME TYPE REF TO ZAPLINK_COMPONENT .
  TYPES:
    BEGIN OF TS_COMPONENT,
          TYPE TYPE TD_COMPTYPE,
          NAME TYPE TD_COMPNAME,
        END OF TS_COMPONENT .

  CONSTANTS:
    BEGIN OF CONNEXISTS,
          EXISTS     TYPE TD_CONNEXISTS VALUE ZAPLINK_DATATYPES~EXISTS-EXISTS,
          NOT_EXISTS TYPE TD_CONNEXISTS VALUE ZAPLINK_DATATYPES~EXISTS-NOT_EXISTS,
        END OF CONNEXISTS .

  METHODS GET_TYPE
    RETURNING
      VALUE(RESULT) TYPE TD_COMPTYPE
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS SET_TYPE
    IMPORTING
      !DATA TYPE TD_COMPTYPE
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS GET_DEVCLASS
    RETURNING
      VALUE(RESULT) TYPE TD_DEVCLASS
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS SET_DEVCLASS
    IMPORTING
      !DATA TYPE TD_DEVCLASS
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS GET_NAME
    RETURNING
      VALUE(RESULT) TYPE TD_COMPNAME
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS SET_NAME
    IMPORTING
      !DATA TYPE ANY
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS EXISTS
    RETURNING
      VALUE(RESULT) TYPE TD_COMPEXISTS
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS CONNECTOR_EXISTS
    RETURNING
      VALUE(RESULT) TYPE TD_CONNEXISTS
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS CONNECTOR
    RETURNING
      VALUE(RESULT) TYPE TO_CONNECTOR
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS GET_CLASS_OFF
    RETURNING
      VALUE(RESULT) TYPE TD_CONNCLASS
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS GET_CONNUUID
    RETURNING
      VALUE(RESULT) TYPE TD_CONNUUID
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS SET_CONNUUID
    IMPORTING
      !DATA TYPE TD_CONNUUID
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS GET_KEY
    RETURNING
      VALUE(RESULT) TYPE TS_COMPONENT
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS GET_EXCEPTION
    RETURNING
      VALUE(RESULT) TYPE TO_CONN_EXCEPTION
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS SET_EXCEPTION
    IMPORTING
      !DATA TYPE TO_CONN_EXCEPTION
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS GET_MSG_COLL
    RETURNING
      VALUE(RESULT) TYPE TO_MSG_COLL
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS SET_MSG_COLL
    IMPORTING
      !DATA TYPE TO_MSG_COLL
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS GET_SUBCOMPONENTS
    RETURNING
      VALUE(RESULT) TYPE TO_LIST
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS SET_SUBCOMPONENTS
    IMPORTING
      !DATA TYPE TO_LIST
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS CLONE
    RETURNING
      VALUE(RESULT) TYPE TO_ME .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_COMPONENT
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  ALIASES TS_CONN_CLASS
    FOR ZAPLINK_DATATYPES~TS_CONN_CLASS .
  ALIASES TT_CONNECTORLIST
    FOR ZAPLINK_DATATYPES~TT_CONNECTORLIST .
  ALIASES TT_TYPES
    FOR ZAPLINK_DATATYPES~TT_TYPES .

  TYPES:
    BEGIN OF TS_CONNDATA,
          UUID      TYPE TD_CONNUUID,
          EXISTS    TYPE TD_CONNEXISTS,
*          CLASSNAME TYPE TD_CONNCLASS,
          O_CONN    TYPE TO_CONNECTOR,
        END OF TS_CONNDATA .
  TYPES:
    BEGIN OF TS_CLASS.
INCLUDE TYPE TS_CONN_CLASS.
TYPES:
    TYPES TYPE TT_TYPES,   &quot; SUPPORTED_TYPES
  END OF TS_CLASS .
  TYPES:
    TT_CLASSES TYPE SORTED TABLE OF TS_CLASS WITH UNIQUE KEY CLASSNAME .
  TYPES:
    TT_SAPTYPES TYPE HASHED TABLE OF KO100 WITH UNIQUE KEY OBJECT .

  DATA NAME TYPE TD_COMPNAME .
  DATA TYPE TYPE TD_COMPTYPE .
  DATA _CONNECTOR TYPE TS_CONNDATA .
  DATA _EXISTS TYPE TD_COMPEXISTS .
  DATA _EXCEPTION TYPE TO_CONN_EXCEPTION .
  DATA _MSG_COLL TYPE TO_MSG_COLL .
  CLASS-DATA _CLASSES TYPE TT_CLASSES .
  DATA _DEVCLASS TYPE TD_DEVCLASS .
  CONSTANTS LOCAL_DEVCLASS TYPE TD_DEVCLASS VALUE &apos;$LOCAL$&apos;. &quot;#EC NOTEXT
  DATA _SUBCOMPONENTS TYPE TO_LIST .

  METHODS _GET_KEY
    RETURNING
      VALUE(RESULT) TYPE TS_COMPKEY .
  CLASS-METHODS CREATE_NEW
    IMPORTING
      !KEY TYPE TS_COMPKEY
    RETURNING
      VALUE(RESULT) TYPE TO_ME
    RAISING
      ZAPLINK_CX_COMPONENT .
  METHODS _SET_KEY
    IMPORTING
      VALUE(DATA) TYPE TS_COMPKEY
    RAISING
      ZAPLINK_CX_COMPONENT .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_COMPONENT
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  DATA O_EXCEPTION TYPE TO_EXCEPTION .

  METHODS ON_CHANGE_CLEAR .
  METHODS ON_CHANGE_UPDATE .
ENDCLASS. &quot;ZAPLINK_COMPONENT DEFINITION
CLASS ZAPLINK_CX_CONTAINER DEFINITION
  INHERITING FROM ZAPLINK_CX
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_CX_CONTAINER
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  CONSTANTS ADD_COMP_FAILED TYPE SOTR_CONC VALUE &apos;FCE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS ADD_FAILED TYPE SOTR_CONC VALUE &apos;FDE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS ZAPLINK_CX_CONTAINER TYPE SOTR_CONC VALUE &apos;FBE6044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  DATA NAME TYPE ZAPLINK_CX_COMPONENT=&gt;TD_COMPNAME .
  DATA TYPE TYPE ZAPLINK_CX_COMPONENT=&gt;TD_COMPTYPE .

  METHODS CONSTRUCTOR
    IMPORTING
      !TEXTID LIKE TEXTID OPTIONAL
      !PREVIOUS LIKE PREVIOUS OPTIONAL
      !MSG TYPE STRING DEFAULT &apos;44F7518323DB08BC02000000A7E42BB6&apos;
      !MESSAGES TYPE O_MSG_COLL OPTIONAL
      !OBJECT TYPE BALOBJ_D OPTIONAL
      !SUBOBJECT TYPE BALSUBOBJ OPTIONAL
      !PREV_CX TYPE REF TO ZAPLINK_CX OPTIONAL
      !EXT_ID TYPE BALNREXT OPTIONAL
      !CX_NAME TYPE STRING OPTIONAL
      !NAME TYPE ZAPLINK_CX_COMPONENT=&gt;TD_COMPNAME OPTIONAL
      !TYPE TYPE ZAPLINK_CX_COMPONENT=&gt;TD_COMPTYPE OPTIONAL .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_CX_CONTAINER
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_CX_CONTAINER
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_CX_CONTAINER DEFINITION
CLASS ZAPLINK_CX_FILE DEFINITION
  INHERITING FROM ZAPLINK_CX
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_CX_FILE
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  TYPES T_FILENAME TYPE STRING .
  TYPES T_FILETYPE TYPE CHAR1 .

  CONSTANTS DIALOG_CANCELED TYPE SOTR_CONC VALUE &apos;18E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_FILEKIND TYPE SOTR_CONC VALUE &apos;19E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_FILENAME TYPE SOTR_CONC VALUE &apos;1AE7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS INVALID_FILETYPE TYPE SOTR_CONC VALUE &apos;1BE7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS LOAD_ERROR TYPE SOTR_CONC VALUE &apos;1CE7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS MISSING_FILENAME TYPE SOTR_CONC VALUE &apos;17E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS SAVE_ERROR TYPE SOTR_CONC VALUE &apos;1DE7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS ZAPLINK_CX_FILE TYPE SOTR_CONC VALUE &apos;16E7044B26B30C5BE1000000AC120173&apos;. &quot;#EC NOTEXT
  DATA FILENAME TYPE T_FILENAME .
  DATA FILETYPE TYPE T_FILETYPE .
  DATA FILEKIND TYPE T_FILETYPE .

  METHODS CONSTRUCTOR
    IMPORTING
      !TEXTID LIKE TEXTID OPTIONAL
      !PREVIOUS LIKE PREVIOUS OPTIONAL
      !MSG TYPE STRING DEFAULT &apos;44F7518323DB08BC02000000A7E42BB6&apos;
      !MESSAGES TYPE O_MSG_COLL OPTIONAL
      !OBJECT TYPE BALOBJ_D OPTIONAL
      !SUBOBJECT TYPE BALSUBOBJ OPTIONAL
      !PREV_CX TYPE REF TO ZAPLINK_CX OPTIONAL
      !EXT_ID TYPE BALNREXT OPTIONAL
      !CX_NAME TYPE STRING OPTIONAL
      !FILENAME TYPE T_FILENAME OPTIONAL
      !FILETYPE TYPE T_FILETYPE OPTIONAL
      !FILEKIND TYPE T_FILETYPE OPTIONAL .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_CX_FILE
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_CX_FILE
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_CX_FILE DEFINITION
CLASS ZAPLINK_FILE DEFINITION
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_FILE
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  TYPES T_FILENAME TYPE ZAPLINK_CX_FILE=&gt;T_FILENAME .
  TYPES T_FILETYPE TYPE ZAPLINK_CX_FILE=&gt;T_FILETYPE .

  CONSTANTS C_FT_LOCAL TYPE T_FILETYPE VALUE &apos;L&apos;. &quot;#EC NOTEXT
  CONSTANTS C_FT_SERVER TYPE T_FILETYPE VALUE &apos;S&apos;. &quot;#EC NOTEXT
  CONSTANTS:
    BEGIN OF FILETYPES,
        LOCAL     TYPE T_FILETYPE VALUE &apos;L&apos;,                &quot;#EC NOTEXT
        SERVER    TYPE T_FILETYPE VALUE &apos;S&apos;,                &quot;#EC NOTEXT
      END OF FILETYPES .

  METHODS GET_FILENAME
    RETURNING
      VALUE(RESULT) TYPE T_FILENAME
    RAISING
      ZAPLINK_CX_FILE .
  METHODS GET_FILETYPE
    RETURNING
      VALUE(RESULT) TYPE T_FILETYPE
    RAISING
      ZAPLINK_CX_FILE .
  METHODS SET_FILENAME
    IMPORTING
      !DATA TYPE T_FILENAME
    RAISING
      ZAPLINK_CX_FILE .
  METHODS SET_FILETYPE
    IMPORTING
      !DATA TYPE T_FILETYPE
    RAISING
      ZAPLINK_CX_FILE .
  METHODS GET_FILECONTENT
    RETURNING
      VALUE(RESULT) TYPE STRING
    RAISING
      ZAPLINK_CX_FILE .
  METHODS SET_FILECONTENT
    IMPORTING
      !DATA TYPE STRING
    RAISING
      ZAPLINK_CX_FILE .
  METHODS SAVE
    RAISING
      ZAPLINK_CX_FILE .
  METHODS LOAD
    RAISING
      ZAPLINK_CX_FILE .
  METHODS SAVE_DIALOG
    IMPORTING
      !FILENAME TYPE T_FILENAME OPTIONAL
    RAISING
      ZAPLINK_CX_FILE .
  METHODS LOAD_DIALOG
    IMPORTING
      !FILENAME TYPE T_FILENAME OPTIONAL
    RAISING
      ZAPLINK_CX_FILE .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_FILE
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  TYPES T_CONTENT TYPE STRING .

  DATA _FILENAME TYPE T_FILENAME .
  DATA _FILETYPE TYPE T_FILETYPE .
  DATA _CONTENT TYPE T_CONTENT .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_FILE
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_FILE DEFINITION
CLASS ZAPLINK_CONTAINER_4INST DEFINITION
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_CONTAINER_4INST
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES BALLOG_OBJECT
    FOR ZAPLINK_DATATYPES~BALLOG_OBJECT .
  ALIASES COMP_NODENAME
    FOR ZAPLINK_DATATYPES~COMP_NODENAME .
  ALIASES EXISTS
    FOR ZAPLINK_DATATYPES~EXISTS .
  ALIASES LINE_SEPARATOR
    FOR ZAPLINK_DATATYPES~LINE_SEPARATOR .
  ALIASES TEXTPOOL_KINDS
    FOR ZAPLINK_DATATYPES~TEXTPOOL_KINDS .
  ALIASES TD_ABAPSOURCE
    FOR ZAPLINK_DATATYPES~TD_ABAPSOURCE .
  ALIASES TD_CLASSNAME
    FOR ZAPLINK_DATATYPES~TD_CLASSNAME .
  ALIASES TD_COMPEXISTS
    FOR ZAPLINK_DATATYPES~TD_COMPEXISTS .
  ALIASES TD_COMPNAME
    FOR ZAPLINK_DATATYPES~TD_COMPNAME .
  ALIASES TD_COMPTEXT
    FOR ZAPLINK_DATATYPES~TD_COMPTEXT .
  ALIASES TD_COMPTYPE
    FOR ZAPLINK_DATATYPES~TD_COMPTYPE .
  ALIASES TD_CONNCLASS
    FOR ZAPLINK_DATATYPES~TD_CONNCLASS .
  ALIASES TD_CONNEXISTS
    FOR ZAPLINK_DATATYPES~TD_CONNEXISTS .
  ALIASES TD_CONNUUID
    FOR ZAPLINK_DATATYPES~TD_CONNUUID .
  ALIASES TD_CONNVER
    FOR ZAPLINK_DATATYPES~TD_CONNVER .
  ALIASES TD_CONTNAME
    FOR ZAPLINK_DATATYPES~TD_CONTNAME .
  ALIASES TD_CONTVER
    FOR ZAPLINK_DATATYPES~TD_CONTVER .
  ALIASES TD_DEVCLASS
    FOR ZAPLINK_DATATYPES~TD_DEVCLASS .
  ALIASES TD_EXISTS
    FOR ZAPLINK_DATATYPES~TD_EXISTS .
  ALIASES TD_FILENAME
    FOR ZAPLINK_DATATYPES~TD_FILENAME .
  ALIASES TD_FILETYPE
    FOR ZAPLINK_DATATYPES~TD_FILETYPE .
  ALIASES TD_LANG
    FOR ZAPLINK_DATATYPES~TD_LANG .
  ALIASES TD_LIGHT
    FOR ZAPLINK_DATATYPES~TD_LIGHT .
  ALIASES TD_OBJ_TYPE
    FOR ZAPLINK_DATATYPES~TD_OBJ_TYPE .
  ALIASES TD_PROGNAME
    FOR ZAPLINK_DATATYPES~TD_PROGNAME .
  ALIASES TD_SEL_ACTION
    FOR ZAPLINK_DATATYPES~TD_SEL_ACTION .
  ALIASES TD_SUBSTITUTIONKIND
    FOR ZAPLINK_DATATYPES~TD_SUBSTITUTIONKIND .
  ALIASES TD_TRANSPORT_REQUEST
    FOR ZAPLINK_DATATYPES~TD_TRANSPORT_REQUEST .
  ALIASES TD_TXTP_ID
    FOR ZAPLINK_DATATYPES~TD_TXTP_ID .
  ALIASES TD_TXTP_KIND
    FOR ZAPLINK_DATATYPES~TD_TXTP_KIND .
  ALIASES TD_TXTP_LEN
    FOR ZAPLINK_DATATYPES~TD_TXTP_LEN .
  ALIASES TD_TXTP_TEXT
    FOR ZAPLINK_DATATYPES~TD_TXTP_TEXT .
  ALIASES TD_TYPE_AS_TEXT
    FOR ZAPLINK_DATATYPES~TD_TYPE_AS_TEXT .
  ALIASES TO_RAW_DATA
    FOR ZAPLINK_DATATYPES~TO_RAW_DATA .
  ALIASES TO_XML
    FOR ZAPLINK_DATATYPES~TO_XML .
  ALIASES TR_DLVUNIT
    FOR ZAPLINK_DATATYPES~TR_DLVUNIT .
  ALIASES TR_PACKAGES
    FOR ZAPLINK_DATATYPES~TR_PACKAGES .
  ALIASES TR_TR
    FOR ZAPLINK_DATATYPES~TR_TR .
  ALIASES TS_BASE_ATTRIBUTS
    FOR ZAPLINK_DATATYPES~TS_BASE_ATTRIBUTS .
  ALIASES TS_COMPKEY
    FOR ZAPLINK_DATATYPES~TS_COMPKEY .
  ALIASES TS_CONNDATA
    FOR ZAPLINK_DATATYPES~TS_CONNDATA .
  ALIASES TS_CONN_CLASS
    FOR ZAPLINK_DATATYPES~TS_CONN_CLASS .
  ALIASES TS_CONN_DEF
    FOR ZAPLINK_DATATYPES~TS_CONN_DEF .
  ALIASES TS_CONTDATA
    FOR ZAPLINK_DATATYPES~TS_CONTDATA .
  ALIASES TS_DIRECTORY
    FOR ZAPLINK_DATATYPES~TS_DIRECTORY .
  ALIASES TS_TXTP_TEXT
    FOR ZAPLINK_DATATYPES~TS_TXTP_TEXT .
  ALIASES TS_TXTP_TEXTPOOL
    FOR ZAPLINK_DATATYPES~TS_TXTP_TEXTPOOL .
  ALIASES TS_TYPE
    FOR ZAPLINK_DATATYPES~TS_TYPE .
  ALIASES TT_ABAPRAWSOURCE
    FOR ZAPLINK_DATATYPES~TT_ABAPRAWSOURCE .
  ALIASES TT_COMPKEYS
    FOR ZAPLINK_DATATYPES~TT_COMPKEYS .
  ALIASES TT_CONNECTORLIST
    FOR ZAPLINK_DATATYPES~TT_CONNECTORLIST .
  ALIASES TT_CONN_CLASSES
    FOR ZAPLINK_DATATYPES~TT_CONN_CLASSES .
  ALIASES TT_TXTP_TEXTPOOLS
    FOR ZAPLINK_DATATYPES~TT_TXTP_TEXTPOOLS .
  ALIASES TT_TXTP_TEXTS
    FOR ZAPLINK_DATATYPES~TT_TXTP_TEXTS .
  ALIASES TT_TYPES
    FOR ZAPLINK_DATATYPES~TT_TYPES .

  TYPES TO_OPTIONS TYPE REF TO ZAPLINK_OPTIONS .
  TYPES TO_RAW TYPE REF TO ZAPLINK_RAW .
  TYPES TO_LOG TYPE REF TO ZAPLINK_MESSAGE_COLLECTOR .
  TYPES TO_LIST TYPE REF TO ZAPLINK_LIST .
  TYPES TO_COMPONENT TYPE REF TO ZAPLINK_COMPONENT .
  TYPES TO_FILE TYPE REF TO ZAPLINK_FILE .

  CONSTANTS TN_NUGGET TYPE STRING VALUE &apos;WAGON&apos;. &quot;#EC NOTEXT
  DATA FILE TYPE TO_FILE .
  DATA LOG TYPE TO_LOG READ-ONLY .
  CONSTANTS BALLOG_SUBOBJECT TYPE BALSUBOBJ VALUE &apos;CONTAINER&apos;. &quot;#EC NOTEXT

  CLASS-METHODS CLASS_CONSTRUCTOR .
  METHODS CONSTRUCTOR
    IMPORTING
      !O_FILE TYPE TO_FILE .
  METHODS LOAD_FROM_FILE
    IMPORTING
      !O_FILE TYPE TO_FILE OPTIONAL
    RAISING
      ZAPLINK_CX_CONTAINER .
  METHODS TRANSPORT_TO_SAP
    IMPORTING
      !OBJECT_LIST TYPE TO_LIST
    RAISING
      ZAPLINK_CX_CONTAINER .
  METHODS GET_CONTENT
    RETURNING
      VALUE(RESULT) TYPE TO_LIST
    RAISING
      ZAPLINK_CX_CONTAINER .
  METHODS GET_OPTIONS
    RETURNING
      VALUE(RESULT) TYPE TO_OPTIONS
    RAISING
      ZAPLINK_CX_CONTAINER .
  METHODS UNINSTALL_FROM_SAP
    IMPORTING
      !OBJECT_LIST TYPE TO_LIST
    RAISING
      ZAPLINK_CX_CONTAINER .
  METHODS SET_OPTIONS
    IMPORTING
      !DATA TYPE TO_OPTIONS
    RAISING
      ZAPLINK_CX_CONTAINER .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_CONTAINER_4INST
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  TYPES:
    BEGIN OF TS_NODEINDEX,
      KEY   TYPE REF TO ZAPLINK_COMPONENT,
      NODE  TYPE REF TO IF_IXML_NODE,
    END OF TS_NODEINDEX .
  TYPES:
    TT_NODEINDEX TYPE SORTED TABLE OF TS_NODEINDEX WITH UNIQUE KEY KEY .
  TYPES TO_CONNECTOR TYPE REF TO ZAPLINK_CONNECTOR .
  TYPES TO_EXCEPTION TYPE REF TO ZAPLINK_CX_CONTAINER .

  DATA XMLDATA TYPE REF TO IF_IXML_DOCUMENT .
  DATA _OPTIONS TYPE TO_OPTIONS .
  CLASS-DATA XMLENGINE TYPE REF TO IF_IXML .
  DATA _COMPLIST TYPE TO_LIST .
  DATA _NODEINDEX TYPE TT_NODEINDEX .
  DATA O_MYCX TYPE TO_EXCEPTION .

  METHODS _FIND_COMPONENT_NODE
    IMPORTING
      !COMPONENT TYPE TO_COMPONENT
    RETURNING
      VALUE(NODE) TYPE REF TO IF_IXML_NODE
    RAISING
      ZAPLINK_CX_CONTAINER .
  METHODS _UPDATE_COMPONENTSLIST .
  METHODS GET_ROOT
    RETURNING
      VALUE(ROOT) TYPE REF TO IF_IXML_NODE .
  TYPE-POOLS ABAP .
  METHODS _IS_SUBCOMPONENT
    IMPORTING
      !NODE TYPE REF TO IF_IXML_NODE
    RETURNING
      VALUE(RESULT) TYPE ABAP_BOOL .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_CONTAINER_4INST
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  DATA O_CURSOR TYPE REF TO IF_IXML_NODE .
ENDCLASS. &quot;ZAPLINK_CONTAINER_4INST DEFINITION
CLASS ZAPLINK_CONNECTOR_ DEFINITION
  ABSTRACT
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_CONNECTOR_
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_CONNECTOR
      ABSTRACT METHODS CREATE_NEW_RAW
                       DELETE_FROM_SAP
                       DO_EXISTS
                       IS_SUPPORTED_VERSION
                       READ_FROM_SAP
                       WRITE_TO_SAP .
  INTERFACES ZAPLINK_DATATYPES .

  ALIASES APPLICATION_LOG
    FOR ZAPLINK_CONNECTOR~APPLICATION_LOG .
  ALIASES BALLOG_OBJECT
    FOR ZAPLINK_CONNECTOR~BALLOG_OBJECT .
  ALIASES COMP_NODENAME
    FOR ZAPLINK_CONNECTOR~COMP_NODENAME .
  ALIASES EXISTS
    FOR ZAPLINK_CONNECTOR~EXISTS .
  ALIASES LINE_SEPARATOR
    FOR ZAPLINK_DATATYPES~LINE_SEPARATOR .
  ALIASES OPTIONS
    FOR ZAPLINK_CONNECTOR~OPTIONS .
  ALIASES SUPPORTED_TYPES
    FOR ZAPLINK_CONNECTOR~SUPPORTED_TYPES .
  ALIASES TEXTPOOL_KINDS
    FOR ZAPLINK_DATATYPES~TEXTPOOL_KINDS .
  ALIASES UUID
    FOR ZAPLINK_CONNECTOR~UUID .
  ALIASES VERSION
    FOR ZAPLINK_CONNECTOR~VERSION .
  ALIASES CREATE_NEW_RAW
    FOR ZAPLINK_CONNECTOR~CREATE_NEW_RAW .
  ALIASES DELETE_FROM_SAP
    FOR ZAPLINK_CONNECTOR~DELETE_FROM_SAP .
  ALIASES DO_EXISTS
    FOR ZAPLINK_CONNECTOR~DO_EXISTS .
  ALIASES EXPORT_FROM_SAP
    FOR ZAPLINK_CONNECTOR~EXPORT_FROM_SAP .
  ALIASES GET_VALUES
    FOR ZAPLINK_CONNECTOR~GET_VALUES .
  ALIASES IMPORT_TO_SAP
    FOR ZAPLINK_CONNECTOR~IMPORT_TO_SAP .
  ALIASES IS_SUPPORTED_VERSION
    FOR ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION .
  ALIASES READ_FROM_SAP
    FOR ZAPLINK_CONNECTOR~READ_FROM_SAP .
  ALIASES WRITE_TO_SAP
    FOR ZAPLINK_CONNECTOR~WRITE_TO_SAP .
  ALIASES TD_ABAPSOURCE
    FOR ZAPLINK_DATATYPES~TD_ABAPSOURCE .
  ALIASES TD_CLASSNAME
    FOR ZAPLINK_DATATYPES~TD_CLASSNAME .
  ALIASES TD_COMPEXISTS
    FOR ZAPLINK_CONNECTOR~TD_COMPEXISTS .
  ALIASES TD_COMPNAME
    FOR ZAPLINK_CONNECTOR~TD_COMPNAME .
  ALIASES TD_COMPTYPE
    FOR ZAPLINK_CONNECTOR~TD_COMPTYPE .
  ALIASES TD_CONNCLASS
    FOR ZAPLINK_CONNECTOR~TD_CONNCLASS .
  ALIASES TD_CONNEXISTS
    FOR ZAPLINK_CONNECTOR~TD_CONNEXISTS .
  ALIASES TD_CONNUUID
    FOR ZAPLINK_CONNECTOR~TD_CONNUUID .
  ALIASES TD_CONNVER
    FOR ZAPLINK_CONNECTOR~TD_CONNVER .
  ALIASES TD_DEVCLASS
    FOR ZAPLINK_DATATYPES~TD_DEVCLASS .
  ALIASES TD_DOC_ID
    FOR ZAPLINK_DATATYPES~TD_DOC_ID .
  ALIASES TD_EXISTS
    FOR ZAPLINK_DATATYPES~TD_EXISTS .
  ALIASES TD_LANG
    FOR ZAPLINK_DATATYPES~TD_LANG .
  ALIASES TD_LIGHT
    FOR ZAPLINK_DATATYPES~TD_LIGHT .
  ALIASES TD_OBJ_TYPE
    FOR ZAPLINK_DATATYPES~TD_OBJ_TYPE .
  ALIASES TD_PROGNAME
    FOR ZAPLINK_DATATYPES~TD_PROGNAME .
  ALIASES TD_SEL_ACTION
    FOR ZAPLINK_DATATYPES~TD_SEL_ACTION .
  ALIASES TD_TXTP_ID
    FOR ZAPLINK_DATATYPES~TD_TXTP_ID .
  ALIASES TD_TXTP_KIND
    FOR ZAPLINK_DATATYPES~TD_TXTP_KIND .
  ALIASES TD_TXTP_LEN
    FOR ZAPLINK_DATATYPES~TD_TXTP_LEN .
  ALIASES TD_TXTP_TEXT
    FOR ZAPLINK_DATATYPES~TD_TXTP_TEXT .
  ALIASES TO_COMPONENT
    FOR ZAPLINK_CONNECTOR~TO_COMPONENT .
  ALIASES TO_CONNECTOR
    FOR ZAPLINK_CONNECTOR~TO_CONNECTOR .
  ALIASES TO_EZ_XML
    FOR ZAPLINK_CONNECTOR~TO_EZ_XML .
  ALIASES TO_LIST
    FOR ZAPLINK_CONNECTOR~TO_LIST .
  ALIASES TO_MSG_COLL
    FOR ZAPLINK_CONNECTOR~TO_MSG_COLL .
  ALIASES TO_OPTIONS
    FOR ZAPLINK_CONNECTOR~TO_OPTIONS .
  ALIASES TO_RAW
    FOR ZAPLINK_CONNECTOR~TO_RAW .
  ALIASES TO_XML
    FOR ZAPLINK_CONNECTOR~TO_XML .
  ALIASES TR_DLVUNIT
    FOR ZAPLINK_DATATYPES~TR_DLVUNIT .
  ALIASES TR_DOCID
    FOR ZAPLINK_DATATYPES~TR_DOCID .
  ALIASES TR_PACKAGES
    FOR ZAPLINK_DATATYPES~TR_PACKAGES .
  ALIASES TR_TR
    FOR ZAPLINK_DATATYPES~TR_TR .
  ALIASES TS_BASE_ATTRIBUTS
    FOR ZAPLINK_CONNECTOR~TS_BASE_ATTRIBUTS .
  ALIASES TS_COMPKEY
    FOR ZAPLINK_DATATYPES~TS_COMPKEY .
  ALIASES TS_CONNDATA
    FOR ZAPLINK_CONNECTOR~TS_CONNDATA .
  ALIASES TS_CONN_CLASS
    FOR ZAPLINK_DATATYPES~TS_CONN_CLASS .
  ALIASES TS_CONN_DEF
    FOR ZAPLINK_DATATYPES~TS_CONN_DEF .
  ALIASES TS_TXTP_TEXT
    FOR ZAPLINK_DATATYPES~TS_TXTP_TEXT .
  ALIASES TS_TXTP_TEXTPOOL
    FOR ZAPLINK_DATATYPES~TS_TXTP_TEXTPOOL .
  ALIASES TS_TYPE
    FOR ZAPLINK_DATATYPES~TS_TYPE .
  ALIASES TT_ABAPRAWSOURCE
    FOR ZAPLINK_DATATYPES~TT_ABAPRAWSOURCE .
  ALIASES TT_COMPKEYS
    FOR ZAPLINK_DATATYPES~TT_COMPKEYS .
  ALIASES TT_CONNECTORLIST
    FOR ZAPLINK_DATATYPES~TT_CONNECTORLIST .
  ALIASES TT_CONN_CLASSES
    FOR ZAPLINK_DATATYPES~TT_CONN_CLASSES .
  ALIASES TT_TXTP_TEXTPOOLS
    FOR ZAPLINK_DATATYPES~TT_TXTP_TEXTPOOLS .
  ALIASES TT_TXTP_TEXTS
    FOR ZAPLINK_DATATYPES~TT_TXTP_TEXTS .
  ALIASES TT_TYPES
    FOR ZAPLINK_CONNECTOR~TT_TYPES .

  METHODS CONSTRUCTOR .
  CLASS-METHODS GET_TYPE_FROM_XML
    IMPORTING
      !OBJECT TYPE TO_XML
    RETURNING
      VALUE(RESULT) TYPE TD_COMPTYPE
    RAISING
      ZAPLINK_CX_CONNECTOR .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_CONNECTOR_
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  TYPES TO_EXCEPTION TYPE REF TO ZAPLINK_CX_CONNECTOR .

  DATA O_MYCX TYPE TO_EXCEPTION .

  METHODS SET_BASE_ATTRIBUTS
    IMPORTING
      !COMPONENT TYPE TO_COMPONENT
    RETURNING
      VALUE(ATTRIBUTS) TYPE TS_BASE_ATTRIBUTS .
  CLASS-METHODS GET_PROG_SOURCE
    IMPORTING
      !PROGRAM TYPE TD_PROGNAME
    RETURNING
      VALUE(RESULT) TYPE TD_ABAPSOURCE .
  CLASS-METHODS GET_PROG_RAWSOURCE
    IMPORTING
      !PROGRAM TYPE TD_PROGNAME
    RETURNING
      VALUE(RESULT) TYPE TT_ABAPRAWSOURCE .
  CLASS-METHODS CONV_ABAP_RAW2SOURCE
    IMPORTING
      !RAW TYPE TT_ABAPRAWSOURCE
    RETURNING
      VALUE(RESULT) TYPE TD_ABAPSOURCE .
  CLASS-METHODS CONV_ABAP_SOURCE2RAW
    IMPORTING
      !SOURCE TYPE TD_ABAPSOURCE
    RETURNING
      VALUE(RESULT) TYPE TT_ABAPRAWSOURCE .
  CLASS-METHODS SET_PROG_RAWSOURCE
    IMPORTING
      !PROGRAM TYPE TD_PROGNAME
      !RAW TYPE TT_ABAPRAWSOURCE .
  CLASS-METHODS SET_PROG_SOURCE
    IMPORTING
      !PROGRAM TYPE TD_PROGNAME
      !SOURCE TYPE TD_ABAPSOURCE .
  CLASS-METHODS GET_PROG_TEXTPOOL
    IMPORTING
      !PROGRAM TYPE TD_PROGNAME
    RETURNING
      VALUE(RESULT) TYPE TT_TXTP_TEXTPOOLS .
  CLASS-METHODS SET_PROG_TEXTPOOL
    IMPORTING
      !PROGRAM TYPE TD_PROGNAME
      !TEXTPOOL TYPE TT_TXTP_TEXTPOOLS .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_CONNECTOR_
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_CONNECTOR_ DEFINITION
CLASS ZAPLINK_DOC_DATA DEFINITION
  FINAL
  CREATE PUBLIC

  FRIENDS ZAPLINK_DOCUMENTATION .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_DOC_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  TYPES:
    BEGIN OF TS_DATA.
    INCLUDE TYPE THEAD AS HEAD.
    TYPES:
        SELFDEF   TYPE DOKIL-SELFDEF,
        STATE     TYPE DOKHL-DOKSTATE,
        TYP       TYPE DOKHL-TYP,
      END OF TS_DATA .
  TYPES:
    TT_TEXT TYPE STANDARD TABLE OF TLINE WITH DEFAULT KEY .
  TYPES:
    BEGIN OF TS_TEXT,
        LANGU TYPE SY-LANGU,
        _     TYPE STRING,      &quot; TEXT
      END OF TS_TEXT .
  TYPES:
    TT_TEXTS TYPE SORTED TABLE OF TS_TEXT WITH UNIQUE KEY LANGU .
  TYPES:
    TT_RAWTEXT TYPE STANDARD TABLE OF TLINE WITH DEFAULT KEY .

  DATA DATA TYPE TS_DATA .
  DATA TEXTS TYPE TT_TEXTS .

  METHODS SET_SOURCE
    IMPORTING
      !TEXT TYPE TT_RAWTEXT .
  METHODS GET_SOURCE
    RETURNING
      VALUE(TEXT) TYPE TT_RAWTEXT .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_DOC_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_DOC_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_DOC_DATA DEFINITION
CLASS ZAPLINK_DOCUMENTATION DEFINITION
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_DOCUMENTATION
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES TD_DOC_ID
    FOR ZAPLINK_DATATYPES~TD_DOC_ID .
  ALIASES TR_DOCID
    FOR ZAPLINK_DATATYPES~TR_DOCID .
  ALIASES TS_HEAD
    FOR ZAPLINK_DATATYPES~TS_HEAD .
  ALIASES TS_LANG
    FOR ZAPLINK_DATATYPES~TS_LANG .
  ALIASES TT_DOCS
    FOR ZAPLINK_DATATYPES~TT_DOCS .
  ALIASES TT_RAWTEXT
    FOR ZAPLINK_DATATYPES~TT_RAWTEXT .

  CONSTANTS NODE_NAME TYPE STRING VALUE &apos;DOCS&apos;. &quot;#EC NOTEXT
  CLASS-DATA BAL_LOG TYPE REF TO ZAPLINK_MESSAGE_COLLECTOR .

  CLASS-METHODS CLASS_CONSTRUCTOR .
  CLASS-METHODS GET
    IMPORTING
      !IDS TYPE TR_DOCID
      !OBJECT TYPE DOKU_OBJ
    RETURNING
      VALUE(T_DOCS) TYPE TT_DOCS .
  CLASS-METHODS SET
    IMPORTING
      !T_DOCS TYPE TT_DOCS .
  CLASS-METHODS GET_AS_XML
    IMPORTING
      !IDS TYPE TR_DOCID
      !OBJECT TYPE DOKU_OBJ
    RETURNING
      VALUE(XMLDOC) TYPE REF TO IF_IXML_DOCUMENT .
  CLASS-METHODS SET_AS_XML
    IMPORTING
      !XML TYPE REF TO IF_IXML_ELEMENT .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_DOCUMENTATION
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_DOCUMENTATION
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  TYPE-POOLS ABAP .
  CONSTANTS LINE_SEPARATOR TYPE ABAP_CHAR1 VALUE CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE. &quot;#EC NOTEXT

  CLASS-METHODS RESET .
  CLASS-METHODS RAW2STRING
    IMPORTING
      !RAW TYPE TT_RAWTEXT
    RETURNING
      VALUE(STRING) TYPE STRING .
  CLASS-METHODS STRING2RAW
    IMPORTING
      !STRING TYPE STRING
    RETURNING
      VALUE(RAW) TYPE TT_RAWTEXT .
  CLASS-METHODS DOCU_GET
    IMPORTING
      !DOCU TYPE DOKIL
    EXPORTING
      !HEAD TYPE TS_HEAD
      !LANG TYPE TS_LANG .
ENDCLASS. &quot;ZAPLINK_DOCUMENTATION DEFINITION
CLASS ZAPLINK_PROG_DATA DEFINITION
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_PROG_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  TYPES:
    BEGIN OF TS_MAINDATA.
*    INCLUDE TYPE REPOSRC. &quot;THE DATABAE VIEW &quot;REPOSRC&quot; IS WRITE-PROTECTED, SO IT CANNOT BE CHANGED.
    INCLUDE TYPE PROGDIR.
    TYPES:
      END OF TS_MAINDATA .
  TYPES T_RAW TYPE RSWSOURCET .
  TYPES:
    BEGIN OF TS_TEXT,
          LANGU   TYPE SPRAS,
          ENTRY   TYPE TEXTPOOLTX,
          LENGTH  TYPE TEXTPOOLLN,
        END OF TS_TEXT .
  TYPES:
    TT_TEXTS TYPE SORTED TABLE OF TS_TEXT WITH UNIQUE KEY LANGU .
  TYPES:
    BEGIN OF TS_TEXTPOOL,
          ID    TYPE  TEXTPOOLID,
          KEY   TYPE  TEXTPOOLKY,
          TEXTS TYPE  TT_TEXTS,
        END OF TS_TEXTPOOL .
  TYPES:
    TT_TEXTPOOLS TYPE SORTED TABLE OF TS_TEXTPOOL WITH UNIQUE KEY ID KEY .
  TYPES TS_SOURCE TYPE STRING .

  DATA A0_MAIN TYPE TS_MAINDATA .
  DATA DOCUMENTATION TYPE ZAPLINK_DOCUMENTATION=&gt;TT_DOCS .
  DATA TEXTSPOOL TYPE TT_TEXTPOOLS .
  DATA SOURCE TYPE TS_SOURCE .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_PROG_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  TYPE-POOLS ABAP .
  CONSTANTS LINE_SEPARATOR TYPE ABAP_CHAR1 VALUE CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE. &quot;#EC NOTEXT
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_PROG_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_PROG_DATA DEFINITION
CLASS ZAPLINK_PROGRAM DEFINITION
  INHERITING FROM ZAPLINK_CONNECTOR_
  FINAL
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_PROGRAM
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  TYPES T_RAW TYPE RSWSOURCET .
  TYPES:
    BEGIN OF TS_TEXT,
      LANGU   TYPE SPRAS,
      ENTRY   TYPE TEXTPOOLTX,
      LENGTH  TYPE TEXTPOOLLN,
    END OF TS_TEXT .
  TYPES:
    TT_TEXTS TYPE SORTED TABLE OF TS_TEXT WITH UNIQUE KEY LANGU .
  TYPES:
    BEGIN OF TS_TEXTPOOL,
      ID    TYPE  TEXTPOOLID,
      KEY   TYPE  TEXTPOOLKY,
      TEXTS TYPE  TT_TEXTS,
    END OF TS_TEXTPOOL .
  TYPES:
    TT_TEXTPOOLS TYPE SORTED TABLE OF TS_TEXTPOOL WITH UNIQUE KEY ID KEY .
  TYPES TS_SOURCE TYPE STRING .

  METHODS CONSTRUCTOR .
  CLASS-METHODS CLASS_CONSTRUCTOR .

  METHODS ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~DO_EXISTS
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~READ_FROM_SAP
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~WRITE_TO_SAP
    REDEFINITION .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_PROGRAM
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  TYPES TO_PROGRAM TYPE REF TO ZAPLINK_PROG_DATA .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_PROGRAM
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  TYPES:
    BEGIN OF TS_PROG_ATTR.
  INCLUDE TYPE TS_BASE_ATTRIBUTS AS BASE.
  TYPES:
    END OF TS_PROG_ATTR .

  CONSTANTS ST_PROGRAM TYPE TD_COMPTYPE VALUE &apos;PROG&apos;. &quot;#EC NOTEXT
  CLASS-DATA R_DOC_ID TYPE TR_DOCID .
  CONSTANTS _UUID TYPE TD_CONNUUID VALUE &apos;AAAD0A4B07A5A05AE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS _VER TYPE TD_CONNVER VALUE &apos;1.0&apos;. &quot;#EC NOTEXT
ENDCLASS. &quot;ZAPLINK_PROGRAM DEFINITION
CLASS ZAPLINK_OBJECT_DATA DEFINITION
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_OBJECT_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.
  TYPE-POOLS SEOF .
  TYPE-POOLS SEOK .
  TYPE-POOLS SEOO .
  TYPE-POOLS SEOR .
  TYPE-POOLS SEOS .
  TYPE-POOLS SEOT .

  TYPES TS_SOURCE TYPE ZAPLINK_PROGRAM=&gt;TS_SOURCE .
  TYPES:
    BEGIN OF TS_SOURCEASSTRUC,
        _ TYPE TS_SOURCE,
      END OF TS_SOURCEASSTRUC .
  TYPES:
    TT_SEOCLASSTX TYPE STANDARD TABLE OF SEOCLASSTX WITH DEFAULT KEY .
  TYPES:
    TT_SEOCLASSTX_S TYPE SORTED TABLE OF SEOCLASSTX WITH UNIQUE KEY LANGU .
  TYPES:
    TT_SEOCOMPOTX TYPE STANDARD TABLE OF SEOCOMPOTX WITH DEFAULT KEY .
  TYPES:
    TT_SEOCOMPOTX_S TYPE SORTED TABLE OF SEOCOMPOTX WITH UNIQUE KEY CMPNAME LANGU .
  TYPES:
    TT_SEOCOMPOTX_L TYPE SORTED TABLE OF SEOCOMPOTX WITH UNIQUE KEY LANGU .
  TYPES:
    TT_SEOSUBCOTX TYPE STANDARD TABLE OF SEOSUBCOTX WITH DEFAULT KEY .
  TYPES:
    TT_SEOSUBCOTX_S TYPE SORTED TABLE OF SEOSUBCOTX WITH UNIQUE KEY CMPNAME SCONAME LANGU .
  TYPES:
    TT_SEOSUBCOTX_L TYPE SORTED TABLE OF SEOSUBCOTX WITH UNIQUE KEY LANGU .
  TYPES:
    BEGIN OF TS_INCLUDES,
          CLASSPOOL     TYPE PROGRAM,
          PUBSEC        TYPE PROGRAM,
          PRISEC        TYPE PROGRAM,
          PROSEC        TYPE PROGRAM,
          CL            TYPE PROGRAM,
          CCIMP         TYPE PROGRAM,
          CCDEF         TYPE PROGRAM,
          CCMAC         TYPE PROGRAM,
          INTERFACEPOOL TYPE PROGRAM,
          INTFSEC       TYPE PROGRAM,
          METHODS       TYPE SEOP_METHODS_W_INCLUDE,
        END OF TS_INCLUDES .
  TYPES:
    TT_SOTR_TEXTS TYPE SORTED TABLE OF SOTR_TEXT WITH UNIQUE KEY LANGU OBJECT .
  TYPES:
    BEGIN OF TS_CX_TEXT.
      INCLUDE TYPE SOTR_HEAD AS HDR.
  TYPES:
      TEXTS   TYPE TT_SOTR_TEXTS,
      CMPNAME TYPE SEOO_ATTRIBUTE_R-CMPNAME,
    END OF TS_CX_TEXT .
  TYPES:
    TT_CX_TEXTS TYPE SORTED TABLE OF TS_CX_TEXT WITH UNIQUE KEY CONCEPT .
  TYPES:
    BEGIN OF T_FM_DATA,
*            NAME TYPE SEOCLSNAME,
*            VERSION TYPE SEOVERSION,
            CLASS TYPE  VSEOCLASS,
            INTERFACE TYPE  VSEOINTERF,
            ATTRIBUTES  TYPE  SEOO_ATTRIBUTES_R,
            METHODS TYPE  SEOO_METHODS_R,
            EVENTS  TYPE  SEOO_EVENTS_R,
            TYPES TYPE  SEOO_TYPES_R,
            PARAMETERS  TYPE  SEOS_PARAMETERS_R,
            EXCEPS  TYPE  SEOS_EXCEPTIONS_R,
            IMPLEMENTINGS TYPE  SEOR_IMPLEMENTINGS_R,
            INHERITANCE TYPE  VSEOEXTEND,
            REDEFINITIONS TYPE  SEOR_REDEFINITIONS_R,
            IMPL_DETAILS  TYPE  SEOR_REDEFINITIONS_R,
            FRIENDSHIPS TYPE  SEOF_FRIENDSHIPS_R,
            TYPEUSAGES TYPE  SEOT_TYPEPUSAGES_R,
            CLSDEFERRDS TYPE  SEOT_CLSDEFERRDS_R,
            INTDEFERRDS TYPE  SEOT_INTDEFERRDS_R,
            COMPRISINGS TYPE  SEOR_COMPRISINGS_R,
            EXPLORE_INHERITANCE TYPE  SEOK_CLS_TYPEINFOS,
            EXPLORE_IMPLEMENTINGS TYPE  SEOK_INT_TYPEINFOS,
            EXPLORE_COMPRISINGS TYPE  SEOK_INT_TYPEINFOS,
            ALIASES TYPE  SEOO_ALIASES_R,
            ENHANCEMENT_METHODS TYPE  ENHMETH_TABHEADER,
            ENHANCEMENT_ATTRIBUTES  TYPE  ENHCLASSTABATTRIB,
            ENHANCEMENT_EVENTS  TYPE  ENHCLASSTABEVENT,
            ENHANCEMENT_IMPLEMENTINGS TYPE  ENHCLASSTABIMPLEMENTING,
            ENHANCEMENT_COMPRISINGS TYPE  ENHCLASSTABINTFCOMPRI,
            CLASS_DESC  TYPE TT_SEOCLASSTX,
            COMPONENT_DESC  TYPE  TT_SEOCOMPOTX,
            SUBCOMPONENT_DESC TYPE  TT_SEOSUBCOTX,
            INCLUDES TYPE TS_INCLUDES,
* FOR SEO_CLASS_CREATE_COMPLETE ONLY
            METHOD_SOURCES TYPE SEO_METHOD_SOURCE_TABLE,
            LOCALS_DEF  TYPE  RSWSOURCET,
            LOCALS_IMP  TYPE  RSWSOURCET,
            LOCALS_MAC  TYPE  RSWSOURCET,
* FOR EXCEPTION CLASS
            EXCEPTIONS_TEXTS TYPE TT_CX_TEXTS,
          END OF T_FM_DATA .
  TYPES:
    BEGIN OF TS_PARAM_DATA.
  INCLUDE TYPE SEOS_PARAMETER_R AS HDR.
  TYPES:
      TEXTS   TYPE TT_SEOSUBCOTX_L,
    END OF TS_PARAM_DATA .
  TYPES:
    TT_PARAMETERS TYPE SORTED TABLE OF TS_PARAM_DATA WITH UNIQUE KEY SCONAME .
  TYPES:
    BEGIN OF TS_EXCEP_DATA.
  INCLUDE TYPE SEOS_EXCEPTION_R AS HDR.
  TYPES:
      TEXTS   TYPE TT_SEOSUBCOTX_L,
    END OF TS_EXCEP_DATA .
  TYPES:
    TT_EXCEPTIONS TYPE SORTED TABLE OF TS_EXCEP_DATA WITH UNIQUE KEY SCONAME .
  TYPES:
    BEGIN OF TS_EVENT_DATA.
  INCLUDE TYPE SEOO_EVENT_R AS HDR.
  TYPES:
      TEXTS         TYPE TT_SEOCOMPOTX_L,
*      REDEFINITION  TYPE SEOREDEF,
      PARAMETERS    TYPE TT_PARAMETERS,
*        EXCEPTIONS    TYPE TT_EXCEPTIONS,
*      _               TYPE TS_SOURCE,
    END OF TS_EVENT_DATA .
  TYPES:
    TT_EVENTS TYPE SORTED TABLE OF TS_EVENT_DATA WITH UNIQUE KEY CMPNAME .
  TYPES:
    BEGIN OF TS_METH_DATA.
  INCLUDE TYPE SEOO_METHOD_R AS HDR.
  TYPES:
      TEXTS         TYPE TT_SEOCOMPOTX_L,
*      REDEFINITION  TYPE TS_REDEFINITION,
      PARAMETERS    TYPE TT_PARAMETERS,
      EXCEPTIONS    TYPE TT_EXCEPTIONS,
      SOURCE        TYPE TS_SOURCEASSTRUC,
    END OF TS_METH_DATA .
  TYPES:
    TT_METHODS TYPE SORTED TABLE OF TS_METH_DATA WITH UNIQUE KEY CMPNAME .
  TYPES:
    BEGIN OF TS_ALIAS_DATA.
  INCLUDE TYPE SEOO_ALIAS_R AS HDR.
  TYPES:
      TEXTS   TYPE TT_SEOCOMPOTX_L,
    END OF TS_ALIAS_DATA .
  TYPES:
    TT_ALIAS TYPE SORTED TABLE OF TS_ALIAS_DATA WITH UNIQUE KEY CMPNAME .
  TYPES:
    BEGIN OF TS_ATTR_DATA.
  INCLUDE TYPE SEOO_ATTRIBUTE_R AS HDR.
  TYPES:
      TEXTS   TYPE TT_SEOCOMPOTX_L,
    END OF TS_ATTR_DATA .
  TYPES:
    TT_ATTRIBUTS TYPE SORTED TABLE OF TS_ATTR_DATA WITH UNIQUE KEY CMPNAME .
  TYPES:
    BEGIN OF TS_TYPE_DATA.
  INCLUDE TYPE SEOO_TYPE_R AS HDR.
  TYPES:
      TEXTS   TYPE TT_SEOCOMPOTX_L,
      _       TYPE TS_SOURCE,
    END OF TS_TYPE_DATA .
  TYPES:
    TT_TYPES TYPE SORTED TABLE OF TS_TYPE_DATA WITH UNIQUE KEY CMPNAME .
  TYPES:
    BEGIN OF TS_TGRP_DATA.
  INCLUDE TYPE SEOT_TYPEPUSAGE_R AS HDR.
  TYPES:
      DEFERED TYPE SEOT_CLSDEFERRD_R,
      ITF_DEF TYPE SEOT_INTDEFERRD_R,
    END OF TS_TGRP_DATA .
  TYPES:
    TT_TYPEGROUPS TYPE SORTED TABLE OF TS_TGRP_DATA WITH UNIQUE KEY TYPEGROUP .
  TYPES:
    TT_ITF_DEFAULT_VALUES TYPE SORTED TABLE OF SEOREDEF WITH UNIQUE KEY MTDNAME .
  TYPES:
    BEGIN OF TS_INTERFACE.
  INCLUDE TYPE SEOR_IMPLEMENTING_R AS HDR.  &quot; MTHODES REDFINIES PAR RELATION D&apos;HRITAGE
  TYPES:
      ATTRIBUTES_REDEFINITION TYPE TT_ITF_DEFAULT_VALUES,   &quot; INTERFACE PUBLIC ATTRIBUTE DEFAULT VALUE
    END OF TS_INTERFACE .
  TYPES:
    TT_INTERFACES TYPE SORTED TABLE OF TS_INTERFACE WITH UNIQUE KEY REFCLSNAME .
  TYPES:
    BEGIN OF TS_SOURCES,
        CLASSPOOL   TYPE  TS_SOURCEASSTRUC,
        LOCAL_TYPES TYPE  TS_SOURCEASSTRUC,
        LOCAL_IMP   TYPE  TS_SOURCEASSTRUC,
        MACROS      TYPE  TS_SOURCEASSTRUC,
        PUBLIC      TYPE  TS_SOURCEASSTRUC,
        PRIVATE     TYPE  TS_SOURCEASSTRUC,
        PROTECTED   TYPE  TS_SOURCEASSTRUC,
      END OF TS_SOURCES .

  DATA ALIASES TYPE TT_ALIAS .
  DATA ATTRIBUTS TYPE TT_ATTRIBUTS .
  DATA DOCUMENTATION TYPE ZAPLINK_DOCUMENTATION=&gt;TT_DOCS .
  DATA EVENTS TYPE TT_EVENTS .
  DATA INTERFACES TYPE TT_INTERFACES .
  DATA METHODS TYPE TT_METHODS .
  DATA TYPEGROUPS TYPE TT_TYPEGROUPS .
  DATA TYPES TYPE TT_TYPES .

  CLASS-METHODS GET_INCLUDES
    IMPORTING
      !CLSNAME TYPE SEOCLSNAME
    RETURNING
      VALUE(INCLUDES) TYPE TS_INCLUDES .
  METHODS FROM_DATA
    IMPORTING
      !FM_DATA TYPE T_FM_DATA .
  METHODS TO_DATA
    RETURNING
      VALUE(FM_DATA) TYPE T_FM_DATA .
  METHODS COMPLETE_DATA
    CHANGING
      !FM_DATA TYPE T_FM_DATA .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_OBJECT_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  TYPES:
    BEGIN OF TS_COMPONENT,
      CMPNAME TYPE SEOO_METHOD_R-CMPNAME,
    END OF TS_COMPONENT .
  TYPES:
    TT_COMPONENTS TYPE SORTED TABLE OF TS_COMPONENT WITH UNIQUE KEY CMPNAME .

  DATA COMPONENTS TYPE TT_COMPONENTS .
  DATA OBJ_NAME TYPE SEOCLSNAME .
  DATA OBJ_VERSION TYPE SEOVERSION .
  DATA OBJ_LANGU TYPE SYLANGU .
  TYPE-POOLS ABAP .
  CONSTANTS LINE_SEPARATOR TYPE ABAP_CHAR1 VALUE CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE. &quot;#EC NOTEXT

  METHODS FD_PARAMETERS
    IMPORTING
      !FM_DATA TYPE T_FM_DATA
      !COMPONENT TYPE SEOCMPNAME
    RETURNING
      VALUE(PARAMETERS) TYPE TT_PARAMETERS .
  METHODS FD_EXCEPTIONS
    IMPORTING
      !FM_DATA TYPE T_FM_DATA
      !COMPONENT TYPE SEOCMPNAME
    RETURNING
      VALUE(EXCEPTIONS) TYPE TT_EXCEPTIONS .
  METHODS FD_SUBC_DESC
    IMPORTING
      !DESCRIPTIONS TYPE TT_SEOSUBCOTX
      !SUB_COMPONENT TYPE SEOSCONAME
      !COMPONENT TYPE SEOCMPNAME
    RETURNING
      VALUE(TEXTS) TYPE TT_SEOSUBCOTX_L .
  METHODS FD_COMP_DESC
    IMPORTING
      !DESCRIPTIONS TYPE TT_SEOCOMPOTX
      !COMPONENT TYPE SEOCMPNAME
    RETURNING
      VALUE(TEXTS) TYPE TT_SEOCOMPOTX_L .
  METHODS TD_SUBC_DESC
    IMPORTING
      !SUB_COMPONENT TYPE SEOSCONAME
      !COMPONENT TYPE SEOCMPNAME
      !TEXTS TYPE TT_SEOSUBCOTX_L
    CHANGING
      !DESCRIPTIONS TYPE TT_SEOSUBCOTX .
  METHODS TD_COMP_DESC
    IMPORTING
      !COMPONENT TYPE SEOCMPNAME
      !TEXTS TYPE TT_SEOCOMPOTX_L
    CHANGING
      !DESCRIPTIONS TYPE TT_SEOCOMPOTX .
  METHODS TD_PARAMETERS
    IMPORTING
      !COMPONENT TYPE SEOCMPNAME
      !PARAMETERS TYPE TT_PARAMETERS
    CHANGING
      !FM_DATA TYPE T_FM_DATA .
  METHODS TD_EXCEPTIONS
    IMPORTING
      !COMPONENT TYPE SEOCMPNAME
      !EXCEPTION TYPE TT_EXCEPTIONS
    CHANGING
      !FM_DATA TYPE T_FM_DATA .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_OBJECT_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_OBJECT_DATA DEFINITION
CLASS ZAPLINK_CLAS_DATA DEFINITION
  INHERITING FROM ZAPLINK_OBJECT_DATA
  FINAL
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_CLAS_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.
  TYPE-POOLS SEOF .
  TYPE-POOLS SEOK .
  TYPE-POOLS SEOO .
  TYPE-POOLS SEOR .
  TYPE-POOLS SEOS .
  TYPE-POOLS SEOT .

  TYPES TO_MSG_COL TYPE REF TO ZAPLINK_MESSAGE_COLLECTOR .
  TYPES:
    BEGIN OF TS_EXCEPTION_TEXT.
    INCLUDE TYPE SEOO_ATTRIBUTE_R AS ATTR.
    INCLUDE TYPE SOTR_HEAD AS CX.
    TYPES:
        TEXTS     TYPE TT_SEOCOMPOTX_L,
        LONGTEXTS TYPE TT_SOTR_TEXTS,
      END OF TS_EXCEPTION_TEXT .
  TYPES:
    TT_EXCEPTIONS_TEXTS TYPE SORTED TABLE OF TS_EXCEPTION_TEXT WITH UNIQUE KEY CMPNAME .
  TYPES:
    BEGIN OF TS_SOURCE_,
      _ TYPE TS_SOURCE,
    END OF TS_SOURCE_.
  TYPES:
    BEGIN OF TS_LOCALS,
          TYPES           TYPE TS_SOURCE_,
          IMPLEMENTATIONS TYPE TS_SOURCE_,
          MACROS          TYPE TS_SOURCE_,
        END OF TS_LOCALS .
  TYPES:
    BEGIN OF TS_REDEFINITION.
    INCLUDE TYPE SEOREDEF AS HDR.  &quot; MTHODES REDFINIES PAR RELATION D&apos;HRITAGE
    TYPES:
        SOURCE  TYPE TS_SOURCEASSTRUC,
      END OF TS_REDEFINITION .
  TYPES:
    TT_REDEFINITIONS TYPE SORTED TABLE OF TS_REDEFINITION WITH UNIQUE KEY MTDNAME .
  TYPES:
    TT_FRIENDS    TYPE SORTED TABLE OF SEOFRIENDS WITH UNIQUE KEY REFCLSNAME FRIENDTYPE .
  TYPES:
    BEGIN OF TS_CLASS_DATA.
    INCLUDE TYPE VSEOCLASS AS HDR.
*      INCLUDE TYPE VSEOEXTEND AS INH.  &quot; DUPLICATE NAME FOR SOME FIELDS
    TYPES:
**      CLSNAME     TYPE SEOMETAREL-CLSNAME,
*      REFCLSNAME  TYPE SEOMETAREL-REFCLSNAME,
**      VERSION     TYPE SEOMETAREL-VERSION,
**      STATE       TYPE SEOMETAREL-STATE,
*      AUTHOR      TYPE SEOMETAREL-AUTHOR,
*      CREATEDON   TYPE SEOMETAREL-CREATEDON,
*      CHANGEDBY   TYPE SEOMETAREL-CHANGEDBY,
*      CHANGEDON   TYPE SEOMETAREL-CHANGEDON,
*      RELNAME     TYPE SEOMETAREL-RELNAME,
        INHERITANCE TYPE VSEOEXTEND,
*        TYPEGROUPS  TYPE TT_TYPEGROUPS,
*        INTERFACES  TYPE TT_INTERFACES,
*        FRIENDS     TYPE TT_FRIENDS,
        TEXTS       TYPE TT_SEOCLASSTX_S,
        TEXTPOOL    TYPE ZAPLINK_PROGRAM=&gt;TT_TEXTPOOLS,
        SOURCES     TYPE TS_SOURCES,
      END OF TS_CLASS_DATA .

  DATA A0_MAINDATA TYPE TS_CLASS_DATA .
  DATA FRIENDS TYPE TT_FRIENDS .
  DATA REDEFINITIONS TYPE TT_REDEFINITIONS .
  DATA LOCAL TYPE TS_LOCALS .
  DATA EXCEPTIONS_TEXTS TYPE TT_EXCEPTIONS_TEXTS .

  CLASS-METHODS UPDATE_CONCEPT
    IMPORTING
      !MSG_COL TYPE TO_MSG_COL
    CHANGING
      !FM_DATA TYPE T_FM_DATA .

  METHODS COMPLETE_DATA
    REDEFINITION .
  METHODS FROM_DATA
    REDEFINITION .
  METHODS TO_DATA
    REDEFINITION .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_CLAS_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_CLAS_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  CLASS-METHODS GET_SOURCE
    IMPORTING
      !PROGRAM TYPE PROGRAMM
    RETURNING
      VALUE(SOURCE) TYPE TS_SOURCE .
  CLASS-METHODS VALUE2SOTR
    IMPORTING
      !DATA TYPE SEOVALUE
    RETURNING
      VALUE(RESULT) TYPE SOTR_CONC .
  CLASS-METHODS SOTR2VALUE
    IMPORTING
      !DATA TYPE SOTR_CONC
    RETURNING
      VALUE(RESULT) TYPE SEOVALUE .
ENDCLASS. &quot;ZAPLINK_CLAS_DATA DEFINITION
CLASS ZAPLINK_INTF_DATA DEFINITION
  INHERITING FROM ZAPLINK_OBJECT_DATA
  FINAL
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_INTF_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.
  TYPE-POOLS SEOF .
  TYPE-POOLS SEOK .
  TYPE-POOLS SEOO .
  TYPE-POOLS SEOR .
  TYPE-POOLS SEOS .
  TYPE-POOLS SEOT .

  TYPES:
    BEGIN OF TS_MAIN_DATA.
    INCLUDE TYPE VSEOINTERF AS HDR.
    TYPES:
        TEXTS       TYPE TT_SEOCLASSTX_S,
        TEXTPOOL    TYPE ZAPLINK_PROGRAM=&gt;TT_TEXTPOOLS,
      END OF TS_MAIN_DATA .

  DATA A0_MAINDATA TYPE TS_MAIN_DATA .

  METHODS FROM_DATA
    REDEFINITION .
  METHODS TO_DATA
    REDEFINITION .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_INTERFACE_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_INTERFACE_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_INTF_DATA DEFINITION
CLASS ZAPLINK_OBJECT DEFINITION
  INHERITING FROM ZAPLINK_CONNECTOR_
  CREATE PUBLIC

  FRIENDS ZAPLINK_OBJECT_DATA .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_OBJECT
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.
  TYPE-POOLS SEOF .
  TYPE-POOLS SEOK .
  TYPE-POOLS SEOP .
  TYPE-POOLS SEOR .
  TYPE-POOLS SEOS .
  TYPE-POOLS SEOT .
  TYPE-POOLS SEOX .

  METHODS CONSTRUCTOR .
  CLASS-METHODS CLASS_CONSTRUCTOR .

  METHODS ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~DO_EXISTS
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~READ_FROM_SAP
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~WRITE_TO_SAP
    REDEFINITION .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_OBJECT
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

*  CLASS ZAPLINK_OBJECT_DATA DEFINITION LOAD .
  TYPES T_FM_DATA TYPE ZAPLINK_OBJECT_DATA=&gt;T_FM_DATA .
  TYPES TO_CLASS TYPE REF TO ZAPLINK_CLAS_DATA .
  TYPES TO_INTERFACE TYPE REF TO ZAPLINK_INTF_DATA .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_OBJECT
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  TYPES:
    BEGIN OF TS_BAPI_DATA,
    CLASS                       TYPE  VSEOCLASS,
    ATTRIBUTES                  TYPE  SEOO_ATTRIBUTES_R,
    METHODS                     TYPE  SEOO_METHODS_R,
    EVENTS                      TYPE  SEOO_EVENTS_R,
    TYPES                       TYPE  SEOO_TYPES_R,
    PARAMETERS                  TYPE  SEOS_PARAMETERS_R,
    EXCEPS                      TYPE  SEOS_EXCEPTIONS_R,
    IMPLEMENTINGS               TYPE  SEOR_IMPLEMENTINGS_R,
    INHERITANCE                 TYPE  VSEOEXTEND,
    REDEFINITIONS               TYPE  SEOR_REDEFINITIONS_R,
    IMPL_DETAILS                TYPE  SEOR_REDEFINITIONS_R,
    FRIENDSHIPS                 TYPE  SEOF_FRIENDSHIPS_R,
    TYPEPUSAGES                 TYPE  SEOT_TYPEPUSAGES_R,
    CLSDEFERRDS                 TYPE  SEOT_CLSDEFERRDS_R,
    INTDEFERRDS                 TYPE  SEOT_INTDEFERRDS_R,
    EXPLORE_INHERITANCE         TYPE  SEOK_CLS_TYPEINFOS,
    EXPLORE_IMPLEMENTINGS       TYPE  SEOK_INT_TYPEINFOS,
    ALIASES                     TYPE  SEOO_ALIASES_R,
    ENHANCEMENT_METHODS         TYPE  ENHMETH_TABHEADER,
    ENHANCEMENT_ATTRIBUTES      TYPE  ENHCLASSTABATTRIB,
    ENHANCEMENT_EVENTS          TYPE  ENHCLASSTABEVENT,
    ENHANCEMENT_IMPLEMENTINGS   TYPE ENHCLASSTABIMPLEMENTING,
  END OF TS_BAPI_DATA .
  TYPES:
    BEGIN OF TS_DOC_KEY,                                    &quot; EQUIV DOKU_OBJ = CHAR 60
    NAME       TYPE SEOCLSNAME,                             &quot; CHAR 30
    OTHER(30)  TYPE C,
  END OF TS_DOC_KEY .
  TYPES:
    BEGIN OF TS_CLAS_ATTR.
  INCLUDE TYPE TS_BASE_ATTRIBUTS AS BASE.
  TYPES:
    END OF TS_CLAS_ATTR .

  CLASS-DATA R_DOC_ID_CLASS TYPE TR_DOCID .
  CONSTANTS ST_CLASS TYPE TD_COMPTYPE VALUE &apos;CLAS&apos;.         &quot;#EC NOTEXT
  CONSTANTS ST_INTERFACE TYPE TD_COMPTYPE VALUE &apos;INTF&apos;.     &quot;#EC NOTEXT
  CLASS-DATA R_DOC_ID_INTERFACE TYPE TR_DOCID .
  CONSTANTS _UUID TYPE TD_CONNUUID VALUE &apos;39AC0A4B07A5A05AE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS _VER TYPE TD_CONNVER VALUE &apos;1.0&apos;.               &quot;#EC NOTEXT
  CONSTANTS BALLOG_SUBOBJECT TYPE BALSUBOBJ VALUE &apos;OBJECT&apos;. &quot;#EC NOTEXT

  METHODS IMPORT_TO_SAP_CLASS
    IMPORTING
      !O_DATA TYPE TO_CLASS
    RETURNING
      VALUE(COMPONENTS) TYPE TO_LIST .
  METHODS EXPORT_FROM_SAP_CLASS
    IMPORTING
      !COMPONENT TYPE TO_COMPONENT
    RETURNING
      VALUE(OBJECT) TYPE TO_CLASS .
  METHODS EXPORT_FROM_SAP_INTERFACE
    IMPORTING
      !COMPONENT TYPE TO_COMPONENT
    RETURNING
      VALUE(OBJECT) TYPE TO_INTERFACE .
  METHODS IMPORT_TO_SAP_INTERFACE
    IMPORTING
      !O_DATA TYPE TO_INTERFACE
    RETURNING
      VALUE(COMPONENTS) TYPE TO_LIST .
ENDCLASS. &quot;ZAPLINK_OBJECT DEFINITION
CLASS ZAPLINK_PINF_DATA DEFINITION
  FINAL
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_PINF_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  TYPES:
    TT_ELEMENTS TYPE STANDARD TABLE OF SCOMELDTLN WITH NON-UNIQUE DEFAULT KEY .
  TYPES:
    TT_ACLS     TYPE STANDARD TABLE OF SCOMACLSTR WITH NON-UNIQUE DEFAULT KEY .

  DATA DATA TYPE SCOMPIDTLN .
  DATA ACLS TYPE TT_ACLS .
  DATA ELEMENTS TYPE TT_ELEMENTS .
  DATA IF TYPE REF TO IF_PACKAGE_INTERFACE .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_PINF_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_PINF_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_PINF_DATA DEFINITION
CLASS ZAPLINK_PINF_RAW DEFINITION
  INHERITING FROM ZAPLINK_RAW
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_PINF_RAW
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  METHODS CONSTRUCTOR
    IMPORTING
      !O_COMP TYPE TO_COMPONENT OPTIONAL .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_DEVC_RAW
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_DEVC_RAW
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_PINF_RAW DEFINITION
CLASS ZAPLINK_DEVC_RAW DEFINITION
  INHERITING FROM ZAPLINK_RAW
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_DEVC_RAW
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  METHODS CONSTRUCTOR
    IMPORTING
      !O_COMP TYPE TO_COMPONENT OPTIONAL .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_DEVC_RAW
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_DEVC_RAW
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_DEVC_RAW DEFINITION
CLASS ZAPLINK_DEVC_DATA DEFINITION
  FINAL
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_DEVC_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  TYPES:
    TT_ACLS TYPE STANDARD TABLE OF PKGPERMDAT WITH NON-UNIQUE DEFAULT KEY .
  TYPES: TO_INTERFACE_RAW TYPE REF TO ZAPLINK_PINF_RAW.
  TYPES:
    BEGIN OF TS_INTERFACE,
      ZL_OBJECT TYPE TO_INTERFACE_RAW,
    END OF TS_INTERFACE.
  TYPES:
    TT_INTERFACES TYPE STANDARD TABLE OF TS_INTERFACE WITH NON-UNIQUE DEFAULT KEY .
  TYPES: TO_PACKAGE_RAW TYPE REF TO ZAPLINK_DEVC_RAW.
  TYPES:
    BEGIN OF TS_PACKAGE,
      ZL_OBJECT TYPE TO_PACKAGE_RAW,
    END OF TS_PACKAGE.
  TYPES:
    TT_PACKAGES TYPE STANDARD TABLE OF TS_PACKAGE WITH NON-UNIQUE DEFAULT KEY .

  DATA DATA TYPE SCOMPKDTLN .
  DATA INTERFACES TYPE TT_INTERFACES .
  DATA PACKAGES TYPE TT_PACKAGES .
  DATA IF TYPE REF TO IF_PACKAGE .
  DATA ACLS TYPE TT_ACLS .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_DEVC_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_DEVC_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_DEVC_DATA DEFINITION
CLASS ZAPLINK_PACKAGE DEFINITION
  INHERITING FROM ZAPLINK_CONNECTOR_
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_PACKAGE
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.
  TYPE-POOLS SEOF .
  TYPE-POOLS SEOK .
  TYPE-POOLS SEOP .
  TYPE-POOLS SEOR .
  TYPE-POOLS SEOS .
  TYPE-POOLS SEOT .
  TYPE-POOLS SEOX .

  DATA TRANSPORT_REQUEST TYPE E070-TRKORR .

  METHODS CONSTRUCTOR .
  CLASS-METHODS CLASS_CONSTRUCTOR .

  METHODS ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~DO_EXISTS
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~READ_FROM_SAP
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~WRITE_TO_SAP
    REDEFINITION .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_PACKAGE
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_PACKAGE
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  TYPES:
    BEGIN OF TS_ELE,
    SELECT    TYPE FLAG,
    ELEM_TYPE TYPE TROBJTYPE,
    ELEM_KEY  TYPE ELEMGENKEY,
    TD_PACK   TYPE DEVCLASS,
    ELEM_PACK TYPE DEVCLASS,
  END OF TS_ELE .
  TYPES:
    TT_ELE TYPE STANDARD TABLE OF TS_ELE WITH NON-UNIQUE DEFAULT KEY .
  TYPES:
    BEGIN OF TS_DOC_KEY,                                    &quot; EQUIV DOKU_OBJ = CHAR 60
    NAME       TYPE SEOCLSNAME,                             &quot; CHAR 30
    OTHER(30)  TYPE C,
  END OF TS_DOC_KEY .
  TYPES:
    BEGIN OF TS_CLAS_ATTR.
  INCLUDE TYPE TS_BASE_ATTRIBUTS AS BASE.
  TYPES:
    END OF TS_CLAS_ATTR .
  TYPES TO_PACKAGE TYPE REF TO ZAPLINK_DEVC_DATA .
  TYPES TO_INTERFACE TYPE REF TO ZAPLINK_PINF_DATA .
  TYPES TD_PACKAGE TYPE DEVCLASS .
  TYPES TD_INTERFACE TYPE SCOMIFNAM .
  TYPES TO_PACKAGE_RAW TYPE REF TO ZAPLINK_DEVC_RAW .
  TYPES TO_INTERFACE_RAW TYPE REF TO ZAPLINK_PINF_RAW .

  CONSTANTS ST_PACKAGE TYPE TD_COMPTYPE VALUE &apos;DEVC&apos;. &quot;#EC NOTEXT
  CONSTANTS ST_INTERFACE TYPE TD_COMPTYPE VALUE &apos;PINF&apos;. &quot;#EC NOTEXT
  TYPE-POOLS SLIS .
  CLASS-DATA CAT_ELE TYPE SLIS_T_FIELDCAT_ALV .
  CLASS-DATA CAT_LAYOUT TYPE SLIS_LAYOUT_ALV .
  CONSTANTS _UUID TYPE TD_CONNUUID VALUE &apos;29AD0A4B07A5A05AE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS _VER TYPE TD_CONNVER VALUE &apos;1.0&apos;. &quot;#EC NOTEXT

  METHODS IMPORT_TO_SAP_PACKAGE
    IMPORTING
      !O_DATA TYPE TO_PACKAGE
    RETURNING
      VALUE(COMPONENTS) TYPE TO_LIST .
  METHODS EXPORT_FROM_SAP_PACKAGE
    IMPORTING
      !COMPONENT TYPE TO_COMPONENT
    RETURNING
      VALUE(OBJECT) TYPE TO_PACKAGE
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS EXPORT_FROM_SAP_INTERFACE
    IMPORTING
      !COMPONENT TYPE TO_COMPONENT
    RETURNING
      VALUE(OBJECT) TYPE TO_INTERFACE .
  METHODS IMPORT_TO_SAP_INTERFACE
    IMPORTING
      !O_DATA TYPE TO_INTERFACE
    RETURNING
      VALUE(COMPONENTS) TYPE TO_LIST .
  METHODS LOAD_DEVC
    IMPORTING
      !KEY TYPE TD_PACKAGE
    RETURNING
      VALUE(OBJ) TYPE REF TO IF_PACKAGE
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS LOAD_INTF
    IMPORTING
      !KEY TYPE TD_INTERFACE
    RETURNING
      VALUE(OBJ) TYPE REF TO IF_PACKAGE_INTERFACE
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS CONV_INTERFACE
    IMPORTING
      !INTERFACE TYPE REF TO IF_PACKAGE_INTERFACE
      !SUBCOMPONENTS TYPE TO_LIST
    RETURNING
      VALUE(O_DATA) TYPE TO_INTERFACE
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS CONV_INTERFACE_RAW
    IMPORTING
      !INTERFACE TYPE REF TO IF_PACKAGE_INTERFACE
      !SUBCOMPONENTS TYPE TO_LIST
    RETURNING
      VALUE(O_DATA) TYPE TO_INTERFACE_RAW
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS CONV_PACKAGE
    IMPORTING
      !PACKAGE TYPE REF TO IF_PACKAGE
      !SUBCOMPONENTS TYPE TO_LIST
    RETURNING
      VALUE(O_DATA) TYPE TO_PACKAGE
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS CONV_PACKAGE_RAW
    IMPORTING
      !PACKAGE TYPE REF TO IF_PACKAGE
      !SUBCOMPONENTS TYPE TO_LIST
    RETURNING
      VALUE(O_DATA) TYPE TO_PACKAGE_RAW
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS CREATE_INTERFACE
    IMPORTING
      !OVERWRITE TYPE FLAG
      !INTERFACE TYPE TO_INTERFACE
      !COMPONENTS TYPE TO_LIST
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS CREATE_PACKAGE
    IMPORTING
      !OVERWRITE TYPE FLAG
      !PACKAGE TYPE TO_PACKAGE
      !COMPONENTS TYPE TO_LIST
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS SET_INTERFACE_ATTRIB
    IMPORTING
      !INTERFACE TYPE TO_INTERFACE
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS SET_PACKAGE_ATTRIB
    IMPORTING
      !PACKAGE TYPE TO_PACKAGE
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS _DELETE_DEVC
    IMPORTING
      !PACKAGE TYPE REF TO IF_PACKAGE
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS _DELETE_INTF
    IMPORTING
      !INTERFACE TYPE REF TO IF_PACKAGE_INTERFACE
    RAISING
      ZAPLINK_CX_CONNECTOR .
  CLASS-METHODS UPDATE_INTERFACE
    IMPORTING
      !DATA TYPE SCOMPIDTLN
    CHANGING
      !INTERFACE TYPE REF TO IF_PACKAGE_INTERFACE
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS UPDATE_PACKAGE
    IMPORTING
      !DATA TYPE SCOMPKDTLN
    CHANGING
      !PACKAGE TYPE REF TO IF_PACKAGE
    RAISING
      ZAPLINK_CX_CONNECTOR .
  METHODS ADD_ELEMENTS_LIST
    IMPORTING
      !INTERFACE TYPE TO_INTERFACE
      !ASK_USER TYPE FLAG OPTIONAL
      !ADD_REMAIN TYPE FLAG DEFAULT &apos;X&apos;
    RAISING
      ZAPLINK_CX_CONNECTOR .
  CLASS-METHODS BUILD_ERROR_MSG
    IMPORTING
      !ELEMENTS TYPE SCOMELDATA
    RETURNING
      VALUE(ERRORMSG) TYPE STRING .
  CLASS-METHODS ELEMENTS2ALV
    IMPORTING
      !ELEMENTS TYPE SCOMELDATA
    RETURNING
      VALUE(ALV_DATA) TYPE TT_ELE .
  METHODS CHANGE_TADIR
    CHANGING
      !ALV_DATA TYPE TT_ELE .
ENDCLASS. &quot;ZAPLINK_PACKAGE DEFINITION
CLASS ZAPLINK_MSAG_DATA DEFINITION
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_MSAG_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  INTERFACES ZAPLINK_DATATYPES .

  ALIASES TS_LANG
    FOR ZAPLINK_DATATYPES~TS_LANG .

  TYPES:
    BEGIN OF TS_MAINDATA.
    INCLUDE TYPE T100A.
    TYPES:
      END OF TS_MAINDATA .
  TYPES:
    BEGIN OF TS_TEXT,
* T100T
          LANGU      TYPE SPRAS,
          SHORT_TXT  TYPE STRING,
          LONG_TXT   TYPE TS_LANG,
        END OF TS_TEXT .
  TYPES:
    TT_TEXTS TYPE SORTED TABLE OF TS_TEXT WITH UNIQUE KEY LANGU .
  TYPES:
    BEGIN OF TS_MSGTEXT,
          MSGNR       TYPE MSGNR,
* T100U
          NAME        TYPE SYUNAME,
          DATUM       TYPE SYDATUM,
          SELFDEF     TYPE DOKU_SELFD,
* DOCUMETATION : LONG TEXT
          APPLICATION TYPE TDOBJECT,
          TYP         TYPE DOKU_TYP,
          DOKFORM     TYPE TDFORMNEW,
          DOKSTYLE    TYPE TDSTYLE,
* T100 &amp; DOCUMENTATION
          TEXTS       TYPE TT_TEXTS,
        END OF TS_MSGTEXT .
  TYPES:
    TT_MSGTEXTS TYPE SORTED TABLE OF TS_MSGTEXT WITH UNIQUE KEY MSGNR .

  DATA A0_MAIN TYPE TS_MAINDATA .
*  CLASS ZAPLINK_DOCUMENTATION DEFINITION LOAD .
  DATA _DOCUMENTATION_OFF TYPE ZAPLINK_DOCUMENTATION=&gt;TT_DOCS .
  DATA TEXTS TYPE TT_TEXTS .
  DATA MESSAGES TYPE TT_MSGTEXTS .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_MESSAGE_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_MSAG_DATA
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.
ENDCLASS. &quot;ZAPLINK_MSAG_DATA DEFINITION
CLASS ZAPLINK_MESSAGE DEFINITION
  INHERITING FROM ZAPLINK_CONNECTOR_
  CREATE PUBLIC .

*&quot;* PUBLIC COMPONENTS OF CLASS ZAPLINK_MESSAGE
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PUBLIC SECTION.

  TYPES TD_RAW____ TYPE RSWSOURCET .
  TYPES:
    BEGIN OF TS_TEXT,
      LANGU   TYPE SPRAS,
      ENTRY   TYPE TEXTPOOLTX,
      LENGTH  TYPE TEXTPOOLLN,
    END OF TS_TEXT .
  TYPES:
    TT_TEXTS TYPE SORTED TABLE OF TS_TEXT WITH UNIQUE KEY LANGU .
  TYPES:
    BEGIN OF TS_TEXTPOOL,
      ID    TYPE  TEXTPOOLID,
      KEY   TYPE  TEXTPOOLKY,
      TEXTS TYPE  TT_TEXTS,
    END OF TS_TEXTPOOL .
  TYPES:
    TT_TEXTPOOLS TYPE SORTED TABLE OF TS_TEXTPOOL WITH UNIQUE KEY ID KEY .
  TYPES TS_SOURCE TYPE STRING .

  METHODS CONSTRUCTOR .
  CLASS-METHODS CLASS_CONSTRUCTOR .

  METHODS ZAPLINK_CONNECTOR~CREATE_NEW_RAW
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~DELETE_FROM_SAP
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~DO_EXISTS
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~READ_FROM_SAP
    REDEFINITION .
  METHODS ZAPLINK_CONNECTOR~WRITE_TO_SAP
    REDEFINITION .
*&quot;* PROTECTED DECLARATIONS
*&quot;* PROTECTED COMPONENTS OF CLASS ZAPLINK_MESSAGE
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PROTECTED SECTION.

  TYPES TO_DATA TYPE REF TO ZAPLINK_MSAG_DATA .
*&quot;* PRIVATE DECLARATIONS
*&quot;* PRIVATE COMPONENTS OF CLASS ZAPLINK_MESSAGE
*&quot;* DO NOT INCLUDE OTHER SOURCE FILES HERE!!!
PRIVATE SECTION.

  TYPES:
    BEGIN OF TS_PROG_ATTR.
  INCLUDE TYPE TS_BASE_ATTRIBUTS AS BASE.
  TYPES:
    END OF TS_PROG_ATTR .

  CONSTANTS ST_MSGCLASS TYPE TD_COMPTYPE VALUE &apos;MSAG&apos;. &quot;#EC NOTEXT
  CLASS-DATA R_DOC_ID TYPE TR_DOCID .
  CONSTANTS _UUID TYPE TD_CONNUUID VALUE &apos;1FAC0A4B07A5A05AE1000000AC120173&apos;. &quot;#EC NOTEXT
  CONSTANTS _VER TYPE TD_CONNVER VALUE &apos;1.0&apos;. &quot;#EC NOTEXT
  CONSTANTS C_MSG_ID TYPE TD_DOC_ID VALUE &apos;NA&apos;. &quot;#EC NOTEXT
ENDCLASS. &quot;ZAPLINK_MESSAGE DEFINITION
CLASS ZAPLINK_CX IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
.
 IF TEXTID IS INITIAL.
   ME-&gt;TEXTID = ZAPLINK_CX .
 ENDIF.
ME-&gt;MSG = MSG .
ME-&gt;MESSAGES = MESSAGES .
ME-&gt;OBJECT = OBJECT .
ME-&gt;SUBOBJECT = SUBOBJECT .
ME-&gt;PREV_CX = PREV_CX .
ME-&gt;EXT_ID = EXT_ID .
ME-&gt;CX_NAME = CX_NAME .
ENDMETHOD.
METHOD CONV_PROGNAME.
DATA P_WB_REQUEST TYPE REF TO CL_WB_REQUEST.
  DATA P_EX_REQUEST TYPE REF TO CL_WB_REQUEST.
  DATA P_WB_SOURCE_REQ_DISPATCHER TYPE REF TO CL_WB_SOURCE_REQ_DISPATCHER.
  DATA KIND TYPE  SEOCLSNAME.

  CREATE OBJECT P_WB_SOURCE_REQ_DISPATCHER.

  CREATE OBJECT P_WB_REQUEST
    EXPORTING
      P_OBJECT_TYPE                = &apos;P&apos;
      P_OBJECT_NAME                = OBJECT_NAME
      P_OPERATION                  = &apos;DISPLAY&apos;
*      P_IN_NEW_WINDOW              = WN_SAME_WINDOW
*      P_OBJECT_STATE               =
*      P_LAZY_START                 = TO_IMMEDIATE_START
    EXCEPTIONS
      ILLEGAL_OBJECT_TYPE          = 1
      ILLEGAL_OPERATION            = 2
      ILLEGAL_NEW_WINDOW_PARAMETER = 3
      OTHERS                       = 4.
  IF SY-SUBRC &lt;&gt; 0.
    SOURCE-STR = SOURCE-NAME = OBJECT_NAME.
    EXIT.
  ENDIF.

  CALL METHOD P_WB_SOURCE_REQ_DISPATCHER-&gt;IF_WB_DECISION_CLASS~GET_TOOL_FOR_REQUEST
    EXPORTING
      P_WB_REQUEST            = P_WB_REQUEST
    IMPORTING
      P_EXECUTION_REQUEST     = P_EX_REQUEST
      P_TOOLNAME              = KIND
    EXCEPTIONS
      NO_TOOL_FOUND           = 1
      OBJECT_NOT_FOUND        = 2
      OPERATION_NOT_SUPPORTED = 3
      OTHERS                  = 4.
  IF SY-SUBRC &lt;&gt; 0.
    SOURCE-STR = SOURCE-NAME = OBJECT_NAME.
    EXIT.
  ENDIF.

  IF NOT P_EX_REQUEST IS BOUND.
    P_EX_REQUEST = P_WB_REQUEST.
  ENDIF.

  SOURCE-NAME = P_EX_REQUEST-&gt;OBJECT_NAME.
  IF NOT CONTEXT IS INITIAL.
    REPLACE FIRST OCCURRENCE OF CONTEXT IN SOURCE-NAME WITH ` `.
    CONDENSE SOURCE-NAME.
  ENDIF.

  SELECT SINGLE SINGULAR INTO SOURCE-TYPE_TXT
    FROM EUOBJT
    WHERE SPRAS = SY-LANGU
      AND TYPE = P_EX_REQUEST-&gt;OBJECT_TYPE.
  IF SY-SUBRC &lt;&gt; 0.
    SELECT SINGLE SINGULAR INTO SOURCE-TYPE_TXT
      FROM EUOBJT
      WHERE SPRAS = &apos;E&apos;
        AND TYPE = P_EX_REQUEST-&gt;OBJECT_TYPE.
    IF SY-SUBRC &lt;&gt; 0.
      SELECT SINGLE SINGULAR INTO SOURCE-TYPE_TXT
        FROM EUOBJT
        WHERE TYPE = P_EX_REQUEST-&gt;OBJECT_TYPE.
    ENDIF.
  ENDIF.
  IF SY-SUBRC = 0.
    CONCATENATE SOURCE-TYPE_TXT SOURCE-NAME INTO SOURCE-STR SEPARATED BY SPACE.
  ELSE.
    SOURCE-STR = SOURCE-NAME.
  ENDIF.
ENDMETHOD.
METHOD GET_SOURCE_POSITION_AS_STRING.
STR = SOURCE_POSITION_AS_STRING( ME ).
ENDMETHOD.
METHOD NEW_WITH_BALLOG.
CREATE OBJECT EXCEPTION
    EXPORTING
      TEXTID = TEXTID
*      PREVIOUS =
*      MSG    = &apos;44F7518323DB08BC02000000A7E42BB6&apos;
      MESSAGES = MESSAGE_COLLECTOR
*      OBJECT =
*      SUBOBJECT =
      PREV_CX = PREV_CX
*      EXT_ID =
      .
  EXCEPTION-&gt;UPDATE( ).
ENDMETHOD.
METHOD SOURCE_POSITION_AS_STRING.
DATA _POS TYPE TS_SOURCE_POS.
  DATA _KEY TYPE SEU_OBJKEY.
  DATA _PROG TYPE TS_SOURCE_DEF.
  DATA _INCLUDE TYPE TS_SOURCE_DEF.

  CALL METHOD EXCEPTION-&gt;GET_SOURCE_POSITION
    IMPORTING
      PROGRAM_NAME = _POS-PROGRAM_NAME
      INCLUDE_NAME = _POS-INCLUDE_NAME
      SOURCE_LINE  = _POS-SOURCE_LINE.

  _KEY = _POS-PROGRAM_NAME. _PROG = CONV_PROGNAME( _KEY ).
  _KEY = _POS-INCLUDE_NAME. _INCLUDE = CONV_PROGNAME( OBJECT_NAME = _KEY
                                                          CONTEXT = _PROG-NAME ).

  MESSAGE I000 WITH _PROG-STR _INCLUDE-STR _POS-SOURCE_LINE INTO STR.
ENDMETHOD.
METHOD UPDATE.
* BAL_LOG
  IF MESSAGES IS BOUND.
    OBJECT = MESSAGES-&gt;OBJECT.
    SUBOBJECT = MESSAGES-&gt;SUBOBJECT.
    EXT_ID = MESSAGES-&gt;EXT_ID.
  ENDIF.

* CX_NAME
  DATA DESC TYPE REF TO CL_ABAP_OBJECTDESCR.
  IF CX_NAME IS INITIAL AND PREV_CX IS BOUND.
    DESC ?= CL_ABAP_OBJECTDESCR=&gt;DESCRIBE_BY_OBJECT_REF( PREV_CX ).
    CX_NAME = DESC-&gt;ABSOLUTE_NAME.
  ELSEIF CX_NAME IS INITIAL AND PREVIOUS IS BOUND.
    DESC ?= CL_ABAP_OBJECTDESCR=&gt;DESCRIBE_BY_OBJECT_REF( PREVIOUS ).
    CX_NAME = DESC-&gt;ABSOLUTE_NAME.
  ENDIF.
ENDMETHOD.
METHOD WRITE.
DATA _EXCEPTIONS TYPE STANDARD TABLE OF STRING.
  DATA _MSG TYPE STRING.
  DATA _POS TYPE STRING.
  DATA _CX TYPE REF TO ZAPLINK_CX.
  DATA _ORDER TYPE STANDARD TABLE OF STRING.
  DATA _OFFSET TYPE STRING.
  DATA _MESSAGES TYPE BAPIRETTAB.
  DATA _LIGHT TYPE ICON_D.
  FIELD-SYMBOLS:
    &lt;M&gt; LIKE LINE OF _MESSAGES,
    &lt;E&gt; LIKE LINE OF _EXCEPTIONS.

  _CX = ME.
  WHILE _CX IS BOUND.
    _MSG = _CX-&gt;GET_TEXT( ).
    _POS = _CX-&gt;GET_SOURCE_POSITION_AS_STRING( ).
    CONCATENATE _MSG _POS INTO _MSG SEPARATED BY SPACE.
    APPEND _MSG TO _EXCEPTIONS.
    _CX = _CX-&gt;PREV_CX.
  ENDWHILE.

  LOOP AT _EXCEPTIONS ASSIGNING &lt;E&gt;.
    INSERT &lt;E&gt; INTO _ORDER INDEX 1.
  ENDLOOP.
  FREE _EXCEPTIONS.
*ICON_ARROW_RIGHT
*ICON_WF_LINK
*ICON_PDIR_FOREWARD
*ICON_PDIR_FOREWARD_SWITCH
*ICON_CONNECT
*ICON_TREND_UNCHANGED
*ICON_PAGE_RIGHT
  LOOP AT _ORDER ASSIGNING &lt;E&gt;.
    IF SY-TABIX = 1.
      WRITE:/ ICON_MESSAGE_CRITICAL_SMALL AS ICON, &lt;E&gt;.
    ELSE.
      CONCATENATE ` ` _OFFSET INTO _OFFSET.
      WRITE:/ _OFFSET, ICON_ARROW_RIGHT AS ICON, &lt;E&gt;.
    ENDIF.
  ENDLOOP.
  IF ME-&gt;MESSAGES IS BOUND.
    CONCATENATE ` ` _OFFSET INTO _OFFSET.
    MESSAGES-&gt;WRITE( _OFFSET ).
  ENDIF.
ENDMETHOD.
METHOD CREATE_FROM_MF_CX.
CONSTANTS C_CX_KIND TYPE FUNCT-KIND VALUE &apos;X&apos;. &quot; EXCEPTION

  DATA _FUNCNAME      TYPE RS38L-NAME.
  DATA LT_PTFDIR      TYPE STANDARD TABLE OF TFDIR WITH DEFAULT KEY.
  DATA LT_PTFTIT      TYPE STANDARD TABLE OF TFTIT WITH DEFAULT KEY.
  DATA LT_PFUNCT      TYPE STANDARD TABLE OF FUNCT WITH DEFAULT KEY.
  DATA LT_PENLFDIR    TYPE STANDARD TABLE OF ENLFDIR WITH DEFAULT KEY.
  DATA LT_PTRDIR      TYPE STANDARD TABLE OF TRDIR WITH DEFAULT KEY.
  DATA LT_PFUPARAREF  TYPE STANDARD TABLE OF SFUPARAREF WITH DEFAULT KEY.
  DATA LT_UINCL       TYPE STANDARD TABLE OF ABAPTXT255 WITH DEFAULT KEY.
  DATA _CX            TYPE REF TO ZAPLINK_CX.
  DATA _SUBRC         TYPE SY-SUBRC.
  FIELD-SYMBOLS:
    &lt;T&gt; LIKE LINE OF LT_PFUNCT,
    &lt;P&gt; LIKE LINE OF LT_PFUPARAREF.

  _FUNCNAME = FUNCNAME.
  TRANSLATE _FUNCNAME TO UPPER CASE.
  IF NOT CLASSNAME IS INITIAL.
    TRY.
        CREATE OBJECT RESULT
          TYPE
            (CLASSNAME)
          EXPORTING
            TEXTID      = TEXTID.
      CATCH CX_ROOT.
    ENDTRY.
  ENDIF.

  IF RESULT IS NOT BOUND.
    CREATE OBJECT RESULT
      EXPORTING
        TEXTID = TEXTID.
  ENDIF.

  CALL FUNCTION &apos;FUNC_GET_OBJECT&apos;
    EXPORTING
      FUNCNAME                 = _FUNCNAME
*     R3STATE                  = &apos;A&apos;
    TABLES
      PTFDIR                   = LT_PTFDIR
      PTFTIT                   = LT_PTFTIT
      PFUNCT                   = LT_PFUNCT
      PENLFDIR                 = LT_PENLFDIR
      PTRDIR                   = LT_PTRDIR
      PFUPARAREF               = LT_PFUPARAREF
      UINCL                    = LT_UINCL
*     VSMODISRC                =
*     VSMODILOG                =
    EXCEPTIONS
      FUNCTION_NOT_EXIST       = 1
      VERSION_NOT_FOUND        = 2
      OTHERS                   = 3.
  IF SY-SUBRC &lt;&gt; 0.
    _CX = CREATE_FROM_MF_CX( FUNCNAME = &apos;FUNC_GET_OBJECT&apos;
                                SUBRC = SY-SUBRC ).
    RESULT-&gt;PREV_CX = _CX.
    RESULT-&gt;TEXTID = ZAPLINK_CX=&gt;SYSTEM_ERROR.
    EXIT.
  ENDIF.

  DELETE LT_PFUNCT WHERE KIND &lt;&gt; C_CX_KIND.
  DELETE LT_PFUPARAREF WHERE PARAMTYPE &lt;&gt; C_CX_KIND.

  READ TABLE LT_PFUPARAREF ASSIGNING &lt;P&gt;
       WITH KEY PPOSITION = SUBRC.
  IF SY-SUBRC &lt;&gt; 0.
    _SUBRC = SUBRC - 1.
    READ TABLE LT_PFUPARAREF ASSIGNING &lt;P&gt;
         WITH KEY PPOSITION = SUBRC.
    IF SY-SUBRC = 0.
      RESULT-&gt;CX_NAME = &apos;OTHERS&apos;.
      EXIT.
    ENDIF.
  ENDIF.
  IF NOT &lt;P&gt; IS ASSIGNED.
    RAISE EXCEPTION TYPE ZAPLINK_CX
          EXPORTING TEXTID = ZAPLINK_CX=&gt;SYSTEM_ERROR.
  ENDIF.

  RESULT-&gt;CX_NAME = &lt;P&gt;-PARAMETER.
  READ TABLE LT_PFUNCT ASSIGNING &lt;T&gt;
       WITH KEY PARAMETER = &lt;P&gt;-PARAMETER
                    SPRAS = SY-LANGU.
  IF &lt;T&gt; IS ASSIGNED. IF &lt;T&gt;-STEXT IS INITIAL.     UNASSIGN &lt;T&gt;.      ENDIF. ENDIF.
  IF NOT &lt;T&gt; IS ASSIGNED.
    READ TABLE LT_PFUNCT ASSIGNING &lt;T&gt;
         WITH KEY PARAMETER = &lt;P&gt;-PARAMETER
                      SPRAS = &apos;E&apos;.
    IF &lt;T&gt; IS ASSIGNED. IF &lt;T&gt;-STEXT IS INITIAL.     UNASSIGN &lt;T&gt;.      ENDIF. ENDIF.
  ENDIF.
  IF NOT &lt;T&gt; IS ASSIGNED.
    READ TABLE LT_PFUNCT ASSIGNING &lt;T&gt;
         WITH KEY PARAMETER = &lt;P&gt;-PARAMETER.
    IF &lt;T&gt; IS ASSIGNED. IF &lt;T&gt;-STEXT IS INITIAL.     UNASSIGN &lt;T&gt;.      ENDIF. ENDIF.
  ENDIF.
  IF &lt;T&gt; IS ASSIGNED.
    CONCATENATE RESULT-&gt;CX_NAME &apos;(&apos; &lt;T&gt;-STEXT &apos;)&apos; INTO RESULT-&gt;CX_NAME.
  ENDIF.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_CX IMPLEMENTATION

CLASS ZAPLINK_MESSAGE_COLLECTOR IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*======================================================================
* STANDARD SY-MESSAGES
*======================================================================
DEFINE MAC_SYMSG_SEND.
  MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
          WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
END-OF-DEFINITION.

DEFINE MAC_SYMSG_SEND_AS_TYPE.
  MESSAGE ID SY-MSGID TYPE &amp;1 NUMBER SY-MSGNO
          DISPLAY LIKE SY-MSGTY
          WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
END-OF-DEFINITION.

DEFINE MAC_SYMSG_RAISE.
  MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
          WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4
          RAISING &amp;1.
END-OF-DEFINITION.

DEFINE MAC_SYMSG_RAISE_AS_TYPE.
  MESSAGE ID SY-MSGID TYPE &amp;1 NUMBER SY-MSGNO
          WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4
          RAISING &amp;2.
END-OF-DEFINITION.

DEFINE MAC_SYMSG_RAISE_ON_SUBRC.
  IF SY-SUBRC = &amp;1.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4
            RAISING &amp;2.
  ENDIF.
END-OF-DEFINITION.

DEFINE MAC_SYMSG_INTO_TEXT.
  MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
          WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4
          INTO &amp;1.
END-OF-DEFINITION.

DEFINE MAC_SYMSG_SET.
  SY-MSGID = &amp;1.
  SY-MSGTY = &amp;2.
  SY-MSGNO = &amp;3.
  SY-MSGV1 = &amp;4.
  SY-MSGV2 = &amp;5.
  SY-MSGV3 = &amp;6.
  SY-MSGV4 = &amp;7.
END-OF-DEFINITION.

DEFINE MAC_SYMSG_SET_FROM_MSG.
  SY-MSGID = &amp;1-MSGID.
  SY-MSGTY = &amp;1-MSGTY.
  SY-MSGNO = &amp;1-MSGNO.
  SY-MSGV1 = &amp;1-MSGV1.
  SY-MSGV2 = &amp;1-MSGV2.
  SY-MSGV3 = &amp;1-MSGV3.
  SY-MSGV4 = &amp;1-MSGV4.
END-OF-DEFINITION.

DEFINE MAC_MSG_SET_FROM_SYMSG.
  &amp;1-MSGID = SY-MSGID.
  &amp;1-MSGTY = SY-MSGTY.
  &amp;1-MSGNO = SY-MSGNO.
  &amp;1-MSGV1 = SY-MSGV1.
  &amp;1-MSGV2 = SY-MSGV2.
  &amp;1-MSGV3 = SY-MSGV3.
  &amp;1-MSGV4 = SY-MSGV4.
END-OF-DEFINITION.


*======================================================================
* BAPI MESSAGES
*======================================================================
DEFINE MAC_BAPIMSG_TO_SYMSG.
  SY-MSGTY = &amp;1-TYPE.
  SY-MSGID = &amp;1-ID.
  SY-MSGNO = &amp;1-NUMBER.
  SY-MSGV1 = &amp;1-MESSAGE_V1.
  SY-MSGV2 = &amp;1-MESSAGE_V2.
  SY-MSGV3 = &amp;1-MESSAGE_V3.
  SY-MSGV4 = &amp;1-MESSAGE_V4.
END-OF-DEFINITION.

DEFINE MAC_MSG_TO_BAPIMSG.
  CALL FUNCTION &apos;BALW_BAPIRETURN_GET2&apos;
    EXPORTING
      TYPE       = &amp;1-MSGTY
      CL         = &amp;1-MSGID
      NUMBER     = &amp;1-MSGNO
      PAR1       = &amp;1-MSGV1
      PAR2       = &amp;1-MSGV2
      PAR3       = &amp;1-MSGV3
      PAR4       = &amp;1-MSGV4
*     LOG_NO     = &apos; &apos;
*     LOG_MSG_NO = &apos; &apos;
*     PARAMETER  = &apos; &apos;
*     ROW        = 0
*     FIELD      = &apos; &apos;
    IMPORTING
      RETURN     = &amp;2.
END-OF-DEFINITION.


*======================================================================
*======================================================================
DEFINE MAC_MSGLIST_ADD.
  CALL METHOD &amp;1-&gt;ADD
    EXPORTING
      ID_MSGTY = &amp;2
      ID_MSGID = &amp;3
      ID_MSGNO = &amp;4
      ID_MSGV1 = &amp;5
      ID_MSGV2 = &amp;6
      ID_MSGV3 = &amp;7
      ID_MSGV4 = &amp;8.
END-OF-DEFINITION.


*======================================================================
* FORMATTING
*======================================================================
DEFINE MAC_SYMSG_FORMAT_OUT.
  WRITE &amp;1 TO &amp;2 LEFT-JUSTIFIED.
  CONDENSE &amp;2.
END-OF-DEFINITION.

DEFINE MAC_SYMSG_FORMAT_NUM.
  IF &amp;1 IS NOT INITIAL.
    WRITE &amp;1 TO &amp;2 NO-ZERO.
    CONDENSE &amp;2.
  ELSE.
    CLEAR &amp;2.
  ENDIF.
END-OF-DEFINITION.


*======================================================================
* ASSERTIONS / FATAL ERROR HANDLING
*======================================================================

DEFINE MAC_INVALID_PRECONDITION.
  ASSERT 0 = 1.
END-OF-DEFINITION.

DEFINE MAC_INVALID_POSTCONDITION.
  ASSERT 0 = 1.
END-OF-DEFINITION.

DEFINE MAC_ASSERT_INITIAL.
  ASSERT FIELDS &amp;1 CONDITION &amp;1 IS INITIAL.
END-OF-DEFINITION.

DEFINE MAC_ASSERT_NOT_INITIAL.
  ASSERT &amp;1 IS NOT INITIAL.
END-OF-DEFINITION.

DEFINE MAC_ASSERT_REF.
  ASSERT &amp;1 IS BOUND.
END-OF-DEFINITION.

DEFINE MAC_ASSERT_SUBRC.
  ASSERT FIELDS SY-SUBRC CONDITION SY-SUBRC = 0.
END-OF-DEFINITION.


*======================================================================
* SWITCH BOOLEAN VALUE
*======================================================================
DEFINE MAC_SWITCH_FLAG.
  IF &amp;1 &lt;&gt; &apos; &apos;.
    &amp;1 = &apos; &apos;.
  ELSE.
    &amp;1 = &apos;X&apos;.
  ENDIF.
END-OF-DEFINITION.

*======================================================================
* DATE
*======================================================================
*DEFINE MAC_SET_DATE_IF_INITIAL.
*  IF CL_RECA_DATE=&gt;IS_DATE_INITIAL( &amp;1 ) = ABAP_TRUE.
*    &amp;1 = &amp;2.
*  ENDIF.
*END-OF-DEFINITION.

DEFINE MAC_CLEAR_DATE_IF_INITIAL.
  IF IS_DATE_INITIAL( &amp;1 ) = ABAP_TRUE.
    CLEAR &amp;1.
  ENDIF.
END-OF-DEFINITION.

*DEFINE MAC_CLEAR_DATE_IF_MIN_MAX.
*  IF &amp;1 = RECA0_DATE-MIN OR &amp;1 = RECA0_DATE-MAX.
*    CLEAR &amp;1.
*  ENDIF.
*END-OF-DEFINITION.

*DEFINE MAC_REFRESH_SUPPORT_LIST.
** ALSO REFRESH SUPPORT MESSAGE LIST
*  IF CL_RECA_TRACE=&gt;MS_OPTIONS-TRACEON = ABAP_TRUE.
*    CALL METHOD GET_LIST_X
*      IMPORTING
*        ET_LIST_X = MT_SUP_MSG.
*    MD_SUP_COUNT = LINES( MT_SUP_MSG ).
*  ENDIF.
*END-OF-DEFINITION.
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD ADD.
DATA:
    LS_MESSAGE    TYPE BAL_S_MSG,
*    LS_MSGCONTEXT TYPE RECAMSGCONTEXT,
    LS_PAR        LIKE LINE OF LS_MESSAGE-PARAMS-T_PAR,
    LD_PARCONTEXT TYPE BALPVAL.

  DEFINE MAC_APPEND_PAR.
    IF &amp;2 IS NOT INITIAL.
      LS_PAR-PARNAME  = &amp;1.
      LS_PAR-PARVALUE = &amp;2.
      APPEND LS_PAR TO LS_MESSAGE-PARAMS-T_PAR.
    ENDIF.
  END-OF-DEFINITION.

* INIT RESULTS
  CLEAR ES_MESSAGE.

* BODY
  IF IS_MESSAGE IS NOT INITIAL.

*   SET MESSAGE DATA FROM STRUCTURE
    LS_MESSAGE = IS_MESSAGE.

  ELSE.

*   SET MESSAGE DATA FROM SINGLE FIELD VALUES
*   (SPECIAL HANDLING OF MESSAGE V1..V4 FOR TYPE DATE)
    LS_MESSAGE-MSGTY = ID_MSGTY.
    IF ID_MSGID IS INITIAL.
      LS_MESSAGE-MSGID = MSGID.
    ELSE.
      LS_MESSAGE-MSGID = ID_MSGID.
    ENDIF.
    LS_MESSAGE-MSGNO = ID_MSGNO.

    IF ID_MSGV1 IS SUPPLIED.
      LS_MESSAGE-MSGV1 = ID_MSGV1.
    ELSEIF ID_MSGD1 IS SUPPLIED.
      CALL METHOD CONVERT_DATE_TO_STRING
        EXPORTING
          ID_DATE        = ID_MSGD1
        IMPORTING
          ED_DATE_STRING = LS_MESSAGE-MSGV1.
    ENDIF.

    IF ID_MSGV2 IS SUPPLIED.
      LS_MESSAGE-MSGV2 = ID_MSGV2.
    ELSEIF ID_MSGD2 IS SUPPLIED.
      CALL METHOD CONVERT_DATE_TO_STRING
        EXPORTING
          ID_DATE        = ID_MSGD2
        IMPORTING
          ED_DATE_STRING = LS_MESSAGE-MSGV2.
    ENDIF.

    IF ID_MSGV3 IS SUPPLIED.
      LS_MESSAGE-MSGV3 = ID_MSGV3.
    ELSEIF ID_MSGD3 IS SUPPLIED.
      CALL METHOD CONVERT_DATE_TO_STRING
        EXPORTING
          ID_DATE        = ID_MSGD3
        IMPORTING
          ED_DATE_STRING = LS_MESSAGE-MSGV3.
    ENDIF.

    IF ID_MSGV4 IS SUPPLIED.
      LS_MESSAGE-MSGV4 = ID_MSGV4.
    ELSEIF ID_MSGD4 IS SUPPLIED.
      CALL METHOD CONVERT_DATE_TO_STRING
        EXPORTING
          ID_DATE        = ID_MSGD4
        IMPORTING
          ED_DATE_STRING = LS_MESSAGE-MSGV4.
    ENDIF.

    LS_MESSAGE-DETLEVEL  = ID_DETLEVEL.
    LS_MESSAGE-PROBCLASS = ID_PROBCLASS.

  ENDIF.

* CHECK MESSAGE DATA (T100)
  IF ( LS_MESSAGE-MSGTY NA &apos;ISWEAX&apos; ) OR
     ( LS_MESSAGE-MSGID IS INITIAL  ).
    MESSAGE ID LS_MESSAGE-MSGID TYPE LS_MESSAGE-MSGTY NUMBER LS_MESSAGE-MSGNO
            WITH LS_MESSAGE-MSGV1 LS_MESSAGE-MSGV2 LS_MESSAGE-MSGV3 LS_MESSAGE-MSGV4.
  ENDIF.

* MODIFY DETAIL LEVEL FOR MESSAGE HIERARCHY
  IF LS_MESSAGE-DETLEVEL NOT BETWEEN MC_MIN_LEVEL AND MC_MAX_LEVEL.
    LS_MESSAGE-DETLEVEL = MD_LEVEL.
  ENDIF.

* MODIFY PROBLEM CLASS
  IF LS_MESSAGE-PROBCLASS IS INITIAL.
    CASE LS_MESSAGE-MSGTY.
      WHEN &apos;I&apos; OR &apos;S&apos;.       LS_MESSAGE-PROBCLASS = &apos;4&apos;.
      WHEN &apos;W&apos;.              LS_MESSAGE-PROBCLASS = &apos;3&apos;.
      WHEN &apos;E&apos;.              LS_MESSAGE-PROBCLASS = &apos;2&apos;.
      WHEN &apos;A&apos; OR &apos;X&apos;.       LS_MESSAGE-PROBCLASS = &apos;1&apos;.
    ENDCASE.
  ENDIF.

** SET ADDITIONAL MESSAGE DATA
*  IF ( ID_TABNAME   IS NOT INITIAL ) OR
*     ( ID_FIELDNAME IS NOT INITIAL ) OR
*     ( ID_VALUE     IS NOT INITIAL ) OR
*     ( ID_INDEX     IS NOT INITIAL ) OR
*     ( ID_INTRENO   IS NOT INITIAL ) OR
*     ( ID_CUSTACT   IS NOT INITIAL ) OR
*     ( ID_SUBLOG    IS NOT INITIAL ) OR
*     ( ID_CONTEXT   IS NOT INITIAL ).
*
***   SET CALLBACK HEADER
**    IF ( ID_TABNAME IS NOT INITIAL OR ID_FIELDNAME IS NOT INITIAL ) OR
**       ( ID_INTRENO IS NOT INITIAL                                ) OR
**       ( ID_CUSTACT IS NOT INITIAL                                ) OR
**       ( ID_SUBLOG  IS NOT INITIAL                                ).
**      LS_MESSAGE-PARAMS-CALLBACK-USEREXITP = SPACE.
**      LS_MESSAGE-PARAMS-CALLBACK-USEREXITF = MC_FUNC_CALLBACK.
**      LS_MESSAGE-PARAMS-CALLBACK-USEREXITT = &apos;F&apos;.
**    ELSE.
*      LS_MESSAGE-PARAMS-ALTEXT = &apos;-&apos;.
**    ENDIF.
*
**   SET MESSAGE CALLBACK PARAMETER
*    MAC_APPEND_PAR &apos;TABNAME&apos;   ID_TABNAME.
*    MAC_APPEND_PAR &apos;FIELDNAME&apos; ID_FIELDNAME.
*    MAC_APPEND_PAR &apos;VALUE&apos;     ID_VALUE.
*    MAC_APPEND_PAR &apos;INDEX&apos;     ID_INDEX.
*    MAC_APPEND_PAR &apos;INTRENO&apos;   ID_INTRENO.
*    MAC_APPEND_PAR &apos;CUSTACT&apos;   ID_CUSTACT.
*    MAC_APPEND_PAR &apos;SUBLOG&apos;    ID_SUBLOG.
*
**    IF ID_CONTEXT IS NOT INITIAL.
***     (UNICODE-LIKE ASSIGNMENT)
**      CALL METHOD CL_ABAP_CONTAINER_UTILITIES=&gt;FILL_CONTAINER_C
**        EXPORTING
**          IM_VALUE     = ID_CONTEXT
**        IMPORTING
**          EX_CONTAINER = LD_PARCONTEXT.
**    ENDIF.
**
**    MAC_APPEND_PAR &apos;CONTEXT&apos;   LD_PARCONTEXT.
**
****   SET MESSAGE CONTEXT (ONLY USED TO DISPLAY IN SUPPORT MODE)
***    LS_MSGCONTEXT-TABNAME      = ID_TABNAME.
***    LS_MSGCONTEXT-FIELDNAME    = ID_FIELDNAME.
***    LS_MSGCONTEXT-TABINDEX     = ID_INDEX.
***    LS_MSGCONTEXT-INTRENO      = ID_INTRENO.
***
***    LS_MESSAGE-CONTEXT-TABNAME = &apos;RECAMSGCONTEXT&apos;.
**    LS_MESSAGE-CONTEXT-TABNAME = ID_TABNAME.
**
***   (UNICODE-LIKE ASSIGNMENT)
**    CALL METHOD CL_ABAP_CONTAINER_UTILITIES=&gt;FILL_CONTAINER_C
**      EXPORTING
**        IM_VALUE     = ID_CONTEXT
**      IMPORTING
**        EX_CONTAINER = LS_MESSAGE-CONTEXT-VALUE.
*
*  ENDIF.

* ADD MESSAGE TO APPLICATION LOG

  IF IF_CUMULATE = ABAP_TRUE.
*   ADD CUMULATED MESSAGES (SEE DOCUMENTATION OF FUNCION MODULE BAL_LOG_MSG_CUMULATE)
    CALL FUNCTION &apos;BAL_LOG_MSG_CUMULATE&apos;
      EXPORTING
        I_LOG_HANDLE         = MD_HANDLE
        I_S_MSG              = LS_MESSAGE
        I_COMPARE_ATTRIBUTES = ABAP_TRUE       &quot; COMPARE ATTRIBUTES
        I_COMPARE_CONTEXT    = ABAP_TRUE       &quot; AND CONTEXT
        I_COMPARE_PARAMETERS = ABAP_FALSE
      EXCEPTIONS
        LOG_NOT_FOUND        = 1
        MSG_INCONSISTENT     = 2
        LOG_IS_FULL          = 3
        OTHERS               = 4.
  ELSE.
*   JUST SEPARATELY ADD THIS MESSAGE
    CALL FUNCTION &apos;BAL_LOG_MSG_ADD&apos;
      EXPORTING
        I_LOG_HANDLE     = MD_HANDLE
        I_S_MSG          = LS_MESSAGE
      EXCEPTIONS
        LOG_NOT_FOUND    = 1
        MSG_INCONSISTENT = 2
        LOG_IS_FULL      = 3
        OTHERS           = 4.
  ENDIF.
  IF SY-SUBRC &lt;&gt; 0.
    MAC_SYMSG_SEND_AS_TYPE &apos;A&apos;.
  ELSE.
    ES_MESSAGE = LS_MESSAGE.
  ENDIF.

** ALSO REFRESH SUPPORT MESSAGE LIST
*  MAC_REFRESH_SUPPORT_LIST.
ENDMETHOD.
METHOD ADD_ABEND.
DATA: _DETLEVEL TYPE BALLEVEL.

  IF ID_DETLEVEL IS INITIAL.
    _DETLEVEL = MD_LEVEL.
  ELSE.
    _DETLEVEL = ID_DETLEVEL.
  ENDIF.

  CALL METHOD ADD
    EXPORTING
*      IS_MESSAGE   =
      ID_MSGTY     = &apos;A&apos;
      ID_MSGID     = ID_MSGID
      ID_MSGNO     = ID_MSGNO
      ID_MSGV1     = ID_MSGV1
      ID_MSGV2     = ID_MSGV2
      ID_MSGV3     = ID_MSGV3
      ID_MSGV4     = ID_MSGV4
*      ID_MSGD1     =
*      ID_MSGD2     =
*      ID_MSGD3     =
*      ID_MSGD4     =
      ID_DETLEVEL  = _DETLEVEL
*      IF_CUMULATE  =
      ID_PROBCLASS = ID_PROBCLASS
*      ID_INDEX     =
*      ID_SUBLOG    =
*    IMPORTING
*      ES_MESSAGE   =
      .
ENDMETHOD.
METHOD ADD_ERROR.
DATA: _DETLEVEL TYPE BALLEVEL.

  IF ID_DETLEVEL IS INITIAL.
    _DETLEVEL = MD_LEVEL.
  ELSE.
    _DETLEVEL = ID_DETLEVEL.
  ENDIF.

  CALL METHOD ADD
    EXPORTING
*      IS_MESSAGE   =
      ID_MSGTY     = &apos;E&apos;
      ID_MSGID     = ID_MSGID
      ID_MSGNO     = ID_MSGNO
      ID_MSGV1     = ID_MSGV1
      ID_MSGV2     = ID_MSGV2
      ID_MSGV3     = ID_MSGV3
      ID_MSGV4     = ID_MSGV4
*      ID_MSGD1     =
*      ID_MSGD2     =
*      ID_MSGD3     =
*      ID_MSGD4     =
      ID_DETLEVEL  = _DETLEVEL
*      IF_CUMULATE  =
      ID_PROBCLASS = ID_PROBCLASS
*      ID_INDEX     =
*      ID_SUBLOG    =
*    IMPORTING
*      ES_MESSAGE   =
      .
ENDMETHOD.
METHOD ADD_EXCEPTION.
  DATA _DETLEVEL  TYPE BALLEVEL.
  DATA CX_TEXT    TYPE STRING.
  DATA O_REF      TYPE REF TO CL_ABAP_REFDESCR.
  DATA O_OBJ      TYPE REF TO CL_ABAP_CLASSDESCR.
  DATA PROG       TYPE SYREPID.
  DATA INCLUDE    TYPE SYREPID.
  DATA LINE       TYPE I.
  DATA CX_SRC_POS TYPE STRING.
  DATA O_ZL_CX    TYPE REF TO ZAPLINK_CX.

  IF ID_DETLEVEL IS INITIAL.
    _DETLEVEL = MD_LEVEL.
  ELSE.
    _DETLEVEL = ID_DETLEVEL.
  ENDIF.

  TRY.
      O_ZL_CX ?= EXCEPTION.
    CATCH CX_ROOT.
  ENDTRY.
  IF O_ZL_CX IS BOUND.
    CALL METHOD _ADD_ZL_CX
      EXPORTING
        EXCEPTION    = O_ZL_CX
        ID_DETLEVEL  = ID_DETLEVEL
        ID_PROBCLASS = ID_PROBCLASS.
    EXIT.
  ENDIF.

  IF EXCEPTION-&gt;PREVIOUS IS BOUND.
    ADD 1 TO _DETLEVEL.
    CALL METHOD ADD_EXCEPTION
      EXPORTING
        EXCEPTION    = EXCEPTION-&gt;PREVIOUS
        ID_DETLEVEL  = _DETLEVEL
        ID_PROBCLASS = ID_PROBCLASS.
    SUBTRACT 1 FROM _DETLEVEL.
  ENDIF.

  O_REF ?= CL_ABAP_CLASSDESCR=&gt;DESCRIBE_BY_DATA( P_DATA = EXCEPTION ).
  O_OBJ ?= GET_REF_TYPE( O_REF ).

  CALL METHOD EXCEPTION-&gt;GET_SOURCE_POSITION
    IMPORTING
      PROGRAM_NAME = PROG
      INCLUDE_NAME = INCLUDE
      SOURCE_LINE  = LINE.
  CX_SRC_POS = LINE.
  IF INCLUDE IS INITIAL.
    CONCATENATE PROG &apos; @&apos; CX_SRC_POS INTO CX_SRC_POS.
  ELSE.
    CONCATENATE INCLUDE &apos;(&apos; PROG &apos;) @&apos; CX_SRC_POS INTO CX_SRC_POS.
  ENDIF.

  CX_TEXT = EXCEPTION-&gt;IF_MESSAGE~GET_TEXT( ).
  IF 1 = 2. MESSAGE ID &apos;ZAPLINK_EASYXML&apos; TYPE &apos;E&apos; NUMBER 002 WITH ABAP_TRUE ABAP_TRUE ABAP_TRUE. ENDIF.
  CALL METHOD ADD_ERROR
    EXPORTING
      ID_MSGID     = &apos;ZAPLINK_EASYXML&apos;
      ID_MSGNO     = &apos;002&apos;
      ID_MSGV1     = O_OBJ-&gt;ABSOLUTE_NAME
      ID_MSGV2     = CX_TEXT
      ID_MSGV3     = CX_SRC_POS
*      ID_MSGV4     =
      ID_DETLEVEL  = _DETLEVEL
      ID_PROBCLASS = ID_PROBCLASS
      .

ENDMETHOD.
METHOD ADD_FROM_BAPI.
FIELD-SYMBOLS:
    &lt;LS_BAPIRET&gt; LIKE IS_BAPIRET.

* INIT RESULTS
  EF_ADD_ERROR   = ABAP_FALSE.
  EF_ADD_WARNING = ABAP_FALSE.

* BODY
* EVALUATE BAPI RETURN TABLE
  LOOP AT IT_BAPIRET ASSIGNING &lt;LS_BAPIRET&gt;.
    CALL METHOD ADD
      EXPORTING
        ID_MSGTY     = &lt;LS_BAPIRET&gt;-TYPE
        ID_MSGID     = &lt;LS_BAPIRET&gt;-ID
        ID_MSGNO     = &lt;LS_BAPIRET&gt;-NUMBER
        ID_MSGV1     = &lt;LS_BAPIRET&gt;-MESSAGE_V1
        ID_MSGV2     = &lt;LS_BAPIRET&gt;-MESSAGE_V2
        ID_MSGV3     = &lt;LS_BAPIRET&gt;-MESSAGE_V3
        ID_MSGV4     = &lt;LS_BAPIRET&gt;-MESSAGE_V4
        IF_CUMULATE  = IF_CUMULATE.
*       ID_TABNAME   = &lt;LS_BAPIRET&gt;-PARAMETER
*       ID_FIELDNAME = &lt;LS_BAPIRET&gt;-FIELD
*       ID_INDEX     = &lt;LS_BAPIRET&gt;-ROW

    IF ( &lt;LS_BAPIRET&gt;-TYPE = &apos;E&apos; ) OR
       ( &lt;LS_BAPIRET&gt;-TYPE = &apos;A&apos; ).
      EF_ADD_ERROR   = ABAP_TRUE.
    ELSEIF ( &lt;LS_BAPIRET&gt;-TYPE = &apos;W&apos; ).
      EF_ADD_WARNING = ABAP_TRUE.
    ENDIF.
  ENDLOOP.

* EVALUATE BAPI RETURN STRUCTURE
  IF IS_BAPIRET IS NOT INITIAL.
    CALL METHOD ADD
      EXPORTING
        ID_MSGTY     = IS_BAPIRET-TYPE
        ID_MSGID     = IS_BAPIRET-ID
        ID_MSGNO     = IS_BAPIRET-NUMBER
        ID_MSGV1     = IS_BAPIRET-MESSAGE_V1
        ID_MSGV2     = IS_BAPIRET-MESSAGE_V2
        ID_MSGV3     = IS_BAPIRET-MESSAGE_V3
        ID_MSGV4     = IS_BAPIRET-MESSAGE_V4
        IF_CUMULATE  = IF_CUMULATE.
*       ID_TABNAME   = IS_BAPIRET-PARAMETER
*       ID_FIELDNAME = IS_BAPIRET-FIELD
*       ID_INDEX     = IS_BAPIRET-ROW

    IF ( IS_BAPIRET-TYPE = &apos;E&apos; ) OR
       ( IS_BAPIRET-TYPE = &apos;A&apos; ).
      EF_ADD_ERROR   = ABAP_TRUE.
    ELSEIF ( IS_BAPIRET-TYPE = &apos;W&apos; ).
      EF_ADD_WARNING = ABAP_TRUE.
    ENDIF.
  ENDIF.
ENDMETHOD.
METHOD ADD_FROM_INSTANCE.
DATA:
    LT_MSGLIST            TYPE T_MSG,
    LS_MSGLIST            TYPE BAL_S_MSG,
    LD_NUM_MAX_LEVEL      TYPE INT1 VALUE MC_MAX_LEVEL,
    LD_NUM_DETLEVEL_DIFF  TYPE INT1,
    LD_NUM_DETLEVEL_OTHER TYPE INT1,
    LF_CUMULATE           TYPE ABAP_BOOL.

  FIELD-SYMBOLS:
    &lt;LS_MSGLIST&gt;          LIKE LINE OF LT_MSGLIST.

* PRECONDITION
  IF IO_MSGLIST IS NOT BOUND.
    MAC_INVALID_PRECONDITION.
  ENDIF.

* BODY
  LT_MSGLIST = IO_MSGLIST-&gt;GET_LIST( ).

  CHECK LT_MSGLIST IS NOT INITIAL.

* CUMULATION OF MESSAGES
  LF_CUMULATE = IF_CUMULATE.

* INCREMENT DETAIL LEVEL?
  IF IF_ADD_AS_SUBNODE = ABAP_TRUE.
    SET_DETAIL_LEVEL( ID_RELATIVE = 1 ).
    LF_CUMULATE = ABAP_FALSE.
  ENDIF.

  LOOP AT LT_MSGLIST ASSIGNING &lt;LS_MSGLIST&gt;.

    MOVE-CORRESPONDING &lt;LS_MSGLIST&gt; TO LS_MSGLIST.

*   CLEAR SOME FIELDS AS MESSAGES ARE &quot;NEW&quot;
    CLEAR:
      LS_MSGLIST-TIME_STMP,
      LS_MSGLIST-MSG_COUNT.

*   SET DETAIL LEVEL
    IF LS_MSGLIST-DETLEVEL NOT BETWEEN MC_MIN_LEVEL AND MC_MAX_LEVEL.
*     ADOPT ALWAYS CURRENT DETAIL LEVEL
      LS_MSGLIST-DETLEVEL = MD_LEVEL.
    ELSEIF MD_LEVEL = MC_MIN_LEVEL.
*     NOTHING TO DO: ADOPT THE DETAIL LEVEL FROM OTHER
    ELSE.
*     ADOPT THE MESSAGE WITH A &quot;DEEPER&quot; DETAIL LEVEL
      LD_NUM_DETLEVEL_DIFF  = MD_LEVEL - 1.
      LD_NUM_DETLEVEL_OTHER = LS_MSGLIST-DETLEVEL.
      ADD LD_NUM_DETLEVEL_DIFF TO LD_NUM_DETLEVEL_OTHER.

      IF LD_NUM_DETLEVEL_OTHER &lt;= LD_NUM_MAX_LEVEL.
        LS_MSGLIST-DETLEVEL = LD_NUM_DETLEVEL_OTHER.
      ELSE.
        LS_MSGLIST-DETLEVEL = MC_MAX_LEVEL.
      ENDIF.
    ENDIF.

*   ADD MESSAGE
    ADD( IS_MESSAGE  = LS_MSGLIST
         IF_CUMULATE = LF_CUMULATE ).

  ENDLOOP.

* DECREMENT DETAIL LEVEL?
  IF IF_ADD_AS_SUBNODE = ABAP_TRUE.
    SET_DETAIL_LEVEL( ID_RELATIVE = -1 ).
  ENDIF.
ENDMETHOD.
METHOD ADD_INFO.
DATA: _DETLEVEL TYPE BALLEVEL.

  IF ID_DETLEVEL IS INITIAL.
    _DETLEVEL = MD_LEVEL.
  ELSE.
    _DETLEVEL = ID_DETLEVEL.
  ENDIF.

  CALL METHOD ADD
    EXPORTING
*      IS_MESSAGE   =
      ID_MSGTY     = &apos;I&apos;
      ID_MSGID     = ID_MSGID
      ID_MSGNO     = ID_MSGNO
      ID_MSGV1     = ID_MSGV1
      ID_MSGV2     = ID_MSGV2
      ID_MSGV3     = ID_MSGV3
      ID_MSGV4     = ID_MSGV4
*      ID_MSGD1     =
*      ID_MSGD2     =
*      ID_MSGD3     =
*      ID_MSGD4     =
      ID_DETLEVEL  = _DETLEVEL
*      IF_CUMULATE  =
      ID_PROBCLASS = ID_PROBCLASS
*      ID_INDEX     =
*      ID_SUBLOG    =
*    IMPORTING
*      ES_MESSAGE   =
      .
ENDMETHOD.
METHOD ADD_SUCCESS.
DATA: _DETLEVEL TYPE BALLEVEL.

  IF ID_DETLEVEL IS INITIAL.
    _DETLEVEL = MD_LEVEL.
  ELSE.
    _DETLEVEL = ID_DETLEVEL.
  ENDIF.

  CALL METHOD ADD
    EXPORTING
*      IS_MESSAGE   =
      ID_MSGTY     = &apos;I&apos;
      ID_MSGID     = ID_MSGID
      ID_MSGNO     = ID_MSGNO
      ID_MSGV1     = ID_MSGV1
      ID_MSGV2     = ID_MSGV2
      ID_MSGV3     = ID_MSGV3
      ID_MSGV4     = ID_MSGV4
*      ID_MSGD1     =
*      ID_MSGD2     =
*      ID_MSGD3     =
*      ID_MSGD4     =
      ID_DETLEVEL  = _DETLEVEL
*      IF_CUMULATE  =
      ID_PROBCLASS = ID_PROBCLASS
*      ID_INDEX     =
*      ID_SUBLOG    =
*    IMPORTING
*      ES_MESSAGE   =
      .
ENDMETHOD.
METHOD ADD_SYMSG.
  DATA LS_SYMSG TYPE SYMSG.

  CHECK NOT SY-MSGID IS INITIAL AND
*        NOT ID_MSGTY IS INITIAL AND
        NOT SY-MSGNO IS INITIAL.
* BODY
* PASS LOCAL COPIES OF CURRENT SY-MSG*-VALUES
  LS_SYMSG-MSGTY = ID_MSGTY.
  LS_SYMSG-MSGID = SY-MSGID.
  LS_SYMSG-MSGNO = SY-MSGNO.
  LS_SYMSG-MSGV1 = SY-MSGV1.
  LS_SYMSG-MSGV2 = SY-MSGV2.
  LS_SYMSG-MSGV3 = SY-MSGV3.
  LS_SYMSG-MSGV4 = SY-MSGV4.

* ADD MESSAGE
  CALL METHOD ADD
    EXPORTING
      ID_MSGTY     = LS_SYMSG-MSGTY
      ID_MSGID     = LS_SYMSG-MSGID
      ID_MSGNO     = LS_SYMSG-MSGNO
      ID_MSGV1     = LS_SYMSG-MSGV1
      ID_MSGV2     = LS_SYMSG-MSGV2
      ID_MSGV3     = LS_SYMSG-MSGV3
      ID_MSGV4     = LS_SYMSG-MSGV4
      IF_CUMULATE  = IF_CUMULATE
      ID_DETLEVEL  = ID_DETLEVEL
      ID_PROBCLASS = ID_PROBCLASS
*      ID_TABNAME   = ID_TABNAME
*      ID_FIELDNAME = ID_FIELDNAME
*      ID_VALUE     = ID_VALUE
      ID_INDEX     = ID_INDEX
*      ID_INTRENO   = ID_INTRENO
*      ID_CUSTACT   = ID_CUSTACT
*      ID_CONTEXT   = ID_CONTEXT
    IMPORTING
      ES_MESSAGE   = ES_MESSAGE.
ENDMETHOD.
METHOD ADD_WARNING.
DATA: _DETLEVEL TYPE BALLEVEL.

  IF ID_DETLEVEL IS INITIAL.
    _DETLEVEL = MD_LEVEL.
  ELSE.
    _DETLEVEL = ID_DETLEVEL.
  ENDIF.

  CALL METHOD ADD
    EXPORTING
*      IS_MESSAGE   =
      ID_MSGTY     = &apos;I&apos;
      ID_MSGID     = ID_MSGID
      ID_MSGNO     = ID_MSGNO
      ID_MSGV1     = ID_MSGV1
      ID_MSGV2     = ID_MSGV2
      ID_MSGV3     = ID_MSGV3
      ID_MSGV4     = ID_MSGV4
*      ID_MSGD1     =
*      ID_MSGD2     =
*      ID_MSGD3     =
*      ID_MSGD4     =
      ID_DETLEVEL  = _DETLEVEL
*      IF_CUMULATE  =
      ID_PROBCLASS = ID_PROBCLASS
*      ID_INDEX     =
*      ID_SUBLOG    =
*    IMPORTING
*      ES_MESSAGE   =
      .
ENDMETHOD.
METHOD AS_CHAR.
* BODY
  CALL FUNCTION &apos;CONVERT_DATE_TO_EXTERNAL&apos;
    EXPORTING
      DATE_INTERNAL            = ID_DATE
    IMPORTING
      DATE_EXTERNAL            = RD_DATE
    EXCEPTIONS
      DATE_INTERNAL_IS_INVALID = 1
      OTHERS                   = 2.
  IF SY-SUBRC &lt;&gt; 0.
    CLEAR RD_DATE.
  ENDIF.
ENDMETHOD.
METHOD CHANGE_MSG_TYPE.
DATA:
    LT_LOG_HANDLE   TYPE BAL_T_LOGH,
    LT_MSG_HANDLE   TYPE BAL_T_MSGH,
    LS_MSG          TYPE BAL_S_MSG.

  FIELD-SYMBOLS:
    &lt;LS_MSG_HANDLE&gt; LIKE LINE OF LT_MSG_HANDLE.

* PRECONDITION
  IF ( ID_MSGTY_SRC NA &apos; AEISWX&apos; ) OR
     ( ID_MSGTY_TRG NA &apos;AEISWX&apos;  ).
    MAC_INVALID_PRECONDITION.
  ENDIF.

* BODY
* SOMETHING TO DO?
  CHECK ID_MSGTY_SRC &lt;&gt; ID_MSGTY_TRG.

* GET HANDLES OF MESSAGES
  INSERT MD_HANDLE INTO TABLE LT_LOG_HANDLE.

  CALL FUNCTION &apos;BAL_GLB_SEARCH_MSG&apos;
    EXPORTING
      I_T_LOG_HANDLE = LT_LOG_HANDLE
    IMPORTING
      E_T_MSG_HANDLE = LT_MSG_HANDLE
    EXCEPTIONS
      MSG_NOT_FOUND  = 1
      OTHERS         = 2.
  IF SY-SUBRC &lt;&gt; 0.
*   NO MESSAGE FOUND
    RETURN.
  ENDIF.

* GET MESSAGE DATA AND CHANGE
  LOOP AT LT_MSG_HANDLE ASSIGNING &lt;LS_MSG_HANDLE&gt;.

    CALL FUNCTION &apos;BAL_LOG_MSG_READ&apos;
      EXPORTING
        I_S_MSG_HANDLE = &lt;LS_MSG_HANDLE&gt;
      IMPORTING
        E_S_MSG        = LS_MSG
      EXCEPTIONS
        LOG_NOT_FOUND  = 1
        MSG_NOT_FOUND  = 2
        OTHERS         = 3.

    IF SY-SUBRC = 0.

      IF ( ID_MSGTY_SRC IS INITIAL     ) OR
         ( ID_MSGTY_SRC = LS_MSG-MSGTY ).

        LS_MSG-MSGTY = ID_MSGTY_TRG.
        CALL FUNCTION &apos;BAL_LOG_MSG_CHANGE&apos;
          EXPORTING
            I_S_MSG_HANDLE = &lt;LS_MSG_HANDLE&gt;
            I_S_MSG        = LS_MSG
          EXCEPTIONS
            OTHERS         = 1.
        IF SY-SUBRC = 0.
          ADD 1 TO RD_CHANGED.
        ENDIF.

      ENDIF.

    ENDIF.

  ENDLOOP.

** ALSO REFRESH SUPPORT MESSAGE LIST
*  MAC_REFRESH_SUPPORT_LIST.
ENDMETHOD.
METHOD CHECK_CUSTO.
DATA _COMMIT  TYPE FLAG.
  DATA OBJ      TYPE BALOBJ.
  DATA OBJ_T    TYPE BALOBJT.
  DATA SOBJ     TYPE BALSUB.
  DATA SOBJ_T   TYPE BALSUBT.

* CHECK BALOBJ
  OBJ-OBJECT = ID_OBJECT.
  SELECT SINGLE * INTO OBJ
    FROM BALOBJ
    WHERE OBJECT = OBJ-OBJECT.
  IF SY-SUBRC &lt;&gt; 0.
    INSERT BALOBJ FROM OBJ.
    OBJ_T-SPRAS = SY-LANGU.
    OBJ_T-OBJECT = OBJ-OBJECT.
    OBJ_T-OBJTXT = &apos;ENTRY AUTO CREATED BY ZSAPLINK_MSG_COLLECTOR&apos;(TXT).
    INSERT BALOBJT FROM OBJ_T.
    _COMMIT = ABAP_TRUE.
  ENDIF.

* CHECK BALSUB
  SOBJ-OBJECT = OBJ-OBJECT.
  SOBJ-SUBOBJECT = ID_SUBOBJECT.
  SELECT SINGLE * INTO SOBJ
    FROM BALSUB
    WHERE    OBJECT = SOBJ-OBJECT
      AND SUBOBJECT = SOBJ-SUBOBJECT.
  IF SY-SUBRC &lt;&gt; 0.
    INSERT BALSUB FROM SOBJ.
    SOBJ_T-SPRAS = SY-LANGU.
    SOBJ_T-OBJECT = SOBJ-OBJECT.
    SOBJ_T-SUBOBJECT = SOBJ-SUBOBJECT.
    SOBJ_T-SUBOBJTXT = &apos;ENTRY AUTO CREATED BY ZSAPLINK_MSG_COLLECTOR&apos;(TXT).
    INSERT BALSUBT FROM SOBJ_T.
    _COMMIT = ABAP_TRUE.
  ENDIF.

  IF NOT _COMMIT IS INITIAL.
    COMMIT WORK AND WAIT.
* RELOAD BAL CACHE
    CALL FUNCTION &apos;BAL_OBJECT_SELECT&apos;
      EXPORTING
        I_OBJECT                      = ID_OBJECT
*     IMPORTING
*       E_BALOBJ                      =
*       E_T_BALSUB                    =
*       E_OBJECT_HAS_SUBOBJECTS       =
     EXCEPTIONS
       OBJECT_NOT_FOUND              = 1
       OTHERS                        = 2
              .
    IF SY-SUBRC &lt;&gt; 0.
* IGNORE ERROR
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.
  ENDIF.
ENDMETHOD.
METHOD CLEAR.
* BODY
* DELETE ALL MESSAGES
  CALL FUNCTION &apos;BAL_LOG_MSG_DELETE_ALL&apos;
    EXPORTING
      I_LOG_HANDLE = MD_HANDLE
    EXCEPTIONS
      OTHERS       = 0.

* INITIALIZE DETAIL LEVEL
  MD_LEVEL = MC_MIN_LEVEL.

* ALSO DELETE SUPPORT MODE TABLES
  CLEAR:
    MD_SUP_COUNT,
    MT_SUP_MSG.
ENDMETHOD.
METHOD CONVERT_DATE_TO_STRING.
* LOCAL DATA
  DATA:
    LD_DATE     TYPE SYDATUM,
    LD_CHAR(10) TYPE C.

* ELIMINATE NULL DATES
  LD_DATE = ID_DATE.
  MAC_CLEAR_DATE_IF_INITIAL LD_DATE.

* CONVERT DATE
  LD_CHAR = AS_CHAR( LD_DATE ).

* SET &quot;CORRECT&quot; DATE &quot;00.00.0000&quot; FOR INITIAL DATES
  IF LD_CHAR IS INITIAL.
    LD_DATE = &apos;11111111&apos;.
    LD_CHAR = AS_CHAR( LD_DATE ).
    REPLACE &apos;1&apos; WITH &apos;0&apos; INTO LD_CHAR.
  ENDIF.

  ED_DATE_STRING = LD_CHAR.
ENDMETHOD.
METHOD COUNT.
DATA:
    LT_LOG_HANDLE TYPE BAL_T_LOGH,
    LT_MSG_HANDLE TYPE BAL_T_MSGH.

* BODY
* GET HANDLES OF MESSAGES
  INSERT MD_HANDLE INTO TABLE LT_LOG_HANDLE.

  CALL FUNCTION &apos;BAL_GLB_SEARCH_MSG&apos;
    EXPORTING
      I_T_LOG_HANDLE = LT_LOG_HANDLE
    IMPORTING
      E_T_MSG_HANDLE = LT_MSG_HANDLE
    EXCEPTIONS
      MSG_NOT_FOUND  = 1
      OTHERS         = 2.
  IF SY-SUBRC = 0.
    RD_COUNT = LINES( LT_MSG_HANDLE ).
  ELSE.
*   NO MESSAGE FOUND
    RD_COUNT = 0.
  ENDIF.
ENDMETHOD.
METHOD DELETE_MESSAGE.
DATA:
    LS_MSG_HANDLE TYPE BALMSGHNDL.

* BODY
  LS_MSG_HANDLE-LOG_HANDLE = MD_HANDLE.
  LS_MSG_HANDLE-MSGNUMBER  = ID_MSGNUMBER.

  CALL FUNCTION &apos;BAL_LOG_MSG_DELETE&apos;
    EXPORTING
      I_S_MSG_HANDLE = LS_MSG_HANDLE
    EXCEPTIONS
      MSG_NOT_FOUND  = 1
      LOG_NOT_FOUND  = 2
      OTHERS         = 3.
  IF SY-SUBRC &lt;&gt; 0.
    MAC_SYMSG_RAISE NOT_FOUND.
  ENDIF.

** ALSO REFRESH SUPPORT MESSAGE LIST
*  MAC_REFRESH_SUPPORT_LIST.
ENDMETHOD.
METHOD FREE.
* BODY
  IF MF_LOG_NOT_STORED = ABAP_FALSE.
    CALL FUNCTION &apos;BAL_LOG_REFRESH&apos;
    EXPORTING
      I_LOG_HANDLE = MD_HANDLE
    EXCEPTIONS
      OTHERS       = 0.
  ENDIF.

* CLEAR INSTANCE ATTRIBUTES
  CLEAR MD_HANDLE.
  CLEAR MS_LOG.
ENDMETHOD.
METHOD GET_FIRST_MESSAGE.
DATA:
    LT_LOG_HANDLE TYPE BAL_T_LOGH,
    LT_MSG_HANDLE TYPE BAL_T_MSGH,
    LS_MSG_FILTER TYPE BAL_S_MFIL,
    LD_MSG_HANDLE TYPE BALMSGHNDL,
    LS_MSG        TYPE BAL_S_MSG.

* INIT RESULTS
  CLEAR ES_MESSAGE.

* PRECONDITION
  IF ID_MSGTY NA &apos;IWEA&apos;.
    MAC_INVALID_PRECONDITION.
  ENDIF.

* BODY
* GET MESSAGE FILTER BY MESSAGE TYPE
  CALL METHOD GET_MSG_FILTER
    EXPORTING
      ID_MSGTY      = ID_MSGTY
      IF_OR_HIGHER  = IF_OR_HIGHER
    IMPORTING
      ES_MSG_FILTER = LS_MSG_FILTER.

* GET HANDLES OF MESSAGES
  INSERT MD_HANDLE INTO TABLE LT_LOG_HANDLE.

  CALL FUNCTION &apos;BAL_GLB_SEARCH_MSG&apos;
    EXPORTING
      I_T_LOG_HANDLE = LT_LOG_HANDLE
      I_S_MSG_FILTER = LS_MSG_FILTER
    IMPORTING
      E_T_MSG_HANDLE = LT_MSG_HANDLE
    EXCEPTIONS
      MSG_NOT_FOUND  = 1
      OTHERS         = 2.
  IF SY-SUBRC &lt;&gt; 0.
*   NO MESSAGE FOUND
    MAC_SYMSG_RAISE NOT_FOUND.
  ENDIF.

* GET DATA OF FIRST MESSAGE
  READ TABLE LT_MSG_HANDLE INDEX 1 INTO LD_MSG_HANDLE.
  CALL FUNCTION &apos;BAL_LOG_MSG_READ&apos;
    EXPORTING
      I_S_MSG_HANDLE = LD_MSG_HANDLE
    IMPORTING
      E_S_MSG        = LS_MSG
    EXCEPTIONS
      LOG_NOT_FOUND  = 1
      MSG_NOT_FOUND  = 2
      OTHERS         = 3.
  IF SY-SUBRC &lt;&gt; 0.
    MAC_SYMSG_RAISE NOT_FOUND.
  ENDIF.

  ES_MESSAGE = LS_MSG.
ENDMETHOD.
METHOD GET_HANDLE.
* BODY
  RD_HANDLE = MD_HANDLE.
ENDMETHOD.
METHOD GET_LAST_MESSAGE.
DATA:
    LT_LOG_HANDLE TYPE BAL_T_LOGH,
    LT_MSG_HANDLE TYPE BAL_T_MSGH,
    LS_MSG_FILTER TYPE BAL_S_MFIL,
    LD_MSG_HANDLE TYPE BALMSGHNDL,
    LS_MSG        TYPE BAL_S_MSG,
    LD_COUNT      TYPE I.

* INIT RESULTS
  CLEAR ES_MESSAGE.

* PRECONDITION
  IF ID_MSGTY NA &apos;IWEA&apos;.
    MAC_INVALID_PRECONDITION.
  ENDIF.

* BODY
* GET MESSAGE FILTER BY MESSAGE TYPE
  CALL METHOD GET_MSG_FILTER
    EXPORTING
      ID_MSGTY      = ID_MSGTY
      IF_OR_HIGHER  = IF_OR_HIGHER
    IMPORTING
      ES_MSG_FILTER = LS_MSG_FILTER.

* GET HANDLES OF MESSAGES
  INSERT MD_HANDLE INTO TABLE LT_LOG_HANDLE.

  CALL FUNCTION &apos;BAL_GLB_SEARCH_MSG&apos;
    EXPORTING
      I_T_LOG_HANDLE = LT_LOG_HANDLE
      I_S_MSG_FILTER = LS_MSG_FILTER
    IMPORTING
      E_T_MSG_HANDLE = LT_MSG_HANDLE
    EXCEPTIONS
      MSG_NOT_FOUND  = 1
      OTHERS         = 2.
  IF SY-SUBRC &lt;&gt; 0.
*   NO MESSAGE FOUND
    MAC_SYMSG_RAISE NOT_FOUND.
  ENDIF.

* GET DATA OF LAST MESSAGE
  LD_COUNT = LINES( LT_MSG_HANDLE ).
  READ TABLE LT_MSG_HANDLE INDEX LD_COUNT INTO LD_MSG_HANDLE.
  CALL FUNCTION &apos;BAL_LOG_MSG_READ&apos;
    EXPORTING
      I_S_MSG_HANDLE = LD_MSG_HANDLE
    IMPORTING
      E_S_MSG        = LS_MSG
    EXCEPTIONS
      LOG_NOT_FOUND  = 1
      MSG_NOT_FOUND  = 2
      OTHERS         = 3.
  IF SY-SUBRC &lt;&gt; 0.
    MAC_SYMSG_RAISE NOT_FOUND.
  ENDIF.

  ES_MESSAGE = LS_MSG.
ENDMETHOD.
METHOD GET_LIST.
DATA:
    LT_MSGLIST_X   TYPE T_MSG_X.

  FIELD-SYMBOLS:
    &lt;LS_MSGLIST_X&gt; LIKE LINE OF LT_MSGLIST_X.

* INIT RESULTS
  CLEAR ET_LIST.

* BODY
  CALL METHOD GET_LIST_X
    IMPORTING
      ET_LIST_X = LT_MSGLIST_X.

  LOOP AT LT_MSGLIST_X ASSIGNING &lt;LS_MSGLIST_X&gt;.
    APPEND &lt;LS_MSGLIST_X&gt;-MSG TO ET_LIST.
  ENDLOOP.
ENDMETHOD.
METHOD GET_LIST_AS_BAPIRET.
DATA:
    LT_MSGLIST_X  TYPE T_MSG_X,
    LS_LIST       LIKE LINE OF ET_LIST,
    LS_PAR        TYPE BAL_S_PAR,
    LD_BAPI_PAR   TYPE BAPIRET2-PARAMETER,
    LD_BAPI_FIELD TYPE BAPIRET2-FIELD,
    LD_BAPI_ROW   TYPE BAPIRET2-ROW.

  FIELD-SYMBOLS:
    &lt;LS_MSGLIST_X&gt; LIKE LINE OF LT_MSGLIST_X.

* INIT RESULTS
  CLEAR ET_LIST.

* BODY
* GET MESSAGES
  CALL METHOD GET_LIST_X
    IMPORTING
      ET_LIST_X = LT_MSGLIST_X.

  LOOP AT LT_MSGLIST_X ASSIGNING &lt;LS_MSGLIST_X&gt;.
*   ALSO TRY TO GET PARAMETERS
*   1. TABLE NAME
    READ TABLE &lt;LS_MSGLIST_X&gt;-PARAMS-T_PAR INTO LS_PAR
      WITH KEY PARNAME = &apos;TABNAME&apos;.
    IF SY-SUBRC = 0.
      LD_BAPI_PAR = LS_PAR-PARVALUE.
    ELSE.
      CLEAR LD_BAPI_PAR.
    ENDIF.

*   2. FIELD NAME
    READ TABLE &lt;LS_MSGLIST_X&gt;-PARAMS-T_PAR INTO LS_PAR
      WITH KEY PARNAME = &apos;FIELDNAME&apos;.
    IF SY-SUBRC = 0.
      LD_BAPI_FIELD = LS_PAR-PARVALUE.
    ELSE.
      CLEAR LD_BAPI_FIELD.
    ENDIF.

*   3. INDEX
    READ TABLE &lt;LS_MSGLIST_X&gt;-PARAMS-T_PAR INTO LS_PAR
      WITH KEY PARNAME = &apos;INDEX&apos;.
    IF SY-SUBRC = 0.
      LD_BAPI_ROW = LS_PAR-PARVALUE.
    ELSE.
      LD_BAPI_ROW = 0.
    ENDIF.

    CALL FUNCTION &apos;BALW_BAPIRETURN_GET2&apos;
      EXPORTING
        TYPE       = &lt;LS_MSGLIST_X&gt;-MSGTY
        CL         = &lt;LS_MSGLIST_X&gt;-MSGID
        NUMBER     = &lt;LS_MSGLIST_X&gt;-MSGNO
        PAR1       = &lt;LS_MSGLIST_X&gt;-MSGV1
        PAR2       = &lt;LS_MSGLIST_X&gt;-MSGV2
        PAR3       = &lt;LS_MSGLIST_X&gt;-MSGV3
        PAR4       = &lt;LS_MSGLIST_X&gt;-MSGV4
*       LOG_NO     = &apos; &apos;
*       LOG_MSG_NO = &apos; &apos;
        PARAMETER  = LD_BAPI_PAR
        ROW        = LD_BAPI_ROW
        FIELD      = LD_BAPI_FIELD
      IMPORTING
        RETURN     = LS_LIST.
    APPEND LS_LIST TO ET_LIST.
  ENDLOOP.
ENDMETHOD.
METHOD GET_LIST_X.
DATA:
    LT_LOG_HANDLE   TYPE BAL_T_LOGH,
    LT_MSG_HANDLE   TYPE BAL_T_MSGH,
    LS_MSG_FILTER   TYPE BAL_S_MFIL,
    LS_MSG          TYPE BAL_S_MSG,
    LS_LIST_X       LIKE LINE OF ET_LIST_X.

  FIELD-SYMBOLS:
    &lt;LS_MSG_HANDLE&gt; LIKE LINE OF LT_MSG_HANDLE.

* INIT RESULTS
  CLEAR ET_LIST_X.

* PRECONDITION
  IF ID_MSGTY NA &apos;IWEA&apos;.
    MAC_INVALID_PRECONDITION.
  ENDIF.

* BODY
* GET MESSAGE FILTER BY MESSAGE TYPE
  CALL METHOD GET_MSG_FILTER
    EXPORTING
      ID_MSGTY      = ID_MSGTY
      IF_OR_HIGHER  = ABAP_TRUE
    IMPORTING
      ES_MSG_FILTER = LS_MSG_FILTER.

* GET HANDLES OF MESSAGES
  INSERT MD_HANDLE INTO TABLE LT_LOG_HANDLE.

  CALL FUNCTION &apos;BAL_GLB_SEARCH_MSG&apos;
    EXPORTING
      I_T_LOG_HANDLE = LT_LOG_HANDLE
      I_S_MSG_FILTER = LS_MSG_FILTER
    IMPORTING
      E_T_MSG_HANDLE = LT_MSG_HANDLE
    EXCEPTIONS
      MSG_NOT_FOUND  = 1
      OTHERS         = 2.
  IF SY-SUBRC &lt;&gt; 0.
*   NO MESSAGE FOUND
    RETURN.
  ENDIF.

* GET MESSAGE DATA
  LOOP AT LT_MSG_HANDLE ASSIGNING &lt;LS_MSG_HANDLE&gt;.

    CALL FUNCTION &apos;BAL_LOG_MSG_READ&apos;
      EXPORTING
        I_S_MSG_HANDLE = &lt;LS_MSG_HANDLE&gt;
      IMPORTING
        E_S_MSG        = LS_MSG
      EXCEPTIONS
        LOG_NOT_FOUND  = 1
        MSG_NOT_FOUND  = 2
        OTHERS         = 3.
    IF SY-SUBRC = 0.
      LS_LIST_X-MSG       = LS_MSG.
      LS_LIST_X-MSGNUMBER = &lt;LS_MSG_HANDLE&gt;-MSGNUMBER.
      APPEND LS_LIST_X TO ET_LIST_X.
    ENDIF.

  ENDLOOP.
ENDMETHOD.
METHOD GET_MSG_FILTER.
DATA:
    LS_SO_MSGTY LIKE LINE OF ES_MSG_FILTER-MSGTY.

  DEFINE MAC_ADD_MSGTY.
    CLEAR LS_SO_MSGTY.
    LS_SO_MSGTY-SIGN   = &apos;I&apos;.
    LS_SO_MSGTY-OPTION = &apos;EQ&apos;.
    LS_SO_MSGTY-LOW    = &amp;1.
    APPEND LS_SO_MSGTY TO ES_MSG_FILTER-MSGTY.
  END-OF-DEFINITION.

* INIT RESULTS
  CLEAR ES_MSG_FILTER.

* PRECONDITION
  IF ID_MSGTY NA &apos;AEISWX&apos;.
    MAC_INVALID_PRECONDITION.
  ENDIF.

* BODY
* SOMETHING TO DO?
  IF ( ID_MSGTY     CA &apos;IS&apos;     ) AND
     ( IF_OR_HIGHER = ABAP_TRUE ).
    RETURN.
  ENDIF.

* SET FILTER BY MESSAGE TYPE
  MAC_ADD_MSGTY ID_MSGTY.

* ADD MESSAGE TYPE WITH SAME LEVEL
  CASE ID_MSGTY.
    WHEN &apos;I&apos;.     MAC_ADD_MSGTY &apos;S&apos;.
    WHEN &apos;S&apos;.     MAC_ADD_MSGTY &apos;I&apos;.
    WHEN &apos;A&apos;.     MAC_ADD_MSGTY &apos;X&apos;.
    WHEN &apos;X&apos;.     MAC_ADD_MSGTY &apos;A&apos;.
  ENDCASE.

* ADD MESSAGE TYPES WITH HIGHER LEVEL
  IF IF_OR_HIGHER = ABAP_TRUE.
    CASE ID_MSGTY.
      WHEN &apos;I&apos; OR &apos;S&apos;.
        MAC_ADD_MSGTY &apos;W&apos;.
        MAC_ADD_MSGTY &apos;E&apos;.
        MAC_ADD_MSGTY &apos;A&apos;.
        MAC_ADD_MSGTY &apos;X&apos;.

      WHEN &apos;W&apos;.
        MAC_ADD_MSGTY &apos;E&apos;.
        MAC_ADD_MSGTY &apos;A&apos;.
        MAC_ADD_MSGTY &apos;X&apos;.

      WHEN &apos;E&apos;.
        MAC_ADD_MSGTY &apos;A&apos;.
        MAC_ADD_MSGTY &apos;X&apos;.

    ENDCASE.
  ENDIF.
ENDMETHOD.
METHOD GET_REF_TYPE.
DATA O_REF      TYPE REF TO CL_ABAP_REFDESCR.

  IF TYPEDESC-&gt;KIND = CL_ABAP_DATADESCR=&gt;KIND_REF.
    O_REF ?= TYPEDESC.
    REF_TYPE = O_REF-&gt;GET_REFERENCED_TYPE( ).
  ELSE.
    REF_TYPE = TYPEDESC.
  ENDIF.
ENDMETHOD.
METHOD GET_STATISTICS.
* CLEAR RESULT
  CLEAR RS_STATISTICS.

* CALL LOG
  CALL FUNCTION &apos;BAL_LOG_HDR_READ&apos;
    EXPORTING
      I_LOG_HANDLE = MD_HANDLE
    IMPORTING
      E_STATISTICS = RS_STATISTICS
    EXCEPTIONS
      OTHERS       = 0.
ENDMETHOD.
METHOD GET_STATISTICS_AS_TE.
DATA:
    LS_STATISTICS   TYPE BAL_S_SCNT,
    LD_RESULT       TYPE STRING,
    LD_RESULT_CNT   TYPE STRING,
    LD_RESULT_CNT_E TYPE STRING,
    LD_RESULT_CNT_W TYPE STRING,
    LD_RESULT_CNT_I TYPE STRING.

* INIT RESULTS
  CLEAR ED_TEXT.

* BODY
  LS_STATISTICS = GET_STATISTICS( ).

* EVALUATE E- / W- / I-MESSAGES ONLY
  ADD LS_STATISTICS-MSG_CNT_A TO LS_STATISTICS-MSG_CNT_E.
  ADD LS_STATISTICS-MSG_CNT_S TO LS_STATISTICS-MSG_CNT_I.

* BUILD TEXT FOR EACH MESSAGE TYPE ONLY
  IF IF_OUTPUT_E_MESSAGES = ABAP_TRUE.
    IF LS_STATISTICS-MSG_CNT_E &gt; 1.
      LD_RESULT_CNT = LS_STATISTICS-MSG_CNT_E.
      LD_RESULT_CNT_E = TEXT-SE0.
      REPLACE &apos;&amp;1&apos; WITH LD_RESULT_CNT INTO LD_RESULT_CNT_E.
      CONDENSE LD_RESULT_CNT_E.
    ELSEIF LS_STATISTICS-MSG_CNT_E = 1.
      LD_RESULT_CNT_E = TEXT-SE1.
    ENDIF.
  ENDIF.

  IF IF_OUTPUT_W_MESSAGES = ABAP_TRUE.
    IF LS_STATISTICS-MSG_CNT_W &gt; 1.
      LD_RESULT_CNT = LS_STATISTICS-MSG_CNT_W.
      LD_RESULT_CNT_W = TEXT-SW0.
      REPLACE &apos;&amp;1&apos; IN LD_RESULT_CNT_W WITH LD_RESULT_CNT.
      CONDENSE LD_RESULT_CNT_W.
    ELSEIF LS_STATISTICS-MSG_CNT_W = 1.
      LD_RESULT_CNT_W = TEXT-SW1.
    ENDIF.
  ENDIF.

  IF IF_OUTPUT_I_MESSAGES = ABAP_TRUE.
    IF LS_STATISTICS-MSG_CNT_I &gt; 1.
      LD_RESULT_CNT = LS_STATISTICS-MSG_CNT_I.
      LD_RESULT_CNT_I = TEXT-SI0.
      REPLACE &apos;&amp;1&apos; WITH LD_RESULT_CNT INTO LD_RESULT_CNT_I.
      CONDENSE LD_RESULT_CNT_I.
    ELSEIF LS_STATISTICS-MSG_CNT_I = 1.
      LD_RESULT_CNT_I = TEXT-SI1.
    ENDIF.
  ENDIF.

* BUILD RESULTING TEXT
  IF LD_RESULT_CNT_E IS NOT INITIAL.
    LD_RESULT = LD_RESULT_CNT_E.
  ENDIF.

  IF LD_RESULT_CNT_W IS NOT INITIAL.
    IF LD_RESULT IS INITIAL.
      LD_RESULT = LD_RESULT_CNT_W.
    ELSEIF IF_OUTPUT_HIGHEST_ONLY = ABAP_FALSE.
      CONCATENATE LD_RESULT &apos;, &amp;1&apos;
             INTO LD_RESULT.
      REPLACE &apos;&amp;1&apos; IN LD_RESULT WITH LD_RESULT_CNT_W.
    ENDIF.
  ENDIF.

  IF LD_RESULT_CNT_I IS NOT INITIAL.
    IF LD_RESULT IS INITIAL.
      LD_RESULT = LD_RESULT_CNT_I.
    ELSEIF IF_OUTPUT_HIGHEST_ONLY = ABAP_FALSE.
      CONCATENATE LD_RESULT &apos;, &amp;1&apos;
             INTO LD_RESULT.
      REPLACE &apos;&amp;1&apos; IN LD_RESULT WITH LD_RESULT_CNT_I.
    ENDIF.
  ENDIF.

* SET RESULT
  ED_TEXT = LD_RESULT.
ENDMETHOD.
METHOD HAS_MESSAGES_OF_MSGT.
DATA:
    LS_STATISTICS TYPE BAL_S_SCNT,
    LD_MSG_COUNT  TYPE I.

* PRECONDITION
  IF ID_MSGTY NA &apos;IWEA&apos;.
    MAC_INVALID_PRECONDITION.
  ENDIF.

* BODY
  IF ( ID_MSGTY     = &apos;I&apos;       ) AND
     ( IF_OR_HIGHER = ABAP_TRUE ).

*   CORRESPONDS TO &quot;ALL MESSAGES&quot;
    IF IS_EMPTY( ) = ABAP_FALSE.
      RF_EXISTS = ABAP_TRUE.
    ENDIF.

  ELSE.

*   GET STATISTICS ABOUT MESSAGES
    LS_STATISTICS = GET_STATISTICS( ).
    LD_MSG_COUNT  = 0.

    CASE ID_MSGTY.
      WHEN &apos;I&apos;.
        LD_MSG_COUNT = LS_STATISTICS-MSG_CNT_I +
                       LS_STATISTICS-MSG_CNT_S.

      WHEN &apos;W&apos;.
        LD_MSG_COUNT = LS_STATISTICS-MSG_CNT_W.
        IF ( IF_OR_HIGHER = ABAP_TRUE ) AND ( LD_MSG_COUNT = 0 ).
          LD_MSG_COUNT = LS_STATISTICS-MSG_CNT_E +
                         LS_STATISTICS-MSG_CNT_A.
        ENDIF.

      WHEN &apos;E&apos;.
        LD_MSG_COUNT = LS_STATISTICS-MSG_CNT_E.
        IF ( IF_OR_HIGHER = ABAP_TRUE ) AND ( LD_MSG_COUNT = 0 ).
          LD_MSG_COUNT = LS_STATISTICS-MSG_CNT_A.
        ENDIF.

      WHEN &apos;A&apos;.
        LD_MSG_COUNT = LS_STATISTICS-MSG_CNT_A.

    ENDCASE.

*   CHECK MESSAGE COUNTER
    IF LD_MSG_COUNT &gt; 0.
      RF_EXISTS = ABAP_TRUE.
    ENDIF.

  ENDIF.
ENDMETHOD.
METHOD INIT.
DATA:
    LT_LOG_HEADER TYPE BALHDR_T,
    LS_LOG_HEADER TYPE BALHDR,
    LS_LOG_FILTER TYPE BAL_S_LFIL,
    LD_GUID       TYPE GUID_32.
*TYPE BU_AKTYP
*01    CREATE
*02    CHANGE
*03    DISPLAY
*04    MODIFY (DIRECT INPUT: CREATE/CHANGE)
*06    DELETE
*11    CREATE DEFAULTS
*12    CHANGE DEFAULTS
*13    DISPLAY DEFAULTS

  IF NOT AUTO_UPD_CUSTO IS INITIAL.
    CHECK_CUSTO( ID_OBJECT = ID_OBJECT
              ID_SUBOBJECT = ID_SUBOBJECT ).
  ENDIF.

* BODY
  IF ID_ACTIVITY = ACT_CREATE.                    &quot;CREATE

*   INITIALIZE APPLICATION LOG DATA
    MS_LOG-OBJECT     = ID_OBJECT.
    MS_LOG-SUBOBJECT  = ID_SUBOBJECT.
    MS_LOG-ALUSER     = SY-UNAME.
    MS_LOG-ALPROG     = SY-CPROG.
    MS_LOG-ALDATE_DEL = SY-DATUM + 30.      &quot;EXPIRATION IN 30 DAYS

*   SET EXTERNAL NUMBER
    IF ID_EXTNUMBER IS NOT INITIAL.
      MS_LOG-EXTNUMBER = ID_EXTNUMBER.
    ELSE.
      CALL FUNCTION &apos;GUID_CREATE&apos;
        IMPORTING
          EV_GUID_32 = LD_GUID.
      MS_LOG-EXTNUMBER = LD_GUID.
    ENDIF.

*   CREATE APPLICATION LOG
    CALL FUNCTION &apos;BAL_LOG_CREATE&apos;
      EXPORTING
        I_S_LOG                 = MS_LOG
      IMPORTING
        E_LOG_HANDLE            = MD_HANDLE
      EXCEPTIONS
        LOG_HEADER_INCONSISTENT = 1
        OTHERS                  = 2.
    IF SY-SUBRC &lt;&gt; 0.
      MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
              WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.

  ELSE.

*   FIND LOG HEADER
    CALL FUNCTION &apos;BAL_FILTER_CREATE&apos;
      EXPORTING
        I_OBJECT       = ID_OBJECT
        I_SUBOBJECT    = ID_SUBOBJECT
        I_EXTNUMBER    = ID_EXTNUMBER
      IMPORTING
        E_S_LOG_FILTER = LS_LOG_FILTER.

    CALL FUNCTION &apos;BAL_DB_SEARCH&apos;
      EXPORTING
        I_S_LOG_FILTER     = LS_LOG_FILTER
      IMPORTING
        E_T_LOG_HEADER     = LT_LOG_HEADER
      EXCEPTIONS
        LOG_NOT_FOUND      = 1
        NO_FILTER_CRITERIA = 2
        OTHERS             = 3.
    IF SY-SUBRC &lt;&gt; 0.
      MAC_SYMSG_RAISE ERROR.
    ENDIF.

*    IF LINES( LT_LOG_HEADER ) &gt; 1.
*      MESSAGE E105(RECABC)
*              RAISING ERROR.
*    ENDIF.

*   LOAD LOG
    CALL FUNCTION &apos;BAL_DB_LOAD&apos;
      EXPORTING
        I_T_LOG_HEADER                = LT_LOG_HEADER
*       I_DO_NOT_LOAD_MESSAGES        = &apos; &apos;
*       I_EXCEPTION_IF_ALREADY_LOADED =
*     IMPORTING
*       E_T_LOG_HANDLE                =
*       E_T_MSG_HANDLE                =
      EXCEPTIONS
        NO_LOGS_SPECIFIED             = 1
        LOG_NOT_FOUND                 = 2
        LOG_ALREADY_LOADED            = 3
        OTHERS                        = 4.
    IF SY-SUBRC &lt;&gt; 0.
      MAC_SYMSG_RAISE ERROR.
    ENDIF.

*   INITIALIZE ATTRIBUTES
    READ TABLE LT_LOG_HEADER INDEX 1 INTO LS_LOG_HEADER.
    MOVE-CORRESPONDING LS_LOG_HEADER TO MS_LOG.
    MD_HANDLE = LS_LOG_HEADER-LOG_HANDLE.

  ENDIF.

* SET INTERFACE ATTRIBUTE
  OBJECT = ID_OBJECT.
  SUBOBJECT = ID_SUBOBJECT.
  EXT_ID = MD_EXTNUMBER = MS_LOG-EXTNUMBER.

* INITIALIZE DETAIL LEVEL
  MD_LEVEL = MC_MIN_LEVEL.
ENDMETHOD.
METHOD INIT_BY_HANDLE.
DATA:
    LT_LOG_HANDLE TYPE BAL_T_LOGH,
    LF_LOAD_ERROR TYPE ABAP_BOOL.

* BODY
* LOAD LOG
  INSERT ID_HANDLE INTO TABLE LT_LOG_HANDLE.

* READ LOG FROM DB
  CALL FUNCTION &apos;BAL_DB_LOAD&apos;
    EXPORTING
      I_T_LOG_HANDLE = LT_LOG_HANDLE
    EXCEPTIONS
      NO_LOGS_SPECIFIED  = 1
      LOG_NOT_FOUND      = 2
      LOG_ALREADY_LOADED = 3
      OTHERS             = 4.
* IGNORE ERROR (MAYBE THE LOG IS NOT YET STORED)
  IF SY-SUBRC &lt;&gt; 0.
    LF_LOAD_ERROR = ABAP_TRUE.
  ENDIF.

* INITIALIZE ATTRIBUTES
  CALL FUNCTION &apos;BAL_LOG_HDR_READ&apos;
    EXPORTING
      I_LOG_HANDLE = ID_HANDLE
    IMPORTING
      E_S_LOG      = MS_LOG
    EXCEPTIONS
      OTHERS       = 1.
  IF SY-SUBRC &lt;&gt; 0.
    MAC_SYMSG_RAISE ERROR.
  ENDIF.

* IF LOAD ERROR =&gt; DO NOT DELETE LOG ( SEE METHOD FREE)
  IF LF_LOAD_ERROR = ABAP_TRUE.
    MF_LOG_NOT_STORED = ABAP_TRUE.
  ENDIF.

* INITIALIZE ATTRIBUTES
  MD_HANDLE    = ID_HANDLE.
  EXT_ID = MD_EXTNUMBER = MS_LOG-EXTNUMBER.
  MD_LEVEL     = MC_MIN_LEVEL.
ENDMETHOD.
METHOD INSERT.
DATA:
    LT_MSGLIST_X              TYPE T_MSG_X,
    LD_INSERT_INDEX           TYPE I,
    LD_DELETE_INDEX           TYPE I,
    LD_NUM_DETLEVEL_NEW       TYPE I,
    LD_NUM_DETLEVEL_NEXT      TYPE I,
    LD_NUM_DETLEVEL_DIFF      TYPE I,
    LD_NUM_DETLEVEL_FOLLOWING TYPE I.

  FIELD-SYMBOLS:
    &lt;LS_MSGLIST_X&gt;            LIKE LINE OF LT_MSGLIST_X.

* BODY
* ADOPT INDEX AS INSERTING POSITION
* (INDEX = 0 OR INDEX = 1 INSERTS THE NEW MESSAGE AS THE 1ST MESSAGE)
  IF ID_INSERT_INDEX &gt; 0.
    LD_INSERT_INDEX = ID_INSERT_INDEX.
  ELSE.
    LD_INSERT_INDEX = 1.
  ENDIF.

* GET ALL CURRENT MESSAGES
  CALL METHOD GET_LIST_X
    IMPORTING
      ET_LIST_X = LT_MSGLIST_X.

* INSERT NEW MESSAGE
  IF LD_INSERT_INDEX &gt; LINES( LT_MSGLIST_X ).

*   SIMPLY APPEND AS LAST MESSAGE
    CALL METHOD ADD
      EXPORTING
        IS_MESSAGE   = IS_MESSAGE
        ID_MSGTY     = ID_MSGTY
        ID_MSGID     = ID_MSGID
        ID_MSGNO     = ID_MSGNO
        ID_MSGV1     = ID_MSGV1
        ID_MSGV2     = ID_MSGV2
        ID_MSGV3     = ID_MSGV3
        ID_MSGV4     = ID_MSGV4
        ID_MSGD1     = ID_MSGD1
        ID_MSGD2     = ID_MSGD2
        ID_MSGD3     = ID_MSGD3
        ID_MSGD4     = ID_MSGD4
        ID_DETLEVEL  = ID_DETLEVEL
        ID_PROBCLASS = ID_PROBCLASS
*        ID_TABNAME   = ID_TABNAME
*        ID_FIELDNAME = ID_FIELDNAME
*        ID_VALUE     = ID_VALUE
        ID_INDEX     = ID_INDEX
*        ID_INTRENO   = ID_INTRENO
*        ID_CONTEXT   = ID_CONTEXT
      IMPORTING
        ES_MESSAGE   = ES_MESSAGE.

  ELSE.

*   INSERT MESSAGE WITH SPECIFIED INDEX

*   DELETE ALL FOLLOWING MESSAGES FROM MESSAGE LIST AND
*   HOLD ONLY THESE MESSAGES IN LT_MSGLIST_X
    IF LD_INSERT_INDEX &gt; 1.
      LD_DELETE_INDEX = LD_INSERT_INDEX - 1.
      DELETE LT_MSGLIST_X TO LD_DELETE_INDEX.

      LOOP AT LT_MSGLIST_X ASSIGNING &lt;LS_MSGLIST_X&gt;.
        CALL METHOD DELETE_MESSAGE
          EXPORTING
            ID_MSGNUMBER = &lt;LS_MSGLIST_X&gt;-MSGNUMBER
          EXCEPTIONS
            OTHERS       = 0.
      ENDLOOP.
    ELSE.
      CLEAR( ).
    ENDIF.

*   APPEND NEW MESSAGE TO TEMPORARILY REDUCED LIST
    CALL METHOD ADD
      EXPORTING
        IS_MESSAGE   = IS_MESSAGE
        ID_MSGTY     = ID_MSGTY
        ID_MSGID     = ID_MSGID
        ID_MSGNO     = ID_MSGNO
        ID_MSGV1     = ID_MSGV1
        ID_MSGV2     = ID_MSGV2
        ID_MSGV3     = ID_MSGV3
        ID_MSGV4     = ID_MSGV4
        ID_MSGD1     = ID_MSGD1
        ID_MSGD2     = ID_MSGD2
        ID_MSGD3     = ID_MSGD3
        ID_MSGD4     = ID_MSGD4
        ID_DETLEVEL  = ID_DETLEVEL
        ID_PROBCLASS = ID_PROBCLASS
*        ID_TABNAME   = ID_TABNAME
*        ID_FIELDNAME = ID_FIELDNAME
*        ID_VALUE     = ID_VALUE
        ID_INDEX     = ID_INDEX
*        ID_INTRENO   = ID_INTRENO
*        ID_CONTEXT   = ID_CONTEXT
      IMPORTING
        ES_MESSAGE   = ES_MESSAGE.

*   DETERMINE DETAIL LEVEL FOR SUBNODE
    IF IF_SET_FOLLOWING_AS_SUBNODE = ABAP_TRUE.
      READ TABLE LT_MSGLIST_X INDEX 1 ASSIGNING &lt;LS_MSGLIST_X&gt;.
      LD_NUM_DETLEVEL_NEXT = &lt;LS_MSGLIST_X&gt;-DETLEVEL.
      LD_NUM_DETLEVEL_NEW  = ES_MESSAGE-DETLEVEL.
      LD_NUM_DETLEVEL_DIFF = LD_NUM_DETLEVEL_NEW  -
                             LD_NUM_DETLEVEL_NEXT + 1.
    ENDIF.

*   APPEND DELETED MESSAGES
    LOOP AT LT_MSGLIST_X ASSIGNING &lt;LS_MSGLIST_X&gt;.

*     CLEAR SOME FIELDS AS MESSAGES ARE &quot;NEW&quot;
      CLEAR:
        &lt;LS_MSGLIST_X&gt;-TIME_STMP,
        &lt;LS_MSGLIST_X&gt;-MSG_COUNT.

*     ADOPT DETAIL LEVEL
      IF IF_SET_FOLLOWING_AS_SUBNODE = ABAP_TRUE.
        LD_NUM_DETLEVEL_FOLLOWING = &lt;LS_MSGLIST_X&gt;-DETLEVEL +
                                    LD_NUM_DETLEVEL_DIFF.
        IF LD_NUM_DETLEVEL_FOLLOWING &lt; 0.
          &lt;LS_MSGLIST_X&gt;-DETLEVEL = 0.
        ELSEIF LD_NUM_DETLEVEL_FOLLOWING &gt; MC_MAX_LEVEL.
          &lt;LS_MSGLIST_X&gt;-DETLEVEL = MC_MAX_LEVEL.
        ELSE.
          &lt;LS_MSGLIST_X&gt;-DETLEVEL = LD_NUM_DETLEVEL_FOLLOWING.
        ENDIF.
      ENDIF.

*     ADD MESSAGE
      CALL METHOD ADD( IS_MESSAGE = &lt;LS_MSGLIST_X&gt;-MSG ).

    ENDLOOP.

  ENDIF.
ENDMETHOD.
METHOD IS_DATE_INITIAL.
* PRECONDITION
  IF ( ID_DATE(1) &gt;= &apos;1&apos; ).
    RF_INITIAL = ABAP_FALSE.
    RETURN.
  ENDIF.

* BODY
  IF ( ID_DATE IS INITIAL    ) OR
     ( ID_DATE  = SPACE      ) OR
     ( ID_DATE  = &apos;00000000&apos; ).
    RF_INITIAL = ABAP_TRUE.
  ENDIF.
ENDMETHOD.
METHOD IS_EMPTY.
DATA:
    LT_LOG_HANDLE TYPE BAL_T_LOGH.

* BODY
* TRY TO GET HANDLES OF MESSAGES
  INSERT MD_HANDLE INTO TABLE LT_LOG_HANDLE.

  CALL FUNCTION &apos;BAL_GLB_SEARCH_MSG&apos;
    EXPORTING
      I_T_LOG_HANDLE = LT_LOG_HANDLE
    EXCEPTIONS
      MSG_NOT_FOUND  = 1
      OTHERS         = 2.
  IF SY-SUBRC &lt;&gt; 0.
*   NO MESSAGE FOUND
    RF_EMPTY = ABAP_TRUE.
  ENDIF.
ENDMETHOD.
METHOD NEW.
CREATE OBJECT OBJ.
ENDMETHOD.
METHOD RAISE_FIRST_MESSAGE.
DATA:
    LS_MSG TYPE BAL_S_MSG.

* BODY
  CALL METHOD GET_FIRST_MESSAGE
    EXPORTING
      ID_MSGTY     = ID_MSGTY
      IF_OR_HIGHER = IF_OR_HIGHER
    IMPORTING
      ES_MESSAGE   = LS_MSG
    EXCEPTIONS
      NOT_FOUND    = 1
      OTHERS       = 2.
  IF SY-SUBRC = 0.
    MESSAGE ID LS_MSG-MSGID TYPE LS_MSG-MSGTY NUMBER LS_MSG-MSGNO
            WITH LS_MSG-MSGV1 LS_MSG-MSGV2 LS_MSG-MSGV3 LS_MSG-MSGV4
            RAISING FIRST_MESSAGE.
  ENDIF.
ENDMETHOD.
METHOD RAISE_ON_ERROR.
DATA O_EXCEPTION TYPE REF TO ZAPLINK_CX.

  IF NOT HAS_MESSAGES_OF_MSGT( ID_MSGTY = &apos;E&apos; ) IS INITIAL.
* FATAL ERRORS OCCURS, CHECK BA LOG (SLG1) : &apos;&amp;1&apos; &apos;&amp;2&apos; &apos;&amp;3&apos;
    IF 1 = 2. MESSAGE ID &apos;ZAPLINK_PACKAGE&apos; TYPE &apos;E&apos; NUMBER 012 WITH SPACE SPACE SPACE. ENDIF.
    ADD_ABEND( ID_MSGID = &apos;ZAPLINK_PACKAGE&apos;
               ID_MSGNO = &apos;012&apos;
               ID_MSGV1 = OBJECT
               ID_MSGV2 = SUBOBJECT
               ID_MSGV3 = EXT_ID
*             ID_MSGV4 = ID_MSGV4
*               ID_DETLEVEL = &apos;1&apos;
*               ID_PROBCLASS = &apos;1&apos;
                ).

    O_EXCEPTION = ZAPLINK_CX=&gt;NEW_WITH_BALLOG( MESSAGE_COLLECTOR = ME ).

    RAISE EXCEPTION O_EXCEPTION.
  ENDIF.
ENDMETHOD.
METHOD SET_DETAIL_LEVEL.
DATA:
    LD_NUM_MIN_LEVEL    LIKE ID_RELATIVE,
    LD_NUM_MAX_LEVEL    LIKE ID_RELATIVE,
    LD_NUM_LEVEL_SIGNED LIKE ID_RELATIVE.

* PRECONDITION
  IF ( ID_ABSOLUTE IS NOT INITIAL ) AND
     ( ID_RELATIVE IS NOT INITIAL ).
    MAC_INVALID_PRECONDITION.
  ENDIF.

* BODY
  IF ID_ABSOLUTE IS NOT INITIAL.

*   SET LEVEL AS ABSOLUTE NUMBER
    IF ID_ABSOLUTE BETWEEN MC_MIN_LEVEL AND MC_MAX_LEVEL.
      MD_LEVEL = ID_ABSOLUTE.
    ENDIF.

  ELSEIF ID_RELATIVE IS NOT INITIAL .

*   SET LEVEL RELATIVE TO THE PREVIOUS ONE
    LD_NUM_MIN_LEVEL = MC_MIN_LEVEL.
    LD_NUM_MAX_LEVEL = MC_MAX_LEVEL.

    LD_NUM_LEVEL_SIGNED = MD_LEVEL.
    ADD ID_RELATIVE TO LD_NUM_LEVEL_SIGNED.

    IF LD_NUM_LEVEL_SIGNED &lt; LD_NUM_MIN_LEVEL.
      MD_LEVEL = MC_MIN_LEVEL.
    ELSEIF LD_NUM_LEVEL_SIGNED &gt; LD_NUM_MAX_LEVEL.
      MD_LEVEL = MC_MAX_LEVEL.
    ELSE.
      MD_LEVEL = LD_NUM_LEVEL_SIGNED.
    ENDIF.

  ENDIF.
ENDMETHOD.
METHOD SET_EXTNUMBER.
DATA:
    LS_LOG_TEMP LIKE MS_LOG.

* PRECONDITION
  CHECK ID_EXTNUMBER IS NOT INITIAL.

* BODY
  LS_LOG_TEMP           = MS_LOG.
  LS_LOG_TEMP-EXTNUMBER = ID_EXTNUMBER.

  CALL FUNCTION &apos;BAL_LOG_HDR_CHANGE&apos;
    EXPORTING
      I_LOG_HANDLE            = MD_HANDLE
      I_S_LOG                 = LS_LOG_TEMP
    EXCEPTIONS
      LOG_NOT_FOUND           = 1
      LOG_HEADER_INCONSISTENT = 2
      OTHERS                  = 3.
  IF SY-SUBRC &lt;&gt; 0.
*   IGNORE FAILURE
    RETURN.
  ENDIF.

  MS_LOG-EXTNUMBER = ID_EXTNUMBER.
  EXT_ID = MD_EXTNUMBER     = ID_EXTNUMBER.
ENDMETHOD.
METHOD STORE.
DATA:
    LT_LOG_HANDLE TYPE BAL_T_LOGH.

* BODY
  INSERT MD_HANDLE INTO TABLE LT_LOG_HANDLE.

  CALL FUNCTION &apos;BAL_DB_SAVE&apos;
    EXPORTING
*     I_CLIENT         = SY-MANDT
      I_IN_UPDATE_TASK = IF_IN_UPDATE_TASK
*     I_SAVE_ALL       = &apos; &apos;
      I_T_LOG_HANDLE   = LT_LOG_HANDLE
*   IMPORTING
*     E_NEW_LOGNUMBERS =
    EXCEPTIONS
      LOG_NOT_FOUND    = 1
      SAVE_NOT_ALLOWED = 2
      NUMBERING_ERROR  = 3
      OTHERS           = 4.
  IF SY-SUBRC &lt;&gt; 0.
    MAC_SYMSG_RAISE ERROR.
  ENDIF.
ENDMETHOD.
METHOD WRITE.
DATA LT_MESSAGES  TYPE T_MSG_X.
  DATA _MSG TYPE STRING.
  DATA _LIGHT TYPE ICON_D.
  FIELD-SYMBOLS:
    &lt;M&gt; LIKE LINE OF LT_MESSAGES.

* GET MESSAGES
  CALL METHOD GET_LIST_X
    IMPORTING
      ET_LIST_X = LT_MESSAGES.

  LOOP AT LT_MESSAGES ASSIGNING &lt;M&gt;.
    CASE &lt;M&gt;-MSGTY.
      WHEN &apos;X&apos;. _LIGHT = ICON_RED_XCIRCLE.
      WHEN &apos;A&apos;. _LIGHT = ICON_MESSAGE_CRITICAL_SMALL.
      WHEN &apos;E&apos;. _LIGHT = ICON_RED_LIGHT.
      WHEN &apos;W&apos;. _LIGHT = ICON_YELLOW_LIGHT.
      WHEN &apos;I&apos;. _LIGHT = ICON_LIGHT_OUT.
      WHEN &apos;S&apos;. _LIGHT = ICON_GREEN_LIGHT.
      WHEN OTHERS. _LIGHT = ICON_LIGHT_OUT.
    ENDCASE.
    MESSAGE ID &lt;M&gt;-MSGID TYPE &apos;I&apos; NUMBER &lt;M&gt;-MSGNO WITH &lt;M&gt;-MSGV1 &lt;M&gt;-MSGV2 &lt;M&gt;-MSGV3 &lt;M&gt;-MSGV4 INTO _MSG.
    WRITE:/ _OFFSET, _LIGHT AS ICON, _MSG.
  ENDLOOP.
ENDMETHOD.
METHOD _ADD_ZL_CX.
  DATA _DETLEVEL  TYPE BALLEVEL.
  DATA CX_TEXT    TYPE STRING.
  DATA O_REF      TYPE REF TO CL_ABAP_REFDESCR.
  DATA O_OBJ      TYPE REF TO CL_ABAP_CLASSDESCR.
  DATA PROG       TYPE SYREPID.
  DATA INCLUDE    TYPE SYREPID.
  DATA LINE       TYPE I.
  DATA CX_SRC_POS TYPE STRING.

  IF ID_DETLEVEL IS INITIAL.
    _DETLEVEL = MD_LEVEL.
  ELSE.
    _DETLEVEL = ID_DETLEVEL.
  ENDIF.

  IF EXCEPTION-&gt;PREV_CX IS BOUND.
    ADD 1 TO _DETLEVEL.
    CALL METHOD _ADD_ZL_CX
      EXPORTING
        EXCEPTION    = EXCEPTION-&gt;PREV_CX
        ID_DETLEVEL  = _DETLEVEL
        ID_PROBCLASS = ID_PROBCLASS.
    SUBTRACT 1 FROM _DETLEVEL.
  ENDIF.

  IF EXCEPTION-&gt;PREVIOUS IS BOUND.
    ADD 1 TO _DETLEVEL.
    CALL METHOD ADD_EXCEPTION
      EXPORTING
        EXCEPTION    = EXCEPTION-&gt;PREVIOUS
        ID_DETLEVEL  = _DETLEVEL
        ID_PROBCLASS = ID_PROBCLASS.
    SUBTRACT 1 FROM _DETLEVEL.
  ENDIF.

  O_REF ?= CL_ABAP_CLASSDESCR=&gt;DESCRIBE_BY_DATA( P_DATA = EXCEPTION ).
  O_OBJ ?= GET_REF_TYPE( O_REF ).

  CALL METHOD EXCEPTION-&gt;GET_SOURCE_POSITION
    IMPORTING
      PROGRAM_NAME = PROG
      INCLUDE_NAME = INCLUDE
      SOURCE_LINE  = LINE.
  CX_SRC_POS = LINE.
  IF INCLUDE IS INITIAL.
    CONCATENATE PROG &apos; @&apos; CX_SRC_POS INTO CX_SRC_POS.
  ELSE.
    CONCATENATE INCLUDE &apos;(&apos; PROG &apos;) @&apos; CX_SRC_POS INTO CX_SRC_POS.
  ENDIF.

  CX_TEXT = EXCEPTION-&gt;IF_MESSAGE~GET_TEXT( ).
  IF 1 = 2. MESSAGE ID &apos;ZAPLINK_EASYXML&apos; TYPE &apos;E&apos; NUMBER 002 WITH ABAP_TRUE ABAP_TRUE ABAP_TRUE. ENDIF.
  CALL METHOD ADD_ERROR
    EXPORTING
      ID_MSGID     = &apos;ZAPLINK_EASYXML&apos;
      ID_MSGNO     = &apos;002&apos;
      ID_MSGV1     = O_OBJ-&gt;ABSOLUTE_NAME
      ID_MSGV2     = CX_TEXT
      ID_MSGV3     = CX_SRC_POS
*      ID_MSGV4     =
      ID_DETLEVEL  = _DETLEVEL
      ID_PROBCLASS = ID_PROBCLASS
      .

  IF EXCEPTION-&gt;MESSAGES IS BOUND.
    CALL METHOD ADD_FROM_INSTANCE
      EXPORTING
        IO_MSGLIST        = EXCEPTION-&gt;MESSAGES
        IF_ADD_AS_SUBNODE = ABAP_TRUE
*      IF_CUMULATE       =
        .
  ENDIF.

ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_MESSAGE_COLLECTOR IMPLEMENTATION

CLASS ZAPLINK_EASYXML IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
DEFINE MAC_SYSERR_LOG.
    IF &amp;1 &lt;&gt; 0.
      IF NOT BAL_LOG IS BOUND. MESSAGE ID MSGID TYPE &apos;E&apos; NUMBER 000 WITH ABAP_TRUE ABAP_TRUE ABAP_TRUE. ENDIF.
      CRC = &amp;1.
      CALL METHOD BAL_LOG-&gt;ADD_ERROR
        EXPORTING
*          ID_MSGID     = MSGID
          ID_MSGNO     = &apos;000&apos;
          ID_MSGV1     = CRC
          ID_MSGV2     = &amp;2
          ID_MSGV3     = &amp;3
*          ID_MSGV4     =
*          ID_DETLEVEL  =
*          ID_PROBCLASS =
          .
    ENDIF.
END-OF-DEFINITION.
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD ADD_ANY.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DONE BY : TARYCK BENSIALI                   |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  DATA _DESC     TYPE REF TO CL_ABAP_TYPEDESCR.
  DATA STRING    TYPE STRING.
  DATA NODE      TYPE REF TO IF_IXML_ELEMENT.

  IF TYPEDESC IS BOUND.
    _DESC = TYPEDESC.
  ELSE.
    _DESC = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( P_DATA = ANY ).
  ENDIF.

  _DESC = GET_REF_TYPE( _DESC ).
  STACK_DESCR( _DESC ).
  CASE _DESC-&gt;KIND.
    WHEN CL_ABAP_DATADESCR=&gt;KIND_REF.
* UNEXPECTED =&gt; IGNORED
      MAC_SYSERR_LOG -1 &apos;CL_ABAP_DATADESCR=&gt;KIND_REF&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_ANY&apos;.
    WHEN CL_ABAP_DATADESCR=&gt;KIND_ELEM.
      STRING = ELEM_2_STRING( ANY = ANY
                        TYPE_DESC = _DESC ).
      IF NOT STRING IS INITIAL.
        IF NAME IS INITIAL.
          NODE = XML_NODE.
        ELSE.
          NODE = XMLDOC-&gt;CREATE_ELEMENT( NAME ).
        ENDIF.
        RC = NODE-&gt;SET_VALUE( STRING ).
        MAC_SYSERR_LOG RC &apos;SET_VALUE&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_ANY&apos;.
        XML_NODE-&gt;APPEND_CHILD( NODE ).
      ENDIF.
    WHEN CL_ABAP_DATADESCR=&gt;KIND_STRUCT.
      ADD_STRUCTURE(   XMLDOC = XMLDOC
                     XML_NODE = XML_NODE
                         NAME = NAME
                    STRUCTURE = ANY ).
    WHEN CL_ABAP_DATADESCR=&gt;KIND_TABLE.
      ADD_TABLE(   XMLDOC = XMLDOC
                 XML_NODE = XML_NODE
                     NAME = NAME
                    TABLE = ANY ).
    WHEN CL_ABAP_DATADESCR=&gt;KIND_CLASS.
      ADD_OBJECT(   XMLDOC = XMLDOC
                  XML_NODE = XML_NODE
                      NAME = NAME
                    OBJECT = ANY
                  TYPEDESC = _DESC ).
    WHEN CL_ABAP_DATADESCR=&gt;KIND_INTF.
* TO BE IGNORED
      STRING = _DESC-&gt;GET_RELATIVE_NAME( ).
      IF NOT BAL_LOG IS BOUND. MESSAGE ID MSGID TYPE &apos;E&apos; NUMBER 001 WITH ABAP_TRUE ABAP_TRUE. ENDIF.
      CALL METHOD BAL_LOG-&gt;ADD_WARNING
        EXPORTING
*          ID_MSGID     = MSGID
          ID_MSGNO     = &apos;001&apos;
          ID_MSGV1     = NAME
          ID_MSGV2     = STRING
*          ID_MSGV3     = &amp;3
*          ID_MSGV4     =
*          ID_DETLEVEL  =
*          ID_PROBCLASS =
          .
  ENDCASE.
  UNSTACK( ).
ENDMETHOD.
METHOD ADD_OBJECT.
  DATA O_REF     TYPE REF TO CL_ABAP_REFDESCR.
  DATA NODE      TYPE REF TO IF_IXML_ELEMENT.
  DATA O_OBJ     TYPE REF TO CL_ABAP_CLASSDESCR.
  DATA _TYPE     TYPE REF TO CL_ABAP_TYPEDESCR.
  DATA TYPEDESCR TYPE REF TO CL_ABAP_TYPEDESCR.
  DATA SVALUE    TYPE STRING.
  DATA SNAME     TYPE STRING.
  DATA ATTR_NAME TYPE STRING.
  DATA SELF_DONE TYPE FLAG.
  FIELD-SYMBOLS:
    &lt;D&gt; TYPE ANY,
    &lt;A&gt; LIKE LINE OF O_OBJ-&gt;ATTRIBUTES.

  IF NOT OBJECT IS BOUND. EXIT. ENDIF.

  IF TYPEDESC IS BOUND.
    O_OBJ ?= TYPEDESC.
  ELSE.
    O_OBJ ?= CL_ABAP_CLASSDESCR=&gt;DESCRIBE_BY_OBJECT_REF( P_OBJECT_REF = OBJECT ).
  ENDIF.
  IF O_OBJ-&gt;ABSOLUTE_NAME = &apos;\CLASS=OBJECT&apos;.
    O_OBJ ?= CL_ABAP_CLASSDESCR=&gt;DESCRIBE_BY_OBJECT_REF( P_OBJECT_REF = OBJECT ).
* REPLACE IN STACK &apos;\CLASS=OBJECT&apos; =&gt; &apos;\CLASS=XXXX&apos;
    UNSTACK( ).
    ATTR_NAME = O_OBJ-&gt;ABSOLUTE_NAME.
    STACK( ATTR_NAME ).
  ENDIF.

  IF NAME IS INITIAL.
    NODE = XML_NODE.
  ELSE.
    NODE = XMLDOC-&gt;CREATE_ELEMENT( NAME ).
  ENDIF.

* SET VALUE BEFORE ADDING NODE OR THEY WILL BE LOST
  READ TABLE O_OBJ-&gt;ATTRIBUTES TRANSPORTING NO FIELDS
       WITH KEY NAME = SELF_FIELDNAME.
  IF SY-SUBRC = 0.
    ASSIGN OBJECT-&gt;(SELF_FIELDNAME) TO &lt;D&gt;.
    IF SY-SUBRC &lt;&gt; 0.
*ERROR HANDLING
      MAC_SYSERR_LOG SY-SUBRC &apos;ASSIGN COMPONENT &lt;C&gt;-NAME OF STRUCTURE STRUCTURE&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_OBJECT&apos;.
    ELSE.
      TYPEDESCR = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( &lt;D&gt; ).
      TYPEDESCR = GET_REF_TYPE( TYPEDESCR ).
      CASE TYPEDESCR-&gt;KIND.
        WHEN CL_ABAP_DATADESCR=&gt;KIND_ELEM.
          SVALUE = ELEM_2_STRING( ANY = &lt;D&gt;
                            TYPE_DESC = TYPEDESCR ).
          IF SVALUE IS NOT INITIAL.
            RC = NODE-&gt;SET_VALUE( SVALUE ).
            MAC_SYSERR_LOG RC &apos;SET_VALUE&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;.
            IF RC = 0.
              SELF_DONE = ABAP_TRUE.
            ENDIF.
          ENDIF.
        WHEN OTHERS.
* SELF FIELD &apos;&amp;1&apos; OF STRUCTURE &amp;2 (&amp;3) MUST BE SIMPLE DATA TYPE, NOT &apos;&amp;4&apos;
          IF NOT BAL_LOG IS BOUND. MESSAGE ID MSGID TYPE &apos;E&apos; NUMBER 004 WITH ABAP_TRUE ABAP_TRUE ABAP_TRUE ABAP_TRUE. ENDIF.
          SVALUE = TYPEDESCR-&gt;GET_RELATIVE_NAME( ).
          CALL METHOD BAL_LOG-&gt;ADD_WARNING
            EXPORTING
*              ID_MSGID     = MSGID
              ID_MSGNO     = 004
              ID_MSGV1     = SELF_FIELDNAME
              ID_MSGV2     = NAME
              ID_MSGV3     = SVALUE
              ID_MSGV4     = TYPEDESCR-&gt;KIND
*              ID_DETLEVEL  =
*              ID_PROBCLASS =
              .
      ENDCASE.
    ENDIF.
  ENDIF.

  LOOP AT O_OBJ-&gt;ATTRIBUTES ASSIGNING &lt;A&gt;
    WHERE ( VISIBILITY = CL_ABAP_CLASSDESCR=&gt;PUBLIC OR
            VISIBILITY = CL_ABAP_CLASSDESCR=&gt;PROTECTED )
      AND IS_CONSTANT IS INITIAL
      AND ALIAS_FOR IS INITIAL
      AND IS_VIRTUAL IS INITIAL.

    ASSIGN OBJECT-&gt;(&lt;A&gt;-NAME) TO &lt;D&gt;.
    IF SY-SUBRC &lt;&gt; 0.
* ERROR HANDLING
      MAC_SYSERR_LOG SY-SUBRC &apos;ASSIGN OBJECT-&gt;(&lt;A&gt;-NAME)&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_OBJECT&apos;.
      CONTINUE.
    ENDIF.
    TYPEDESCR = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( &lt;D&gt; ).
    TYPEDESCR = GET_REF_TYPE( TYPEDESCR ).
    SNAME = &lt;A&gt;-NAME.
    CASE TYPEDESCR-&gt;KIND.
      WHEN CL_ABAP_DATADESCR=&gt;KIND_ELEM.
        SVALUE = ELEM_2_STRING( ANY = &lt;D&gt;
                          TYPE_DESC = TYPEDESCR ).
        IF SVALUE IS NOT INITIAL AND ( &lt;A&gt;-NAME &lt;&gt; SELF_FIELDNAME OR SELF_DONE &lt;&gt; ABAP_TRUE ).
          RC = NODE-&gt;SET_ATTRIBUTE( NAME = SNAME
                                   VALUE = SVALUE ).
          MAC_SYSERR_LOG RC &apos;SET_ATTRIBUTE&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_OBJECT&apos;.
        ENDIF.
      WHEN OTHERS.
        ATTR_NAME = &lt;A&gt;-NAME.
        STACK( ATTR_NAME ).
        ADD_ANY(   XMLDOC = XMLDOC
                 XML_NODE = NODE
                     NAME = ATTR_NAME
                      ANY = &lt;D&gt; ).
        UNSTACK( ).
    ENDCASE.
  ENDLOOP.

  IF NODE IS BOUND AND NOT NAME IS INITIAL.
    RC = XML_NODE-&gt;APPEND_CHILD( NODE ).
    MAC_SYSERR_LOG RC &apos;APPEND_CHILD&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_OBJECT&apos;.
  ENDIF.
ENDMETHOD.
METHOD ADD_STRUCTURE.
DATA NODE        TYPE REF TO IF_IXML_ELEMENT.
  DATA SNAME TYPE STRING.
  DATA SVALUE TYPE STRING.
  DATA STRUCTDESCR TYPE REF TO CL_ABAP_STRUCTDESCR.
  DATA TYPEDESCR   TYPE REF TO CL_ABAP_TYPEDESCR.
  FIELD-SYMBOLS:
    &lt;C&gt; LIKE LINE OF STRUCTDESCR-&gt;COMPONENTS.
  FIELD-SYMBOLS &lt;FIELDVALUE&gt; TYPE ANY.

  IF STRUCTURE IS INITIAL. EXIT. ENDIF.

  IF NAME IS INITIAL.
    NODE = XML_NODE.
  ELSE.
    NODE = XMLDOC-&gt;CREATE_ELEMENT( NAME ).
  ENDIF.

  STRUCTDESCR ?= CL_ABAP_STRUCTDESCR=&gt;DESCRIBE_BY_DATA( STRUCTURE ).
* SET VALUE BEFORE ADDING NODE OR THEY WILL BE LOST
  READ TABLE STRUCTDESCR-&gt;COMPONENTS TRANSPORTING NO FIELDS
       WITH KEY NAME = SELF_FIELDNAME.
  IF SY-SUBRC = 0.
    ASSIGN COMPONENT SELF_FIELDNAME OF STRUCTURE STRUCTURE TO &lt;FIELDVALUE&gt;.
    IF SY-SUBRC &lt;&gt; 0.
*ERROR HANDLING
      MAC_SYSERR_LOG SY-SUBRC &apos;ASSIGN COMPONENT &lt;C&gt;-NAME OF STRUCTURE STRUCTURE&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;.
    ELSE.
      TYPEDESCR = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( &lt;FIELDVALUE&gt; ).
      TYPEDESCR = GET_REF_TYPE( TYPEDESCR ).
      CASE TYPEDESCR-&gt;KIND.
        WHEN CL_ABAP_DATADESCR=&gt;KIND_ELEM.
          SVALUE = ELEM_2_STRING( ANY = &lt;FIELDVALUE&gt;
                            TYPE_DESC = TYPEDESCR ).
          IF SVALUE IS NOT INITIAL.
            RC = NODE-&gt;SET_VALUE( SVALUE ).
            MAC_SYSERR_LOG RC &apos;SET_VALUE&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;.
          ENDIF.
        WHEN OTHERS.
* SELF FIELD &apos;&amp;1&apos; OF STRUCTURE &amp;2 (&amp;3) MUST BE SIMPLE DATA TYPE, NOT &apos;&amp;4&apos;
          IF NOT BAL_LOG IS BOUND. MESSAGE ID MSGID TYPE &apos;E&apos; NUMBER 004 WITH ABAP_TRUE ABAP_TRUE ABAP_TRUE ABAP_TRUE. ENDIF.
          SVALUE = TYPEDESCR-&gt;GET_RELATIVE_NAME( ).
          CALL METHOD BAL_LOG-&gt;ADD_WARNING
            EXPORTING
*              ID_MSGID     = MSGID
              ID_MSGNO     = 004
              ID_MSGV1     = SELF_FIELDNAME
              ID_MSGV2     = NAME
              ID_MSGV3     = SVALUE
              ID_MSGV4     = TYPEDESCR-&gt;KIND
*              ID_DETLEVEL  =
*              ID_PROBCLASS =
              .
      ENDCASE.
    ENDIF.
  ENDIF.
  LOOP AT STRUCTDESCR-&gt;COMPONENTS ASSIGNING &lt;C&gt;.
    ASSIGN COMPONENT &lt;C&gt;-NAME OF STRUCTURE STRUCTURE TO &lt;FIELDVALUE&gt;.
    IF SY-SUBRC &lt;&gt; 0.
*ERROR HANDLING
      MAC_SYSERR_LOG SY-SUBRC &apos;ASSIGN COMPONENT &lt;C&gt;-NAME OF STRUCTURE STRUCTURE&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;.
      CONTINUE.
    ENDIF.
    TYPEDESCR = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( &lt;FIELDVALUE&gt; ).
    TYPEDESCR = GET_REF_TYPE( TYPEDESCR ).
    SNAME = &lt;C&gt;-NAME.
    CASE TYPEDESCR-&gt;KIND.
      WHEN CL_ABAP_DATADESCR=&gt;KIND_REF.
* EXCEPTION REF OF REF ?
        MAC_SYSERR_LOG -1 &apos;CL_ABAP_DATADESCR=&gt;KIND_REF&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;.
      WHEN CL_ABAP_DATADESCR=&gt;KIND_ELEM.
        SVALUE = ELEM_2_STRING( ANY = &lt;FIELDVALUE&gt;
                          TYPE_DESC = TYPEDESCR ).
        IF SVALUE IS NOT INITIAL AND &lt;C&gt;-NAME &lt;&gt; SELF_FIELDNAME.
          RC = NODE-&gt;SET_ATTRIBUTE( NAME = SNAME
                                   VALUE = SVALUE ).
          MAC_SYSERR_LOG RC &apos;SET_ATTRIBUTE&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;.
        ENDIF.
* CL_ABAP_DATADESCR=&gt;KIND_STRUCT CL_ABAP_DATADESCR=&gt;KIND_TABLE CL_ABAP_DATADESCR=&gt;KIND_CLASS CL_ABAP_DATADESCR=&gt;KIND_INTF.
      WHEN OTHERS.
        STACK( SNAME ).
        ADD_ANY( XMLDOC = XMLDOC
               XML_NODE = NODE
                   NAME = SNAME
                    ANY = &lt;FIELDVALUE&gt;
               TYPEDESC = TYPEDESCR ).
        UNSTACK( ).
    ENDCASE.
  ENDLOOP.

  IF NODE IS BOUND AND NOT NAME IS INITIAL.
    RC = XML_NODE-&gt;APPEND_CHILD( NODE ).
    MAC_SYSERR_LOG RC &apos;APPEND_CHILD&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_STRUCTURE&apos;.
  ENDIF.
ENDMETHOD.
METHOD ADD_TABLE.
DATA NODE        TYPE REF TO IF_IXML_ELEMENT.
  FIELD-SYMBOLS:
    &lt;L&gt; TYPE ANY.

  IF TABLE IS INITIAL. EXIT. ENDIF.

  IF NAME IS INITIAL.
    NODE = XML_NODE.
  ELSE.
    NODE = XMLDOC-&gt;CREATE_ELEMENT( NAME ).
  ENDIF.

  LOOP AT TABLE ASSIGNING &lt;L&gt;.
    ADD_ANY(   XMLDOC = XMLDOC
             XML_NODE = NODE
                 NAME = EN_LINE
                  ANY = &lt;L&gt; ).
  ENDLOOP.

  IF NODE IS BOUND AND NOT NAME IS INITIAL.
    RC = XML_NODE-&gt;APPEND_CHILD( NODE ).
    MAC_SYSERR_LOG RC &apos;APPEND_CHILD&apos; &apos;ZAPLINK_EASYXML-&gt;ADD_TABLE&apos;.
  ENDIF.
ENDMETHOD.
METHOD ANY2XML.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DONE BY : TARYCK BENSIALI                   |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  DATA XML_NODE  TYPE REF TO IF_IXML_ELEMENT.
  DATA _DESC     TYPE REF TO CL_ABAP_TYPEDESCR.
  DATA STRING    TYPE STRING.

  XMLDOC = IXML-&gt;CREATE_DOCUMENT( ).
  XML_NODE = XMLDOC-&gt;CREATE_ELEMENT( TYPE ). STACK( TYPE ).

  IF ATTRIBUTS IS SUPPLIED.
    _DESC = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( P_DATA = ATTRIBUTS ).
    _DESC = GET_REF_TYPE( _DESC ).
    STACK_DESCR( _DESC ).
    CASE _DESC-&gt;KIND.
      WHEN CL_ABAP_DATADESCR=&gt;KIND_REF.
* UNEXPECTED =&gt; IGNORED
        MAC_SYSERR_LOG -1 &apos;CL_ABAP_DATADESCR=&gt;KIND_REF&apos; &apos;ZAPLINK_EASYXML-&gt;ANY2XML&apos;.
      WHEN CL_ABAP_DATADESCR=&gt;KIND_STRUCT.
        ADD_STRUCTURE(   XMLDOC = XMLDOC
                       XML_NODE = XML_NODE
*                         NAME = NAME
                      STRUCTURE = ATTRIBUTS ).
        &quot; CL_ABAP_DATADESCR=&gt;KIND_ELEM.
        &quot; CL_ABAP_DATADESCR=&gt;KIND_TABLE.
        &quot; CL_ABAP_DATADESCR=&gt;KIND_CLASS.
      WHEN OTHERS. &quot; CL_ABAP_DATADESCR=&gt;KIND_INTF.
* TO BE IGNORED
        STRING = _DESC-&gt;GET_RELATIVE_NAME( ).
        MESSAGE ID MSGID TYPE &apos;X&apos; NUMBER 001 WITH STRING &apos;ATTRIBUTES&apos;.
    ENDCASE.
    UNSTACK( ).
  ENDIF.
*  IF NOT NAME IS INITIAL. XML_NODE-&gt;SET_ATTRIBUTE( NAME = TN_NAME VALUE = NAME ). ENDIF.
*  IF NOT VERSION IS INITIAL.
*    RC = XML_NODE-&gt;SET_ATTRIBUTE( NAME = TN_VERSION VALUE = VERSION ).
*    MAC_SYSERR_LOG RC &apos;SET_ATTRIBUTE&apos; &apos;ZAPLINK_EASYXML-&gt;ANY2XML&apos;.
*    IF RC &lt;&gt; 0.
*      EXIT.
*    ENDIF.
*  ENDIF.

  ADD_ANY( XMLDOC = XMLDOC
         XML_NODE = XML_NODE
*             NAME =
              ANY = ANY ).

  RC = XMLDOC-&gt;APPEND_CHILD( XML_NODE ).
  MAC_SYSERR_LOG RC &apos;APPEND_CHILD&apos; &apos;ZAPLINK_EASYXML-&gt;ANY2XML&apos;.

  IF BAL_LOG-&gt;HAS_MESSAGES_OF_MSGT( ID_MSGTY     = &apos;E&apos; ) IS INITIAL.
* SUCCESSFULL CONVERSION DATA TO XML.
    IF NOT BAL_LOG IS BOUND. MESSAGE ID MSGID TYPE &apos;S&apos; NUMBER 006. ENDIF.
    CALL METHOD BAL_LOG-&gt;ADD_SUCCESS
      EXPORTING
*          ID_MSGID     = MSGID
        ID_MSGNO     = &apos;006&apos;
*          ID_MSGV1     =
*          ID_MSGV2     =
*          ID_MSGV3     =
*          ID_MSGV4     =
*          ID_DETLEVEL  =
*          ID_PROBCLASS =
        .
  ENDIF.
  UNSTACK( ).
ENDMETHOD.
METHOD CLASS_CONSTRUCTOR.
DATA: OBJ TYPE BALOBJ.
  DATA: SOBJ TYPE BALSUB.
*&lt;?XML VERSION=&quot;1.0&quot; ENCODING=&quot;UTF-16&quot;?&gt;
*&lt;NUGGET NAME=&quot;BALLOG&quot;&gt;
* &lt;TABU TABNAME=&quot;BALOBJ&quot;&gt;
*  &lt;DATAROW OBJECT=&quot;ZSAPLINK&quot;/&gt;
* &lt;/TABU&gt;
* &lt;TABU TABNAME=&quot;BALOBJT&quot;&gt;
*  &lt;DATAROW SPRAS=&quot;D&quot; OBJECT=&quot;ZSAPLINK&quot; OBJTXT=&quot;SAP LINK - LOGS&quot;/&gt;
*  &lt;DATAROW SPRAS=&quot;E&quot; OBJECT=&quot;ZSAPLINK&quot; OBJTXT=&quot;SAP LINK - LOGS&quot;/&gt;
*  &lt;DATAROW SPRAS=&quot;F&quot; OBJECT=&quot;ZSAPLINK&quot; OBJTXT=&quot;SAP LINK - LOGS&quot;/&gt;
* &lt;/TABU&gt;
* &lt;TABU TABNAME=&quot;BALSUB&quot;&gt;
*  &lt;DATAROW OBJECT=&quot;ZSAPLINK&quot; SUBOBJECT=&quot;DEVC&quot;/&gt;
* &lt;/TABU&gt;
* &lt;TABU TABNAME=&quot;BALSUBT&quot;&gt;
*  &lt;DATAROW SPRAS=&quot;D&quot; OBJECT=&quot;ZSAPLINK&quot; SUBOBJECT=&quot;DEVC&quot; SUBOBJTXT=&quot;DEVLOPMENT CLASS&quot;/&gt;
*  &lt;DATAROW SPRAS=&quot;E&quot; OBJECT=&quot;ZSAPLINK&quot; SUBOBJECT=&quot;DEVC&quot; SUBOBJTXT=&quot;DEVLOPMENT CLASS&quot;/&gt;
*  &lt;DATAROW SPRAS=&quot;F&quot; OBJECT=&quot;ZSAPLINK&quot; SUBOBJECT=&quot;DEVC&quot; SUBOBJTXT=&quot;DEVLOPMENT CLASS&quot;/&gt;
* &lt;/TABU&gt;
*&lt;/NUGGET&gt;

* CHECK BALOBJ
  OBJ-OBJECT = &apos;ZAPLINK&apos;.
  SELECT SINGLE * INTO OBJ
    FROM BALOBJ
    WHERE OBJECT = OBJ-OBJECT.
  IF SY-SUBRC &lt;&gt; 0.
    INSERT BALOBJ FROM OBJ.
  ENDIF.

* CHECK BALSUB
  SOBJ-OBJECT = OBJ-OBJECT.
  SOBJ-SUBOBJECT = &apos;EASYXML&apos;.
  SELECT SINGLE * INTO SOBJ
    FROM BALSUB
    WHERE    OBJECT = SOBJ-OBJECT
      AND SUBOBJECT = SOBJ-SUBOBJECT.
  IF SY-SUBRC &lt;&gt; 0.
    INSERT BALSUB FROM SOBJ.
  ENDIF.
  IF SY-SUBRC &lt;&gt; 0.
    COMMIT WORK AND WAIT.
  ENDIF.
ENDMETHOD.
METHOD CONSTRUCTOR.
IXML = CL_IXML=&gt;CREATE( ).

  RESET( ).
ENDMETHOD.
METHOD ELEM_2_STRING.
  DATA _DESC     TYPE REF TO CL_ABAP_TYPEDESCR.
  DATA EXCEPTION TYPE REF TO CX_ROOT.
  DATA L_CONVIN  TYPE REF TO CL_ABAP_CONV_IN_CE.

  IF ANY IS INITIAL.
    EXIT.
  ENDIF.

  IF TYPE_DESC IS BOUND.
    _DESC = TYPE_DESC.
  ELSE.
    _DESC = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( P_DATA = ANY ).
  ENDIF.

  IF _DESC-&gt;KIND &lt;&gt; CL_ABAP_DATADESCR=&gt;KIND_ELEM. EXIT. ENDIF.

  CASE _DESC-&gt;TYPE_KIND.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_XSTRING
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_XSEQUENCE.
      TRY.
*          CALL FUNCTION &apos;ECATT_CONV_XSTRING_TO_STRING&apos;
          L_CONVIN = CL_ABAP_CONV_IN_CE=&gt;CREATE( ENCODING = &apos;UTF-8&apos;
                                                    INPUT = ANY ).
          CALL METHOD L_CONVIN-&gt;READ
            IMPORTING
              DATA = STRING.
        CATCH CX_ROOT INTO EXCEPTION.
          IF NOT BAL_LOG IS BOUND. RAISE EXCEPTION EXCEPTION. ENDIF.
          BAL_LOG-&gt;ADD_EXCEPTION( EXCEPTION = EXCEPTION ).
      ENDTRY.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_CHAR
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_CLIKE
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_DATE
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_TIME
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_STRING
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_CSEQUENCE
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_NUM
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_NUMERIC
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INT
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INT1
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INT2
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_FLOAT
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_PACKED
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_SIMPLE
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_HEX        &quot; CONVERT HEX TO STRING WORKS
        .
      TRY.
          STRING = ANY.
        CATCH CX_ROOT INTO EXCEPTION.
          IF NOT BAL_LOG IS BOUND. MESSAGE ID MSGID TYPE &apos;E&apos; NUMBER 002 WITH ABAP_TRUE ABAP_TRUE ABAP_TRUE. ENDIF.
          CALL METHOD BAL_LOG-&gt;ADD_ERROR
            EXPORTING
*             ID_MSGID     = MSGID
              ID_MSGNO     = &apos;002&apos;
              ID_MSGV1     = ANY
              ID_MSGV2     = STRING
*             ID_MSGV3     = &amp;3
*             ID_MSGV4     =
*             ID_DETLEVEL  =
*             ID_PROBCLASS =
              .
      ENDTRY.
    WHEN OTHERS.
* UNEXPECTED =&gt; DUMP
      MAC_SYSERR_LOG -1 &apos;WHEN OTHERS&apos; &apos;ZAPLINK_EASYXML-&gt;ELEM_2_STRING&apos;.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_CLASS
*      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_STRUCT1
*      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_STRUCT2
*      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_TABLE
*      .
*
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_ANY.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_DATA.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_DREF.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INTF.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_IREF.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_OREF.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_W.
  ENDCASE.
ENDMETHOD.
METHOD GET_ATTRIBUTS.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DONE BY : TARYCK BENSIALI                   |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  DATA ROOT_NODE   TYPE REF TO IF_IXML_ELEMENT.
  DATA _DESC     TYPE REF TO CL_ABAP_TYPEDESCR.
  DATA STRING    TYPE STRING.

  ROOT_NODE = XMLDOC-&gt;GET_ROOT_ELEMENT( ).

  IF ROOT_NODE IS BOUND.

    _DESC = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( P_DATA = ATTRIBUTS ).
    _DESC = GET_REF_TYPE( _DESC ).
    STACK_DESCR( _DESC ).
    CASE _DESC-&gt;KIND.
      WHEN CL_ABAP_DATADESCR=&gt;KIND_REF.
* UNEXPECTED =&gt; IGNORED
        MAC_SYSERR_LOG -1 &apos;CL_ABAP_DATADESCR=&gt;KIND_REF&apos; &apos;ZAPLINK_EASYXML-&gt;ANY2XML&apos;.
      WHEN CL_ABAP_DATADESCR=&gt;KIND_STRUCT.
        READ_STRUCTURE( EXPORTING
                         XML_NODE = ROOT_NODE
                         CHANGING
                        STRUCTURE = ATTRIBUTS ).
        &quot; CL_ABAP_DATADESCR=&gt;KIND_ELEM.
        &quot; CL_ABAP_DATADESCR=&gt;KIND_TABLE.
        &quot; CL_ABAP_DATADESCR=&gt;KIND_CLASS.
      WHEN OTHERS. &quot; CL_ABAP_DATADESCR=&gt;KIND_INTF.
* TO BE IGNORED
        STRING = _DESC-&gt;GET_RELATIVE_NAME( ).
        MESSAGE ID MSGID TYPE &apos;X&apos; NUMBER 001 WITH STRING &apos;ATTRIBUTES&apos;.
    ENDCASE.
    UNSTACK( ).
  ENDIF.
ENDMETHOD.
METHOD GET_REF_TYPE.
DATA O_REF      TYPE REF TO CL_ABAP_REFDESCR.

  IF TYPEDESC-&gt;KIND = CL_ABAP_DATADESCR=&gt;KIND_REF.
    O_REF ?= TYPEDESC.
    REF_TYPE = O_REF-&gt;GET_REFERENCED_TYPE( ).
  ELSE.
    REF_TYPE = TYPEDESC.
  ENDIF.
ENDMETHOD.
METHOD IS_SIMPLE_TYPE_KIND.
RESULT = &apos;?&apos;.  &quot; UNKNOW

  CASE TYPE_KIND.
*          WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_CLIKE.
*          WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_DATE.
*          WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_TIME.
*          WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_STRING.

*          WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INT.
*          WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INT1.
*          WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INT2.

*          WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_NUM.
*          WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_NUMERIC.

*          WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_FLOAT.
*          WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_PACKED.
*          WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_SIMPLE.

    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_CHAR
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_CLIKE
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_DATE
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_TIME
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_STRING
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_XSTRING
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_NUM
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_NUMERIC
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INT
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INT1
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INT2
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_FLOAT
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_PACKED
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_SIMPLE
        .
     RESULT = ABAP_TRUE.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_CLASS
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_STRUCT1
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_STRUCT2
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_TABLE
      .
     RESULT = ABAP_FALSE.

    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_ANY.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_CSEQUENCE.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_DATA.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_DREF.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_HEX.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INTF.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_IREF.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_OREF.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_W.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_XSEQUENCE.
  ENDCASE.
ENDMETHOD.
METHOD NODE2STRING.
DATA _IXML TYPE REF TO IF_IXML.
  DATA _STREAMFACTORY TYPE REF TO IF_IXML_STREAM_FACTORY.
  DATA _OUTPUTSTREAM TYPE REF TO IF_IXML_OSTREAM.
*  DATA _RENDERER TYPE REF TO IF_IXML_RENDERER.
  DATA _PRINTXMLDOC TYPE REF TO CL_XML_DOCUMENT.

  _IXML = CL_IXML=&gt;CREATE( ).
  _STREAMFACTORY = _IXML-&gt;CREATE_STREAM_FACTORY( ).
  _OUTPUTSTREAM = _STREAMFACTORY-&gt;CREATE_OSTREAM_CSTRING( STRING ).
  CALL METHOD XML_NODE-&gt;RENDER
    EXPORTING
      OSTREAM   = _OUTPUTSTREAM
*      RECURSIVE = &apos;X&apos;
      .
  CREATE OBJECT _PRINTXMLDOC.
  _PRINTXMLDOC-&gt;PARSE_STRING( STRING ).
ENDMETHOD.
METHOD READ_ANY.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DONE BY : TARYCK BENSIALI                   |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  DATA _DESC     TYPE REF TO CL_ABAP_TYPEDESCR.
  DATA STRING    TYPE STRING.
  DATA NAME      TYPE STRING.
  DATA OBJECT    TYPE REF TO OBJECT.

  IF TYPEDESC IS BOUND.
    _DESC = TYPEDESC.
  ELSE.
    _DESC = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( P_DATA = ANY ).
  ENDIF.

  _DESC = GET_REF_TYPE( _DESC ).
  STACK_DESCR( _DESC ).
  CASE _DESC-&gt;KIND.
    WHEN CL_ABAP_DATADESCR=&gt;KIND_REF.
* UNEXPECTED =&gt; IGNORED
      MAC_SYSERR_LOG -1 &apos;CL_ABAP_DATADESCR=&gt;KIND_REF&apos; &apos;ZAPLINK_EASYXML-&gt;READ_ANY&apos;.
    WHEN CL_ABAP_DATADESCR=&gt;KIND_ELEM.
*      STRING = XML_NODE-&gt;GET_ATTRIBUTE( NAME = TN_VALUE ).
      STRING = XML_NODE-&gt;GET_VALUE( ).
      STRING_2_ELEM( EXPORTING
                        STRING = STRING
                    TYPE_DESC = _DESC
                     CHANGING
                          ANY = ANY ).
    WHEN CL_ABAP_DATADESCR=&gt;KIND_STRUCT.
      READ_STRUCTURE( EXPORTING
                       XML_NODE = XML_NODE
                       CHANGING
                      STRUCTURE = ANY ).
    WHEN CL_ABAP_DATADESCR=&gt;KIND_TABLE.
      READ_TABLE( EXPORTING
                   XML_NODE = XML_NODE
                   CHANGING
                      TABLE = ANY ).
    WHEN CL_ABAP_DATADESCR=&gt;KIND_CLASS.
      OBJECT = ANY.
      READ_OBJECT( EXPORTING
                    XML_NODE = XML_NODE
                    TYPEDESC = _DESC
                    CHANGING
                      OBJECT = OBJECT ).
      ANY ?= OBJECT.
    WHEN CL_ABAP_DATADESCR=&gt;KIND_INTF.
* TO BE IGNORED
      STRING = _DESC-&gt;GET_RELATIVE_NAME( ).
      NAME = XML_NODE-&gt;GET_NAME( ).
      IF NOT BAL_LOG IS BOUND. MESSAGE ID MSGID TYPE &apos;E&apos; NUMBER 001 WITH SPACE SPACE. ENDIF.
      CALL METHOD BAL_LOG-&gt;ADD_WARNING
        EXPORTING
*          ID_MSGID     = MSGID
          ID_MSGNO     = &apos;001&apos;
          ID_MSGV1     = NAME
          ID_MSGV2     = STRING
*          ID_MSGV3     = &amp;3
*          ID_MSGV4     =
*          ID_DETLEVEL  =
*          ID_PROBCLASS =
          .
  ENDCASE.
  UNSTACK( ).
ENDMETHOD.
METHOD READ_OBJECT.
  DATA O_REF      TYPE REF TO CL_ABAP_REFDESCR.
  DATA ELEM       TYPE REF TO IF_IXML_ELEMENT.
  DATA NODE       TYPE REF TO IF_IXML_NODE.
  DATA O_OBJ      TYPE REF TO CL_ABAP_CLASSDESCR.
  DATA ITERATOR   TYPE REF TO IF_IXML_NODE_ITERATOR.
  DATA CHILDS     TYPE REF TO IF_IXML_NODE_LIST.
  DATA ATTRS      TYPE REF TO IF_IXML_NAMED_NODE_MAP.
  DATA DATA_TYPE  TYPE STRING.
  DATA ATTR_NAME  TYPE STRING.
  DATA NAME       TYPE STRING.
  DATA SVALUE     TYPE STRING.
  DATA TYPEDESCR  TYPE REF TO CL_ABAP_TYPEDESCR.
  DATA _CX        TYPE REF TO CX_ROOT.
  FIELD-SYMBOLS:
    &lt;D&gt; TYPE ANY.

  IF NOT OBJECT IS BOUND AND NOT TYPEDESC IS BOUND. EXIT. ENDIF.
  IF NOT OBJECT IS BOUND.
    DATA_TYPE = TYPEDESC-&gt;GET_RELATIVE_NAME( ).
    TRY.
        CREATE OBJECT OBJECT TYPE (DATA_TYPE).
      CATCH CX_ROOT INTO _CX.
        CALL METHOD BAL_LOG-&gt;ADD_EXCEPTION
          EXPORTING
            EXCEPTION    = _CX
*          ID_DETLEVEL  =
*          ID_PROBCLASS =
            .
        EXIT.
    ENDTRY.
  ENDIF.

  IF TYPEDESC IS BOUND.
    O_OBJ ?= TYPEDESC.
  ELSE.
    O_REF ?= CL_ABAP_CLASSDESCR=&gt;DESCRIBE_BY_DATA( P_DATA = OBJECT ).
    O_OBJ ?= GET_REF_TYPE( O_REF ).
  ENDIF.
  IF O_OBJ-&gt;ABSOLUTE_NAME = &apos;\CLASS=OBJECT&apos;.
    O_OBJ ?= CL_ABAP_CLASSDESCR=&gt;DESCRIBE_BY_OBJECT_REF( P_OBJECT_REF = OBJECT ).
* REPLACE IN STACK &apos;\CLASS=OBJECT&apos; =&gt; &apos;\CLASS=XXXX&apos;
    UNSTACK( ).
    ATTR_NAME = O_OBJ-&gt;ABSOLUTE_NAME.
    STACK( ATTR_NAME ).
  ENDIF.

* XML VALUE
  SVALUE = XML_NODE-&gt;GET_VALUE( ).
  IF NOT SVALUE IS INITIAL.
    ASSIGN OBJECT-&gt;(SELF_FIELDNAME) TO &lt;D&gt;.
    IF SY-SUBRC &lt;&gt; 0.
* ERROR TO RAISE
      MAC_SYSERR_LOG SY-SUBRC &apos;ASSIGN COMPONENT SELF_FIELDNAME OF STRUCTURE STRUCTURE (VALUE)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_OBJECT&apos;.
    ELSE.
* ATTRIBUTE ASSIGNED
      TYPEDESCR = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( &lt;D&gt; ).
      TYPEDESCR = GET_REF_TYPE( TYPEDESCR ).
      CASE TYPEDESCR-&gt;KIND.
        WHEN CL_ABAP_DATADESCR=&gt;KIND_REF.
* EXCEPTION REF OF REF ?
          MAC_SYSERR_LOG -1 &apos;CL_ABAP_DATADESCR=&gt;KIND_REF (VALUE)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_OBJECT&apos;.
        WHEN CL_ABAP_DATADESCR=&gt;KIND_ELEM.
          STRING_2_ELEM( EXPORTING
                            STRING = SVALUE
                        TYPE_DESC = TYPEDESCR
                         CHANGING
                              ANY = &lt;D&gt; ).
* CL_ABAP_DATADESCR=&gt;KIND_STRUCT CL_ABAP_DATADESCR=&gt;KIND_TABLE CL_ABAP_DATADESCR=&gt;KIND_CLASS CL_ABAP_DATADESCR=&gt;KIND_INTF.
        WHEN OTHERS.
          MAC_SYSERR_LOG -1 &apos;NOT CL_ABAP_DATADESCR=&gt;KIND_ELEM (VALUE)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_OBJECT&apos;.
      ENDCASE.
    ENDIF.
  ENDIF.

* XML ATTRIBUTS
  ATTRS = XML_NODE-&gt;GET_ATTRIBUTES( ).
  ITERATOR = ATTRS-&gt;CREATE_ITERATOR( ).
  NODE = ITERATOR-&gt;GET_NEXT( ).
  WHILE NODE IS BOUND.
    ATTR_NAME = NODE-&gt;GET_NAME( ).
    READ TABLE O_OBJ-&gt;ATTRIBUTES TRANSPORTING NO FIELDS WITH KEY NAME = ATTR_NAME.
    IF SY-SUBRC &lt;&gt; 0.
* COMPONENT NOT FOUND
      DATA_TYPE = O_OBJ-&gt;GET_RELATIVE_NAME( ).
      NAME = XML_NODE-&gt;GET_NAME( ).
      IF NOT BAL_LOG IS BOUND. MESSAGE ID MSGID TYPE &apos;E&apos; NUMBER 003 WITH ABAP_TRUE ABAP_TRUE ABAP_TRUE. ENDIF.
      CALL METHOD BAL_LOG-&gt;ADD_WARNING
        EXPORTING
*          ID_MSGID     = MSGID
          ID_MSGNO     = &apos;003&apos;
          ID_MSGV1     = ATTR_NAME
          ID_MSGV2     = NAME
          ID_MSGV3     = DATA_TYPE
*          ID_MSGV4     =
*          ID_DETLEVEL  =
*          ID_PROBCLASS =
          .
    ELSE.
      ASSIGN OBJECT-&gt;(ATTR_NAME) TO &lt;D&gt;.
      IF SY-SUBRC &lt;&gt; 0.
* ERROR TO RAISE
        MAC_SYSERR_LOG SY-SUBRC &apos;ASSIGN OBJECT-&gt;(ATTR_NAME) TO &lt;D&gt; (ATTRS)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;.
      ELSE.
* ATTRIBUTE ASSIGNED
        TYPEDESCR = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( &lt;D&gt; ).
        TYPEDESCR = GET_REF_TYPE( TYPEDESCR ).
        CASE TYPEDESCR-&gt;KIND.
          WHEN CL_ABAP_DATADESCR=&gt;KIND_REF.
* EXCEPTION REF OF REF ?
            MAC_SYSERR_LOG -1 &apos;CL_ABAP_DATADESCR=&gt;KIND_REF (ATTRS)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;.
          WHEN CL_ABAP_DATADESCR=&gt;KIND_ELEM.
*            SVALUE = XML_NODE-&gt;GET_ATTRIBUTE( NAME = ATTR_NAME ). &quot; EQUIVALENT TO =&gt;
            SVALUE = NODE-&gt;GET_VALUE( ).
            STRING_2_ELEM( EXPORTING
                              STRING = SVALUE
                          TYPE_DESC = TYPEDESCR
                           CHANGING
                                ANY = &lt;D&gt; ).
* CL_ABAP_DATADESCR=&gt;KIND_STRUCT CL_ABAP_DATADESCR=&gt;KIND_TABLE CL_ABAP_DATADESCR=&gt;KIND_CLASS CL_ABAP_DATADESCR=&gt;KIND_INTF.
          WHEN OTHERS.
            TRY.
                ELEM ?= NODE.
                STACK( ATTR_NAME ).
                READ_ANY( EXPORTING
                           XML_NODE = ELEM
                           TYPEDESC = TYPEDESCR
                           CHANGING
                                ANY = &lt;D&gt; ).
                UNSTACK( ).
              CATCH CX_ROOT INTO _CX.
                BAL_LOG-&gt;ADD_EXCEPTION( EXCEPTION = _CX ).
            ENDTRY.
        ENDCASE.
      ENDIF.
    ENDIF.
    NODE ?= ITERATOR-&gt;GET_NEXT( ).
  ENDWHILE.

* XML CHILDS
  CHILDS = XML_NODE-&gt;GET_CHILDREN( ).
  ITERATOR = CHILDS-&gt;CREATE_ITERATOR( ).
  NODE = ITERATOR-&gt;GET_NEXT( ).
  WHILE NODE IS NOT INITIAL.
    ATTR_NAME = NODE-&gt;GET_NAME( ).
    READ TABLE O_OBJ-&gt;ATTRIBUTES TRANSPORTING NO FIELDS WITH KEY NAME = ATTR_NAME.
    IF SY-SUBRC &lt;&gt; 0.
* ATTRIBUTES NOT FOUND
      DATA_TYPE = O_OBJ-&gt;GET_RELATIVE_NAME( ).
      NAME = XML_NODE-&gt;GET_NAME( ).
      IF NOT BAL_LOG IS BOUND. MESSAGE ID MSGID TYPE &apos;E&apos; NUMBER 003 WITH ABAP_TRUE ABAP_TRUE ABAP_TRUE. ENDIF.
      CALL METHOD BAL_LOG-&gt;ADD_WARNING
        EXPORTING
*          ID_MSGID     = MSGID
          ID_MSGNO     = &apos;003&apos;
          ID_MSGV1     = ATTR_NAME
          ID_MSGV2     = NAME
          ID_MSGV3     = DATA_TYPE
*          ID_MSGV4     =
*          ID_DETLEVEL  =
*          ID_PROBCLASS =
          .
    ELSE.
      ASSIGN OBJECT-&gt;(ATTR_NAME) TO &lt;D&gt;.
      IF SY-SUBRC &lt;&gt; 0.
* ERROR TO RAISE
        MAC_SYSERR_LOG SY-SUBRC &apos;ASSIGN OBJECT-&gt;(ATTR_NAME)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_OBJECT&apos;.
      ELSE.
* ATTRIBUTE ASSIGNED
        TYPEDESCR = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( &lt;D&gt; ).
        TYPEDESCR = GET_REF_TYPE( TYPEDESCR ).
        CASE TYPEDESCR-&gt;KIND.
*          WHEN CL_ABAP_DATADESCR=&gt;KIND_REF.
** EXCEPTION REF OF REF ?
*            MAC_SYSERR_LOG -1 &apos;CL_ABAP_DATADESCR=&gt;KIND_REF (ATTRS)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_OBJECT&apos;.
          WHEN CL_ABAP_DATADESCR=&gt;KIND_ELEM.
*            SVALUE = XML_NODE-&gt;GET_ATTRIBUTE( NAME = ATTR_NAME ). &quot; EQUIVALENT TO =&gt;
            SVALUE = NODE-&gt;GET_VALUE( ).
            STRING_2_ELEM( EXPORTING
                              STRING = SVALUE
                          TYPE_DESC = TYPEDESCR
                           CHANGING
                                ANY = &lt;D&gt; ).
* CL_ABAP_DATADESCR=&gt;KIND_STRUCT CL_ABAP_DATADESCR=&gt;KIND_TABLE CL_ABAP_DATADESCR=&gt;KIND_CLASS CL_ABAP_DATADESCR=&gt;KIND_INTF.
          WHEN OTHERS.
            TRY.
                ELEM ?= NODE.
                STACK( ATTR_NAME ).
                READ_ANY( EXPORTING
                           XML_NODE = ELEM
                           TYPEDESC = TYPEDESCR
                           CHANGING
                                ANY = &lt;D&gt; ).
                UNSTACK( ).
              CATCH CX_ROOT INTO _CX.
                BAL_LOG-&gt;ADD_EXCEPTION( EXCEPTION = _CX ).
            ENDTRY.
        ENDCASE.
      ENDIF.
    ENDIF.
    NODE = ITERATOR-&gt;GET_NEXT( ).
  ENDWHILE.
ENDMETHOD.
METHOD READ_STRUCTURE.
  DATA ELEM        TYPE REF TO IF_IXML_ELEMENT.
  DATA NODE        TYPE REF TO IF_IXML_NODE.
  DATA OBJECT      TYPE REF TO OBJECT.
  DATA STRUCTDESCR TYPE REF TO CL_ABAP_STRUCTDESCR.
  DATA TYPEDESCR   TYPE REF TO CL_ABAP_TYPEDESCR.
  DATA SVALUE      TYPE STRING.
  FIELD-SYMBOLS:
    &lt;D&gt; TYPE ANY,
    &lt;C&gt; LIKE LINE OF STRUCTDESCR-&gt;COMPONENTS.
  DATA ATTRS      TYPE REF TO IF_IXML_NAMED_NODE_MAP.
  DATA ITERATOR   TYPE REF TO IF_IXML_NODE_ITERATOR.
  DATA CHILDS     TYPE REF TO IF_IXML_NODE_LIST.
  DATA ATTR_NAME  TYPE STRING.
  DATA NAME       TYPE STRING.
  DATA DATA_TYPE  TYPE STRING.
  DATA EXCEPTION TYPE REF TO CX_ROOT.

* XML VALUE
  SVALUE = XML_NODE-&gt;GET_VALUE( ).
  IF NOT SVALUE IS INITIAL.
    ASSIGN COMPONENT SELF_FIELDNAME OF STRUCTURE STRUCTURE TO &lt;D&gt;.
    IF SY-SUBRC &lt;&gt; 0.
* ERROR TO RAISE
      MAC_SYSERR_LOG SY-SUBRC &apos;ASSIGN COMPONENT SELF_FIELDNAME OF STRUCTURE STRUCTURE (VALUE)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;.
    ELSE.
* ATTRIBUTE ASSIGNED
      TYPEDESCR = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( &lt;D&gt; ).
      TYPEDESCR = GET_REF_TYPE( TYPEDESCR ).
      CASE TYPEDESCR-&gt;KIND.
        WHEN CL_ABAP_DATADESCR=&gt;KIND_REF.
* EXCEPTION REF OF REF ?
          MAC_SYSERR_LOG -1 &apos;CL_ABAP_DATADESCR=&gt;KIND_REF (VALUE)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;.
        WHEN CL_ABAP_DATADESCR=&gt;KIND_ELEM.
          STRING_2_ELEM( EXPORTING
                            STRING = SVALUE
                        TYPE_DESC = TYPEDESCR
                         CHANGING
                              ANY = &lt;D&gt; ).
* CL_ABAP_DATADESCR=&gt;KIND_STRUCT CL_ABAP_DATADESCR=&gt;KIND_TABLE CL_ABAP_DATADESCR=&gt;KIND_CLASS CL_ABAP_DATADESCR=&gt;KIND_INTF.
        WHEN OTHERS.
          MAC_SYSERR_LOG -1 &apos;NOT CL_ABAP_DATADESCR=&gt;KIND_ELEM (VALUE)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;.
      ENDCASE.
    ENDIF.
  ENDIF.

* XML ATTRIBUTS
  STRUCTDESCR ?= CL_ABAP_STRUCTDESCR=&gt;DESCRIBE_BY_DATA( STRUCTURE ).
  ATTRS = XML_NODE-&gt;GET_ATTRIBUTES( ).
  ITERATOR = ATTRS-&gt;CREATE_ITERATOR( ).
  NODE = ITERATOR-&gt;GET_NEXT( ).
  WHILE NODE IS BOUND.
    ATTR_NAME = NODE-&gt;GET_NAME( ).
    READ TABLE STRUCTDESCR-&gt;COMPONENTS ASSIGNING &lt;C&gt; WITH KEY NAME = ATTR_NAME.
    IF SY-SUBRC &lt;&gt; 0.
* COMPONENT NOT FOUND
      DATA_TYPE = STRUCTDESCR-&gt;GET_RELATIVE_NAME( ).
      NAME = XML_NODE-&gt;GET_NAME( ).
      IF NOT BAL_LOG IS BOUND. MESSAGE ID MSGID TYPE &apos;E&apos; NUMBER 003 WITH ABAP_TRUE ABAP_TRUE ABAP_TRUE. ENDIF.
      CALL METHOD BAL_LOG-&gt;ADD_WARNING
        EXPORTING
*          ID_MSGID     = MSGID
          ID_MSGNO     = &apos;003&apos;
          ID_MSGV1     = ATTR_NAME
          ID_MSGV2     = NAME
          ID_MSGV3     = DATA_TYPE
*          ID_MSGV4     =
*          ID_DETLEVEL  =
*          ID_PROBCLASS =
          .
    ELSE.
      ASSIGN COMPONENT ATTR_NAME OF STRUCTURE STRUCTURE TO &lt;D&gt;.
      IF SY-SUBRC &lt;&gt; 0.
* ERROR TO RAISE
        MAC_SYSERR_LOG SY-SUBRC &apos;ASSIGN COMPONENT ATTR_NAME OF STRUCTURE STRUCTURE (ATTRS)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;.
      ELSE.
* ATTRIBUTE ASSIGNED
        TYPEDESCR = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( &lt;D&gt; ).
        TYPEDESCR = GET_REF_TYPE( TYPEDESCR ).
        CASE TYPEDESCR-&gt;KIND.
          WHEN CL_ABAP_DATADESCR=&gt;KIND_REF.
* EXCEPTION REF OF REF ?
            MAC_SYSERR_LOG -1 &apos;CL_ABAP_DATADESCR=&gt;KIND_REF (ATTRS)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;.
          WHEN CL_ABAP_DATADESCR=&gt;KIND_ELEM.
*            SVALUE = XML_NODE-&gt;GET_ATTRIBUTE( NAME = ATTR_NAME ). &quot; EQUIVALENT TO =&gt;
            SVALUE = NODE-&gt;GET_VALUE( ).
            STRING_2_ELEM( EXPORTING
                              STRING = SVALUE
                          TYPE_DESC = TYPEDESCR
                           CHANGING
                                ANY = &lt;D&gt; ).
* CL_ABAP_DATADESCR=&gt;KIND_STRUCT CL_ABAP_DATADESCR=&gt;KIND_TABLE CL_ABAP_DATADESCR=&gt;KIND_CLASS CL_ABAP_DATADESCR=&gt;KIND_INTF.
          WHEN OTHERS.
            TRY.
                ELEM ?= NODE.
                STACK( ATTR_NAME ).
                READ_ANY( EXPORTING
                           XML_NODE = ELEM
                           TYPEDESC = TYPEDESCR
                           CHANGING
                                ANY = &lt;D&gt; ).
                UNSTACK( ).
              CATCH CX_ROOT INTO EXCEPTION.
                BAL_LOG-&gt;ADD_EXCEPTION( EXCEPTION = EXCEPTION ).
            ENDTRY.
        ENDCASE.
      ENDIF.
    ENDIF.
    NODE ?= ITERATOR-&gt;GET_NEXT( ).
  ENDWHILE.

* XML CHILDS
  CHILDS = XML_NODE-&gt;GET_CHILDREN( ).
  ITERATOR = CHILDS-&gt;CREATE_ITERATOR( ).
*  NODE ?= ITERATOR-&gt;GET_NEXT( ).
  NODE = ITERATOR-&gt;GET_NEXT( ).
  WHILE NODE IS BOUND.
    ATTR_NAME = NODE-&gt;GET_NAME( ).
    READ TABLE STRUCTDESCR-&gt;COMPONENTS ASSIGNING &lt;C&gt; WITH KEY NAME = ATTR_NAME.
    IF SY-SUBRC &lt;&gt; 0.
* COMPONENT NOT FOUND
      DATA_TYPE = STRUCTDESCR-&gt;GET_RELATIVE_NAME( ).
      NAME = XML_NODE-&gt;GET_NAME( ).
      IF NOT BAL_LOG IS BOUND. MESSAGE ID MSGID TYPE &apos;E&apos; NUMBER 003 WITH ABAP_TRUE ABAP_TRUE ABAP_TRUE. ENDIF.
      CALL METHOD BAL_LOG-&gt;ADD_WARNING
        EXPORTING
*          ID_MSGID     = MSGID
          ID_MSGNO     = &apos;003&apos;
          ID_MSGV1     = ATTR_NAME
          ID_MSGV2     = NAME
          ID_MSGV3     = DATA_TYPE
*          ID_MSGV4     =
*          ID_DETLEVEL  =
*          ID_PROBCLASS =
          .
    ELSE.
      ASSIGN COMPONENT ATTR_NAME OF STRUCTURE STRUCTURE TO &lt;D&gt;.
      IF SY-SUBRC &lt;&gt; 0.
* ERROR TO RAISE
        MAC_SYSERR_LOG SY-SUBRC &apos;ASSIGN COMPONENT ATTR_NAME OF STRUCTURE STRUCTURE (CHILDS)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;.
      ELSE.
* ATTRIBUTE ASSIGNED
        TYPEDESCR = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( &lt;D&gt; ).
        TYPEDESCR = GET_REF_TYPE( TYPEDESCR ).
        CASE TYPEDESCR-&gt;KIND.
          WHEN CL_ABAP_DATADESCR=&gt;KIND_REF.
* EXCEPTION REF OF REF ?
            MAC_SYSERR_LOG -1 &apos;CL_ABAP_DATADESCR=&gt;KIND_REF (CHILDS)&apos; &apos;ZAPLINK_EASYXML-&gt;READ_STRUCTURE&apos;.
          WHEN CL_ABAP_DATADESCR=&gt;KIND_ELEM.
            SVALUE = NODE-&gt;GET_VALUE( ).
            STRING_2_ELEM( EXPORTING
                              STRING = SVALUE
                          TYPE_DESC = TYPEDESCR
                           CHANGING
                                ANY = &lt;D&gt; ).
* CL_ABAP_DATADESCR=&gt;KIND_STRUCT CL_ABAP_DATADESCR=&gt;KIND_TABLE CL_ABAP_DATADESCR=&gt;KIND_CLASS CL_ABAP_DATADESCR=&gt;KIND_INTF.
          WHEN OTHERS.
            ELEM ?= NODE.
            STACK( ATTR_NAME ).
            READ_ANY( EXPORTING
                       XML_NODE = ELEM
                       TYPEDESC = TYPEDESCR
                       CHANGING
                            ANY = &lt;D&gt; ).
            UNSTACK( ).
        ENDCASE.
      ENDIF.
    ENDIF.
    NODE ?= ITERATOR-&gt;GET_NEXT( ).
  ENDWHILE.
ENDMETHOD.
METHOD READ_TABLE.
DATA NODE       TYPE REF TO IF_IXML_ELEMENT.
  DATA ITERATOR   TYPE REF TO IF_IXML_NODE_ITERATOR.
  DATA CHILDS     TYPE REF TO IF_IXML_NODE_LIST.
  DATA DREF       TYPE REF TO DATA.
  FIELD-SYMBOLS:
    &lt;D&gt; TYPE ANY.

  CHILDS = XML_NODE-&gt;GET_CHILDREN( ).
  ITERATOR = CHILDS-&gt;CREATE_ITERATOR( ).
  NODE ?= ITERATOR-&gt;GET_NEXT( ).
  WHILE NODE IS NOT INITIAL.
    IF EN_LINE &lt;&gt; NODE-&gt;GET_NAME( ).
* UNEXPECTED NODE NAME
    ELSE.
*      TRY.
          CREATE DATA DREF LIKE LINE OF TABLE.
*        CATCH CX_ROOT.
*      ENDTRY.
      ASSIGN DREF-&gt;* TO &lt;D&gt;.
      IF SY-SUBRC &lt;&gt; 0.
* ASSIGN ERROR
        MAC_SYSERR_LOG SY-SUBRC &apos;ASSIGN DREF-&gt;*&apos; &apos;ZAPLINK_EASYXML-&gt;READ_TABLE&apos;.
      ELSE.
        READ_ANY( EXPORTING
                   XML_NODE = NODE
                   CHANGING
                        ANY = &lt;D&gt; ).
        INSERT &lt;D&gt; INTO TABLE TABLE.
        MAC_SYSERR_LOG SY-SUBRC &apos;INSERT &lt;D&gt; INTO TABLE TABLE.&apos; &apos;ZAPLINK_EASYXML-&gt;READ_TABLE&apos;.
      ENDIF.
    ENDIF.
    NODE ?= ITERATOR-&gt;GET_NEXT( ).
  ENDWHILE.
ENDMETHOD.
METHOD RESET.
DATA OBJECT TYPE BALOBJ_D.
  DATA SUBOBJECT  TYPE BALSUBOBJ.
  DATA EXT_ID TYPE BALNREXT.

  IF BAL_LOG IS BOUND.
    BAL_LOG-&gt;CLEAR( ).
    BAL_LOG-&gt;FREE( ).
  ELSE.
    CREATE OBJECT BAL_LOG.
    BAL_LOG-&gt;MSGID = MSGID.

    OBJECT = &apos;ZAPLINK&apos;.
    SUBOBJECT = &apos;EASYXML&apos;.
*  CONCATENATE SY-UNAME SY-DATUM SY-UZEIT INTO EXT_ID SEPARATED BY SPACE.
*01    CREATE
*02    CHANGE
*03    DISPLAY
*04    MODIFY (DIRECT INPUT: CREATE/CHANGE)
*06    DELETE
*11    CREATE DEFAULTS
*12    CHANGE DEFAULTS
*13    DISPLAY DEFAULTS
    CALL METHOD BAL_LOG-&gt;INIT
      EXPORTING
        ID_OBJECT      = OBJECT
        ID_SUBOBJECT   = SUBOBJECT
        ID_EXTNUMBER   = EXT_ID
        AUTO_UPD_CUSTO = ABAP_TRUE
        ID_ACTIVITY    = ZAPLINK_MESSAGE_COLLECTOR=&gt;ACT_CREATE
      EXCEPTIONS
        ERROR          = 1
        OTHERS         = 2.
    IF SY-SUBRC &lt;&gt; 0.
* IGNORE
    ELSE.
      BAL_LEVEL = 1.
    ENDIF.
  ENDIF.
ENDMETHOD.
METHOD STACK.
IF NOT ITEM IS INITIAL.
    INSERT ITEM INTO CONTEXT INDEX 1.
  ENDIF.
ENDMETHOD.
METHOD STACK_DESCR.
DATA NAME TYPE STRING.

  NAME = DESC-&gt;ABSOLUTE_NAME.

  STACK( NAME ).
ENDMETHOD.
METHOD STRING_2_ELEM.
  DATA _DESC     TYPE REF TO CL_ABAP_TYPEDESCR.
  DATA EXCEPTION TYPE REF TO CX_ROOT.

  IF STRING IS INITIAL. EXIT. ENDIF.

  IF TYPE_DESC IS BOUND.
    _DESC = TYPE_DESC.
  ELSE.
    _DESC = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_DATA( P_DATA = ANY ).
  ENDIF.

  IF _DESC-&gt;KIND &lt;&gt; CL_ABAP_DATADESCR=&gt;KIND_ELEM. EXIT. ENDIF.

  CASE _DESC-&gt;TYPE_KIND.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_XSTRING
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_XSEQUENCE.
      TRY.
          CALL FUNCTION &apos;ECATT_CONV_STRING_TO_XSTRING&apos;
            EXPORTING
              IM_STRING         = STRING
*             IM_ENCODING       = &apos;UTF-8&apos;
            IMPORTING
              EX_XSTRING        = ANY
*             EX_LEN            =
                    .
        CATCH CX_ROOT INTO EXCEPTION.
          IF NOT BAL_LOG IS BOUND. RAISE EXCEPTION EXCEPTION. ENDIF.
          BAL_LOG-&gt;ADD_EXCEPTION( EXCEPTION = EXCEPTION ).
      ENDTRY.
    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_CHAR
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_CLIKE
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_DATE
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_TIME
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_STRING
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_CSEQUENCE
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_NUM
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_NUMERIC
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INT
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INT1
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INT2
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_FLOAT
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_PACKED
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_SIMPLE
      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_HEX        &quot; CONVERT HEX TO STRING WORKS
        .
      TRY.
          ANY = STRING.
        CATCH CX_ROOT INTO EXCEPTION.
          IF NOT BAL_LOG IS BOUND. RAISE EXCEPTION EXCEPTION. ENDIF.
          BAL_LOG-&gt;ADD_EXCEPTION( EXCEPTION = EXCEPTION ).
      ENDTRY.
    WHEN OTHERS.
* UNEXPECTED =&gt; DUMP
      MAC_SYSERR_LOG -1 &apos;WHEN OTHERS&apos; &apos;ZAPLINK_EASYXML-&gt;STRING_2_ELEM&apos;.

*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_CLASS
*      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_STRUCT1
*      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_STRUCT2
*      OR CL_ABAP_TYPEDESCR=&gt;TYPEKIND_TABLE
*      .
*
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_ANY.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_DATA.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_DREF.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_HEX.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_INTF.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_IREF.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_OREF.
*    WHEN CL_ABAP_TYPEDESCR=&gt;TYPEKIND_W.
  ENDCASE.
ENDMETHOD.
METHOD UNSTACK.
IF NOT CONTEXT IS INITIAL.
    DELETE CONTEXT INDEX 1.
  ENDIF.
ENDMETHOD.
METHOD XML2ANY.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DONE BY : TARYCK BENSIALI                   |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  DATA ROOT_NODE   TYPE REF TO IF_IXML_ELEMENT.

  ROOT_NODE = XMLDOC-&gt;GET_ROOT_ELEMENT( ).

  IF ROOT_NODE IS BOUND.
    IF ATTRIBUTS IS SUPPLIED.
      CALL METHOD ME-&gt;GET_ATTRIBUTS
        EXPORTING
          XMLDOC    = XMLDOC
        CHANGING
          ATTRIBUTS = ATTRIBUTS.
    ENDIF.

    READ_ANY( EXPORTING
               XML_NODE = ROOT_NODE
               CHANGING
                    ANY = ANY ).
    IF BAL_LOG-&gt;HAS_MESSAGES_OF_MSGT( ID_MSGTY     = &apos;E&apos; ) IS INITIAL.
* SUCCESSFULL CONVERSION XML TO DATA.
      IF NOT BAL_LOG IS BOUND. MESSAGE ID MSGID TYPE &apos;S&apos; NUMBER 005. ENDIF.
      CALL METHOD BAL_LOG-&gt;ADD_SUCCESS
        EXPORTING
*          ID_MSGID     = MSGID
          ID_MSGNO     = &apos;005&apos;
*          ID_MSGV1     =
*          ID_MSGV2     =
*          ID_MSGV3     =
*          ID_MSGV4     =
*          ID_DETLEVEL  =
*          ID_PROBCLASS =
          .
    ENDIF.
  ENDIF.
ENDMETHOD.
METHOD _XML2ANY.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DONE BY : TARYCK BENSIALI                   |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  DATA ROOT_NODE   TYPE REF TO IF_IXML_ELEMENT.
  DATA _DOC        TYPE REF TO IF_IXML_DOCUMENT.

  TRY.
      _DOC ?= XML.
      ROOT_NODE = _DOC-&gt;GET_ROOT_ELEMENT( ).
    CATCH CX_SY_MOVE_CAST_ERROR.
    ROOT_NODE ?= XML.
  ENDTRY.

  IF ROOT_NODE IS BOUND.
    READ_ANY( EXPORTING
               XML_NODE = ROOT_NODE
               CHANGING
                    ANY = ANY ).
  ENDIF.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_EASYXML IMPLEMENTATION

CLASS ZAPLINK_LIST_ IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
ENDCLASS. &quot;ZAPLINK_LIST_ IMPLEMENTATION

CLASS ZAPLINK_CX_LIST IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MSG = MSG
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
.
 IF TEXTID IS INITIAL.
   ME-&gt;TEXTID = ZAPLINK_CX_LIST .
 ENDIF.
ME-&gt;NAME = NAME .
ME-&gt;TYPE = TYPE .
ME-&gt;CONNCLASS = CONNCLASS .
ME-&gt;SEL_ACTION = SEL_ACTION .
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_CX_LIST IMPLEMENTATION

CLASS ZAPLINK_CX_COMPONENT IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MSG = MSG
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
.
 IF TEXTID IS INITIAL.
   ME-&gt;TEXTID = ZAPLINK_CX_COMPONENT .
 ENDIF.
ME-&gt;NAME = NAME .
ME-&gt;TYPE = TYPE .
ME-&gt;CONNCLASS = CONNCLASS .
ME-&gt;OBJTYPE = OBJTYPE .
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_CX_COMPONENT IMPLEMENTATION

CLASS ZAPLINK_CX_CONNECTOR IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MSG = MSG
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
.
 IF TEXTID IS INITIAL.
   ME-&gt;TEXTID = ZAPLINK_CX_CONNECTOR .
 ENDIF.
ME-&gt;NAME = NAME .
ME-&gt;TYPE = TYPE .
ME-&gt;DEVCLASS = DEVCLASS .
ME-&gt;CONNCLASS = CONNCLASS .
ME-&gt;CONNUUID = CONNUUID .
ME-&gt;NODE_NAME = NODE_NAME .
ME-&gt;CONN_VER = CONN_VER .
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_CX_CONNECTOR IMPLEMENTATION

CLASS ZAPLINK_RAW IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS

*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES


*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD SET_COMPONENT.
  CHECK O_COMP IS BOUND.

  TYPE = O_COMP-&gt;GET_TYPE( ).
  NAME = O_COMP-&gt;GET_NAME( ).
  CONNECTOR = O_COMP-&gt;GET_CONNUUID( ).
  REFRESH_DIRECTORY( ).

ENDMETHOD.
METHOD CONSTRUCTOR.
  IF O_COMP IS BOUND.
    SET_COMPONENT( O_COMP ).
  ENDIF.
ENDMETHOD.
METHOD GET_COMPONENT.
  CREATE OBJECT O_COMP.

  O_COMP-&gt;SET_TYPE( TYPE ).
  O_COMP-&gt;SET_NAME( NAME ).
  O_COMP-&gt;SET_DEVCLASS( DEVCLASS ).
  O_COMP-&gt;SET_CONNUUID( CONNECTOR ).

ENDMETHOD.
METHOD GET_NAME.
  RESULT = NAME.
ENDMETHOD.
METHOD GET_TYPE.
  RESULT = TYPE.
ENDMETHOD.
METHOD SET_NAME.

  CHECK DATA &lt;&gt; NAME.
  NAME = DATA.
  REFRESH_DIRECTORY( ).

ENDMETHOD.
METHOD SET_TYPE.

  CHECK DATA &lt;&gt; TYPE.
  TYPE = DATA.
  REFRESH_DIRECTORY( ).

ENDMETHOD.
METHOD GET_DEVCLASS_OFF.
  RESULT = DIRECTORY-DEVCLASS.
ENDMETHOD.
METHOD SET_DEVCLASS_OFF.
  CHECK DATA &lt;&gt; DIRECTORY-DEVCLASS.
  DIRECTORY-DEVCLASS = DATA.
ENDMETHOD.
METHOD REFRESH_DIRECTORY.
  SELECT SINGLE *
    INTO CORRESPONDING FIELDS OF DIRECTORY
    FROM TADIR
    WHERE PGMID = &apos;R3TR&apos;
      AND OBJECT = TYPE
      AND OBJ_NAME = NAME.
*  IF NOT O_COMP-&gt;GET_DEVCLASS( ) IS INITIAL.
*    DIRECTORY-DEVCLASS = O_COMP-&gt;GET_DEVCLASS( ).
*  ENDIF.
  IF TYPE = &apos;DEVC&apos;. CLEAR DIRECTORY-DEVCLASS. ENDIF.
*  DEVCLASS = DIRECTORY-DEVCLASS.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_RAW IMPLEMENTATION

CLASS ZAPLINK_CONNECTORS IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD ADD_LOCAL_CONNECTOR.

  TRY.

      _ADD_CONNECTOR( CLASS = LOCAL_CLASS
                   DEVCLASS = LOCAL_DEVCLASS ).
      _UPDATE_DEF_CLASS( ).

    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.
ENDMETHOD.
METHOD CLASS_CONSTRUCTOR.
  TYPES:
    BEGIN OF T_CLASSLIST,
      CLASS TYPE SEOCLSNAME,
    END OF T_CLASSLIST.

  DATA CLASSLIST TYPE STANDARD TABLE OF T_CLASSLIST WITH DEFAULT KEY.
  DATA CONNECTOR TYPE TO_CONNECTOR.
  DATA TABLETYPELINE TYPE KO105.
  DATA _CONN LIKE LINE OF CONNECTOR_LIST.
  DATA _CLASS LIKE LINE OF _CONN-CLASSES.
  DATA _TYPES TYPE STANDARD TABLE OF KO100 WITH DEFAULT KEY.
  DATA _CONNECTORS TYPE REF TO CL_OO_IF_RELATIONS.
  FIELD-SYMBOLS:
    &lt;IM_CL&gt; LIKE LINE OF _CONNECTORS-&gt;IMPLEMENTING_CLASSES,
    &lt;S_CL&gt; LIKE LINE OF _CONNECTORS-&gt;SUBCLASSES.

* CREATE XML ENGINE
  XMLENGINE = CL_IXML=&gt;CREATE( ).

  CALL FUNCTION &apos;TR_OBJECT_TABLE&apos;
*   IMPORTING
*     WE_TABLE_LINES       =
    TABLES
      WT_OBJECT_TEXT       = _TYPES.
  SORT _TYPES BY OBJECT.
  DELETE ADJACENT DUPLICATES FROM _TYPES COMPARING OBJECT.
  SAPTYPES = _TYPES.

* INTERFACE USE
  CREATE OBJECT _CONNECTORS
    EXPORTING
      CLSNAME      = &apos;ZAPLINK_CONNECTOR&apos;
*      W_REFERENCES = SEOX_TRUE
*      W_IMPLEMENTINGS = SEOX_TRUE
*      W_COMPRISINGS = SEOX_TRUE
*      W_SUBCLASSES = SEOX_TRUE
    EXCEPTIONS
      NOT_EXISTING = 0    &quot; FOR INSTALLER IGNORE NOT EXISTING CLASS
      IS_CLASS     = 2
      OTHERS       = 3
      .
  IF SY-SUBRC &lt;&gt; 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
               WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.
  IF _CONNECTORS IS BOUND.
    LOOP AT _CONNECTORS-&gt;IMPLEMENTING_CLASSES ASSIGNING &lt;IM_CL&gt;
            WHERE EXPOSURE &lt;&gt; &apos;0&apos;   &quot; PRIVATE
              AND VERSION = &apos;1&apos;     &quot; ACTIVE
              AND STATE &lt;&gt; &apos;0&apos;      &quot; ONLY MODELED
              .

      TRY.

          _ADD_CONNECTOR( CLASS = &lt;IM_CL&gt;-CLSNAME ).

        CATCH CX_ROOT.
          CONTINUE.
      ENDTRY.

    ENDLOOP.

    LOOP AT _CONNECTORS-&gt;SUBCLASSES ASSIGNING &lt;S_CL&gt;
            WHERE STATE &lt;&gt; &apos;0&apos;      &quot; ONLY MODELED
              AND VERSION = &apos;1&apos;     &quot; ACTIVE
              .

      TRY.

          _ADD_CONNECTOR( CLASS = &lt;S_CL&gt;-CLSNAME ).

        CATCH CX_ROOT.
          CONTINUE.
      ENDTRY.

    ENDLOOP.

    _UPDATE_DEF_CLASS( ).
  ENDIF.
ENDMETHOD.
METHOD _ADD_CONNECTOR.
  DATA CONNECTOR TYPE REF TO ZAPLINK_CONNECTOR.
  DATA CX        TYPE REF TO CX_ROOT.
  DATA CX_COMP   TYPE REF TO ZAPLINK_CX_COMPONENT.
  DATA TABLETYPELINE TYPE KO105.
  DATA _CONN     LIKE LINE OF CONNECTOR_LIST.
  DATA _CLASS    LIKE LINE OF _CONN-CLASSES.
  DATA THE_CLASS LIKE LINE OF _CLASSES.
  DATA _VALUE    LIKE LINE OF VALUE_TABLE.

  FIELD-SYMBOLS:
    &lt;CL&gt; LIKE LINE OF _CLASSES,
    &lt;C&gt;  LIKE LINE OF CONNECTOR_LIST,
    &lt;ST&gt; LIKE LINE OF SAPTYPES,
    &lt;T&gt;  LIKE LINE OF CONNECTOR-&gt;SUPPORTED_TYPES.

* TRY TO BUILD CLASS
  TRY.

      CREATE OBJECT CONNECTOR TYPE (CLASS).

    CATCH CX_ROOT INTO CX.
      CREATE OBJECT CX_COMP
        EXPORTING
          TEXTID   = ZAPLINK_CX_COMPONENT=&gt;SYSTEM_ERROR
          PREVIOUS = CX.
      CX_COMP-&gt;UPDATE( ).
      RAISE EXCEPTION CX_COMP.
  ENDTRY.

  THE_CLASS-UUID = CONNECTOR-&gt;UUID.
* CHECK SAME CLASS ALREADY LOADED
  READ TABLE _CLASSES ASSIGNING &lt;CL&gt;
             WITH TABLE KEY UUID = THE_CLASS-UUID.
  IF SY-SUBRC = 0.
    IF NOT ( &lt;CL&gt;-DEVCLASS &lt;&gt; LOCAL_DEVCLASS AND DEVCLASS = LOCAL_DEVCLASS ).
      RAISE EXCEPTION TYPE ZAPLINK_CX_COMPONENT EXPORTING
                      TEXTID = ZAPLINK_CX_COMPONENT=&gt;TWICE_CLASS
                   CONNCLASS = CLASS.
    ELSE.
* OK : OVERIDE GENERAL CLASS WITH LOCAL CLASS
      LOOP AT &lt;CL&gt;-TYPES ASSIGNING &lt;T&gt;.
        READ TABLE CONNECTOR_LIST ASSIGNING &lt;C&gt;
             WITH TABLE KEY OBJECT = &lt;T&gt;-TYPE.
        IF SY-SUBRC &lt;&gt; 0.
          RAISE EXCEPTION TYPE ZAPLINK_CX_COMPONENT EXPORTING
                          TEXTID = ZAPLINK_CX_COMPONENT=&gt;SYSTEM_ERROR
                         CX_NAME = &apos;TYPE NOT FOUND&apos;.
        ELSE.
          DELETE &lt;C&gt;-CLASSES WHERE CLASSNAME = CLASS.
        ENDIF.
      ENDLOOP.
    ENDIF.
  ENDIF.

  THE_CLASS-CLASSNAME = CLASS.
  IF NOT DEVCLASS IS INITIAL.
    THE_CLASS-DEVCLASS = DEVCLASS.
  ELSE.
    SELECT SINGLE DEVCLASS INTO THE_CLASS-DEVCLASS
      FROM TADIR
      WHERE PGMID = &apos;R3TR&apos;
        AND OBJECT = &apos;CLAS&apos;
        AND OBJ_NAME = THE_CLASS-CLASSNAME.
  ENDIF.
  THE_CLASS-TYPES = CONNECTOR-&gt;SUPPORTED_TYPES.
  INSERT THE_CLASS INTO TABLE _CLASSES.

  LOOP AT CONNECTOR-&gt;SUPPORTED_TYPES ASSIGNING &lt;T&gt;.
    READ TABLE CONNECTOR_LIST ASSIGNING &lt;C&gt;
         WITH TABLE KEY OBJECT = &lt;T&gt;-TYPE.
    IF SY-SUBRC &lt;&gt; 0.
      _CONN-OBJECT = &lt;T&gt;-TYPE.
      READ TABLE SAPTYPES ASSIGNING &lt;ST&gt;
                 WITH TABLE KEY OBJECT = _CONN-OBJECT.
      IF SY-SUBRC = 0.
        _CONN-TEXT = &lt;ST&gt;-TEXT.
      ENDIF.
      INSERT _CONN INTO TABLE CONNECTOR_LIST.
      READ TABLE CONNECTOR_LIST ASSIGNING &lt;C&gt;
           WITH TABLE KEY OBJECT = &lt;T&gt;-TYPE.
    ENDIF.
    CLEAR _CLASS.
    MOVE-CORRESPONDING THE_CLASS TO _CLASS.
    INSERT _CLASS INTO TABLE &lt;C&gt;-CLASSES.
  ENDLOOP.

  CLEAR VALUE_TABLE.
  LOOP AT CONNECTOR_LIST ASSIGNING &lt;C&gt;.
    _VALUE-OBJECT = &lt;C&gt;-OBJECT.
    _VALUE-TEXT = &lt;C&gt;-TEXT.
    APPEND _VALUE TO VALUE_TABLE.
  ENDLOOP.

ENDMETHOD.
METHOD _UPDATE_DEF_CLASS.
TYPES:
    BEGIN OF T_CLASSLIST,
      CLASS TYPE SEOCLSNAME,
    END OF T_CLASSLIST.

  DATA CLASSLIST TYPE STANDARD TABLE OF T_CLASSLIST WITH DEFAULT KEY.
  DATA TABLETYPELINE TYPE KO105.
  DATA _CONN LIKE LINE OF CONNECTOR_LIST.
  DATA _CLASS LIKE LINE OF _CONN-CLASSES.
  DATA _TYPES TYPE STANDARD TABLE OF KO100 WITH DEFAULT KEY.
  FIELD-SYMBOLS:
    &lt;C&gt; LIKE LINE OF CONNECTOR_LIST.

* DEFAULT CLASS
  LOOP AT CONNECTOR_LIST ASSIGNING &lt;C&gt;.
    CHECK NOT &lt;C&gt;-CLASSES IS INITIAL.
    LOOP AT &lt;C&gt;-CLASSES INTO _CLASS   WHERE DEVCLASS = LOCAL_DEVCLASS.
      EXIT.
    ENDLOOP.
    LOOP AT &lt;C&gt;-CLASSES INTO _CLASS   WHERE DEVCLASS = &apos;ZAPLINK-CONNECTORS-MAIN&apos;.
      EXIT.
    ENDLOOP.
    IF SY-SUBRC &lt;&gt; 0 OR _CLASS-CLASSNAME IS INITIAL.
      LOOP AT &lt;C&gt;-CLASSES INTO _CLASS WHERE DEVCLASS CP &apos;ZAPLINK-CONNECTORS*&apos;.
        EXIT.
      ENDLOOP.
    ENDIF.
    IF SY-SUBRC &lt;&gt; 0 OR _CLASS-CLASSNAME IS INITIAL.
      LOOP AT &lt;C&gt;-CLASSES INTO _CLASS WHERE DEVCLASS CP &apos;ZAPLINK*&apos;.
        EXIT.
      ENDLOOP.
    ENDIF.
    IF SY-SUBRC &lt;&gt; 0 OR _CLASS-CLASSNAME IS INITIAL.
      READ TABLE &lt;C&gt;-CLASSES INTO _CLASS INDEX 1.
    ENDIF.
    &lt;C&gt;-DEFAULT_CLASS = _CLASS-CLASSNAME.
  ENDLOOP.
ENDMETHOD.
METHOD DO_EXISTS.
  DATA _CX   TYPE REF TO ZAPLINK_CX_COMPONENT.
  DATA _CONN LIKE LINE OF CONNECTOR_LIST.

  TRY.
     RESULT = EXISTS-NOT_EXISTS.
      _CONN = _SEARCH_CONNECTOR( TYPE ).

      IF NOT _CONN-CLASSES IS INITIAL.
        RESULT = EXISTS-EXISTS.
      ENDIF.

    CATCH ZAPLINK_CX_COMPONENT INTO _CX.
      RAISE EXCEPTION _CX.
  ENDTRY.
ENDMETHOD.
METHOD CREATE_CONNECTOR.
  DATA _CX        TYPE REF TO CX_ROOT.
  DATA _CONN      LIKE LINE OF CONNECTOR_LIST.
  DATA _CLASSNAME TYPE TD_CONNCLASS.
  FIELD-SYMBOLS:
    &lt;C&gt; LIKE LINE OF _CONN-CLASSES.

  TRY.
      _CONN = _SEARCH_CONNECTOR( TYPE ).

      IF NOT CONNUUID IS INITIAL.
        READ TABLE _CONN-CLASSES ASSIGNING &lt;C&gt;
             WITH TABLE KEY UUID = CONNUUID.
        IF SY-SUBRC &lt;&gt; 0.
* CLASS &apos;&amp;CONNUUID&amp;&apos; FOR TYPE &apos;&amp;TYPE&amp;&apos; IS NOT A VALID CONNECTOR. CHECK ATTRIBUTE SUPPORTED_TYPES OF CLASS &apos;&amp;CONNCLASS&amp;&apos;
          RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
                     EXPORTING TEXTID = ZAPLINK_CX_CONNECTOR=&gt;INVALID_UUID
                                 TYPE = TYPE
                             CONNUUID = CONNUUID.
        ENDIF.
        _CLASSNAME = &lt;C&gt;-CLASSNAME.
      ELSE.
        IF NOT _CONN-CLASSES IS INITIAL AND _CONN-DEFAULT_CLASS IS INITIAL.
          READ TABLE _CONN-CLASSES ASSIGNING &lt;C&gt; INDEX 1.
          IF SY-SUBRC = 0.
            _CONN-DEFAULT_CLASS = &lt;C&gt;-CLASSNAME.
          ENDIF.
        ENDIF.
        _CLASSNAME = _CONN-DEFAULT_CLASS.
      ENDIF.

      IF NOT _CLASSNAME IS INITIAL.
        TRY.
            CREATE OBJECT RESULT TYPE (_CLASSNAME).
          CATCH CX_ROOT INTO _CX.
            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
                       EXPORTING TEXTID = ZAPLINK_CX=&gt;SYSTEM_ERROR
                               PREVIOUS = _CX.
        ENDTRY.
      ENDIF.

    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

ENDMETHOD.
METHOD _SEARCH_CONNECTOR.

  READ TABLE CONNECTOR_LIST INTO RESULT
             WITH TABLE KEY OBJECT = TYPE.
  IF SY-SUBRC &lt;&gt; 0.
    READ TABLE SAPTYPES TRANSPORTING NO FIELDS
               WITH TABLE KEY OBJECT = TYPE.
    IF SY-SUBRC &lt;&gt; 0.
* TYPE &apos;&amp;1&apos; IS NOT ASSIGNED TO A ZAPLINK CONNECTOR AND IS NOT A KNOWN SAPOBJECT TYPE (TRANSACTION SE01).
      RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
                 EXPORTING TEXTID = ZAPLINK_CX_CONNECTOR=&gt;INVALID_TYPE
                             TYPE = TYPE.
    ENDIF.
  ENDIF.

ENDMETHOD.
METHOD GET_VALUES.
  DATA LT_RETURN TYPE STANDARD TABLE OF DDSHRETVAL.

  CALL FUNCTION &apos;F4IF_INT_TABLE_VALUE_REQUEST&apos;
    EXPORTING
*     DDIC_STRUCTURE         = &apos; &apos;
      RETFIELD               = &apos;OBJECT&apos;
*     PVALKEY                = &apos; &apos;
*     DYNPPROG               = &apos; &apos;
*     DYNPNR                 = &apos; &apos;
*     DYNPROFIELD            = &apos; &apos;
*     STEPL                  = 0
      WINDOW_TITLE           = &apos;INSTALLED CONNECTORS&apos;(SH1)
      VALUE                  = TYPE
      VALUE_ORG              = &apos;S&apos;
*     MULTIPLE_CHOICE        = &apos; &apos;
*     DISPLAY                = &apos; &apos;
*     CALLBACK_PROGRAM       = &apos; &apos;
*     CALLBACK_FORM          = &apos; &apos;
*     MARK_TAB               =
*   IMPORTING
*     USER_RESET             =
    TABLES
      VALUE_TAB              = VALUE_TABLE
*     FIELD_TAB              =
      RETURN_TAB             = LT_RETURN
*     DYNPFLD_MAPPING        =
    EXCEPTIONS
      PARAMETER_ERROR        = 1
      NO_VALUES_FOUND        = 2
      OTHERS                 = 3
            .
  IF SY-SUBRC &lt;&gt; 0.
  ELSE.

  ENDIF.

ENDMETHOD.
METHOD TYPE2TEXT.
  FIELD-SYMBOLS:
    &lt;T&gt; LIKE LINE OF SAPTYPES.

    READ TABLE SAPTYPES ASSIGNING &lt;T&gt;
         WITH TABLE KEY OBJECT = DATA.
    IF SY-SUBRC = 0.
      RESULT = &lt;T&gt;-TEXT.
    ENDIF.

ENDMETHOD.
METHOD NODE_2_RAW.
  DATA EZ_XML    TYPE REF TO ZAPLINK_EASYXML.
  DATA _XML_COMP TYPE REF TO IF_IXML_DOCUMENT.
  DATA _CLONE    TYPE REF TO IF_IXML_NODE.
  DATA _CX       TYPE REF TO ZAPLINK_CX.

  _XML_COMP = XMLENGINE-&gt;CREATE_DOCUMENT( ).
  _CLONE = NODE-&gt;CLONE( ).
  _XML_COMP-&gt;IF_IXML_NODE~APPEND_CHILD( _CLONE ).
  CREATE OBJECT RESULT.
  CREATE OBJECT EZ_XML.
  TRY.
      CALL METHOD EZ_XML-&gt;XML2ANY
        EXPORTING
          XMLDOC = _XML_COMP
        CHANGING
          ANY    = RESULT.
    CATCH ZAPLINK_CX INTO _CX.
      CREATE OBJECT O_MYCX EXPORTING
             TEXTID = ZAPLINK_CX=&gt;SYSTEM_ERROR
            PREV_CX = _CX.
      O_MYCX-&gt;UPDATE( ).
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

ENDMETHOD.
METHOD GET_CLASSNAME.
  DATA O_TYPEDESC TYPE REF TO CL_ABAP_OBJECTDESCR.

  CHECK O_CONN IS BOUND.
  O_TYPEDESC ?= CL_ABAP_OBJECTDESCR=&gt;DESCRIBE_BY_OBJECT_REF( O_CONN ).
  RESULT = O_TYPEDESC-&gt;GET_RELATIVE_NAME( ).

ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_CONNECTORS IMPLEMENTATION

CLASS ZAPLINK_LIST IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD ADD.
DATA _IDX  LIKE LINE OF _INDEX.
  DATA _COMP LIKE LINE OF _ALLCOMP.

  _IDX = SEARCH_INDEX( COMP ).
  IF _IDX-O_COMP IS BOUND.
* COMPONENT &apos;&amp;NAME&amp;&apos; (&amp;TYPE&amp;) ALREADY IN THE COLLECTION
    RAISE EXCEPTION TYPE ZAPLINK_CX_LIST
               EXPORTING TEXTID = ZAPLINK_CX_LIST=&gt;ALREADY_EXISTS
                           TYPE = _IDX-KEY-TYPE
                           NAME = _IDX-KEY-NAME.
  ENDIF.

  _IDX-O_COMP = COMP.
  INSERT _IDX INTO TABLE _INDEX.
  MOVE-CORRESPONDING _IDX TO _COMP. INSERT _COMP INTO TABLE _ALLCOMP.
  _ADD_SUBCOMP( COMP ).
ENDMETHOD.
METHOD ADD_KEYS.
DATA O_COMP   TYPE TO_COMPONENT.
  DATA _CX      TYPE REF TO ZAPLINK_CX_LIST.
  DATA _CX_COMP TYPE REF TO ZAPLINK_CX_COMPONENT.
  DATA _LIST    TYPE TT_COMPKEYS.
  FIELD-SYMBOLS:
    &lt;K&gt; LIKE LINE OF _LIST.

  TRY.
      _LIST = DATA.
      SORT _LIST.
      DELETE ADJACENT DUPLICATES FROM _LIST.
      DELETE _LIST WHERE TABLE_LINE IS INITIAL.

      LOOP AT _LIST ASSIGNING &lt;K&gt;.
        TRY.
            O_COMP = ZAPLINK_COMPONENT=&gt;CREATE_NEW( &lt;K&gt; ).
          CATCH ZAPLINK_CX_COMPONENT INTO _CX_COMP.
* ACTION FAILED DUE TO EXCEPTION &apos;&amp;CX_NAME&amp;&apos;
            CREATE OBJECT _CX
              EXPORTING
                TEXTID  = ZAPLINK_CX_LIST=&gt;FAILED
                PREV_CX = _CX_COMP.
            _CX-&gt;UPDATE( ).
            RAISE EXCEPTION _CX.
        ENDTRY.
        ADD( O_COMP ).
      ENDLOOP.
    CATCH ZAPLINK_CX_LIST INTO _CX.
      RAISE EXCEPTION _CX.
  ENDTRY.
ENDMETHOD.
METHOD ADD_LIST.
DATA T_ALLCOMP   TYPE TT_ALLCOMPLIST.
  FIELD-SYMBOLS:
    &lt;I&gt; LIKE LINE OF _INDEX.

  LOOP AT DATA-&gt;_INDEX ASSIGNING &lt;I&gt;.
    READ TABLE _INDEX TRANSPORTING NO FIELDS
               WITH TABLE KEY KEY = &lt;I&gt;-KEY.
    IF SY-SUBRC = 0.
* ALREADY EXIST HERE
      CONTINUE.
    ENDIF.
    T_ALLCOMP = DATA-&gt;_ALLCOMP.
    DELETE T_ALLCOMP WHERE O_COMP &lt;&gt; &lt;I&gt;-O_COMP.
    INSERT &lt;I&gt; INTO TABLE _INDEX.
    INSERT LINES OF T_ALLCOMP INTO TABLE _ALLCOMP.
  ENDLOOP.
ENDMETHOD.
METHOD CHANGE_SELECTION.
DATA ALV TYPE TT_ALV.

  ALV = CONV_TO_ALV( ).

  CALL FUNCTION &apos;REUSE_ALV_GRID_DISPLAY&apos;
    EXPORTING
*      I_CALLBACK_PROGRAM       = &apos;ZSAPLINK&apos;
*      I_CALLBACK_PF_STATUS_SET = &apos;PF_STATUS_SET&apos;
*      I_CALLBACK_USER_COMMAND  = &apos;USER_COMMAND_USER&apos;
      I_GRID_TITLE             = &apos;SELECT OBJECTS&apos;(LST)
      IT_FIELDCAT              = ALV_CONF-FIELDS
      IS_LAYOUT                = ALV_CONF-LAYOUT
    TABLES
      T_OUTTAB                 = ALV
    EXCEPTIONS
      OTHERS                   = 0.

  UPDATE_FROM_ALV( ALV ).
ENDMETHOD.
METHOD CLASS_CONSTRUCTOR.
DATA FIELD     LIKE LINE OF ALV_CONF-FIELDS.
  DATA T_DESC    TYPE REF TO CL_ABAP_TYPEDESCR.
  DATA ST_DESC   TYPE REF TO CL_ABAP_STRUCTDESCR.
  DATA LIST      TYPE TT_ALV.
  DATA LINE      LIKE LINE OF LIST.
  DATA TEXT_NAME TYPE STRING.
  FIELD-SYMBOLS:
    &lt;T&gt; TYPE ANY,
    &lt;C&gt; LIKE LINE OF ST_DESC-&gt;COMPONENTS.

*==============================================
*==========     ALV     =======================
*==============================================

  T_DESC = CL_ABAP_STRUCTDESCR=&gt;DESCRIBE_BY_DATA( LINE ).

  CHECK T_DESC-&gt;KIND = CL_ABAP_STRUCTDESCR=&gt;KIND_STRUCT.
  ST_DESC ?= T_DESC.

  LOOP AT ST_DESC-&gt;COMPONENTS ASSIGNING &lt;C&gt;.
    CLEAR FIELD.

    FIELD-FIELDNAME = &lt;C&gt;-NAME.
    TEXT_NAME = SY-TABIX.
    CONDENSE TEXT_NAME NO-GAPS.
    CONCATENATE &apos;TEXT-NF&apos; TEXT_NAME INTO TEXT_NAME.
    ASSIGN (TEXT_NAME) TO &lt;T&gt;.
    IF SY-SUBRC = 0.
      FIELD-SELTEXT_L = &lt;T&gt;.
    ELSE.
      FIELD-SELTEXT_L = FIELD-FIELDNAME.
    ENDIF.
    APPEND FIELD TO ALV_CONF-FIELDS.
  ENDLOOP.

  ALV_CONF-LAYOUT-BOX_FIELDNAME     = &apos;SELECT&apos;.
  ALV_CONF-LAYOUT-F2CODE            = &apos;MYPICK&apos; .
  ALV_CONF-LAYOUT-COLWIDTH_OPTIMIZE = &apos;X&apos;.
*  ALV_CONF-LAYOUT-LIGHTS_FIELDNAME  = &apos;STATUS&apos;.

  DELETE ALV_CONF-FIELDS WHERE FIELDNAME = ALV_CONF-LAYOUT-BOX_FIELDNAME.
ENDMETHOD.
METHOD CLEAR.
CLEAR:
    DISPLAY_PROGRESS,
    _ALLCOMP,
    _INDEX,
    O_EXCEPTION,
    _IDX_COUNT,
    _ITERATOR_END,
    _ITERATOR_PREV,
    _ITERATOR_TABIX,
    _ITERATOR_TYPE.
ENDMETHOD.
METHOD CLONE.
DATA O_COMP TYPE TO_COMPONENT.
  FIELD-SYMBOLS:
    &lt;I&gt; LIKE LINE OF _INDEX.

  TRY.
      CREATE OBJECT RESULT.

      LOOP AT _INDEX ASSIGNING &lt;I&gt;.
        O_COMP = &lt;I&gt;-O_COMP-&gt;CLONE( ).
        RESULT-&gt;ADD( O_COMP ).
      ENDLOOP.
    CATCH ZAPLINK_CX.
      CLEAR RESULT.
  ENDTRY.
ENDMETHOD.
METHOD CONV_TO_ALV.
  FIELD-SYMBOLS:
    &lt;I&gt; LIKE LINE OF _INDEX.
  DATA _KEY TYPE TS_COMPKEY.
  DATA _LINE LIKE LINE OF RESULT.

  LOOP AT _INDEX ASSIGNING &lt;I&gt;.
    CLEAR _LINE.
    _LINE-SELECT = &lt;I&gt;-SELECTED.
    _KEY = &lt;I&gt;-O_COMP-&gt;_GET_KEY( ).
    _LINE-TYPE = _KEY-TYPE.
    _LINE-NAME = _KEY-NAME.

    _LINE-TYP_TXT = ZAPLINK_CONNECTORS=&gt;TYPE2TEXT( _LINE-TYPE ).

    IF &lt;I&gt;-O_COMP-&gt;_CONNECTOR-EXISTS = ZAPLINK_COMPONENT=&gt;CONNEXISTS-NOT_EXISTS.
      _LINE-PLUGIN = LIGHTS-RED.
      _LINE-STATUS = LIGHTS-NO.
* THERE IS NO ZAP LINK CONNECTOR INSTALLED FOR OBJECT TYPE &apos;&amp;1&apos;
      MESSAGE E000(ZAPLINK_GUI) WITH _LINE-TYPE INTO _LINE-MSG.
    ELSE.
      _LINE-PLUGIN = LIGHTS-GREEN.

      IF &lt;I&gt;-O_COMP-&gt;_EXISTS = ZAPLINK_CONNECTOR=&gt;EXISTS.
        SELECT SINGLE DEVCLASS SRCSYSTEM
          INTO (_LINE-DEVCLASS, _LINE-SRCSYSTEM)
          FROM TADIR
          WHERE   OBJECT = _LINE-TYPE
            AND OBJ_NAME = _LINE-NAME.
        CASE &lt;I&gt;-SELECTED.
          WHEN ABAP_TRUE.
            _LINE-STATUS = LIGHTS-GREEN.
          WHEN ABAP_FALSE.
            _LINE-STATUS = LIGHTS-YELLOW.
            CLEAR _LINE-SELECT.
* OBJECT &apos;&amp;2&apos; (&amp;1) ALREADY EXISTS. SELECT IT TO OVERWRITE
            MESSAGE E001(ZAPLINK_GUI) WITH _LINE-TYPE _LINE-NAME INTO _LINE-MSG.
        ENDCASE.
      ELSE.   &quot; NOT EXISTS
        CASE &lt;I&gt;-SELECTED.
          WHEN ABAP_FALSE.
            _LINE-STATUS = LIGHTS-RED.
* OBJECT &apos;&amp;2&apos; (&amp;1) DOES NOT EXISTS.
            MESSAGE E003(ZAPLINK_GUI) WITH _LINE-TYPE _LINE-NAME INTO _LINE-MSG.
          WHEN ABAP_TRUE.
            _LINE-STATUS = LIGHTS-GREEN.
        ENDCASE.
      ENDIF.
    ENDIF.

    APPEND _LINE TO RESULT.
  ENDLOOP.
ENDMETHOD.
METHOD GET_COUNT.
CASE _ITERATOR_TYPE.
    WHEN ITERATOR_TYPES-SELECTED.
      LOOP AT _INDEX TRANSPORTING NO FIELDS
              WHERE SELECTED = ABAP_TRUE.
        ADD 1 TO RESULT.
      ENDLOOP.
    WHEN ITERATOR_TYPES-ALL.
      RESULT = LINES( _INDEX ).
    WHEN OTHERS.
* GET_NEXT HAS BEEN CALLED WITHOUT INITIALIZE A ITERATOR.
      RAISE EXCEPTION TYPE ZAPLINK_CX_LIST
                 EXPORTING TEXTID = ZAPLINK_CX_LIST=&gt;ITERATOR_NOT_INITIALIZE.
  ENDCASE.
ENDMETHOD.
METHOD GET_NEXT.
DATA COMPONENT TYPE TS_COMPKEY.
  DATA MSG       TYPE STRING.
  DATA _POS      TYPE I.
  DATA _CX       TYPE REF TO ZAPLINK_CX_LIST.
  DATA _KEY TYPE TS_COMPKEY.
  FIELD-SYMBOLS:
    &lt;I&gt; LIKE LINE OF _INDEX.

  CHECK _ITERATOR_END = ABAP_FALSE.

  TRY.
      READ TABLE _INDEX TRANSPORTING NO FIELDS
           WITH KEY O_COMP = _ITERATOR_PREV.
      IF SY-SUBRC = 0.
        _ITERATOR_TABIX = SY-TABIX + 1.  &quot; IN CASE INSERT OCCURS DURING 2 GET_NEXT.
      ELSEIF _ITERATOR_PREV IS BOUND.
        _KEY = _ITERATOR_PREV-&gt;_GET_KEY( ).
        READ TABLE _INDEX TRANSPORTING NO FIELDS
             WITH TABLE KEY KEY = _KEY.
        IF SY-SUBRC = 0.
          _ITERATOR_TABIX = SY-TABIX + 1.  &quot; IN CASE DELETE &amp; INSERT OCCURS DURING 2 GET_NEXT.
        ELSE.
          _ITERATOR_TABIX = SY-TABIX.  &quot; IN CASE DELETE OCCURS DURING 2 GET_NEXT.
        ENDIF.
      ENDIF.
      CASE _ITERATOR_TYPE.
        WHEN ITERATOR_TYPES-SELECTED.
          LOOP AT _INDEX ASSIGNING &lt;I&gt; FROM _ITERATOR_TABIX
                  WHERE SELECTED = ABAP_TRUE.
            _ITERATOR_TABIX = SY-TABIX + 1.
            EXIT.
          ENDLOOP.
        WHEN ITERATOR_TYPES-ALL.
          LOOP AT _INDEX ASSIGNING &lt;I&gt; FROM _ITERATOR_TABIX.
            _ITERATOR_TABIX = SY-TABIX + 1.
            EXIT.
          ENDLOOP.
        WHEN OTHERS.
* GET_NEXT HAS BEEN CALLED WITHOUT INITIALIZE A ITERATOR.
          RAISE EXCEPTION TYPE ZAPLINK_CX_LIST
                     EXPORTING TEXTID = ZAPLINK_CX_LIST=&gt;ITERATOR_NOT_INITIALIZE.
      ENDCASE.
      IF SY-SUBRC &lt;&gt; 0.
        _ITERATOR_END = ABAP_TRUE.
        EXIT.
      ENDIF.
      IF NOT &lt;I&gt;-O_COMP IS BOUND.
        CLEAR _ITERATOR_PREV.
        RESULT = GET_NEXT( ).
        EXIT.
      ENDIF.

      RESULT = _ITERATOR_PREV = &lt;I&gt;-O_COMP.

* DISPLAY PROGRESSION
      IF DISPLAY_PROGRESS = ABAP_TRUE.
        COMPONENT = RESULT-&gt;_GET_KEY( ).
        IF SY-BATCH = ABAP_TRUE.
* PROCESSING OBJECT : &amp;2 (&amp;1)
          MESSAGE I000(ZAPLINK_LIST) WITH COMPONENT-TYPE COMPONENT-NAME.
        ELSE.
* PROCESSING OBJECT : &amp;2 (&amp;1)
          MESSAGE I000(ZAPLINK_LIST) WITH COMPONENT-TYPE COMPONENT-NAME INTO MSG.
          IF _IDX_COUNT &gt; 0.
            _POS = _ITERATOR_TABIX / _IDX_COUNT.
          ELSE.
            _POS = _ITERATOR_TABIX.
          ENDIF.
          CALL FUNCTION &apos;SAPGUI_PROGRESS_INDICATOR&apos;
            EXPORTING
              PERCENTAGE = _POS
              TEXT       = MSG.
        ENDIF.
      ENDIF.
    CATCH ZAPLINK_CX_LIST INTO _CX.
      RAISE EXCEPTION _CX.
  ENDTRY.
ENDMETHOD.
METHOD INIT_ITER.
CLEAR: _ITERATOR_TABIX, _ITERATOR_PREV.
  _ITERATOR_TYPE = ITERATOR_TYPES-ALL.
  _IDX_COUNT = GET_COUNT( ).
  _ITERATOR_END = ABAP_FALSE.
ENDMETHOD.
METHOD INIT_SEL_ITER.
CLEAR: _ITERATOR_TABIX, _ITERATOR_PREV.
  _ITERATOR_TYPE = ITERATOR_TYPES-SELECTED.
  _IDX_COUNT = GET_COUNT( ).
  _ITERATOR_END = ABAP_FALSE.
ENDMETHOD.
METHOD IS_INCLUDED.
DATA T_ALLCOMP TYPE TT_ALLCOMPLIST.
  FIELD-SYMBOLS:
    &lt;C&gt; LIKE LINE OF _ALLCOMP.

  T_ALLCOMP = LIST-&gt;_ALLCOMP.

  DELETE ADJACENT DUPLICATES FROM T_ALLCOMP COMPARING KEY.

  RESULT = ABAP_TRUE.
  LOOP AT T_ALLCOMP ASSIGNING &lt;C&gt;.
    READ TABLE _ALLCOMP TRANSPORTING NO FIELDS
         WITH TABLE KEY KEY = &lt;C&gt;-KEY.
    IF SY-SUBRC &lt;&gt; 0.
      RESULT = ABAP_FALSE.
      EXIT.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD KEEP_COMMUN_LIST.
FIELD-SYMBOLS:
    &lt;I&gt; LIKE LINE OF _INDEX.

  LOOP AT _INDEX ASSIGNING &lt;I&gt;.
    READ TABLE DATA-&gt;_INDEX TRANSPORTING NO FIELDS
               WITH TABLE KEY KEY = &lt;I&gt;-KEY.
    IF SY-SUBRC &lt;&gt; 0.
      DELETE _INDEX FROM &lt;I&gt;.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD REMOVE.
DATA _IDX LIKE LINE OF _INDEX.

  TRY.
      _IDX = SEARCH_INDEX( COMP ).
    CATCH ZAPLINK_CX_LIST INTO O_EXCEPTION.
      RAISE EXCEPTION O_EXCEPTION.
  ENDTRY.

  DELETE _ALLCOMP WHERE O_COMP = _IDX-O_COMP.
  DELETE TABLE _INDEX FROM _IDX.
ENDMETHOD.
METHOD REMOVE_LIST.
FIELD-SYMBOLS:
    &lt;I&gt; LIKE LINE OF _INDEX.

  LOOP AT DATA-&gt;_INDEX ASSIGNING &lt;I&gt;.
    TRY.
        REMOVE( &lt;I&gt;-O_COMP ).
      CATCH ZAPLINK_CX_LIST INTO O_EXCEPTION.
    ENDTRY.
  ENDLOOP.
ENDMETHOD.
METHOD SEARCH.
  DATA _IDX LIKE LINE OF _INDEX.

  _IDX = SEARCH_INDEX( COMP ).
  IF NOT _IDX-O_COMP IS BOUND.
* NOT A REAL EXCEPTION.
* COMPONENT &apos;&amp;NAME&amp;&apos; (&amp;TYPE&amp;) NOT FOUND IN THE COLLECTION
*    RAISE EXCEPTION TYPE ZAPLINK_CX_LIST
*               EXPORTING TEXTID = ZAPLINK_CX_LIST=&gt;NOT_FOUND
*                           TYPE = _IDX-KEY-TYPE
*                           NAME = _IDX-KEY-NAME.
    EXIT.
  ENDIF.

  RESULT = _IDX-O_COMP.
ENDMETHOD.
METHOD SEARCH_INDEX.
DATA _KEY TYPE TS_COMPKEY.

  _KEY = COMP-&gt;_GET_KEY( ).

  READ TABLE _INDEX INTO RESULT
             WITH TABLE KEY KEY = _KEY.
  IF SY-SUBRC &lt;&gt; 0.
    RESULT-KEY = _KEY.
  ENDIF.
ENDMETHOD.
METHOD SELECT_DEFAULT.
TRY.
      CASE SEL_ACTION.
        WHEN SEL_ACTIONS-EXPORT.
          SELECT_EXPORT( ).
        WHEN SEL_ACTIONS-IMPORT.
          SELECT_IMPORT( ).
        WHEN SEL_ACTIONS-UNINSTALL.
          SELECT_EXPORT( ).
        WHEN OTHERS.
          RAISE EXCEPTION TYPE ZAPLINK_CX_LIST
                     EXPORTING TEXTID = ZAPLINK_CX_LIST=&gt;INVALID_ACTION
                           SEL_ACTION = SEL_ACTION.
      ENDCASE.
    CATCH ZAPLINK_CX_LIST INTO O_EXCEPTION.
      RAISE EXCEPTION O_EXCEPTION.
  ENDTRY.
ENDMETHOD.
METHOD SELECT_EXPORT.
FIELD-SYMBOLS:
    &lt;I&gt; LIKE LINE OF _INDEX.

  LOOP AT _INDEX ASSIGNING &lt;I&gt;.
    CLEAR &lt;I&gt;-SELECTED.
    IF     &lt;I&gt;-O_COMP-&gt;_EXISTS = ZAPLINK_CONNECTOR=&gt;EXISTS
       AND &lt;I&gt;-O_COMP-&gt;_CONNECTOR-EXISTS = ZAPLINK_COMPONENT=&gt;CONNEXISTS-EXISTS.
      &lt;I&gt;-SELECTED = ABAP_TRUE.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD SELECT_IMPORT.
FIELD-SYMBOLS:
    &lt;I&gt; LIKE LINE OF _INDEX.

  LOOP AT _INDEX ASSIGNING &lt;I&gt;.
    CLEAR &lt;I&gt;-SELECTED.
    IF     &lt;I&gt;-O_COMP-&gt;_EXISTS = ZAPLINK_CONNECTOR=&gt;EXISTS-NOT_EXISTS
       AND &lt;I&gt;-O_COMP-&gt;_CONNECTOR-EXISTS = ZAPLINK_COMPONENT=&gt;CONNEXISTS-EXISTS.
      &lt;I&gt;-SELECTED = ABAP_TRUE.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD UPDATE_FROM_ALV.
FIELD-SYMBOLS:
    &lt;A&gt; LIKE LINE OF DATA,
    &lt;I&gt; LIKE LINE OF _INDEX.
  DATA _KEY TYPE TS_COMPKEY.

  LOOP AT DATA ASSIGNING &lt;A&gt;.
    _KEY-TYPE = &lt;A&gt;-TYPE.
    _KEY-NAME = &lt;A&gt;-NAME.
    READ TABLE _INDEX ASSIGNING &lt;I&gt;
         WITH KEY KEY = _KEY.
    IF SY-SUBRC = 0.
      IF NOT &lt;A&gt;-SELECT IS INITIAL.
        &lt;I&gt;-SELECTED = ABAP_TRUE.
      ELSE.
        &lt;I&gt;-SELECTED = ABAP_FALSE.
      ENDIF.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD _ADD_SUBCOMP.
DATA O_LIST TYPE TO_ME.
  DATA _COMP LIKE LINE OF _ALLCOMP.

  CHECK DATA IS BOUND.
  O_LIST = DATA-&gt;GET_SUBCOMPONENTS( ).
  CHECK O_LIST IS BOUND.

  LOOP AT O_LIST-&gt;_ALLCOMP INTO _COMP.
    _COMP-AS_SUB = ABAP_TRUE.
    _COMP-O_COMP = DATA.
    INSERT _COMP INTO TABLE _ALLCOMP.
  ENDLOOP.
ENDMETHOD.
METHOD IS_SELECTED.
  DATA _IDX LIKE LINE OF _INDEX.

  _IDX = SEARCH_INDEX( COMP ).
  IF _IDX-SELECTED IS NOT INITIAL.
    RESULT = ABAP_TRUE.
  ELSE.
    RESULT = ABAP_FALSE.
  ENDIF.

ENDMETHOD.
METHOD SELECT.

  TRY.
      _SELECT( COMP = COMP
              VALUE = ABAP_TRUE ).
    CATCH ZAPLINK_CX_LIST INTO O_EXCEPTION.
      RAISE EXCEPTION O_EXCEPTION.
  ENDTRY.

ENDMETHOD.
METHOD _SELECT.
  DATA _IDX LIKE LINE OF _INDEX.

  _IDX = SEARCH_INDEX( COMP ).
  IF NOT _IDX-O_COMP IS BOUND.
* COMPONENT &apos;&amp;NAME&amp;&apos; (&amp;TYPE&amp;) NOT FOUND IN THE COLLECTION
    RAISE EXCEPTION TYPE ZAPLINK_CX_LIST
               EXPORTING TEXTID = ZAPLINK_CX_LIST=&gt;NOT_FOUND
                           TYPE = _IDX-KEY-TYPE
                           NAME = _IDX-KEY-NAME.
  ENDIF.

  _IDX-SELECTED = VALUE.
  MODIFY TABLE _INDEX FROM _IDX TRANSPORTING SELECTED.

  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_LIST
               EXPORTING TEXTID = ZAPLINK_CX_LIST=&gt;SYSTEM_ERROR
                           TYPE = _IDX-KEY-TYPE
                           NAME = _IDX-KEY-NAME.
  ENDIF.

ENDMETHOD.
METHOD UNSELECT.

  TRY.
      _SELECT( COMP = COMP
              VALUE = ABAP_FALSE ).
    CATCH ZAPLINK_CX_LIST INTO O_EXCEPTION.
      RAISE EXCEPTION O_EXCEPTION.
  ENDTRY.

ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_LIST IMPLEMENTATION

CLASS ZAPLINK_CX_OPTIONS IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MSG = MSG
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
.
 IF TEXTID IS INITIAL.
   ME-&gt;TEXTID = ZAPLINK_CX_OPTIONS .
 ENDIF.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_CX_OPTIONS IMPLEMENTATION

CLASS ZAPLINK_CX_OPT_DEVCLASS IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MSG = MSG
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
.
 IF TEXTID IS INITIAL.
   ME-&gt;TEXTID = ZAPLINK_CX_OPT_DEVCLASS .
 ENDIF.
ME-&gt;SUBSTKIND = SUBSTKIND .
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_CX_OPT_DEVCLASS IMPLEMENTATION

CLASS ZAPLINK_OPT_DEVCLASS IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONSTRUCTOR.
  _SUBSTITUTION = SUBSTITUTIONKINDS-KEEP_EXISTING.
ENDMETHOD.
METHOD GET_DEVCLASS.
RESULT = _DEVCLASS.
ENDMETHOD.
METHOD GET_SUBSTITUTIONKIND.
RESULT = _SUBSTITUTION.
ENDMETHOD.
METHOD SET_DEVCLASS.
CHECK DATA &lt;&gt; _DEVCLASS.

  IF _DEVCLASS IS INITIAL AND _SUBSTITUTION = SUBSTITUTIONKINDS-FIXED.
    RAISE EXCEPTION TYPE ZAPLINK_CX_OPT_DEVCLASS
          EXPORTING TEXTID = ZAPLINK_CX_OPT_DEVCLASS=&gt;MISSING_DEVCLASS
                 SUBSTKIND = _SUBSTITUTION.
  ENDIF.
  _DEVCLASS = DATA.
ENDMETHOD.
METHOD SET_SUBSTITUTIONKIND.
CHECK DATA &lt;&gt; _SUBSTITUTION.

  CASE DATA.
    WHEN SUBSTITUTIONKINDS-KEEP_EXISTING OR
         SUBSTITUTIONKINDS-USE_CONTAINER OR
         SUBSTITUTIONKINDS-LOCAL.
    WHEN SUBSTITUTIONKINDS-FIXED.
      IF _DEVCLASS IS INITIAL.
        RAISE EXCEPTION TYPE ZAPLINK_CX_OPT_DEVCLASS
              EXPORTING TEXTID = ZAPLINK_CX_OPT_DEVCLASS=&gt;MISSING_DEVCLASS
                     SUBSTKIND = DATA.
      ENDIF.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE ZAPLINK_CX_OPT_DEVCLASS
            EXPORTING TEXTID = ZAPLINK_CX_OPT_DEVCLASS=&gt;INVALID_SUBSTITUTIONKIND
                   SUBSTKIND = DATA.
  ENDCASE.
  _SUBSTITUTION = DATA.
ENDMETHOD.
METHOD SUBSTITUTE.
  DATA _CX      TYPE REF TO ZAPLINK_CX_OPT_DEVCLASS.
  DATA _CX_COMP TYPE REF TO ZAPLINK_CX_COMPONENT.
  DATA COMP_DEVC TYPE TD_DEVCLASS.
  DATA _NAME        TYPE TADIR-OBJ_NAME.
  DATA _TYPE        TYPE TADIR-OBJECT.
  DATA _EXISTS      TYPE SAUS_DPARA-TADIREXIST.

  CHECK COMPONENT IS BOUND.
  COMP_DEVC = COMPONENT-&gt;DIRECTORY-DEVCLASS.

  IF COMPONENT-&gt;GET_TYPE( ) = &apos;DEVC&apos;.
    RESULT = COMPONENT-&gt;GET_NAME( ).
  ELSE.
    CASE _SUBSTITUTION.
      WHEN SUBSTITUTIONKINDS-KEEP_EXISTING.
        _TYPE = COMPONENT-&gt;GET_TYPE( ).
        _NAME = COMPONENT-&gt;GET_NAME( ).
        CALL FUNCTION &apos;TRINT_TADIR_QUERY&apos;
          EXPORTING
            IV_PGMID           = &apos;R3TR&apos;
            IV_OBJECT          = _TYPE
            IV_OBJ_NAME        = _NAME
          IMPORTING
*      EV_OBJECT          =
*      EV_SRCSYSTEM       =
            EV_DEVCLASS        = RESULT
*      EV_AUTHOR          =
*      EV_GENFLAG         =
            EV_EXIST           = _EXISTS.
        IF _EXISTS IS INITIAL.
          RESULT = LOCAL_DEVCLASS.
        ENDIF.
      WHEN SUBSTITUTIONKINDS-USE_CONTAINER.
        CALL FUNCTION &apos;TRINT_DEVCLASS_GET&apos;
          EXPORTING
            IV_DEVCLASS              = COMP_DEVC
*           IV_LANGU                 = SY-LANGU
*           IV_WITH_LAYER            = &apos;X&apos;
*           IV_WITH_TEXT             = &apos; &apos;
*           IV_USE_MEMORY            = &apos; &apos;
*         IMPORTING
*           ES_TDEVC                 =
          EXCEPTIONS
            DEVCLASS_NOT_FOUND       = 1
            OTHERS                   = 0.
        IF SY-SUBRC = 0.
          RESULT = COMP_DEVC.
        ELSE.
          RESULT = LOCAL_DEVCLASS.
        ENDIF.
      WHEN SUBSTITUTIONKINDS-LOCAL.
        RESULT = LOCAL_DEVCLASS.
      WHEN SUBSTITUTIONKINDS-FIXED.
        RESULT = ME-&gt;_DEVCLASS.
      WHEN OTHERS.
        RAISE EXCEPTION TYPE ZAPLINK_CX_OPT_DEVCLASS
              EXPORTING TEXTID = ZAPLINK_CX_OPT_DEVCLASS=&gt;INVALID_SUBSTITUTIONKIND
                     SUBSTKIND = _SUBSTITUTION.
    ENDCASE.
  ENDIF.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_OPT_DEVCLASS IMPLEMENTATION

CLASS ZAPLINK_OPT_TRANSPORT_REQUEST IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONSTRUCTOR.
  _SUBSTITUTION = SUBSTITUTIONKINDS-INPUT.
ENDMETHOD.
METHOD GET_SUBSTITUTIONKIND.
RESULT = _SUBSTITUTION.
ENDMETHOD.
METHOD SET_SUBSTITUTIONKIND.
CHECK DATA &lt;&gt; _SUBSTITUTION.

  CASE DATA.
    WHEN SUBSTITUTIONKINDS-SAME_AS_CONTAINER OR
         SUBSTITUTIONKINDS-USER OR
         SUBSTITUTIONKINDS-CUSTOM OR
         SUBSTITUTIONKINDS-INPUT.
    WHEN SUBSTITUTIONKINDS-FIXED.
      IF _TRANSPORT_REQUEST IS INITIAL.
        RAISE EXCEPTION TYPE ZAPLINK_CX_OPT_DEVCLASS
              EXPORTING TEXTID = ZAPLINK_CX_OPT_DEVCLASS=&gt;MISSING_DEVCLASS
                     SUBSTKIND = DATA.
      ENDIF.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE ZAPLINK_CX_OPT_DEVCLASS
            EXPORTING TEXTID = ZAPLINK_CX_OPT_DEVCLASS=&gt;INVALID_SUBSTITUTIONKIND
                   SUBSTKIND = DATA.
  ENDCASE.
  _SUBSTITUTION = DATA.
ENDMETHOD.
METHOD SUBSTITUTE.
  FIELD-SYMBOLS:
    &lt;S&gt; LIKE LINE OF _TR_MAPPING.

  CHECK COMPONENT IS BOUND.
  CASE _SUBSTITUTION.
    WHEN SUBSTITUTIONKINDS-INPUT.
      CLEAR RESULT.
      EXIT. &quot; ALL WAYS EMPTY TO LET USE CHOOSE THE RIGHT TRANSPORT REQUEST
    WHEN SUBSTITUTIONKINDS-FIXED.
      RESULT = _TRANSPORT_REQUEST.
    WHEN SUBSTITUTIONKINDS-USER.
* TO DEVELOP USING MF TRINT_ORDER_CHOICE
    WHEN SUBSTITUTIONKINDS-CUSTOM.
* TO DEVELOP USING EVENT ?
    WHEN SUBSTITUTIONKINDS-SAME_AS_CONTAINER.
      READ TABLE _TR_MAPPING ASSIGNING &lt;S&gt;
           WITH TABLE KEY XML_TR = COMPONENT-&gt;DIRECTORY-TRKORR.
      IF SY-SUBRC = 0.
        RESULT = &lt;S&gt;-SAP_TR.
      ELSEIF NOT COMPONENT-&gt;DIRECTORY-TRKORR IS INITIAL.
* TO DEVELOP USING MF TRINT_ORDER_CHOICE
      ENDIF.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE ZAPLINK_CX_OPT_DEVCLASS
            EXPORTING TEXTID = ZAPLINK_CX_OPT_DEVCLASS=&gt;INVALID_SUBSTITUTIONKIND
                   SUBSTKIND = _SUBSTITUTION.
  ENDCASE.
ENDMETHOD.
METHOD GET_TRANSPORT_REQUEST.
  RESULT = _TRANSPORT_REQUEST.
ENDMETHOD.
METHOD SET_TRANSPORT_REQUEST.
CHECK DATA &lt;&gt; _TRANSPORT_REQUEST.

  IF _TRANSPORT_REQUEST IS INITIAL AND _SUBSTITUTION = SUBSTITUTIONKINDS-FIXED.
    RAISE EXCEPTION TYPE ZAPLINK_CX_OPT_DEVCLASS
          EXPORTING TEXTID = ZAPLINK_CX_OPT_DEVCLASS=&gt;MISSING_DEVCLASS
                 SUBSTKIND = _SUBSTITUTION.
  ENDIF.
  _TRANSPORT_REQUEST = DATA.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_OPT_TRANSPORT_REQUEST IMPLEMENTATION

CLASS ZAPLINK_OPT_DIRECTORY IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONSTRUCTOR.
  CREATE OBJECT _DEVCLASS.
  CREATE OBJECT _TR.
  CREATE OBJECT LOG.
  CALL METHOD LOG-&gt;INIT
    EXPORTING
      ID_OBJECT      = BALLOG_OBJECT
      ID_SUBOBJECT   = BALLOG_SUBOBJECT
*      ID_EXTNUMBER   =
      AUTO_UPD_CUSTO = ABAP_TRUE
*      ID_ACTIVITY    = ACT_CREATE
    EXCEPTIONS
      ERROR          = 1
      OTHERS         = 2.
  IF SY-SUBRC &lt;&gt; 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
               WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.
ENDMETHOD.
METHOD GET_DEVCLASS.
RESULT = _DEVCLASS.
ENDMETHOD.
METHOD SET_DEVCLASS.
  CHECK DATA &lt;&gt; _DEVCLASS.

*  IF _DEVCLASS IS INITIAL AND _SUBSTITUTION = SUBSTITUTIONKINDS-FIXED.
*    RAISE EXCEPTION TYPE ZAPLINK_CX_OPT_DEVCLASS
*          EXPORTING TEXTID = ZAPLINK_CX_OPT_DEVCLASS=&gt;MISSING_DEVCLASS
*                 SUBSTKIND = _SUBSTITUTION.
*  ENDIF.
  _DEVCLASS = DATA.
ENDMETHOD.
METHOD GET_TRANSPORT_REQUEST.
  RESULT = _TR.
ENDMETHOD.
METHOD SET_TRANSPORT_REQUEST.
  CHECK DATA &lt;&gt; _TR.

*  IF _DEVCLASS IS INITIAL AND _SUBSTITUTION = SUBSTITUTIONKINDS-FIXED.
*    RAISE EXCEPTION TYPE ZAPLINK_CX_OPT_DEVCLASS
*          EXPORTING TEXTID = ZAPLINK_CX_OPT_DEVCLASS=&gt;MISSING_DEVCLASS
*                 SUBSTKIND = _SUBSTITUTION.
*  ENDIF.
  _TR = DATA.
ENDMETHOD.
METHOD GET_SUBSTITUTIONKIND_OFF.
RESULT = _SUBSTITUTION.
ENDMETHOD.
METHOD SET_SUBSTITUTIONKIND_OFF.
CHECK DATA &lt;&gt; _SUBSTITUTION.

  CASE DATA.
    WHEN SUBSTITUTIONKINDS-KEEP_CONTAINER OR
         SUBSTITUTIONKINDS-USE_COMPONENT OR
         SUBSTITUTIONKINDS-LOCAL.
    WHEN SUBSTITUTIONKINDS-FIXED.
      IF _DEVCLASS IS INITIAL.
        RAISE EXCEPTION TYPE ZAPLINK_CX_OPT_DEVCLASS
              EXPORTING TEXTID = ZAPLINK_CX_OPT_DEVCLASS=&gt;MISSING_DEVCLASS
                     SUBSTKIND = DATA.
      ENDIF.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE ZAPLINK_CX_OPT_DEVCLASS
            EXPORTING TEXTID = ZAPLINK_CX_OPT_DEVCLASS=&gt;INVALID_SUBSTITUTIONKIND
                   SUBSTKIND = DATA.
  ENDCASE.
  _SUBSTITUTION = DATA.
ENDMETHOD.
METHOD SET_DIRECTORY.
  DATA _NAME        TYPE TADIR-OBJ_NAME.
  DATA _TYPE        TYPE TADIR-OBJECT.
  DATA _ACT_DEVC    TYPE TADIR-DEVCLASS.
  DATA _EXISTS      TYPE SAUS_DPARA-TADIREXIST.

  CHECK COMPONENT IS BOUND.
  RESULT = COMPONENT-&gt;DIRECTORY.

  IF ME-&gt;_DEVCLASS IS BOUND.
    TRY.
        RESULT-DEVCLASS = ME-&gt;_DEVCLASS-&gt;SUBSTITUTE( COMPONENT ).
      CATCH ZAPLINK_CX_OPTIONS INTO O_MYCX.
        RAISE EXCEPTION O_MYCX.
    ENDTRY.
  ENDIF.

  IF ME-&gt;_TR IS BOUND.
    TRY.
        RESULT-TRKORR = _TR-&gt;SUBSTITUTE( COMPONENT ).
      CATCH ZAPLINK_CX_OPTIONS INTO O_MYCX.
        RAISE EXCEPTION O_MYCX.
    ENDTRY.
  ENDIF.

  _TYPE = COMPONENT-&gt;GET_TYPE( ).
  _NAME = COMPONENT-&gt;GET_NAME( ).
  CALL FUNCTION &apos;TRINT_TADIR_QUERY&apos;
    EXPORTING
      IV_PGMID           = &apos;R3TR&apos;
      IV_OBJECT          = _TYPE
      IV_OBJ_NAME        = _NAME
    IMPORTING
*      EV_OBJECT          =
*      EV_SRCSYSTEM       =
      EV_DEVCLASS        = _ACT_DEVC
*      EV_AUTHOR          =
*      EV_GENFLAG         =
      EV_EXIST           = _EXISTS.
  IF _EXISTS IS INITIAL.
    CALL FUNCTION &apos;TRINT_TADIR_INSERT&apos;
      EXPORTING
*        AUTHOR                     = SY-UNAME
*        MASTERLANG                 = &apos; &apos;
        DEVCLASS                   = RESULT-DEVCLASS
*        GENFLAG                    = &apos; &apos;
        OBJECT                     = _TYPE
        OBJ_NAME                   = _NAME
        PGMID                      = &apos;R3TR&apos;
*        SRCSYSTEM                  = SY-SYSID
*        EDTFLAG                    = &apos; &apos;
*        SRCDEP                     =
*        FORCE_MODE                 = &apos; &apos;
*        PAKNOCHECK                 = &apos; &apos;
*        OBJSTABLTY                 = &apos; &apos;
*        TRANSL_TECH_TEXT           = &apos; &apos;
*        DELFLAG                    = &apos; &apos;
*      IMPORTING
*        ES_TADIR                   =
      EXCEPTIONS
        OBJECT_EXISTS_GLOBAL       = 1
        OBJECT_EXISTS_LOCAL        = 2
        OTHERS                     = 3.
    IF SY-SUBRC &lt;&gt; 0.
      O_MYCX ?= ZAPLINK_CX=&gt;CREATE_FROM_MF_CX( FUNCNAME = &apos;TRINT_TADIR_INSERT&apos;
                                                  SUBRC = SY-SUBRC ).
      LOG-&gt;ADD_SYMSG( ).
      LOG-&gt;ADD_EXCEPTION( O_MYCX ).
      CLEAR O_MYCX.
    ENDIF.
  ELSEIF _ACT_DEVC &lt;&gt; RESULT-DEVCLASS.
    CALL FUNCTION &apos;TRINT_TADIR_MODIFY&apos;
      EXPORTING
*        AUTHOR                     = &apos;~&apos;
*        CPROJECT                   = &apos;~&apos;
        DEVCLASS                   = RESULT-DEVCLASS
*        EDTFLAG                    = &apos;~&apos;
*        EXISTS                     = &apos;~&apos;
*        GENFLAG                    = &apos;~&apos;
*        MASTERLANG                 = &apos;~&apos;
        OBJECT                     = _TYPE
        OBJ_NAME                   = _NAME
        PGMID                      = &apos;R3TR&apos;
*        SRCDEP                     = &apos;~&apos;
*        SRCSYSTEM                  = &apos;~&apos;
*        VERSID                     = &apos;~&apos;
*        CHANGE_MASTERLANG          = &apos;~&apos;
*        FORCE_MODE                 = &apos;~&apos;
*        PAKNOCHECK                 = &apos;~&apos;
*        OBJSTABLTY                 = &apos;~&apos;
*        DELFLAG                    = &apos;~&apos;
*        TRANSL_TECH_TEXT           = &apos;~&apos;
*      IMPORTING
*        ES_TADIR                   =
      EXCEPTIONS
        OBJECT_EXISTS_GLOBAL       = 1
        OBJECT_EXISTS_LOCAL        = 2
        OBJECT_HAS_NO_TADIR        = 3
        OTHERS                     = 4.
    IF SY-SUBRC &lt;&gt; 0.
      O_MYCX ?= ZAPLINK_CX=&gt;CREATE_FROM_MF_CX( FUNCNAME = &apos;TRINT_TADIR_MODIFY&apos;
                                                  SUBRC = SY-SUBRC ).
      LOG-&gt;ADD_SYMSG( ).
      LOG-&gt;ADD_EXCEPTION( O_MYCX ).
      CLEAR O_MYCX.
    ENDIF.
  ENDIF.

  CALL FUNCTION &apos;RS_CORR_INSERT&apos;
    EXPORTING
      OBJECT                         = _NAME
      OBJECT_CLASS                   = _TYPE
      MODE                           = &apos;I&apos;        &quot; INSERT
      GLOBAL_LOCK                    = ABAP_TRUE            &quot; R3TR
      DEVCLASS                       = RESULT-DEVCLASS
      KORRNUM                        = RESULT-TRKORR
*      USE_KORRNUM_IMMEDIATEDLY       = &apos; &apos;
*      AUTHOR                         = &apos; &apos;
*      MASTER_LANGUAGE                = &apos; &apos;
*      GENFLAG                        = &apos; &apos;
*      PROGRAM                        = &apos; &apos;
*      OBJECT_CLASS_SUPPORTS_MA       = &apos; &apos;
*      EXTEND                         = &apos; &apos;
*      SUPPRESS_DIALOG                = &apos; &apos;
*      MOD_LANGU                      = &apos; &apos;
*      ACTIVATION_CALL                = &apos; &apos;
    IMPORTING
*      DEVCLASS                       =
      KORRNUM                        = RESULT-TRKORR
*      ORDERNUM                       =
*      NEW_CORR_ENTRY                 =
*      AUTHOR                         =
*      TRANSPORT_KEY                  =
*      NEW_EXTEND                     =
    EXCEPTIONS
      CANCELLED                      = 1
      PERMISSION_FAILURE             = 2
      UNKNOWN_OBJECTCLASS            = 3
      OTHERS                         = 4.
  IF SY-SUBRC &lt;&gt; 0.
    O_MYCX ?= ZAPLINK_CX=&gt;CREATE_FROM_MF_CX( FUNCNAME = &apos;TRINT_TADIR_MODIFY&apos;
                                                SUBRC = SY-SUBRC ).
    LOG-&gt;ADD_SYMSG( ).
    LOG-&gt;ADD_EXCEPTION( O_MYCX ).
    CLEAR O_MYCX.
  ENDIF.

ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_OPT_DIRECTORY IMPLEMENTATION

CLASS ZAPLINK_OPTIONS IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD GET_DEVCLASS.
  RESULT = DEVCLASS.
ENDMETHOD.
METHOD SET_DEVCLASS.
  CHECK DATA &lt;&gt; DEVCLASS.
  DEVCLASS = DATA.
ENDMETHOD.
METHOD GET_DIRECTORY.
  RESULT = DIRECTORY.
ENDMETHOD.
METHOD SET_DIRECTORY.
  CHECK DATA &lt;&gt; DIRECTORY.
  DIRECTORY = DATA.
ENDMETHOD.
METHOD CONSTRUCTOR.
  CREATE OBJECT DIRECTORY.
  CREATE OBJECT DEVCLASS.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_OPTIONS IMPLEMENTATION

CLASS ZAPLINK_COMPONENT IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CLONE.
*  CREATE OBJECT RESULT.
  RESULT = ME.
ENDMETHOD.
METHOD CONNECTOR.
RESULT = _CONNECTOR-O_CONN.
ENDMETHOD.
METHOD CONNECTOR_EXISTS.
RESULT = _CONNECTOR-EXISTS.
ENDMETHOD.
METHOD CREATE_NEW.
DATA _CX TYPE REF TO ZAPLINK_CX_COMPONENT.
  TRY.
      CREATE OBJECT RESULT.
      RESULT-&gt;_SET_KEY( KEY ).
    CATCH ZAPLINK_CX_COMPONENT INTO _CX.
      RAISE EXCEPTION _CX.
  ENDTRY.
ENDMETHOD.
METHOD EXISTS.
RESULT = _EXISTS.
ENDMETHOD.
METHOD GET_DEVCLASS.
RESULT = _DEVCLASS.
ENDMETHOD.
METHOD GET_EXCEPTION.
RESULT = _EXCEPTION.
ENDMETHOD.
METHOD GET_KEY.
IF TYPE IS INITIAL OR NAME IS INITIAL.
    RAISE EXCEPTION TYPE ZAPLINK_CX_COMPONENT
               EXPORTING TEXTID = ZAPLINK_CX_COMPONENT=&gt;SYSTEM_ERROR.
  ENDIF.
  RESULT-TYPE = TYPE.
  RESULT-NAME = NAME.
ENDMETHOD.
METHOD GET_MSG_COLL.
RESULT = _MSG_COLL.
ENDMETHOD.
METHOD GET_NAME.
RESULT = NAME.
ENDMETHOD.
METHOD GET_SUBCOMPONENTS.
RESULT = _SUBCOMPONENTS.
ENDMETHOD.
METHOD GET_TYPE.
RESULT = TYPE.
ENDMETHOD.
METHOD ON_CHANGE_CLEAR.
  CLEAR: _EXISTS.
  CLEAR: _CONNECTOR-UUID.
ENDMETHOD.
METHOD ON_CHANGE_UPDATE.
  IF _CONNECTOR-O_CONN IS BOUND.
    _EXISTS = _CONNECTOR-O_CONN-&gt;DO_EXISTS( ME ).
    _CONNECTOR-UUID = _CONNECTOR-O_CONN-&gt;UUID.
  ENDIF.
ENDMETHOD.
METHOD SET_DEVCLASS.
  CHECK DATA &lt;&gt; _DEVCLASS.
  _DEVCLASS = DATA.
ENDMETHOD.
METHOD SET_EXCEPTION.
DATA CX TYPE REF TO CX_ROOT.
  DATA _CX TYPE REF TO ZAPLINK_CX_COMPONENT.
  DATA _DESC TYPE REF TO CL_ABAP_TYPEDESCR.

  IF DATA IS BOUND.
    TRY.
        _EXCEPTION ?= DATA.
      CATCH CX_ROOT INTO CX.
        _DESC = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_OBJECT_REF( DATA ).
* CAN&apos;T SET EXCEPTION TO THE PROVIDED OBJECT TYPE : &apos;&amp;OBJTYPE&amp;&apos;
        CREATE OBJECT _CX
          EXPORTING
            TEXTID   = ZAPLINK_CX_COMPONENT=&gt;INVALID_EXCEPTION
            OBJTYPE  = _DESC-&gt;ABSOLUTE_NAME
            PREVIOUS = CX.
        _CX-&gt;UPDATE( ).
        RAISE EXCEPTION _CX.
    ENDTRY.
  ELSE.
    CLEAR _EXCEPTION.
  ENDIF.
ENDMETHOD.
METHOD SET_MSG_COLL.
DATA CX TYPE REF TO CX_ROOT.
  DATA _CX TYPE REF TO ZAPLINK_CX_COMPONENT.
  DATA _DESC TYPE REF TO CL_ABAP_TYPEDESCR.

  IF DATA IS BOUND.
    TRY.
        _MSG_COLL ?= DATA.
      CATCH CX_ROOT INTO CX.
        _DESC = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_OBJECT_REF( DATA ).
* CAN&apos;T SET MESSAGE COLLECTOR TO THE PROVIDED OBJECT TYPE : &apos;&amp;OBJTYPE&amp;&apos;
        CREATE OBJECT _CX
          EXPORTING
            TEXTID   = ZAPLINK_CX_COMPONENT=&gt;INVALID_MSG_COLL
            OBJTYPE  = _DESC-&gt;ABSOLUTE_NAME
            PREVIOUS = CX.
        _CX-&gt;UPDATE( ).
        RAISE EXCEPTION _CX.
    ENDTRY.
  ELSE.
    CLEAR _MSG_COLL.
  ENDIF.
ENDMETHOD.
METHOD SET_NAME.
  CHECK DATA &lt;&gt; NAME.
  NAME = DATA.
  ON_CHANGE_CLEAR( ).
  ON_CHANGE_UPDATE( ).
ENDMETHOD.
METHOD SET_SUBCOMPONENTS.
DATA CX TYPE REF TO CX_ROOT.
  DATA _CX TYPE REF TO ZAPLINK_CX_COMPONENT.
  DATA _DESC TYPE REF TO CL_ABAP_TYPEDESCR.

  IF DATA IS BOUND.
    TRY.
        _SUBCOMPONENTS ?= DATA.
      CATCH CX_ROOT INTO CX.
        _DESC = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_OBJECT_REF( DATA ).
* CAN&apos;T SET MESSAGE COLLECTOR TO THE PROVIDED OBJECT TYPE : &apos;&amp;OBJTYPE&amp;&apos;
        CREATE OBJECT _CX
          EXPORTING
            TEXTID   = ZAPLINK_CX_COMPONENT=&gt;INVALID_SUBCOMPONENTS
            OBJTYPE  = _DESC-&gt;ABSOLUTE_NAME
            PREVIOUS = CX.
        _CX-&gt;UPDATE( ).
        RAISE EXCEPTION _CX.
    ENDTRY.
  ELSE.
    CLEAR _MSG_COLL.
  ENDIF.
ENDMETHOD.
METHOD SET_TYPE.
  DATA _CX TYPE REF TO ZAPLINK_CX.
  DATA O_CONN TYPE TO_CONNECTOR.

  CHECK DATA &lt;&gt; TYPE.

  TRY.
      O_CONN = ZAPLINK_CONNECTORS=&gt;CREATE_CONNECTOR( TYPE = DATA ).

      TYPE = DATA.
      CLEAR _CONNECTOR.
      ON_CHANGE_CLEAR( ).
      _CONNECTOR-O_CONN = O_CONN.
*      CLEAR _CONNECTOR-CLASSNAME.
      IF O_CONN IS BOUND.
        _CONNECTOR-EXISTS = CONNEXISTS-EXISTS.
      ELSE.
        _CONNECTOR-EXISTS = CONNEXISTS-NOT_EXISTS.
      ENDIF.
      ON_CHANGE_UPDATE( ).

    CATCH ZAPLINK_CX INTO _CX.
      CREATE OBJECT O_EXCEPTION
        EXPORTING
          TEXTID  = ZAPLINK_CX=&gt;SYSTEM_ERROR
          PREV_CX = _CX.
      _CX-&gt;UPDATE( ).
      RAISE EXCEPTION O_EXCEPTION.
  ENDTRY.

ENDMETHOD.
METHOD _GET_KEY.
RESULT-TYPE = TYPE.
  RESULT-NAME = NAME.
ENDMETHOD.
METHOD _SET_KEY.
DATA _CX TYPE REF TO ZAPLINK_CX_COMPONENT.
  TRY.
      SET_TYPE( DATA-TYPE ).
      SET_NAME( DATA-NAME ).
    CATCH ZAPLINK_CX_COMPONENT INTO _CX.
      RAISE EXCEPTION _CX.
  ENDTRY.
ENDMETHOD.
METHOD SET_CONNUUID.
  DATA _CX    TYPE REF TO ZAPLINK_CX.
  DATA O_CONN TYPE TO_CONNECTOR.

  CHECK DATA &lt;&gt; _CONNECTOR-UUID.

  TRY.
      O_CONN = ZAPLINK_CONNECTORS=&gt;CREATE_CONNECTOR( TYPE = TYPE
                                                 CONNUUID = DATA ).

      _CONNECTOR-O_CONN = O_CONN.
      ON_CHANGE_CLEAR( ).
      _CONNECTOR-UUID = DATA.
      IF O_CONN IS BOUND.
        _CONNECTOR-EXISTS = CONNEXISTS-EXISTS.
      ELSE.
        _CONNECTOR-EXISTS = CONNEXISTS-NOT_EXISTS.
      ENDIF.
      ON_CHANGE_UPDATE( ).

    CATCH ZAPLINK_CX INTO _CX.
      CREATE OBJECT O_EXCEPTION
        EXPORTING
          TEXTID  = ZAPLINK_CX=&gt;SYSTEM_ERROR
          PREV_CX = _CX.
      _CX-&gt;UPDATE( ).
      RAISE EXCEPTION O_EXCEPTION.
  ENDTRY.

ENDMETHOD.
METHOD GET_CONNUUID.
  RESULT = _CONNECTOR-UUID.
ENDMETHOD.
METHOD GET_CLASS_OFF.
*RESULT = _CONNECTOR-CLASSNAME.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_COMPONENT IMPLEMENTATION

CLASS ZAPLINK_CX_CONTAINER IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MSG = MSG
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
.
 IF TEXTID IS INITIAL.
   ME-&gt;TEXTID = ZAPLINK_CX_CONTAINER .
 ENDIF.
ME-&gt;NAME = NAME .
ME-&gt;TYPE = TYPE .
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_CX_CONTAINER IMPLEMENTATION

CLASS ZAPLINK_CX_FILE IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONSTRUCTOR.
CALL METHOD SUPER-&gt;CONSTRUCTOR
EXPORTING
TEXTID = TEXTID
PREVIOUS = PREVIOUS
MSG = MSG
MESSAGES = MESSAGES
OBJECT = OBJECT
SUBOBJECT = SUBOBJECT
PREV_CX = PREV_CX
EXT_ID = EXT_ID
CX_NAME = CX_NAME
.
 IF TEXTID IS INITIAL.
   ME-&gt;TEXTID = ZAPLINK_CX_FILE .
 ENDIF.
ME-&gt;FILENAME = FILENAME .
ME-&gt;FILETYPE = FILETYPE .
ME-&gt;FILEKIND = FILEKIND .
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_CX_FILE IMPLEMENTATION

CLASS ZAPLINK_FILE IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD GET_FILECONTENT.
RESULT = _CONTENT.
ENDMETHOD.
METHOD GET_FILENAME.
RESULT = _FILENAME.
ENDMETHOD.
METHOD GET_FILETYPE.
RESULT = _FILETYPE.
ENDMETHOD.
METHOD LOAD.
DATA TMPTABLE TYPE TABLE_OF_STRINGS.
  DATA CX_NAME TYPE STRING.
  DATA CX TYPE REF TO CX_ROOT.
  DATA _CX TYPE REF TO ZAPLINK_CX_FILE.
  DATA _STR LIKE LINE OF TMPTABLE.
  FIELD-SYMBOLS:
    &lt;S&gt; LIKE LINE OF TMPTABLE.

  IF _FILETYPE = C_FT_LOCAL.
    CALL METHOD CL_GUI_FRONTEND_SERVICES=&gt;GUI_UPLOAD
      EXPORTING
        FILENAME                = _FILENAME
      CHANGING
        DATA_TAB                = TMPTABLE
      EXCEPTIONS
        FILE_OPEN_ERROR         = 1
        FILE_READ_ERROR         = 2
        NO_BATCH                = 3
        GUI_REFUSE_FILETRANSFER = 4
        INVALID_TYPE            = 5
        NO_AUTHORITY            = 6
        UNKNOWN_ERROR           = 7
        BAD_DATA_FORMAT         = 8
        HEADER_NOT_ALLOWED      = 9
        SEPARATOR_NOT_ALLOWED   = 10
        HEADER_TOO_LONG         = 11
        UNKNOWN_DP_ERROR        = 12
        ACCESS_DENIED           = 13
        DP_OUT_OF_MEMORY        = 14
        DISK_FULL               = 15
        DP_TIMEOUT              = 16
        NOT_SUPPORTED_BY_GUI    = 17
        ERROR_NO_GUI            = 18
        OTHERS                  = 19.
    IF SY-SUBRC &lt;&gt; 0.
      CASE SY-SUBRC.
        WHEN &apos;1&apos;.
          CX_NAME = &apos;FILE_OPEN_ERROR&apos;.
        WHEN OTHERS.
          CX_NAME = &apos;OTHERS&apos;.
      ENDCASE.
* EXCEPTION &amp;CX_NAME&amp; WHILE LOADING FILE &amp;FILENAME&amp; (&amp;FILETYPE&amp;)
      RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
            EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;LOAD_ERROR
                    FILENAME = _FILENAME
                    FILETYPE = _FILETYPE
                     CX_NAME = CX_NAME.
    ENDIF.
    LOOP AT TMPTABLE ASSIGNING &lt;S&gt;.
      CONCATENATE _CONTENT &lt;S&gt; CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE
                  INTO _CONTENT.
    ENDLOOP.
  ELSEIF _FILETYPE = C_FT_SERVER.
    TRY.
        OPEN DATASET _FILENAME FOR INPUT IN TEXT MODE ENCODING DEFAULT.
      CATCH CX_ROOT INTO CX.
* EXCEPTION &amp;CX_NAME&amp; WHILE LOADING FILE &amp;FILENAME&amp; (&amp;FILETYPE&amp;)
        CREATE OBJECT _CX
          EXPORTING
            TEXTID   = ZAPLINK_CX_FILE=&gt;LOAD_ERROR
            FILENAME = _FILENAME
            FILETYPE = _FILETYPE
            PREVIOUS = CX.
        _CX-&gt;UPDATE( ).
        RAISE EXCEPTION _CX.
    ENDTRY.
    IF SY-SUBRC &lt;&gt; 0.
* EXCEPTION &amp;CX_NAME&amp; WHILE LOADING FILE &amp;FILENAME&amp; (&amp;FILETYPE&amp;)
      RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
            EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;LOAD_ERROR
                    FILENAME = _FILENAME
                    FILETYPE = _FILETYPE
                     CX_NAME = &apos;OPEN DATASET&apos;.
    ENDIF.

    DO.
      TRY.
          READ DATASET _FILENAME INTO _STR.
        CATCH CX_ROOT INTO CX.
* EXCEPTION &amp;CX_NAME&amp; WHILE LOADING FILE &amp;FILENAME&amp; (&amp;FILETYPE&amp;)
          CREATE OBJECT _CX
            EXPORTING
              TEXTID   = ZAPLINK_CX_FILE=&gt;LOAD_ERROR
              FILENAME = _FILENAME
              FILETYPE = _FILETYPE
              PREVIOUS = CX.
          _CX-&gt;UPDATE( ).
          RAISE EXCEPTION _CX.
      ENDTRY.
      IF SY-SUBRC &lt;&gt; 0.
        EXIT.
      ENDIF.
      APPEND _STR TO TMPTABLE.
    ENDDO.

    TRY.
        CLOSE DATASET _FILENAME.
      CATCH CX_ROOT INTO CX.
* EXCEPTION &amp;CX_NAME&amp; WHILE LOADING FILE &amp;FILENAME&amp; (&amp;FILETYPE&amp;)
        CREATE OBJECT _CX
          EXPORTING
            TEXTID   = ZAPLINK_CX_FILE=&gt;LOAD_ERROR
            FILENAME = _FILENAME
            FILETYPE = _FILETYPE
            PREVIOUS = CX.
        _CX-&gt;UPDATE( ).
        RAISE EXCEPTION _CX.
    ENDTRY.
    IF SY-SUBRC &lt;&gt; 0.
* EXCEPTION &amp;CX_NAME&amp; WHILE LOADING FILE &amp;FILENAME&amp; (&amp;FILETYPE&amp;)
      RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
            EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;LOAD_ERROR
                    FILENAME = _FILENAME
                    FILETYPE = _FILETYPE
                     CX_NAME = &apos;CLOSE DATASET&apos;.
    ENDIF.
  ELSE.
    RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
          EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;INVALID_FILETYPE
                  FILETYPE = _FILETYPE.
  ENDIF.
ENDMETHOD.
METHOD LOAD_DIALOG.
DATA FT TYPE FILETABLE.
  DATA FILECOUNT TYPE I.
  DATA CX_NAME TYPE STRING.

  IF _FILETYPE = C_FT_LOCAL.
    CALL METHOD CL_GUI_FRONTEND_SERVICES=&gt;FILE_OPEN_DIALOG
      EXPORTING
*        WINDOW_TITLE            =
*        DEFAULT_EXTENSION       =
        DEFAULT_FILENAME        = FILENAME
*        FILE_FILTER             =
*        WITH_ENCODING           =
*        INITIAL_DIRECTORY       =
*        MULTISELECTION          =
      CHANGING
        FILE_TABLE              = FT
        RC                      = FILECOUNT
*        USER_ACTION             =
*        FILE_ENCODING           =
      EXCEPTIONS
        FILE_OPEN_DIALOG_FAILED = 1
        CNTL_ERROR              = 2
        ERROR_NO_GUI            = 3
        NOT_SUPPORTED_BY_GUI    = 4
        OTHERS                  = 5.
    IF SY-SUBRC &lt;&gt; 0 OR FILECOUNT &lt; 0.
      CASE SY-SUBRC.
        WHEN &apos;1&apos;.
          CX_NAME = &apos;FILE_OPEN_DIALOG_FAILED&apos;.
        WHEN OTHERS.
          CX_NAME = &apos;OTHERS&apos;.
      ENDCASE.
* EXCEPTION &amp;CX_NAME&amp; WHILE SAVING FILE &amp;FILENAME&amp; (&amp;FILETYPE&amp;)
      RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
            EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;DIALOG_CANCELED
                    FILENAME = FILENAME
                    FILETYPE = _FILETYPE
                     CX_NAME = CX_NAME.
    ENDIF.
    IF FILECOUNT = 0 OR FT IS INITIAL.
* DIALOG CANCELED BY USER
      RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
            EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;DIALOG_CANCELED
                    FILENAME = FILENAME
                    FILETYPE = _FILETYPE.
    ENDIF.
    READ TABLE FT INTO _FILENAME INDEX 1.
  ELSEIF _FILETYPE = C_FT_SERVER.
* NO DIALOG RIGHT NOW
  ELSE.
    RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
          EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;INVALID_FILETYPE
                  FILETYPE = _FILETYPE.
  ENDIF.
ENDMETHOD.
METHOD SAVE.
DATA TMPTABLE TYPE TABLE_OF_STRINGS.
  DATA CX_NAME TYPE STRING.
  DATA CX TYPE REF TO CX_ROOT.
  DATA _CX TYPE REF TO ZAPLINK_CX_FILE.
  FIELD-SYMBOLS:
    &lt;S&gt; LIKE LINE OF TMPTABLE.

  SPLIT _CONTENT AT CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE
            INTO TABLE TMPTABLE.

  IF _FILETYPE = C_FT_LOCAL.
    IF _FILENAME IS INITIAL.
      SAVE_DIALOG( ).
    ELSE.
      CALL METHOD CL_GUI_FRONTEND_SERVICES=&gt;GUI_DOWNLOAD
        EXPORTING
*          BIN_FILESIZE              =
          FILENAME                  = _FILENAME
          FILETYPE                  = &apos;DAT&apos;
*      APPEND                    = SPACE
*      WRITE_FIELD_SEPARATOR     = SPACE
*      HEADER                    = &apos;00&apos;
*      TRUNC_TRAILING_BLANKS     = SPACE
*      WRITE_LF                  = &apos;X&apos;
*      COL_SELECT                = SPACE
*      COL_SELECT_MASK           = SPACE
*      DAT_MODE                  = SPACE
*      CONFIRM_OVERWRITE         = SPACE
*      NO_AUTH_CHECK             = SPACE
*      CODEPAGE                  = SPACE
*      IGNORE_CERR               = ABAP_TRUE
*      REPLACEMENT               = &apos;#&apos;
*      WRITE_BOM                 = SPACE
*      TRUNC_TRAILING_BLANKS_EOL = &apos;X&apos;
*      WK1_N_FORMAT              = SPACE
*      WK1_N_SIZE                = SPACE
*      WK1_T_FORMAT              = SPACE
*      WK1_T_SIZE                = SPACE
*    IMPORTING
*      FILELENGTH                =
        CHANGING
          DATA_TAB                  = TMPTABLE
        EXCEPTIONS
          FILE_WRITE_ERROR          = 1
          NO_BATCH                  = 2
          GUI_REFUSE_FILETRANSFER   = 3
          INVALID_TYPE              = 4
          NO_AUTHORITY              = 5
          UNKNOWN_ERROR             = 6
          HEADER_NOT_ALLOWED        = 7
          SEPARATOR_NOT_ALLOWED     = 8
          FILESIZE_NOT_ALLOWED      = 9
          HEADER_TOO_LONG           = 10
          DP_ERROR_CREATE           = 11
          DP_ERROR_SEND             = 12
          DP_ERROR_WRITE            = 13
          UNKNOWN_DP_ERROR          = 14
          ACCESS_DENIED             = 15
          DP_OUT_OF_MEMORY          = 16
          DISK_FULL                 = 17
          DP_TIMEOUT                = 18
          FILE_NOT_FOUND            = 19
          DATAPROVIDER_EXCEPTION    = 20
          CONTROL_FLUSH_ERROR       = 21
          NOT_SUPPORTED_BY_GUI      = 22
          ERROR_NO_GUI              = 23
          OTHERS                    = 24.
      IF SY-SUBRC &lt;&gt; 0.
        CASE SY-SUBRC.
          WHEN &apos;1&apos;.
            CX_NAME = &apos;&apos;.
          WHEN OTHERS.
            CX_NAME = &apos;OTHERS&apos;.
        ENDCASE.
* EXCEPTION &amp;CX_NAME&amp; WHILE SAVING FILE &amp;FILENAME&amp; (&amp;FILETYPE&amp;)
        RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
              EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;SAVE_ERROR
                      FILENAME = _FILENAME
                      FILETYPE = _FILETYPE
                       CX_NAME = CX_NAME.
      ENDIF.
    ENDIF.
  ELSEIF _FILETYPE = C_FT_SERVER.
    TRY.
        OPEN DATASET _FILENAME FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.
      CATCH CX_ROOT INTO CX.
* EXCEPTION &amp;CX_NAME&amp; WHILE SAVING FILE &amp;FILENAME&amp; (&amp;FILETYPE&amp;)
        CREATE OBJECT _CX
          EXPORTING
            TEXTID   = ZAPLINK_CX_FILE=&gt;SAVE_ERROR
            FILENAME = _FILENAME
            FILETYPE = _FILETYPE
            PREVIOUS = CX.
        _CX-&gt;UPDATE( ).
        RAISE EXCEPTION _CX.
    ENDTRY.
    IF SY-SUBRC &lt;&gt; 0.
* EXCEPTION &amp;CX_NAME&amp; WHILE SAVING FILE &amp;FILENAME&amp; (&amp;FILETYPE&amp;)
      RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
            EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;SAVE_ERROR
                    FILENAME = _FILENAME
                    FILETYPE = _FILETYPE
                     CX_NAME = &apos;OPEN DATASET&apos;.
    ENDIF.

    LOOP AT TMPTABLE ASSIGNING &lt;S&gt;.
      TRY.
          TRANSFER &lt;S&gt; TO _FILENAME.
        CATCH CX_ROOT INTO CX.
* EXCEPTION &amp;CX_NAME&amp; WHILE SAVING FILE &amp;FILENAME&amp; (&amp;FILETYPE&amp;)
          CREATE OBJECT _CX
            EXPORTING
              TEXTID   = ZAPLINK_CX_FILE=&gt;SAVE_ERROR
              FILENAME = _FILENAME
              FILETYPE = _FILETYPE
              PREVIOUS = CX.
          _CX-&gt;UPDATE( ).
          RAISE EXCEPTION _CX.
      ENDTRY.
    ENDLOOP.

    TRY.
        CLOSE DATASET _FILENAME.
      CATCH CX_ROOT INTO CX.
* EXCEPTION &amp;CX_NAME&amp; WHILE SAVING FILE &amp;FILENAME&amp; (&amp;FILETYPE&amp;)
        CREATE OBJECT _CX
          EXPORTING
            TEXTID   = ZAPLINK_CX_FILE=&gt;SAVE_ERROR
            FILENAME = _FILENAME
            FILETYPE = _FILETYPE
            PREVIOUS = CX.
        _CX-&gt;UPDATE( ).
        RAISE EXCEPTION _CX.
    ENDTRY.
    IF SY-SUBRC &lt;&gt; 0.
* EXCEPTION &amp;CX_NAME&amp; WHILE SAVING FILE &amp;FILENAME&amp; (&amp;FILETYPE&amp;)
      RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
            EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;SAVE_ERROR
                    FILENAME = _FILENAME
                    FILETYPE = _FILETYPE
                     CX_NAME = &apos;CLOSE DATASET&apos;.
    ENDIF.
  ELSE.
    RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
          EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;INVALID_FILETYPE
                  FILETYPE = _FILETYPE.
  ENDIF.
ENDMETHOD.
METHOD SAVE_DIALOG.
DATA RETFILENAME TYPE STRING.
  DATA RETPATH TYPE STRING.
  DATA RETFULLPATH TYPE STRING.
  DATA RETUSERACT TYPE I.

  IF FILENAME IS INITIAL.
    RETFILENAME = _FILENAME.
  ELSE.
    RETFILENAME = FILENAME.
  ENDIF.
  IF _FILETYPE = C_FT_LOCAL.

    CALL METHOD CL_GUI_FRONTEND_SERVICES=&gt;FILE_SAVE_DIALOG
      EXPORTING
        DEFAULT_FILE_NAME = RETFILENAME
      CHANGING
        FILENAME          = RETFILENAME
        PATH              = RETPATH
        FULLPATH          = RETFULLPATH
        USER_ACTION       = RETUSERACT.
    IF RETUSERACT &lt;&gt; 0.
* DIALOG CANCELED BY USER
      RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
            EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;DIALOG_CANCELED
                    FILENAME = FILENAME
                    FILETYPE = _FILETYPE.
    ENDIF.
    _FILENAME = RETFILENAME.
  ELSEIF _FILETYPE = C_FT_SERVER.
* NO DIALOG RIGHT NOW
  ELSE.
    RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
          EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;INVALID_FILETYPE
                  FILETYPE = _FILETYPE.
  ENDIF.
ENDMETHOD.
METHOD SET_FILECONTENT.
_CONTENT = DATA.
ENDMETHOD.
METHOD SET_FILENAME.
IF DATA IS INITIAL.
* FILENAME &apos;&amp;FILE&amp;&apos; IS INVALID. PLEASE PROVIDE A VALID FILENAME FOR FILETYPE &apos;&amp;FILETYPE&amp;&apos;
    RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
          EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;INVALID_FILENAME
                  FILENAME = DATA
                  FILETYPE = _FILETYPE.
  ENDIF.
  IF NOT _FILETYPE IS INITIAL.
* TODO CHECK FILENAME
  ENDIF.
  _FILENAME = DATA.
ENDMETHOD.
METHOD SET_FILETYPE.
IF DATA &lt;&gt; C_FT_LOCAL AND DATA &lt;&gt; C_FT_SERVER.
    RAISE EXCEPTION TYPE ZAPLINK_CX_FILE
          EXPORTING TEXTID = ZAPLINK_CX_FILE=&gt;INVALID_FILETYPE
                  FILETYPE = DATA.
  ENDIF.
  IF NOT _FILENAME IS INITIAL.
* TODO CHECK FILENAME
  ENDIF.
  _FILETYPE = DATA.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_FILE IMPLEMENTATION

CLASS ZAPLINK_CONTAINER_4INST IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CLASS_CONSTRUCTOR.
XMLENGINE = CL_IXML=&gt;CREATE( ).
ENDMETHOD.
METHOD CONSTRUCTOR.
  CREATE OBJECT _COMPLIST.
  CREATE OBJECT _OPTIONS.
  CREATE OBJECT LOG.
  CALL METHOD LOG-&gt;INIT
    EXPORTING
      ID_OBJECT      = BALLOG_OBJECT
      ID_SUBOBJECT   = BALLOG_SUBOBJECT
*      ID_EXTNUMBER   =
      AUTO_UPD_CUSTO = ABAP_TRUE
*      ID_ACTIVITY    = ACT_CREATE
    EXCEPTIONS
      ERROR          = 1
      OTHERS         = 2.
  IF SY-SUBRC &lt;&gt; 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
               WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.
  XMLDATA = XMLENGINE-&gt;CREATE_DOCUMENT( ).
  FILE = O_FILE.
ENDMETHOD.
METHOD GET_CONTENT.
RESULT = _COMPLIST-&gt;CLONE( ).
ENDMETHOD.
METHOD GET_ROOT.
ROOT = XMLDATA-&gt;GET_FIRST_CHILD( ).
  CHECK ROOT IS BOUND.
  IF ROOT-&gt;GET_NAME( ) &lt;&gt; TN_NUGGET.
    CLEAR ROOT.
  ENDIF.
ENDMETHOD.
METHOD LOAD_FROM_FILE.
DATA _STREAMFACTORY TYPE REF TO IF_IXML_STREAM_FACTORY.
  DATA _STREAM TYPE REF TO IF_IXML_ISTREAM.
  DATA _PARSER TYPE REF TO IF_IXML_PARSER.
  DATA _DOC TYPE REF TO IF_IXML_DOCUMENT.
  DATA _XML TYPE STRING.
  DATA _FILE  TYPE TO_FILE.

  IF O_FILE IS BOUND.
    _FILE = O_FILE.
  ELSE.
    _FILE = FILE.
  ENDIF.

  TRY.
      _FILE-&gt;LOAD( ).
      _XML = _FILE-&gt;GET_FILECONTENT( ).
    CATCH ZAPLINK_CX_FILE.
      RETURN.
  ENDTRY.
  FILE = _FILE.

  _STREAMFACTORY = XMLENGINE-&gt;CREATE_STREAM_FACTORY( ).
  _DOC = XMLENGINE-&gt;CREATE_DOCUMENT( ).
  _STREAM = _STREAMFACTORY-&gt;CREATE_ISTREAM_STRING( _XML ).
  _PARSER = XMLENGINE-&gt;CREATE_PARSER(  STREAM_FACTORY = _STREAMFACTORY
                                       ISTREAM        = _STREAM
                                       DOCUMENT       = _DOC ).
  _PARSER-&gt;PARSE( ).
  IF _DOC IS BOUND.
    XMLDATA = _DOC.
  ENDIF.

  _UPDATE_COMPONENTSLIST( ).
ENDMETHOD.
METHOD TRANSPORT_TO_SAP.
  DATA O_CONNECTOR  TYPE TO_CONNECTOR.
  DATA O_COMP       TYPE TO_COMPONENT.
  DATA O_COMP_S     TYPE TO_COMPONENT.
  DATA O_LISTSUB    TYPE TO_LIST.
  DATA O_SUBCOMP    TYPE TO_COMPONENT.
  DATA O_SUBCOMP_S  TYPE TO_COMPONENT.
  DATA OBJECT       TYPE TO_RAW.
  DATA _COMPONENTS  TYPE TO_LIST.
  DATA _XML_COMP    TYPE REF TO IF_IXML_DOCUMENT.
  DATA _CLONE       TYPE REF TO IF_IXML_NODE.
  DATA _CX_CONNECTOR TYPE REF TO ZAPLINK_CX_CONNECTOR.
  DATA O_RAW        TYPE TO_RAW.
  DATA _DIRECTORY   TYPE TS_DIRECTORY.
  DATA O_LOG        TYPE TO_LOG.

  CHECK OBJECT_LIST IS BOUND.
  OBJECT_LIST-&gt;KEEP_COMMUN_LIST( _COMPLIST ).
  OBJECT_LIST-&gt;DISPLAY_PROGRESS = ABAP_TRUE.

  OBJECT_LIST-&gt;INIT_SEL_ITER( ).
  O_COMP = OBJECT_LIST-&gt;GET_NEXT( ).
  WHILE O_COMP IS BOUND.
    O_COMP_S = _COMPLIST-&gt;SEARCH( O_COMP ).
    O_CONNECTOR = O_COMP_S-&gt;CONNECTOR( ).
    O_CONNECTOR-&gt;OPTIONS = _OPTIONS.
    O_LOG = O_COMP_S-&gt;GET_MSG_COLL( ).
    IF NOT O_LOG IS BOUND.
      CREATE OBJECT O_LOG.
      O_COMP_S-&gt;SET_MSG_COLL( O_LOG ).
      CALL METHOD O_LOG-&gt;INIT
        EXPORTING
          ID_OBJECT      = BALLOG_OBJECT
          ID_SUBOBJECT   = BALLOG_SUBOBJECT
*          ID_EXTNUMBER   =
          AUTO_UPD_CUSTO = ABAP_TRUE
*          ID_ACTIVITY    = ACT_CREATE
        EXCEPTIONS
          ERROR          = 1
          OTHERS         = 2.
      IF SY-SUBRC &lt;&gt; 0.
        LOG-&gt;ADD_SYMSG( ).
      ENDIF.
    ENDIF.

    _XML_COMP = XMLENGINE-&gt;CREATE_DOCUMENT( ).
    _CLONE = _FIND_COMPONENT_NODE( O_COMP_S ).
    _CLONE = _CLONE-&gt;CLONE( ).
    _XML_COMP-&gt;IF_IXML_NODE~APPEND_CHILD( _CLONE ).

    TRY.
* MAKE DIRECTORY ENTRY
        O_RAW = ZAPLINK_CONNECTORS=&gt;NODE_2_RAW( _CLONE ).
        _DIRECTORY = _OPTIONS-&gt;DIRECTORY-&gt;SET_DIRECTORY( O_RAW ).
        O_LOG-&gt;ADD_FROM_INSTANCE( _OPTIONS-&gt;DIRECTORY-&gt;LOG ).
* SUB COMPONENTS
        O_LISTSUB = O_COMP_S-&gt;GET_SUBCOMPONENTS( ).
        IF O_LISTSUB IS BOUND.
          O_LISTSUB-&gt;DISPLAY_PROGRESS = ABAP_FALSE.
          O_LISTSUB-&gt;INIT_ITER( ).
          O_SUBCOMP = O_LISTSUB-&gt;GET_NEXT( ).
          WHILE O_SUBCOMP IS BOUND.
            O_SUBCOMP_S = _COMPLIST-&gt;SEARCH( O_SUBCOMP ).
            _CLONE = _FIND_COMPONENT_NODE( O_SUBCOMP_S ).
            O_RAW = ZAPLINK_CONNECTORS=&gt;NODE_2_RAW( _CLONE ).
*            _DIRECTORY =
            _OPTIONS-&gt;DIRECTORY-&gt;SET_DIRECTORY( O_RAW ).
            IF _OPTIONS-&gt;DIRECTORY-&gt;LOG IS BOUND.
              O_LOG-&gt;ADD_FROM_INSTANCE( _OPTIONS-&gt;DIRECTORY-&gt;LOG ).
            ENDIF.
            O_SUBCOMP = O_LISTSUB-&gt;GET_NEXT( ).
          ENDWHILE.
        ENDIF.

        _COMPONENTS = O_CONNECTOR-&gt;IMPORT_TO_SAP( _XML_COMP ).
        O_COMP-&gt;SET_SUBCOMPONENTS( _COMPONENTS ).
        IF _COMPONENTS-&gt;SEARCH( O_COMP ) IS BOUND.
*          CALL METHOD LOG-&gt;ADD_SUCCESS
*            EXPORTING
**              ID_MSGID     =
*              ID_MSGNO     =
**              ID_MSGV1     =
**              ID_MSGV2     =
**              ID_MSGV3     =
**              ID_MSGV4     =
**              ID_DETLEVEL  =
**              ID_PROBCLASS =
*              .
          _COMPONENTS-&gt;REMOVE( O_COMP ).
        ENDIF.
      CATCH ZAPLINK_CX_CONNECTOR INTO _CX_CONNECTOR.
        O_COMP-&gt;SET_EXCEPTION( _CX_CONNECTOR ).
        CALL METHOD LOG-&gt;ADD_EXCEPTION
          EXPORTING
            EXCEPTION    = _CX_CONNECTOR
*            ID_DETLEVEL  =
*            ID_PROBCLASS =
            .
    ENDTRY.

    O_COMP = OBJECT_LIST-&gt;GET_NEXT( ).
  ENDWHILE.
ENDMETHOD.
METHOD UNINSTALL_FROM_SAP.
DATA O_CONNECTOR  TYPE TO_CONNECTOR.
  DATA O_COMP       TYPE TO_COMPONENT.
  DATA OBJECT       TYPE TO_RAW.
  DATA _DONE        TYPE ABAP_BOOL.
  DATA _XML_COMP    TYPE REF TO IF_IXML_DOCUMENT.
  DATA _CLONE       TYPE REF TO IF_IXML_NODE.
  DATA _CX_CONNECTOR TYPE REF TO ZAPLINK_CX_CONNECTOR.

  CHECK OBJECT_LIST IS BOUND.
*  OBJECT_LIST-&gt;KEEP_COMMUN_LIST( _COMPLIST ).
  OBJECT_LIST-&gt;DISPLAY_PROGRESS = ABAP_TRUE.

  OBJECT_LIST-&gt;INIT_SEL_ITER( ).
  O_COMP = OBJECT_LIST-&gt;GET_NEXT( ).
  WHILE O_COMP IS BOUND.
    TRY.
        O_CONNECTOR = O_COMP-&gt;CONNECTOR( ).
      CATCH ZAPLINK_CX_COMPONENT.
    ENDTRY.

    TRY.
        _DONE = O_CONNECTOR-&gt;DELETE_FROM_SAP( O_COMP ).
        IF _DONE = ABAP_TRUE.
*          CALL METHOD LOG-&gt;ADD_SUCCESS
*            EXPORTING
**              ID_MSGID     =
*              ID_MSGNO     =
**              ID_MSGV1     =
**              ID_MSGV2     =
**              ID_MSGV3     =
**              ID_MSGV4     =
**              ID_DETLEVEL  =
**              ID_PROBCLASS =
*              .
        ELSE.
*          CALL METHOD LOG-&gt;ADD_ERROR
*            EXPORTING
**              ID_MSGID     =
*              ID_MSGNO     =
**              ID_MSGV1     =
**              ID_MSGV2     =
**              ID_MSGV3     =
**              ID_MSGV4     =
**              ID_DETLEVEL  =
**              ID_PROBCLASS =
*              .
        ENDIF.
      CATCH ZAPLINK_CX_CONNECTOR INTO _CX_CONNECTOR.
        CALL METHOD LOG-&gt;ADD_EXCEPTION
          EXPORTING
            EXCEPTION    = _CX_CONNECTOR
*            ID_DETLEVEL  =
*            ID_PROBCLASS =
            .
    ENDTRY.

    O_COMP = OBJECT_LIST-&gt;GET_NEXT( ).
  ENDWHILE.
ENDMETHOD.
METHOD _UPDATE_COMPONENTSLIST.
*  CALL METHOD SUPER-&gt;_UPDATE_COMPONENTSLIST.
  DATA O_ITERATOR  TYPE REF TO IF_IXML_NODE_ITERATOR.
  DATA O_NODE_ROOT TYPE REF TO IF_IXML_NODE.
  DATA O_FILT_NAME TYPE REF TO IF_IXML_NODE_FILTER.
*  DATA O_FILT_ATTR TYPE REF TO IF_IXML_NODE_FILTER.
  DATA O_NODE      TYPE REF TO  IF_IXML_NODE.
  DATA O_ELEMENT   TYPE REF TO  IF_IXML_ELEMENT.
  DATA O_RAW       TYPE TO_RAW.
  DATA _COMP       TYPE TO_COMPONENT.
  DATA O_COMP_P    TYPE TO_COMPONENT.
  DATA _CX_COMP    TYPE REF TO ZAPLINK_CX_COMPONENT.
  DATA O_CONN      TYPE TO_CONNECTOR.
  DATA O_LIST      TYPE TO_LIST.
  DATA _INDEX      LIKE LINE OF _NODEINDEX.

  O_NODE_ROOT = GET_ROOT( ).
  O_FILT_NAME = O_NODE_ROOT-&gt;CREATE_FILTER_NAME( NAME = COMP_NODENAME ).
  O_ITERATOR = O_NODE_ROOT-&gt;CREATE_ITERATOR_FILTERED( FILTER = O_FILT_NAME ).
  O_NODE = O_ITERATOR-&gt;GET_NEXT( ).
  WHILE O_NODE IS BOUND.
    _INDEX-NODE = O_NODE.          &quot; SAVE CURRENT NODE
    O_NODE = O_ITERATOR-&gt;GET_NEXT( ).&quot; GET NEXT ONE TO ALLOW TO USE &apos;CONTINUE&apos;

    O_RAW = ZAPLINK_CONNECTORS=&gt;NODE_2_RAW( _INDEX-NODE ).
    IF O_RAW-&gt;NAME IS INITIAL.
*        CALL METHOD LOG-&gt;ADD_ERROR
      CONTINUE.
    ENDIF.
    TRY.
        _COMP = O_RAW-&gt;GET_COMPONENT( ).
*        TRY.
*            _COMP-&gt;SET_CONNUUID( _UUID ).
*            O_CONN = _COMP-&gt;CONNECTOR( ).
*          CATCH ZAPLINK_CX_COMPONENT INTO _CX_COMP.
**        CALL METHOD LOG-&gt;ADD_WARNING
*            CLEAR _UUID.
*            _COMP-&gt;SET_CONNUUID( _UUID ).
*            O_CONN = _COMP-&gt;CONNECTOR( ).
*        ENDTRY.
      CATCH ZAPLINK_CX_COMPONENT INTO _CX_COMP.
        CALL METHOD LOG-&gt;ADD_EXCEPTION
          EXPORTING
            EXCEPTION    = _CX_COMP
*            ID_DETLEVEL  =
*            ID_PROBCLASS =
            .
    ENDTRY.

    IF NOT O_CONN IS BOUND.
*        CALL METHOD LOG-&gt;ADD_WARNING
    ELSE.
      IF O_CONN-&gt;IS_SUPPORTED_VERSION( O_RAW-&gt;VERSION ) = ABAP_FALSE.
*        CALL METHOD LOG-&gt;ADD_WARNING
      ENDIF.
    ENDIF.

    IF _IS_SUBCOMPONENT( _INDEX-NODE ) = ABAP_FALSE.
      _COMPLIST-&gt;ADD( _COMP ).
      _INDEX-KEY = _COMP.
      MODIFY TABLE _NODEINDEX FROM _INDEX.
      IF SY-SUBRC &lt;&gt; 0.
        INSERT _INDEX INTO TABLE _NODEINDEX.
      ENDIF.
    ELSE.
* NOT WORKING NODE ARE THE SAME BUT IT&apos;S A NEW OBJECT. :(
*      READ TABLE _NODEINDEX INTO _INDEX
*           WITH KEY NODE = O_CURSOR.
      TRY.
        O_RAW = ZAPLINK_CONNECTORS=&gt;NODE_2_RAW( O_CURSOR ).
        O_COMP_P = O_RAW-&gt;GET_COMPONENT( ).
        O_COMP_P = _COMPLIST-&gt;SEARCH( O_COMP_P ).
        O_LIST = O_COMP_P-&gt;GET_SUBCOMPONENTS( ).
        IF NOT O_LIST IS BOUND.
          CREATE OBJECT O_LIST.
          O_COMP_P-&gt;SET_SUBCOMPONENTS( O_LIST ).
        ENDIF.
        O_LIST-&gt;ADD( _COMP ).
*      CATCH ZAPLINK_CX INTO ....
      ENDTRY.
    ENDIF.

  ENDWHILE.
ENDMETHOD.
METHOD _IS_SUBCOMPONENT.
  DATA _CURSOR TYPE REF TO IF_IXML_NODE.

  RESULT = ABAP_FALSE.
  CLEAR O_CURSOR.
  _CURSOR = NODE-&gt;GET_PARENT( ).
  WHILE _CURSOR IS BOUND.
    IF _CURSOR-&gt;GET_NAME( ) = COMP_NODENAME.
      RESULT = ABAP_TRUE.
      O_CURSOR = _CURSOR.
*      EXIT.  NEW THE ROOT NODE
    ENDIF.
    _CURSOR = _CURSOR-&gt;GET_PARENT( ).
  ENDWHILE.
ENDMETHOD.
METHOD _FIND_COMPONENT_NODE.
  DATA O_COMP   TYPE TO_COMPONENT.
  DATA _CX_LIST TYPE REF TO ZAPLINK_CX_LIST.
  FIELD-SYMBOLS:
    &lt;I&gt; LIKE LINE OF _NODEINDEX.

  TRY.
      O_COMP = _COMPLIST-&gt;SEARCH( COMPONENT ).
    CATCH ZAPLINK_CX_LIST INTO _CX_LIST.
      IF _CX_LIST-&gt;TEXTID = ZAPLINK_CX_LIST=&gt;NOT_FOUND.
        EXIT.
      ELSE.
        CREATE OBJECT O_MYCX
          EXPORTING
            TEXTID  = ZAPLINK_CX=&gt;SYSTEM_ERROR
            PREV_CX = _CX_LIST.
        O_MYCX-&gt;UPDATE( ).
        RAISE EXCEPTION O_MYCX.
      ENDIF.
  ENDTRY.

  READ TABLE _NODEINDEX ASSIGNING &lt;I&gt;
       WITH TABLE KEY KEY = O_COMP.
  IF SY-SUBRC = 0.
    NODE = &lt;I&gt;-NODE.
  ENDIF.

*  DATA _TYPE     TYPE TD_COMPTYPE.
*  DATA _NAME     TYPE TD_COMPNAME.
*  DATA _CX_COMP  TYPE REF TO ZAPLINK_CX_COMPONENT.
*  DATA F_TYPE   TYPE REF TO IF_IXML_NODE_FILTER.
*  DATA F_NAME   TYPE REF TO IF_IXML_NODE_FILTER.
*  DATA O_F_NODE TYPE REF TO IF_IXML_NODE_FILTER.
*  DATA FILTER   TYPE REF TO IF_IXML_NODE_FILTER.
*  DATA FILTER_F TYPE REF TO IF_IXML_NODE_FILTER.
*  DATA ITERATOR TYPE REF TO IF_IXML_NODE_ITERATOR.
*  DATA _ROOT    TYPE REF TO IF_IXML_NODE.
*  DATA STRING TYPE STRING.
*
*  TRY.
*      _TYPE = COMPONENT-&gt;GET_TYPE( ).
*      _NAME = COMPONENT-&gt;GET_NAME( ).
*    CATCH ZAPLINK_CX_COMPONENT INTO _CX_COMP.
*  ENDTRY.
*
*  _ROOT = XMLDATA-&gt;GET_ROOT_ELEMENT( ).
*  O_F_NODE = XMLDATA-&gt;CREATE_FILTER_NAME( NAME = COMP_NODENAME ).
*  STRING = _TYPE.
*  F_TYPE = XMLDATA-&gt;CREATE_FILTER_ATTRIBUTE( NAME = &apos;TYPE&apos;
*                                            VALUE = STRING ).
*  STRING = _NAME.
*  F_NAME = _ROOT-&gt;CREATE_FILTER_ATTRIBUTE( NAME = &apos;NAME&apos;    &quot; TS_NUGGETDATA-NAME
*                                          VALUE = STRING ).
*  FILTER = _ROOT-&gt;CREATE_FILTER_AND( FILTER1 = F_TYPE
*                                     FILTER2 = F_NAME ).
*  FILTER_F = _ROOT-&gt;CREATE_FILTER_AND( FILTER1 = FILTER
*                                       FILTER2 = FILTER_F ).
*  ITERATOR = _ROOT-&gt;CREATE_ITERATOR_FILTERED( DEPTH = 1
*                                             FILTER = FILTER ).
*  NODE = ITERATOR-&gt;GET_NEXT( ).
*  CHECK NODE IS BOUND.
*  WHILE _IS_SUBCOMPONENT( NODE ) = ABAP_TRUE.
*    NODE = ITERATOR-&gt;GET_NEXT( ).
*    IF NOT NODE IS BOUND.
*      EXIT.
*    ENDIF.
*  ENDWHILE.
ENDMETHOD.
METHOD GET_OPTIONS.
RESULT = _OPTIONS.
ENDMETHOD.
METHOD SET_OPTIONS.
CHECK DATA &lt;&gt; _OPTIONS.
  _OPTIONS = DATA.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_CONTAINER_4INST IMPLEMENTATION

CLASS ZAPLINK_CONNECTOR_ IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONV_ABAP_RAW2SOURCE.
FIELD-SYMBOLS:
    &lt;C&gt; LIKE LINE OF RAW.

  LOOP AT RAW ASSIGNING &lt;C&gt;.
    IF RESULT IS INITIAL.
      RESULT = &lt;C&gt;.
    ELSE.
      CONCATENATE RESULT &lt;C&gt; INTO RESULT
                  SEPARATED BY LINE_SEPARATOR.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD CONV_ABAP_SOURCE2RAW.
SPLIT SOURCE AT LINE_SEPARATOR INTO TABLE RESULT.
ENDMETHOD.
METHOD GET_PROG_RAWSOURCE.
READ REPORT PROGRAM INTO RESULT STATE &apos;I&apos;.
  IF SY-SUBRC &lt;&gt; 0.
    READ REPORT PROGRAM INTO RESULT STATE &apos;A&apos;.
  ENDIF.
ENDMETHOD.
METHOD GET_PROG_SOURCE.
DATA CODE TYPE TT_ABAPRAWSOURCE.

  CODE = GET_PROG_RAWSOURCE( PROGRAM ).
  RESULT = CONV_ABAP_RAW2SOURCE( CODE ).
ENDMETHOD.
METHOD GET_PROG_TEXTPOOL.
DATA T_TEXTPOOL TYPE STANDARD TABLE OF TEXTPOOL.
  DATA T_LANGLIST TYPE INSTLANG.
  TYPES:
    BEGIN OF TS_TEXT,
      ID      TYPE  TEXTPOOLID,
      KEY     TYPE  TEXTPOOLKY,
      LANGU   TYPE SPRAS,
      ENTRY   TYPE TEXTPOOLTX,
      LENGTH  TYPE TEXTPOOLLN,
    END OF TS_TEXT.
  DATA: T_TEXTS TYPE STANDARD TABLE OF TS_TEXT.
  DATA _TEXT LIKE LINE OF T_TEXTS.
  DATA _TEXTPOOL LIKE LINE OF RESULT.
  DATA _TPOOL LIKE LINE OF _TEXTPOOL-TEXTS.
  FIELD-SYMBOLS:
    &lt;L&gt; LIKE LINE OF T_LANGLIST,
    &lt;T&gt; LIKE LINE OF T_TEXTPOOL.

  CALL FUNCTION &apos;RS_TEXTLOG_GET_PARAMETERS&apos;
    CHANGING
      INSTALLED_LANGUAGES = T_LANGLIST.

  LOOP AT T_LANGLIST ASSIGNING &lt;L&gt;.
    READ TEXTPOOL PROGRAM INTO T_TEXTPOOL LANGUAGE &lt;L&gt;.
    IF SY-SUBRC = 0.
      _TEXT-LANGU = &lt;L&gt;.
      LOOP AT T_TEXTPOOL ASSIGNING &lt;T&gt;.
        _TEXT-ID = &lt;T&gt;-ID.
        _TEXT-KEY = &lt;T&gt;-KEY.
        _TEXT-ENTRY = &lt;T&gt;-ENTRY.
        _TEXT-LENGTH = &lt;T&gt;-LENGTH.
        APPEND _TEXT TO T_TEXTS.
      ENDLOOP.
    ENDIF.
  ENDLOOP.

  SORT T_TEXTS BY ID KEY LANGU.
  DELETE ADJACENT DUPLICATES FROM T_TEXTS COMPARING ID KEY LANGU.

  LOOP AT T_TEXTS INTO _TEXT.
    AT NEW KEY. &quot; ID
      CLEAR _TEXTPOOL.
      _TEXTPOOL-ID = _TEXT-ID.
      _TEXTPOOL-KEY = _TEXT-KEY.
    ENDAT.
    AT NEW LANGU.
      CLEAR _TPOOL.
      _TPOOL-LANGU = _TEXT-LANGU.
    ENDAT.

    _TPOOL-ENTRY = _TEXT-ENTRY.
    _TPOOL-LENGTH = _TEXT-LENGTH.

    AT END OF LANGU.
      APPEND _TPOOL TO _TEXTPOOL-TEXTS.
    ENDAT.
    AT END OF KEY.
      APPEND _TEXTPOOL TO RESULT.
    ENDAT.

  ENDLOOP.
ENDMETHOD.
METHOD GET_TYPE_FROM_XML.
  DATA ROOT_NODE TYPE REF TO IF_IXML_NODE.
  DATA O_RAW     TYPE TO_RAW.
  DATA _NAME     TYPE STRING.
  DATA _CX       TYPE REF TO CX_ROOT.
  DATA O_MYCX    TYPE TO_EXCEPTION.

  CHECK OBJECT IS BOUND.

  ROOT_NODE = OBJECT-&gt;GET_ROOT_ELEMENT( ).
  IF NOT ROOT_NODE IS BOUND.
    _NAME = &apos;$NONE$&apos;(001).
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR EXPORTING
          TEXTID = ZAPLINK_CX_CONNECTOR=&gt;INVALID_XML
       NODE_NAME = _NAME.
  ENDIF.

  _NAME = ROOT_NODE-&gt;GET_NAME( ).
  IF _NAME &lt;&gt; COMP_NODENAME.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR EXPORTING
          TEXTID = ZAPLINK_CX_CONNECTOR=&gt;INVALID_XML
       NODE_NAME = _NAME.
  ENDIF.

  TRY.
      O_RAW = ZAPLINK_CONNECTORS=&gt;NODE_2_RAW( ROOT_NODE ).
      RESULT = O_RAW-&gt;TYPE.
    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

ENDMETHOD.
METHOD SET_BASE_ATTRIBUTS.
DATA O_DESC    TYPE REF TO CL_ABAP_TYPEDESCR.
  DATA STRING    TYPE STRING.
  DATA _NAME     TYPE TADIR-OBJ_NAME.
  DATA _TYPE     TYPE TADIR-OBJECT.

  O_DESC = CL_ABAP_TYPEDESCR=&gt;DESCRIBE_BY_OBJECT_REF( P_OBJECT_REF = ME ).
  STRING = O_DESC-&gt;GET_RELATIVE_NAME( ).

  _NAME = ATTRIBUTS-NAME = COMPONENT-&gt;GET_NAME( ).
  ATTRIBUTS-CLASS = STRING.
  ATTRIBUTS-VERSION = ME-&gt;VERSION.

  _TYPE = COMPONENT-&gt;GET_TYPE( ).
  CALL FUNCTION &apos;TRINT_TADIR_QUERY&apos;
    EXPORTING
      IV_PGMID           = &apos;R3TR&apos;
      IV_OBJECT          = _TYPE
      IV_OBJ_NAME        = _NAME
    IMPORTING
*     EV_OBJECT          =
*     EV_SRCSYSTEM       =
      EV_DEVCLASS        = ATTRIBUTS-DEVCLASS
*     EV_AUTHOR          =
*     EV_GENFLAG         =
*     EV_EXIST           =
            .
ENDMETHOD.
METHOD SET_PROG_RAWSOURCE.
INSERT REPORT PROGRAM FROM RAW STATE &apos;I&apos;.
  IF SY-SUBRC = 0.
    INSERT REPORT PROGRAM FROM RAW STATE &apos;A&apos;.
  ENDIF.
ENDMETHOD.
METHOD SET_PROG_SOURCE.
DATA _RAW TYPE TT_ABAPRAWSOURCE.

  _RAW = CONV_ABAP_SOURCE2RAW( SOURCE ).
  SET_PROG_RAWSOURCE( PROGRAM = PROGRAM
                          RAW = _RAW ).
ENDMETHOD.
METHOD SET_PROG_TEXTPOOL.
TYPES:
    BEGIN OF TS_TEXT,
      LANGU   TYPE SPRAS,
      ID      TYPE  TEXTPOOLID,
      KEY     TYPE  TEXTPOOLKY,
      ENTRY   TYPE TEXTPOOLTX,
      LENGTH  TYPE TEXTPOOLLN,
    END OF TS_TEXT.
  DATA T_TEXTPOOL TYPE STANDARD TABLE OF TEXTPOOL.
  DATA T_LANGLIST TYPE INSTLANG.
  DATA: T_TEXTS TYPE STANDARD TABLE OF TS_TEXT.
  DATA _TEXT LIKE LINE OF T_TEXTS.
  DATA _TEXTPOOL LIKE LINE OF T_TEXTPOOL.
*  DATA _TPOOL LIKE LINE OF _TEXTPOOL-TEXTS.
  FIELD-SYMBOLS:
    &lt;T&gt; LIKE LINE OF TEXTPOOL,
    &lt;L&gt; LIKE LINE OF &lt;T&gt;-TEXTS.

  LOOP AT TEXTPOOL ASSIGNING &lt;T&gt;.
    _TEXT-ID = &lt;T&gt;-ID.
    _TEXT-KEY = &lt;T&gt;-KEY.
    LOOP AT &lt;T&gt;-TEXTS ASSIGNING &lt;L&gt;.
      _TEXT-LANGU = &lt;L&gt;-LANGU.
      _TEXT-ENTRY = &lt;L&gt;-ENTRY.
      _TEXT-LENGTH = &lt;L&gt;-LENGTH.
      APPEND _TEXT TO T_TEXTS.
    ENDLOOP.
  ENDLOOP.

  SORT T_TEXTS BY LANGU ID KEY.
  DELETE ADJACENT DUPLICATES FROM T_TEXTS COMPARING LANGU ID KEY.

  LOOP AT T_TEXTS INTO _TEXT.
    AT NEW LANGU. &quot; ID
      CLEAR: T_TEXTPOOL, _TEXTPOOL.
    ENDAT.

    _TEXTPOOL-ID = _TEXT-ID.
    _TEXTPOOL-KEY = _TEXT-KEY.
    _TEXTPOOL-ENTRY = _TEXT-ENTRY.
    _TEXTPOOL-LENGTH = _TEXT-LENGTH.
    APPEND _TEXTPOOL TO T_TEXTPOOL.

    AT END OF LANGU.
      INSERT TEXTPOOL PROGRAM FROM T_TEXTPOOL LANGUAGE _TEXT-LANGU.
    ENDAT.

  ENDLOOP.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~EXPORT_FROM_SAP.
  DATA EZ_XML          TYPE TO_EZ_XML.
  DATA O_DATA          TYPE TO_RAW.

  O_DATA = READ_FROM_SAP( COMPONENT ).
  IF O_DATA IS BOUND.
    O_DATA-&gt;CONNECTOR = ME-&gt;UUID.
    O_DATA-&gt;VERSION = ME-&gt;VERSION.
*    IF O_DATA-&gt;TYPE &lt;&gt; &apos;DEVC&apos; AND O_DATA-&gt;GET_DEVCLASS IS INITIAL.
*      SELECT SINGLE DEVCLASS
*        INTO _DEVCLASS
*        FROM TADIR
*        WHERE PGMID = &apos;R3TR&apos;
*          AND OBJECT = O_DATA-&gt;TYPE
*          AND OBJ_NAME = O_DATA-&gt;NAME.
*      O_DATA-&gt;SET_DEVCLASS(  ).
*    ENDIF.
    CREATE OBJECT EZ_XML.

    TRY.
      OBJECT = EZ_XML-&gt;ANY2XML( ANY       = O_DATA
                                TYPE      = COMP_NODENAME ).
* CONTROL CONTENT
    ENDTRY.
  ENDIF.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~IMPORT_TO_SAP.
  DATA ROOT_NODE TYPE REF TO IF_IXML_NODE.
  DATA O_RAW     TYPE TO_RAW.
  DATA _NAME     TYPE STRING.
  DATA EZ_XML    TYPE REF TO ZAPLINK_EASYXML.
  DATA O_CX      TYPE REF TO CX_ROOT.
  DATA O_ZLCX    TYPE REF TO ZAPLINK_CX.

  CHECK OBJECT IS BOUND.

  TRY.
      ROOT_NODE = OBJECT-&gt;GET_ROOT_ELEMENT( ).
      IF NOT ROOT_NODE IS BOUND.
        _NAME = &apos;$NONE$&apos;(001).
        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR EXPORTING
              TEXTID = ZAPLINK_CX_CONNECTOR=&gt;INVALID_XML
           NODE_NAME = _NAME.
      ENDIF.

      _NAME = ROOT_NODE-&gt;GET_NAME( ).
      IF _NAME &lt;&gt; COMP_NODENAME.
        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR EXPORTING
              TEXTID = ZAPLINK_CX_CONNECTOR=&gt;INVALID_XML
           NODE_NAME = _NAME.
      ENDIF.

      TRY.
          O_RAW = ZAPLINK_CONNECTORS=&gt;NODE_2_RAW( ROOT_NODE ).
        CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
          RAISE EXCEPTION O_MYCX.
      ENDTRY.

* VERSION HANDLING TO DEVELOP
      IF IS_SUPPORTED_VERSION( O_RAW-&gt;VERSION ) = ABAP_FALSE.
* VERSION &apos;&amp;CONN_VER&amp;&apos; IS NOT (OR NO LONGER) SUPORTED BY THIS CONNECTOR.
        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR EXPORTING
              TEXTID = ZAPLINK_CX_CONNECTOR=&gt;UNSUPORTED_VERSION
            CONN_VER = O_RAW-&gt;VERSION.
      ENDIF.

      O_RAW = CREATE_NEW_RAW( O_RAW-&gt;TYPE ).
      CREATE OBJECT EZ_XML.
      CALL METHOD EZ_XML-&gt;XML2ANY
        EXPORTING
          XMLDOC = OBJECT
        CHANGING
          ANY    = O_RAW.

      COMPONENTS = WRITE_TO_SAP( O_RAW ).
    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
    CATCH ZAPLINK_CX INTO O_ZLCX.
      CREATE OBJECT O_MYCX EXPORTING
             TEXTID = ZAPLINK_CX=&gt;SYSTEM_ERROR
           PREV_CX = O_ZLCX.
      O_MYCX-&gt;UPDATE( ).
      RAISE EXCEPTION O_MYCX.
    CATCH CX_ROOT INTO O_CX.
      CREATE OBJECT O_MYCX EXPORTING
             TEXTID = ZAPLINK_CX=&gt;SYSTEM_ERROR
           PREVIOUS = O_CX.
      O_MYCX-&gt;UPDATE( ).
      RAISE EXCEPTION O_MYCX.
  ENDTRY.
ENDMETHOD.
METHOD CONSTRUCTOR.
  CREATE OBJECT APPLICATION_LOG.
*  CALL METHOD APPLICATION_LOG-&gt;INIT
*    EXPORTING
*      ID_OBJECT      = BALLOG_OBJECT
*      ID_SUBOBJECT   = SPACE
**      ID_EXTNUMBER   =
*      AUTO_UPD_CUSTO = ABAP_TRUE
**      ID_ACTIVITY    = ACT_CREATE
*    EXCEPTIONS
*      ERROR          = 1
*      OTHERS         = 2.
*  IF SY-SUBRC &lt;&gt; 0.
*    MESSAGE ID SY-MSGID TYPE &apos;I&apos; NUMBER SY-MSGNO
*               WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
*  ENDIF.

ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~GET_VALUES.
  DATA _OBJ_TYPE TYPE  EUOBJ-ID.
  DATA _NAME TYPE TD_COMPNAME.

  _OBJ_TYPE = TYPE.

  CALL FUNCTION &apos;REPOSITORY_INFO_SYSTEM_F4&apos;
    EXPORTING
      OBJECT_TYPE           = _OBJ_TYPE
      OBJECT_NAME           = NAME
      SUPPRESS_SELECTION    = ABAP_TRUE
      USE_ALV_GRID          = ABAP_FALSE
      WITHOUT_PERSONAL_LIST = ABAP_FALSE
    IMPORTING
      OBJECT_NAME_SELECTED  = _NAME
    EXCEPTIONS
      CANCEL                = 1.
  IF SY-SUBRC = 0.
    NAME = _NAME.
  ENDIF.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_CONNECTOR_ IMPLEMENTATION

CLASS ZAPLINK_DOC_DATA IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD GET_SOURCE.
*  SPLIT ME-&gt;TEXTS AT CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE
*        INTO TABLE TEXT.
ENDMETHOD.
METHOD SET_SOURCE.
FIELD-SYMBOLS &lt;L&gt; LIKE LINE OF TEXT.
  DATA STR TYPE STRING.

*  CLEAR ME-&gt;TEXT.
*  LOOP AT TEXT ASSIGNING &lt;L&gt;.
*    STR = &lt;L&gt;.
*    IF ME-&gt;TEXT IS INITIAL.
*      ME-&gt;TEXT = STR.
*    ELSE.
*      CONCATENATE ME-&gt;TEXT CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE STR INTO ME-&gt;TEXT.
*    ENDIF.
*  ENDLOOP.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_DOC_DATA IMPLEMENTATION

CLASS ZAPLINK_DOCUMENTATION IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES
*CLASS ZAPLINK_DOC_DATA DEFINITION LOAD.

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CLASS_CONSTRUCTOR.
CREATE OBJECT BAL_LOG.
ENDMETHOD.
METHOD DOCU_GET.
  DATA _TEXT  TYPE TT_RAWTEXT.

  HEAD-ID = DOCU-ID.
  HEAD-OBJECT = DOCU-OBJECT.
  HEAD-MASTERLANG = DOCU-MASTERLANG.
  HEAD-LANGU = DOCU-LANGU.
  HEAD-TYP = DOCU-TYP.
  HEAD-SELFDEF = DOCU-SELFDEF.
  IF DOCU-SELFDEF = SPACE.
    CALL FUNCTION &apos;DOCU_GET&apos;
      EXPORTING
*       EXTEND_EXCEPT                = &apos; &apos;
        ID                           = DOCU-ID
        LANGU                        = DOCU-LANGU
        OBJECT                       = DOCU-OBJECT
        TYP                          = DOCU-TYP
        VERSION                      = DOCU-VERSION
        VERSION_ACTIVE_OR_LAST       = &apos;A&apos;
*         PRINT_PARAM_GET              = &apos;X&apos;
      IMPORTING
        DOKSTATE                     = LANG-STATE
*         DOKTITLE                     =
        HEAD                         = LANG-HEAD
*        DOKTYP                       = HEAD-TYP
      TABLES
        LINE                         = _TEXT
      EXCEPTIONS
        NO_DOCU_ON_SCREEN            = 1
        NO_DOCU_SELF_DEF             = 2
        NO_DOCU_TEMP                 = 3
        RET_CODE                     = 4
        OTHERS                       = 5
              .
    IF SY-SUBRC &lt;&gt; 0.
      CALL METHOD BAL_LOG-&gt;ADD_SYMSG
*          EXPORTING
*            ID_DETLEVEL  =
*            IF_CUMULATE  =
*            ID_PROBCLASS =
*            ID_INDEX     =
*          IMPORTING
*            ES_MESSAGE   =
          .
      EXIT.
    ENDIF.
    LANG-_ = RAW2STRING( _TEXT ).
    HEAD-APPLICATION = LANG-TDOBJECT.
    HEAD-DOKFORM = LANG-TDFORM.
    HEAD-DOKSTYLE = LANG-TDSTYLE.
    CLEAR:
      LANG-TDOBJECT,
      LANG-TDNAME,
      LANG-TDID,
      LANG-TDFORM,
      LANG-TDSTYLE.
  ENDIF.
ENDMETHOD.
METHOD GET.
  DATA _OBJ   TYPE RANGE OF DOKU_OBJ.
  DATA MY_OBJ LIKE LINE OF _OBJ.
  DATA DOCS   TYPE STANDARD TABLE OF DOKIL WITH DEFAULT KEY.
  DATA DOC    LIKE LINE OF T_DOCS.
  DATA _LANG  LIKE LINE OF DOC-TEXTS.
  FIELD-SYMBOLS:
    &lt;D&gt; LIKE LINE OF DOCS.

  IF IDS IS INITIAL.
    EXIT.
  ENDIF.

  MY_OBJ-SIGN = &apos;I&apos;. MY_OBJ-OPTION = &apos;CP&apos;.
  MY_OBJ-LOW = OBJECT. APPEND MY_OBJ TO _OBJ.

  SELECT * INTO TABLE DOCS
    FROM DOKIL
    WHERE ID IN IDS
      AND OBJECT IN _OBJ.

  IF DOCS IS INITIAL.
    EXIT.
  ENDIF.

  RESET( ).

  SORT DOCS BY ID OBJECT MASTERLANG DESCENDING LANGU.

  LOOP AT DOCS ASSIGNING &lt;D&gt;.
    AT NEW OBJECT. &quot; ID + OBJECT
      CLEAR DOC.
      CALL METHOD DOCU_GET
        EXPORTING
          DOCU = &lt;D&gt;
        IMPORTING
          HEAD = DOC-HEAD
          LANG = _LANG.
    ENDAT.

    IF _LANG IS INITIAL.
      CALL METHOD DOCU_GET
        EXPORTING
          DOCU   = &lt;D&gt;
        IMPORTING
*          HEAD   = _HEAD
          LANG   = _LANG.
    ENDIF.
    IF NOT _LANG IS INITIAL.
      INSERT _LANG INTO TABLE DOC-TEXTS.
      CLEAR _LANG.
    ENDIF.

    AT END OF OBJECT. &quot; ID + OBJECT
      APPEND DOC TO T_DOCS.
    ENDAT.
  ENDLOOP.
ENDMETHOD.
METHOD GET_AS_XML.
DATA EZXML  TYPE REF TO ZAPLINK_EASYXML.
  DATA T_DOCS TYPE TT_DOCS.

  T_DOCS = GET( IDS = IDS
             OBJECT = OBJECT ).

  IF NOT T_DOCS IS INITIAL.
    CREATE OBJECT EZXML.
*    TRY.
    CALL METHOD EZXML-&gt;ANY2XML
      EXPORTING
        ANY        = T_DOCS
        TYPE       = NODE_NAME
*        ATTRIBUTES = &apos;&apos;
      RECEIVING
        XMLDOC     = XMLDOC.
*    ENDTRY.
    CALL METHOD BAL_LOG-&gt;ADD_FROM_INSTANCE
      EXPORTING
        IO_MSGLIST        = EZXML-&gt;BAL_LOG
        IF_ADD_AS_SUBNODE = ABAP_TRUE
*      IF_CUMULATE       =
        .
  ENDIF.
ENDMETHOD.
METHOD RAW2STRING.
FIELD-SYMBOLS &lt;L&gt; LIKE LINE OF RAW.
  DATA STR TYPE STRING.

  LOOP AT RAW ASSIGNING &lt;L&gt;.
    STR = &lt;L&gt;.
    IF STRING IS INITIAL.
      STRING = STR.
    ELSE.
      CONCATENATE STRING LINE_SEPARATOR STR INTO STRING.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD RESET.
DATA OBJECT TYPE BALOBJ_D.
  DATA SUBOBJECT  TYPE BALSUBOBJ.
  DATA EXT_ID TYPE BALNREXT.

  IF NOT BAL_LOG IS BOUND.
    EXIT.
  ENDIF.

  OBJECT = &apos;ZSAPLINK&apos;.
  SUBOBJECT = &apos;DOCT&apos;.
*  CONCATENATE SY-UNAME SY-DATUM SY-UZEIT INTO EXT_ID SEPARATED BY SPACE.
*01    CREATE
*02    CHANGE
*03    DISPLAY
*04    MODIFY (DIRECT INPUT: CREATE/CHANGE)
*06    DELETE
*11    CREATE DEFAULTS
*12    CHANGE DEFAULTS
*13    DISPLAY DEFAULTS
  CALL METHOD BAL_LOG-&gt;INIT
    EXPORTING
      ID_OBJECT      = OBJECT
      ID_SUBOBJECT   = SUBOBJECT
      ID_EXTNUMBER   = EXT_ID
      AUTO_UPD_CUSTO = ABAP_TRUE
      ID_ACTIVITY    = &apos;01&apos;
    EXCEPTIONS
      ERROR          = 1
      OTHERS         = 2.
  IF SY-SUBRC &lt;&gt; 0.
* IGNORE
  ENDIF.
ENDMETHOD.
METHOD SET.
DATA _TEXT  TYPE ZAPLINK_DOC_DATA=&gt;TT_TEXT.
  DATA _DOKIL TYPE DOKIL.
  DATA _HEAD  TYPE THEAD.
  FIELD-SYMBOLS:
    &lt;O&gt; LIKE LINE OF T_DOCS,
    &lt;T&gt; LIKE LINE OF &lt;O&gt;-TEXTS.

  IF T_DOCS IS INITIAL.
    EXIT. &quot;NOTHING TO DO
  ENDIF.

  LOOP AT T_DOCS ASSIGNING &lt;O&gt;.
    _DOKIL-ID = &lt;O&gt;-ID.
    _DOKIL-OBJECT = &lt;O&gt;-OBJECT.
    _DOKIL-SELFDEF = &lt;O&gt;-SELFDEF.

    CALL FUNCTION &apos;DOCU_SELFDEF_WRITE&apos;
      EXPORTING
        OBJECT_ID   = _DOKIL-ID
        OBJECT_NAME = _DOKIL-OBJECT
        SELFDEF     = _DOKIL-SELFDEF
      EXCEPTIONS
        NOT_DELETED = 1
        OTHERS      = 2.
    IF SY-SUBRC &lt;&gt; 0.
      CALL METHOD BAL_LOG-&gt;ADD_SYMSG
*        EXPORTING
*          ID_DETLEVEL  =
*          IF_CUMULATE  =
*          ID_PROBCLASS =
*          ID_INDEX     =
*        IMPORTING
*          ES_MESSAGE   =
          .
    ENDIF.
    LOOP AT &lt;O&gt;-TEXTS ASSIGNING &lt;T&gt;.
      _TEXT = STRING2RAW( &lt;T&gt;-_  ).
      _HEAD = &lt;T&gt;-HEAD.
*    HEAD-APPLICATION = LANG-TDOBJECT.
*    HEAD-DOKFORM = LANG-TDFORM.
*    HEAD-DOKSTYLE = LANG-TDSTYLE.
      _HEAD-TDOBJECT = &lt;O&gt;-APPLICATION.
      _HEAD-TDNAME = &lt;O&gt;-OBJECT.
      _HEAD-TDID = &lt;O&gt;-ID.
      _HEAD-TDFORM = &lt;O&gt;-DOKFORM.
      _HEAD-TDSTYLE = &lt;O&gt;-DOKSTYLE.

      IF &lt;O&gt;-SELFDEF IS INITIAL.
        CALL FUNCTION &apos;DOCU_UPDATE&apos;
          EXPORTING
*       ACTCLASS            = &apos; &apos;
            HEAD                = _HEAD
*       NO_MASTERLANG       = &apos; &apos;
            STATE               = &lt;T&gt;-STATE
            TYP                 = &lt;O&gt;-TYP
            VERSION             = 0
          TABLES
            LINE                = _TEXT.
      ENDIF.
    ENDLOOP.
  ENDLOOP.
ENDMETHOD.
METHOD SET_AS_XML.
DATA T_DOCS TYPE TT_DOCS.
  DATA EZXML  TYPE REF TO ZAPLINK_EASYXML.

  CREATE OBJECT EZXML.

*  TRY.
  CALL METHOD EZXML-&gt;_XML2ANY
    EXPORTING
      XML = XML
    CHANGING
      ANY = T_DOCS.
*  ENDTRY.

  IF T_DOCS IS INITIAL AND EZXML-&gt;BAL_LOG-&gt;HAS_MESSAGES_OF_MSGT( ID_MSGTY = &apos;W&apos; ) IS INITIAL.
    EXIT. &quot;NOTHING TO DO
  ENDIF.

  RESET( ).

  CALL METHOD BAL_LOG-&gt;ADD_FROM_INSTANCE
    EXPORTING
      IO_MSGLIST        = EZXML-&gt;BAL_LOG
      IF_ADD_AS_SUBNODE = ABAP_TRUE
*      IF_CUMULATE       =
      .

  SET( T_DOCS ).
ENDMETHOD.
METHOD STRING2RAW.
SPLIT STRING AT LINE_SEPARATOR
        INTO TABLE RAW.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_DOCUMENTATION IMPLEMENTATION

CLASS ZAPLINK_PROG_DATA IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
ENDCLASS. &quot;ZAPLINK_PROG_DATA IMPLEMENTATION

CLASS ZAPLINK_PROGRAM IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CLASS_CONSTRUCTOR.
*TABLE TDCLT
*DOKCLASS DOKTITEL
*CF       PROGRAM FUNCTION                                             PROGRAM              FUNCTION
*CM       PULL-DOWN MENU/MENU BAR                                      PROGRAM              MENU
*RE       REPORT/FUNCTION GROUP, LOGICAL DB                            PROGRAM/MODULE POOL
  DATA _ID LIKE LINE OF R_DOC_ID.

  _ID-SIGN = &apos;I&apos;.
  _ID-OPTION = &apos;EQ&apos;.
  _ID-LOW = &apos;CF&apos;. APPEND _ID TO R_DOC_ID.
  _ID-LOW = &apos;CM&apos;. APPEND _ID TO R_DOC_ID.
  _ID-LOW = &apos;RE&apos;. APPEND _ID TO R_DOC_ID.
ENDMETHOD.
METHOD CONSTRUCTOR.
  DATA TYPE LIKE LINE OF SUPPORTED_TYPES.

  CALL METHOD SUPER-&gt;CONSTRUCTOR.
  TYPE-TYPE = ST_PROGRAM. INSERT TYPE INTO TABLE SUPPORTED_TYPES.

  UUID = _UUID.
  VERSION = _VER.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~CREATE_NEW_RAW.
  DATA O_PROG TYPE TO_PROGRAM.

  CREATE OBJECT OBJECT.
  CASE TYPE.
    WHEN ST_PROGRAM.
      CREATE OBJECT O_PROG.
      OBJECT-&gt;RAW ?= O_PROG.
    WHEN OTHERS.
      CLEAR OBJECT.
      RAISE EXCEPTION TYPE ZAPLINK_CX.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~DELETE_FROM_SAP.
DATA PROGRAM TYPE SY-REPID.

  CASE COMPONENT-&gt;GET_TYPE( ).
    WHEN ST_PROGRAM.
      PROGRAM = COMPONENT-&gt;GET_NAME( ).
      CALL FUNCTION &apos;RS_DELETE_PROGRAM&apos;
        EXPORTING
*          CORRNUMBER                       =
          PROGRAM                          = PROGRAM
*          SUPPRESS_CHECKS                  = &apos; &apos;
*          SUPPRESS_COMMIT                  = &apos; &apos;
          SUPPRESS_POPUP                   = &apos;X&apos;
*          MASS_DELETE_CALL                 = &apos; &apos;
*          WITH_CUA                         = &apos;X&apos;
*          WITH_DOCUMENTATION               = &apos;X&apos;
*          WITH_DYNPRO                      = &apos;X&apos;
*          WITH_INCLUDES                    = &apos; &apos;
*          WITH_TEXTPOOL                    = &apos;X&apos;
*          WITH_VARIANTS                    = &apos;X&apos;
*          TADIR_DEVCLASS                   =
*          SKIP_PROGRESS_IND                = &apos; &apos;
*          FORCE_DELETE_USED_INCLUDES       = &apos; &apos;
*        IMPORTING
*          CORRNUMBER                       =
*          PROGRAM                          =
        EXCEPTIONS
          ENQUEUE_LOCK                     = 1
          OBJECT_NOT_FOUND                 = 2
          PERMISSION_FAILURE               = 3
          REJECT_DELETION                  = 4
          OTHERS                           = 5.
      IF SY-SUBRC &lt;&gt; 0.
        CASE SY-SUBRC.
*          WHEN 2.
*            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*              EXPORTING TEXTID = ZAPLINK_CX_CONNECTOR=&gt;NOT_FOUND.
*          WHEN 1.
*            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*              EXPORTING
*                TEXTID = ZAPLINK_CX_CONNECTOR=&gt;ERROR_MESSAGE
*                MSG = &apos;PROGRAM LOCK&apos;.
          WHEN OTHERS.
            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
              EXPORTING TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
        ENDCASE.
      ENDIF.
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~DO_EXISTS.
DATA _NAME TYPE TRDIR-NAME.

  EXISTS = ME-&gt;EXISTS-NOT_EXISTS.
  CASE COMPONENT-&gt;GET_TYPE( ).
    WHEN ST_PROGRAM.
      _NAME = COMPONENT-&gt;GET_NAME( ).
      SELECT SINGLE NAME INTO _NAME
        FROM TRDIR
        WHERE NAME = _NAME.
      IF SY-SUBRC = 0.
        EXISTS = ME-&gt;EXISTS-EXISTS.
      ENDIF.
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~READ_FROM_SAP.
DATA _DATA TYPE REF TO ZAPLINK_PROG_DATA.
  DATA _PROG TYPE TD_PROGNAME.
  DATA _NAME TYPE TD_COMPNAME.
  DATA _OBJ  TYPE DOKU_OBJ.

  CREATE OBJECT OBJECT.
  OBJECT-&gt;SET_COMPONENT( COMPONENT ).
  CASE COMPONENT-&gt;GET_TYPE( ).
    WHEN ST_PROGRAM.
      _PROG = _NAME = OBJECT-&gt;NAME.
      CREATE OBJECT _DATA.
      SELECT SINGLE *
        INTO CORRESPONDING FIELDS OF _DATA-&gt;A0_MAIN
        FROM PROGDIR    &quot; REPOSRC
*THE DATABAE VIEW &quot;REPOSRC&quot; IS WRITE-PROTECTED, SO IT CANNOT BE CHANGED.
        WHERE NAME = _NAME
          AND STATE = &apos;A&apos;.        &quot; ACTIVE
      IF SY-SUBRC &lt;&gt; 0.
        SELECT SINGLE *
          INTO CORRESPONDING FIELDS OF _DATA-&gt;A0_MAIN
          FROM PROGDIR    &quot;REPOSRC
          WHERE NAME = _NAME
            AND STATE = &apos;I&apos;.      &quot; INACTIVE
      ENDIF.
      CLEAR _DATA-&gt;A0_MAIN-STATE.
* SOURCE CODE
      _DATA-&gt;SOURCE = GET_PROG_SOURCE( _PROG ).
*      IF NOT _DATA-&gt;SOURCE IS INITIAL. CLEAR _DATA-&gt;A0_MAIN-DATA. ENDIF.
*    INCLUDE TYPE REPOSRC. &quot;THE DATABAE VIEW &quot;REPOSRC&quot; IS WRITE-PROTECTED, SO IT CANNOT BE CHANGED.
* TEXTS POOL
      _DATA-&gt;TEXTSPOOL = GET_PROG_TEXTPOOL( _PROG ).
* DOCUMENTATION
      CONCATENATE _NAME &apos;*&apos; INTO _OBJ.
      _DATA-&gt;DOCUMENTATION = ZAPLINK_DOCUMENTATION=&gt;GET( IDS = R_DOC_ID
                                                      OBJECT = _OBJ ).
      OBJECT-&gt;RAW ?= _DATA.
    WHEN OTHERS.
      CLEAR OBJECT.
      RAISE EXCEPTION TYPE ZAPLINK_CX.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~WRITE_TO_SAP.
DATA _DATA  TYPE REF TO ZAPLINK_PROG_DATA.
  DATA _PROG  TYPE PROGRAMM.
  DATA _ONAME TYPE E071-OBJ_NAME.
  DATA _OBJ   TYPE DOKU_OBJ.
  DATA _REP   TYPE PROGDIR.
  DATA _COMP  TYPE TO_COMPONENT.
  DATA _NAME  TYPE TD_COMPNAME.

  CASE OBJECT-&gt;TYPE.
    WHEN ST_PROGRAM.
      _DATA ?= OBJECT-&gt;RAW.
      _PROG = _DATA-&gt;A0_MAIN-NAME = OBJECT-&gt;NAME.
* PROGRAM
* ADD PROGRAM TO TADIR WITH $TMP
* THIS PREVENT INCLUDE TO BE INCONSISTENT
      CALL FUNCTION &apos;RS_CORR_INSERT&apos;
        EXPORTING
          OBJECT                         = _PROG
          OBJECT_CLASS                   = &apos;ABAP&apos;
          MODE                           = &apos;I&apos;    &quot; INSERT
*         GLOBAL_LOCK                    = &apos; &apos;
          DEVCLASS                       = &apos;$TMP&apos;
*         KORRNUM                        = &apos; &apos;
*         USE_KORRNUM_IMMEDIATEDLY       = &apos; &apos;
*         AUTHOR                         = &apos; &apos;
*         MASTER_LANGUAGE                = &apos; &apos;
*         GENFLAG                        = &apos; &apos;
*         PROGRAM                        = &apos; &apos;
*         OBJECT_CLASS_SUPPORTS_MA       = &apos; &apos;
*         EXTEND                         = &apos; &apos;
*         SUPPRESS_DIALOG                = &apos; &apos;
*         MOD_LANGU                      = &apos; &apos;
*         ACTIVATION_CALL                = &apos; &apos;
*       IMPORTING
*         DEVCLASS                       =
*         KORRNUM                        =
*         ORDERNUM                       =
*         NEW_CORR_ENTRY                 =
*         AUTHOR                         =
*         TRANSPORT_KEY                  =
*         NEW_EXTEND                     =
        EXCEPTIONS
          CANCELLED                      = 1
          PERMISSION_FAILURE             = 2
          UNKNOWN_OBJECTCLASS            = 3
          OTHERS                         = 4.
      IF SY-SUBRC &lt;&gt; 0.
        MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
                WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
      ENDIF.

      _ONAME = _PROG.
      CALL FUNCTION &apos;RS_INSERT_INTO_WORKING_AREA&apos;
        EXPORTING
          OBJECT                  = &apos;PROG&apos;
          OBJ_NAME                = _ONAME
*         DELETED_FLAG            = &apos; &apos;
*       IMPORTING
*         OBJECT_INSERTED         =
        EXCEPTIONS
          WRONG_OBJECT_NAME       = 1
          OTHERS                  = 2.
      IF SY-SUBRC &lt;&gt; 0.
        MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
                WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
      ENDIF.

      MOVE-CORRESPONDING _DATA-&gt;A0_MAIN TO _REP.
      _REP-STATE = &apos;I&apos;.
*      MODIFY REPOSRC FROM _REP. &quot;THE DATABAE VIEW &quot;REPOSRC&quot; IS WRITE-PROTECTED, SO IT CANNOT BE CHANGED.
      MODIFY PROGDIR FROM _REP.
      _REP-STATE = &apos;A&apos;.
*      MODIFY REPOSRC FROM _REP. &quot;THE DATABAE VIEW &quot;REPOSRC&quot; IS WRITE-PROTECTED, SO IT CANNOT BE CHANGED.
      MODIFY PROGDIR FROM _REP.
* SOURCE CODE
      SET_PROG_SOURCE( PROGRAM = _PROG
                        SOURCE = _DATA-&gt;SOURCE ).
* TEXT POOL
      SET_PROG_TEXTPOOL( PROGRAM = _PROG
                        TEXTPOOL = _DATA-&gt;TEXTSPOOL ).
* DOCUMENTATION
      ZAPLINK_DOCUMENTATION=&gt;SET( T_DOCS = _DATA-&gt;DOCUMENTATION ).

      COMMIT WORK AND WAIT.

      CREATE OBJECT _COMP.
      _COMP-&gt;SET_TYPE( ST_PROGRAM ).
      _NAME = _PROG.
      _COMP-&gt;SET_NAME( _NAME ).
      CREATE OBJECT COMPONENTS.
      COMPONENTS-&gt;ADD( _COMP ).
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
  RESULT = ABAP_FALSE.
  IF VERSION = _VER.
    RESULT = ABAP_TRUE.
  ENDIF.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_PROGRAM IMPLEMENTATION

CLASS ZAPLINK_OBJECT_DATA IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD FD_COMP_DESC.
DATA: _T   LIKE LINE OF TEXTS.
  FIELD-SYMBOLS:
    &lt;DESC&gt; LIKE LINE OF DESCRIPTIONS.

  LOOP AT DESCRIPTIONS ASSIGNING &lt;DESC&gt;
       WHERE CLSNAME = OBJ_NAME
         AND CMPNAME = COMPONENT.
    _T = &lt;DESC&gt;.
    CLEAR: _T-CLSNAME, _T-CMPNAME. &quot; VERSION
    INSERT _T INTO TABLE TEXTS.
  ENDLOOP.
ENDMETHOD.
METHOD FD_EXCEPTIONS.
DATA: _EX  LIKE LINE OF EXCEPTIONS.
  FIELD-SYMBOLS:
    &lt;EX&gt;  LIKE LINE OF FM_DATA-EXCEPS.

  LOOP AT FM_DATA-EXCEPS ASSIGNING &lt;EX&gt;
       WHERE CLSNAME = OBJ_NAME
         AND CMPNAME = COMPONENT.
    CLEAR: _EX.
    _EX-HDR = &lt;EX&gt;.
    _EX-TEXTS = FD_SUBC_DESC( DESCRIPTIONS = FM_DATA-SUBCOMPONENT_DESC
                                 COMPONENT = &lt;EX&gt;-CMPNAME
                             SUB_COMPONENT = &lt;EX&gt;-SCONAME ).
    CLEAR: _EX-CLSNAME, _EX-CMPNAME. &quot; VERSION
    INSERT _EX INTO TABLE EXCEPTIONS.
  ENDLOOP.
ENDMETHOD.
METHOD FD_PARAMETERS.
DATA: _PA  LIKE LINE OF PARAMETERS.
  FIELD-SYMBOLS:
    &lt;PA&gt;  LIKE LINE OF FM_DATA-PARAMETERS.

  LOOP AT FM_DATA-PARAMETERS ASSIGNING &lt;PA&gt;
       WHERE CLSNAME = OBJ_NAME
         AND CMPNAME = COMPONENT.
    CLEAR: _PA.
    _PA-HDR = &lt;PA&gt;.
    _PA-TEXTS = FD_SUBC_DESC( DESCRIPTIONS = FM_DATA-SUBCOMPONENT_DESC
                                 COMPONENT = &lt;PA&gt;-CMPNAME
                             SUB_COMPONENT = &lt;PA&gt;-SCONAME ).
    CLEAR: _PA-CLSNAME, _PA-CMPNAME, _PA-LANGU, _PA-DESCRIPT. &quot; VERSION
    INSERT _PA INTO TABLE PARAMETERS.
  ENDLOOP.
ENDMETHOD.
METHOD FD_SUBC_DESC.
DATA: _T   LIKE LINE OF TEXTS.
  FIELD-SYMBOLS:
    &lt;DESC&gt; LIKE LINE OF DESCRIPTIONS.

  LOOP AT DESCRIPTIONS ASSIGNING &lt;DESC&gt;
       WHERE CLSNAME = OBJ_NAME
         AND CMPNAME = COMPONENT
         AND SCONAME = SUB_COMPONENT.
    _T = &lt;DESC&gt;.
    CLEAR: _T-CLSNAME, _T-CMPNAME, _T-SCONAME. &quot; VERSION
    INSERT _T INTO TABLE TEXTS.
  ENDLOOP.
ENDMETHOD.
METHOD FROM_DATA.
DATA _AT  LIKE LINE OF ATTRIBUTS.
  DATA _TY  LIKE LINE OF TYPES.
  DATA _TG  LIKE LINE OF TYPEGROUPS.
  DATA _ME  LIKE LINE OF METHODS.
  DATA _AL  LIKE LINE OF ALIASES.
  DATA _EV  LIKE LINE OF EVENTS.
  DATA _MK  TYPE SEOCPDKEY.
  FIELD-SYMBOLS:
    &lt;M_&gt;  LIKE LINE OF FM_DATA-INCLUDES-METHODS,
    &lt;AT&gt;  LIKE LINE OF FM_DATA-ATTRIBUTES,
    &lt;AL&gt;  LIKE LINE OF FM_DATA-ALIASES,
    &lt;ME&gt;  LIKE LINE OF FM_DATA-METHODS,
    &lt;EV&gt;  LIKE LINE OF FM_DATA-EVENTS,
    &lt;CD&gt;  LIKE LINE OF FM_DATA-CLSDEFERRDS,
    &lt;ID&gt;  LIKE LINE OF FM_DATA-INTDEFERRDS,
    &lt;TY&gt;  LIKE LINE OF FM_DATA-TYPES,
    &lt;TU&gt;  LIKE LINE OF FM_DATA-TYPEUSAGES.

*TYPEPUSAGES  TYPE  SEOT_TYPEPUSAGES_R
*CLSDEFERRDS  TYPE  SEOT_CLSDEFERRDS_R
*INTDEFERRDS  TYPE  SEOT_INTDEFERRDS_R
  LOOP AT FM_DATA-TYPEUSAGES ASSIGNING &lt;TU&gt;
          WHERE CLSNAME = OBJ_NAME.
    CLEAR _TG.
    _TG-HDR = &lt;TU&gt;.

    READ TABLE FM_DATA-CLSDEFERRDS ASSIGNING &lt;CD&gt;
         WITH TABLE KEY CLSNAME = &lt;TU&gt;-CLSNAME
                      TYPEGROUP = &lt;TU&gt;-TYPEGROUP
                        VERSION = &lt;TU&gt;-VERSION.
    IF SY-SUBRC = 0.
      _TG-DEFERED = &lt;CD&gt;.
    ENDIF.

    READ TABLE FM_DATA-INTDEFERRDS ASSIGNING &lt;ID&gt;
         WITH TABLE KEY CLSNAME = &lt;TU&gt;-CLSNAME
                      TYPEGROUP = &lt;TU&gt;-TYPEGROUP
                        VERSION = &lt;TU&gt;-VERSION.
    IF SY-SUBRC = 0.
      _TG-ITF_DEF = &lt;ID&gt;.
    ENDIF.

    CLEAR: _TG-CLSNAME, _TG-DEFERED-CLSNAME, _TG-ITF_DEF-CLSNAME. &quot; VERSION
    INSERT _TG INTO TABLE TYPEGROUPS.
  ENDLOOP.

*ATTRIBUTES TYPE  SEOO_ATTTRIBUTES_R
*COMPONENT_DESC  TYPE  TT_SEOCOMPOTX,
  LOOP AT FM_DATA-ATTRIBUTES ASSIGNING &lt;AT&gt;
    WHERE CLSNAME = OBJ_NAME.
    CLEAR _AT.
    _AT-HDR = &lt;AT&gt;.

    _AT-TEXTS = FD_COMP_DESC( DESCRIPTIONS = FM_DATA-COMPONENT_DESC
                                 COMPONENT = &lt;AT&gt;-CMPNAME ).
    CLEAR: _AT-CLSNAME, _AT-LANGU, _AT-DESCRIPT. &quot; VERSION ?
    INSERT _AT INTO TABLE ATTRIBUTS.
  ENDLOOP.

*METHODS  TYPE  SEOO_MEETHODS_R
*PARAMETERS TYPE  SEOS_PAARAMETERS_R
*EXCEPS TYPE  SEOS_EXXCEPTIONS_R
*SUBCOMPONENT_DESC TYPE  TT_SEOSUBCOTX,
  LOOP AT FM_DATA-METHODS ASSIGNING &lt;ME&gt;
          WHERE CLSNAME = OBJ_NAME.
    CLEAR _ME.
    _ME-HDR = &lt;ME&gt;.

    _ME-TEXTS = FD_COMP_DESC( DESCRIPTIONS = FM_DATA-COMPONENT_DESC
                                 COMPONENT = &lt;ME&gt;-CMPNAME ).

    _ME-EXCEPTIONS = FD_EXCEPTIONS( FM_DATA = FM_DATA
                                  COMPONENT = &lt;ME&gt;-CMPNAME ).

    _ME-PARAMETERS = FD_PARAMETERS( FM_DATA = FM_DATA
                                  COMPONENT = &lt;ME&gt;-CMPNAME ).

    CLEAR: _ME-CLSNAME, _ME-LANGU, _ME-DESCRIPT. &quot; VERSION
    INSERT _ME INTO TABLE METHODS.
  ENDLOOP.

*EVENTS TYPE  SEOO_EXVENTS_R
*PARAMETERS TYPE  SEOS_PAARAMETERS_R
*EXCEPS TYPE  SEOS_EXXCEPTIONS_R
*SUBCOMPONENT_DESC TYPE  TT_SEOSUBCOTX,
  LOOP AT FM_DATA-EVENTS ASSIGNING &lt;EV&gt;
          WHERE CLSNAME = OBJ_NAME.
    CLEAR _EV.
    _EV-HDR = &lt;EV&gt;.

    _EV-TEXTS = FD_COMP_DESC( DESCRIPTIONS = FM_DATA-COMPONENT_DESC
                                 COMPONENT = &lt;EV&gt;-CMPNAME ).

    _EV-PARAMETERS = FD_PARAMETERS( FM_DATA = FM_DATA
                                  COMPONENT = &lt;EV&gt;-CMPNAME ).
* NO EXCEPTION IN EVENT
*    _EV-EXCEPTIONS = FD_EXCEPTIONS( FM_DATA = FM_DATA
*                                  COMPONENT = &lt;EV&gt;-CMPNAME ).

    CLEAR: _EV-CLSNAME, _EV-LANGU, _EV-DESCRIPT. &quot; VERSION
    INSERT _EV INTO TABLE EVENTS.
  ENDLOOP.

*TYPES  TYPE  SEOO_TYPES_R
  LOOP AT FM_DATA-TYPES ASSIGNING &lt;TY&gt;
          WHERE CLSNAME = OBJ_NAME.
    CLEAR _TY.
    _TY-HDR = &lt;TY&gt;.
    _TY-_ = _TY-TYPESRC. CLEAR _TY-TYPESRC.
    REPLACE ALL OCCURRENCES OF CL_ABAP_CHAR_UTILITIES=&gt;CR_LF IN _TY-_ WITH CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE.

    _TY-TEXTS = FD_COMP_DESC( DESCRIPTIONS = FM_DATA-COMPONENT_DESC
                                 COMPONENT = &lt;TY&gt;-CMPNAME ).

    CLEAR: _TY-CLSNAME, _TY-LANGU, _TY-DESCRIPT. &quot; VERSION
    INSERT _TY INTO TABLE TYPES.
  ENDLOOP.

*ALIASES  TYPE  SEOO_ATLIASES_R
  LOOP AT FM_DATA-ALIASES ASSIGNING &lt;AL&gt;
          WHERE CLSNAME = OBJ_NAME.
    CLEAR _AL.
    _AL-HDR = &lt;AL&gt;.

    _AL-TEXTS = FD_COMP_DESC( DESCRIPTIONS = FM_DATA-COMPONENT_DESC
                                 COMPONENT = &lt;AL&gt;-CMPNAME ).

    CLEAR: _AL-CLSNAME. &quot; VERSION
    INSERT _AL INTO TABLE ALIASES.
  ENDLOOP.

* NO USE DETECTED
*EXPLORE_INHERITANCE  TYPE  SEOK_CLS_TYPEINFOS
*EXPLORE_IMPLEMENTINGS  TYPE  SEOK_INT_TYPEINFOS
*ENHANCEMENT_MEETHODS  TYPE  ENHMETH_TABHEADER
*ENHANCEMENT_ATTTRIBUTES TYPE  ENHCLASSTABATTRIB
*ENHANCEMENT_EXVENTS TYPE  ENHCLASSTABEVENT
*ENHANCEMENT_IMPLEMENTINGS  TYPE  ENHCLASSTABIMPLEMENTING
ENDMETHOD.
METHOD TD_COMP_DESC.
DATA: _T   LIKE LINE OF TEXTS.

  LOOP AT TEXTS INTO _T.
    _T-CLSNAME = OBJ_NAME.
    _T-CMPNAME = COMPONENT.
    INSERT _T INTO TABLE DESCRIPTIONS.
  ENDLOOP.
ENDMETHOD.
METHOD TD_EXCEPTIONS.
DATA: _EX  LIKE LINE OF FM_DATA-EXCEPS.
  FIELD-SYMBOLS:
    &lt;EX&gt;  LIKE LINE OF EXCEPTION,
    &lt;T&gt;   LIKE LINE OF &lt;EX&gt;-TEXTS.

  LOOP AT EXCEPTION ASSIGNING &lt;EX&gt;.

    CLEAR: _EX.
    _EX = &lt;EX&gt;-HDR.
    CALL METHOD TD_SUBC_DESC
      EXPORTING
        SUB_COMPONENT = &lt;EX&gt;-SCONAME
        COMPONENT     = COMPONENT
        TEXTS         = &lt;EX&gt;-TEXTS
      CHANGING
        DESCRIPTIONS  = FM_DATA-SUBCOMPONENT_DESC.

    CLEAR: _EX-CLSNAME, _EX-CMPNAME. &quot; VERSION
    _EX-CLSNAME = OBJ_NAME.
    _EX-CMPNAME = COMPONENT.
    _EX-LANGU = OBJ_LANGU.
    READ TABLE &lt;EX&gt;-TEXTS ASSIGNING &lt;T&gt;
         WITH TABLE KEY LANGU = _EX-LANGU.
    IF SY-SUBRC = 0.
      _EX-DESCRIPT = &lt;T&gt;-DESCRIPT.
    ENDIF.
    INSERT _EX INTO TABLE FM_DATA-EXCEPS.
  ENDLOOP.
ENDMETHOD.
METHOD TD_PARAMETERS.
DATA: _PA  LIKE LINE OF FM_DATA-PARAMETERS.
  FIELD-SYMBOLS:
    &lt;PA&gt;  LIKE LINE OF PARAMETERS,
    &lt;T&gt;   LIKE LINE OF &lt;PA&gt;-TEXTS.

  LOOP AT PARAMETERS ASSIGNING &lt;PA&gt;.
    CLEAR: _PA.
    _PA = &lt;PA&gt;-HDR.

    CALL METHOD TD_SUBC_DESC
      EXPORTING
        SUB_COMPONENT = &lt;PA&gt;-SCONAME
        COMPONENT     = COMPONENT
        TEXTS         = &lt;PA&gt;-TEXTS
      CHANGING
        DESCRIPTIONS  = FM_DATA-SUBCOMPONENT_DESC.

    _PA-CLSNAME = OBJ_NAME.
    _PA-CMPNAME = COMPONENT.
    _PA-LANGU = OBJ_LANGU.
    READ TABLE &lt;PA&gt;-TEXTS ASSIGNING &lt;T&gt;
         WITH TABLE KEY LANGU = _PA-LANGU.
    IF SY-SUBRC = 0.
      _PA-DESCRIPT = &lt;T&gt;-DESCRIPT.
    ENDIF.
    INSERT _PA INTO TABLE FM_DATA-PARAMETERS.
  ENDLOOP.
ENDMETHOD.
METHOD TD_SUBC_DESC.
DATA: _T   LIKE LINE OF TEXTS.

  LOOP AT TEXTS INTO _T.
    _T-CLSNAME = OBJ_NAME.
    _T-CMPNAME = COMPONENT.
    _T-SCONAME = SUB_COMPONENT.

    INSERT _T INTO TABLE DESCRIPTIONS.
  ENDLOOP.
ENDMETHOD.
METHOD TO_DATA.
DATA _ID  LIKE LINE OF FM_DATA-IMPL_DETAILS.
  DATA _AT  LIKE LINE OF FM_DATA-ATTRIBUTES.
  DATA _TY  LIKE LINE OF FM_DATA-TYPES.
  DATA _TG  LIKE LINE OF FM_DATA-TYPEUSAGES.
  DATA _ME  LIKE LINE OF FM_DATA-METHODS.
  DATA _AL  LIKE LINE OF FM_DATA-ALIASES.
  DATA _EV  LIKE LINE OF FM_DATA-EVENTS.
  DATA _MS  LIKE LINE OF FM_DATA-METHOD_SOURCES.
  DATA TMP_ME LIKE LINE OF METHODS.
  FIELD-SYMBOLS:
    &lt;AT&gt;  LIKE LINE OF ATTRIBUTS,
    &lt;AL&gt;  LIKE LINE OF ALIASES,
    &lt;ME&gt;  LIKE LINE OF METHODS,
    &lt;EV&gt;  LIKE LINE OF EVENTS,
    &lt;CT&gt;  LIKE LINE OF &lt;AT&gt;-TEXTS,
    &lt;TY&gt;  LIKE LINE OF TYPES,
    &lt;TU&gt;  LIKE LINE OF TYPEGROUPS.

********  MAINDATA-TEXTPOOL = ZAPLINK_PROGRAM=&gt;GET_TEXTPOOL( FM_DATA-INCLUDES-CLASSPOOL ).

* SHOULD BE USELESS
*  MAINDATA-SOURCES-PUBLIC-_ = ZAPLINK_PROGRAM=&gt;GET_SOURCE( FM_DATA-INCLUDES-PUBSEC ).
*  MAINDATA-SOURCES-PROTECTED-_ = ZAPLINK_PROGRAM=&gt;GET_SOURCE( FM_DATA-INCLUDES-PROSEC ).
*  MAINDATA-SOURCES-PRIVATE-_ = ZAPLINK_PROGRAM=&gt;GET_SOURCE( FM_DATA-INCLUDES-PRISEC ).

*TYPEPUSAGES  TYPE  SEOT_TYPEPUSAGES_R
*CLSDEFERRDS  TYPE  SEOT_CLSDEFERRDS_R
*INTDEFERRDS  TYPE  SEOT_INTDEFERRDS_R
  LOOP AT TYPEGROUPS ASSIGNING &lt;TU&gt;.
    CLEAR _TG.
    _TG = &lt;TU&gt;-HDR.

    IF NOT &lt;TU&gt;-DEFERED IS INITIAL.
      &lt;TU&gt;-DEFERED-CLSNAME = &lt;TU&gt;-CLSNAME.
      &lt;TU&gt;-DEFERED-TYPEGROUP = &lt;TU&gt;-TYPEGROUP.
      &lt;TU&gt;-DEFERED-VERSION = &lt;TU&gt;-VERSION.
      APPEND &lt;TU&gt;-DEFERED TO FM_DATA-CLSDEFERRDS.
    ENDIF.

    IF NOT &lt;TU&gt;-ITF_DEF IS INITIAL.
      &lt;TU&gt;-ITF_DEF-CLSNAME = &lt;TU&gt;-CLSNAME.
      &lt;TU&gt;-ITF_DEF-TYPEGROUP = &lt;TU&gt;-TYPEGROUP.
      &lt;TU&gt;-ITF_DEF-VERSION = &lt;TU&gt;-VERSION.
      APPEND &lt;TU&gt;-ITF_DEF TO FM_DATA-INTDEFERRDS.
    ENDIF.

    _TG-CLSNAME = OBJ_NAME.
    INSERT _TG INTO TABLE FM_DATA-TYPEUSAGES.
  ENDLOOP.

*ATTRIBUTES TYPE  SEOO_ATTTRIBUTES_R
*COMPONENT_DESC  TYPE  TT_SEOCOMPOTX,
  LOOP AT ATTRIBUTS ASSIGNING &lt;AT&gt;.
    CLEAR _AT.
    _AT = &lt;AT&gt;-HDR.

    CALL METHOD TD_COMP_DESC
      EXPORTING
        COMPONENT    = &lt;AT&gt;-CMPNAME
        TEXTS        = &lt;AT&gt;-TEXTS
      CHANGING
        DESCRIPTIONS = FM_DATA-COMPONENT_DESC.

    _AT-CLSNAME = OBJ_NAME.
    _AT-LANGU = OBJ_LANGU.
    READ TABLE &lt;AT&gt;-TEXTS ASSIGNING &lt;CT&gt;
         WITH TABLE KEY LANGU = _AT-LANGU.
    IF SY-SUBRC = 0.
      _AT-DESCRIPT = &lt;CT&gt;-DESCRIPT.
    ENDIF.
    INSERT _AT INTO TABLE FM_DATA-ATTRIBUTES.
  ENDLOOP.

*METHODS  TYPE  SEOO_MEETHODS_R
*PARAMETERS TYPE  SEOS_PAARAMETERS_R
*EXCEPS TYPE  SEOS_EXXCEPTIONS_R
*SUBCOMPONENT_DESC TYPE  TT_SEOSUBCOTX,
  LOOP AT METHODS ASSIGNING &lt;ME&gt;.
    CLEAR: _ME, _MS.
    _ME = &lt;ME&gt;-HDR.

    CALL METHOD TD_COMP_DESC
      EXPORTING
        COMPONENT    = &lt;ME&gt;-CMPNAME
        TEXTS        = &lt;ME&gt;-TEXTS
      CHANGING
        DESCRIPTIONS = FM_DATA-COMPONENT_DESC.

    CALL METHOD TD_PARAMETERS
      EXPORTING
        COMPONENT  = &lt;ME&gt;-CMPNAME
        PARAMETERS = &lt;ME&gt;-PARAMETERS
      CHANGING
        FM_DATA    = FM_DATA.

    CALL METHOD TD_EXCEPTIONS
      EXPORTING
        COMPONENT = &lt;ME&gt;-CMPNAME
        EXCEPTION = &lt;ME&gt;-EXCEPTIONS
      CHANGING
        FM_DATA   = FM_DATA.

    TMP_ME = &lt;ME&gt;.
    CLEAR: TMP_ME-CMPNAME, TMP_ME-SOURCE.
    IF TMP_ME IS INITIAL.
      CONTINUE.  &quot; INTERFACE IMPLEMENTATION
    ENDIF.

    _MS-CPDNAME = &lt;ME&gt;-CMPNAME.
    _MS-SOURCE = ZAPLINK_OBJECT=&gt;CONV_ABAP_SOURCE2RAW( &lt;ME&gt;-SOURCE-_ ).
    APPEND _MS TO FM_DATA-METHOD_SOURCES.

    _ME-CLSNAME = OBJ_NAME.
    _ME-LANGU = OBJ_LANGU.
    READ TABLE &lt;ME&gt;-TEXTS ASSIGNING &lt;CT&gt;
         WITH TABLE KEY LANGU = _ME-LANGU.
    IF SY-SUBRC = 0.
      _ME-DESCRIPT = &lt;CT&gt;-DESCRIPT.
    ENDIF.
    INSERT _ME INTO TABLE FM_DATA-METHODS.
  ENDLOOP.

*EVENTS TYPE  SEOO_EXVENTS_R
*PARAMETERS TYPE  SEOS_PAARAMETERS_R
*EXCEPS TYPE  SEOS_EXXCEPTIONS_R
*SUBCOMPONENT_DESC TYPE  TT_SEOSUBCOTX,
  LOOP AT EVENTS ASSIGNING &lt;EV&gt;.
    CLEAR _EV.
    _EV = &lt;EV&gt;-HDR.
    CALL METHOD TD_COMP_DESC
      EXPORTING
        COMPONENT    = &lt;EV&gt;-CMPNAME
        TEXTS        = &lt;EV&gt;-TEXTS
      CHANGING
        DESCRIPTIONS = FM_DATA-COMPONENT_DESC.

    CALL METHOD TD_PARAMETERS
      EXPORTING
        COMPONENT  = &lt;EV&gt;-CMPNAME
        PARAMETERS = &lt;EV&gt;-PARAMETERS
      CHANGING
        FM_DATA    = FM_DATA.

    _EV-CLSNAME = OBJ_NAME.
    _EV-LANGU = OBJ_LANGU.
    READ TABLE &lt;EV&gt;-TEXTS ASSIGNING &lt;CT&gt;
         WITH TABLE KEY LANGU = _EV-LANGU.
    IF SY-SUBRC = 0.
      _EV-DESCRIPT = &lt;CT&gt;-DESCRIPT.
    ENDIF.
    INSERT _EV INTO TABLE FM_DATA-EVENTS.
  ENDLOOP.

*TYPES  TYPE  SEOO_TYPES_R
  LOOP AT TYPES ASSIGNING &lt;TY&gt;.
    CLEAR _TY.
    _TY = &lt;TY&gt;-HDR.
    _TY-TYPESRC = &lt;TY&gt;-_.
*    REPLACE ALL OCCURRENCES OF CL_ABAP_CHAR_UTILITIES=&gt;CR_LF IN _TY-_ WITH CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE.
    REPLACE ALL OCCURRENCES OF CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE IN _TY-TYPESRC WITH CL_ABAP_CHAR_UTILITIES=&gt;CR_LF.

    CALL METHOD ME-&gt;TD_COMP_DESC
      EXPORTING
        COMPONENT    = &lt;TY&gt;-CMPNAME
        TEXTS        = &lt;TY&gt;-TEXTS
      CHANGING
        DESCRIPTIONS = FM_DATA-COMPONENT_DESC.

    _TY-CLSNAME = OBJ_NAME.
    _TY-LANGU = OBJ_LANGU.
    READ TABLE &lt;TY&gt;-TEXTS ASSIGNING &lt;CT&gt;
         WITH TABLE KEY LANGU = _TY-LANGU.
    IF SY-SUBRC = 0.
      _TY-DESCRIPT = &lt;CT&gt;-DESCRIPT.
    ENDIF.
    INSERT _TY INTO TABLE FM_DATA-TYPES.
  ENDLOOP.

*ALIASES  TYPE  SEOO_ATLIASES_R
  LOOP AT ALIASES ASSIGNING &lt;AL&gt;.
    CLEAR _AL.
    _AL = &lt;AL&gt;-HDR.

    CALL METHOD ME-&gt;TD_COMP_DESC
      EXPORTING
        COMPONENT    = &lt;AL&gt;-CMPNAME
        TEXTS        = &lt;AL&gt;-TEXTS
      CHANGING
        DESCRIPTIONS = FM_DATA-COMPONENT_DESC.

    _AL-CLSNAME = OBJ_NAME.
    INSERT _AL INTO TABLE FM_DATA-ALIASES.
  ENDLOOP.

* NO USE DETECTED
*EXPLORE_INHERITANCE  TYPE  SEOK_CLS_TYPEINFOS
*EXPLORE_IMPLEMENTINGS  TYPE  SEOK_INT_TYPEINFOS
*ENHANCEMENT_MEETHODS  TYPE  ENHMETH_TABHEADER
*ENHANCEMENT_ATTTRIBUTES TYPE  ENHCLASSTABATTRIB
*ENHANCEMENT_EXVENTS TYPE  ENHCLASSTABEVENT
*ENHANCEMENT_IMPLEMENTINGS  TYPE  ENHCLASSTABIMPLEMENTING
ENDMETHOD.
METHOD COMPLETE_DATA.

  CHECK NOT FM_DATA-CLASS-CLSNAME IS INITIAL.

  SELECT * INTO TABLE FM_DATA-CLASS_DESC
    FROM SEOCLASSTX
    WHERE CLSNAME = FM_DATA-CLASS-CLSNAME.

  SELECT * INTO TABLE FM_DATA-COMPONENT_DESC
    FROM SEOCOMPOTX
    WHERE CLSNAME = FM_DATA-CLASS-CLSNAME.

  SELECT * INTO TABLE FM_DATA-SUBCOMPONENT_DESC
    FROM SEOSUBCOTX
    WHERE CLSNAME = FM_DATA-CLASS-CLSNAME.

  FM_DATA-INCLUDES = GET_INCLUDES( FM_DATA-CLASS-CLSNAME ).


  DATA _AT  LIKE LINE OF ATTRIBUTS.
  DATA _TY  LIKE LINE OF TYPES.
  DATA _TG  LIKE LINE OF TYPEGROUPS.
  DATA _ME  LIKE LINE OF METHODS.
  DATA _AL  LIKE LINE OF ALIASES.
  DATA _EV  LIKE LINE OF EVENTS.
  DATA _MK  TYPE SEOCPDKEY.
  FIELD-SYMBOLS:
    &lt;M_&gt;  LIKE LINE OF FM_DATA-INCLUDES-METHODS,
    &lt;AT&gt;  LIKE LINE OF FM_DATA-ATTRIBUTES,
    &lt;AL&gt;  LIKE LINE OF FM_DATA-ALIASES,
    &lt;ME&gt;  LIKE LINE OF FM_DATA-METHODS,
    &lt;EV&gt;  LIKE LINE OF FM_DATA-EVENTS,
    &lt;CD&gt;  LIKE LINE OF FM_DATA-CLSDEFERRDS,
    &lt;ID&gt;  LIKE LINE OF FM_DATA-INTDEFERRDS,
    &lt;TY&gt;  LIKE LINE OF FM_DATA-TYPES,
    &lt;TU&gt;  LIKE LINE OF FM_DATA-TYPEUSAGES.

*TYPEPUSAGES  TYPE  SEOT_TYPEPUSAGES_R
*CLSDEFERRDS  TYPE  SEOT_CLSDEFERRDS_R
*INTDEFERRDS  TYPE  SEOT_INTDEFERRDS_R
  LOOP AT FM_DATA-TYPEUSAGES ASSIGNING &lt;TU&gt;
          WHERE CLSNAME = OBJ_NAME.
    CLEAR _TG.
    _TG-HDR = &lt;TU&gt;.

    READ TABLE FM_DATA-CLSDEFERRDS ASSIGNING &lt;CD&gt;
         WITH TABLE KEY CLSNAME = &lt;TU&gt;-CLSNAME
                      TYPEGROUP = &lt;TU&gt;-TYPEGROUP
                        VERSION = &lt;TU&gt;-VERSION.
    IF SY-SUBRC = 0.
      _TG-DEFERED = &lt;CD&gt;.
    ENDIF.

    READ TABLE FM_DATA-INTDEFERRDS ASSIGNING &lt;ID&gt;
         WITH TABLE KEY CLSNAME = &lt;TU&gt;-CLSNAME
                      TYPEGROUP = &lt;TU&gt;-TYPEGROUP
                        VERSION = &lt;TU&gt;-VERSION.
    IF SY-SUBRC = 0.
      _TG-ITF_DEF = &lt;ID&gt;.
    ENDIF.

    CLEAR: _TG-CLSNAME, _TG-DEFERED-CLSNAME, _TG-ITF_DEF-CLSNAME. &quot; VERSION
    INSERT _TG INTO TABLE TYPEGROUPS.
  ENDLOOP.

*ATTRIBUTES TYPE  SEOO_ATTTRIBUTES_R
*COMPONENT_DESC  TYPE  TT_SEOCOMPOTX,
  LOOP AT FM_DATA-ATTRIBUTES ASSIGNING &lt;AT&gt;
    WHERE CLSNAME = OBJ_NAME.
    CLEAR _AT.
    _AT-HDR = &lt;AT&gt;.

    _AT-TEXTS = FD_COMP_DESC( DESCRIPTIONS = FM_DATA-COMPONENT_DESC
                                 COMPONENT = &lt;AT&gt;-CMPNAME ).
    CLEAR: _AT-CLSNAME, _AT-LANGU, _AT-DESCRIPT. &quot; VERSION ?
    INSERT _AT INTO TABLE ATTRIBUTS.
  ENDLOOP.

*METHODS  TYPE  SEOO_MEETHODS_R
*PARAMETERS TYPE  SEOS_PAARAMETERS_R
*EXCEPS TYPE  SEOS_EXXCEPTIONS_R
*SUBCOMPONENT_DESC TYPE  TT_SEOSUBCOTX,
  LOOP AT FM_DATA-METHODS ASSIGNING &lt;ME&gt;
          WHERE CLSNAME = OBJ_NAME.
    CLEAR _ME.
    _ME-HDR = &lt;ME&gt;.

    _ME-TEXTS = FD_COMP_DESC( DESCRIPTIONS = FM_DATA-COMPONENT_DESC
                                 COMPONENT = &lt;ME&gt;-CMPNAME ).

    _ME-EXCEPTIONS = FD_EXCEPTIONS( FM_DATA = FM_DATA
                                  COMPONENT = &lt;ME&gt;-CMPNAME ).

    _ME-PARAMETERS = FD_PARAMETERS( FM_DATA = FM_DATA
                                  COMPONENT = &lt;ME&gt;-CMPNAME ).

    CLEAR: _ME-CLSNAME, _ME-LANGU, _ME-DESCRIPT. &quot; VERSION
    INSERT _ME INTO TABLE METHODS.
  ENDLOOP.

*EVENTS TYPE  SEOO_EXVENTS_R
*PARAMETERS TYPE  SEOS_PAARAMETERS_R
*EXCEPS TYPE  SEOS_EXXCEPTIONS_R
*SUBCOMPONENT_DESC TYPE  TT_SEOSUBCOTX,
  LOOP AT FM_DATA-EVENTS ASSIGNING &lt;EV&gt;
          WHERE CLSNAME = OBJ_NAME.
    CLEAR _EV.
    _EV-HDR = &lt;EV&gt;.

    _EV-TEXTS = FD_COMP_DESC( DESCRIPTIONS = FM_DATA-COMPONENT_DESC
                                 COMPONENT = &lt;EV&gt;-CMPNAME ).

    _EV-PARAMETERS = FD_PARAMETERS( FM_DATA = FM_DATA
                                  COMPONENT = &lt;EV&gt;-CMPNAME ).
* NO EXCEPTION IN EVENT
*    _EV-EXCEPTIONS = FD_EXCEPTIONS( FM_DATA = FM_DATA
*                                  COMPONENT = &lt;EV&gt;-CMPNAME ).

    CLEAR: _EV-CLSNAME, _EV-LANGU, _EV-DESCRIPT. &quot; VERSION
    INSERT _EV INTO TABLE EVENTS.
  ENDLOOP.

*TYPES  TYPE  SEOO_TYPES_R
  LOOP AT FM_DATA-TYPES ASSIGNING &lt;TY&gt;
          WHERE CLSNAME = OBJ_NAME.
    CLEAR _TY.
    _TY-HDR = &lt;TY&gt;.
    _TY-_ = _TY-TYPESRC. CLEAR _TY-TYPESRC.
    REPLACE ALL OCCURRENCES OF CL_ABAP_CHAR_UTILITIES=&gt;CR_LF IN _TY-_ WITH CL_ABAP_CHAR_UTILITIES=&gt;NEWLINE.

    _TY-TEXTS = FD_COMP_DESC( DESCRIPTIONS = FM_DATA-COMPONENT_DESC
                                 COMPONENT = &lt;TY&gt;-CMPNAME ).

    CLEAR: _TY-CLSNAME, _TY-LANGU, _TY-DESCRIPT. &quot; VERSION
    INSERT _TY INTO TABLE TYPES.
  ENDLOOP.

*ALIASES  TYPE  SEOO_ATLIASES_R
  LOOP AT FM_DATA-ALIASES ASSIGNING &lt;AL&gt;
          WHERE CLSNAME = OBJ_NAME.
    CLEAR _AL.
    _AL-HDR = &lt;AL&gt;.

    _AL-TEXTS = FD_COMP_DESC( DESCRIPTIONS = FM_DATA-COMPONENT_DESC
                                 COMPONENT = &lt;AL&gt;-CMPNAME ).

    CLEAR: _AL-CLSNAME. &quot; VERSION
    INSERT _AL INTO TABLE ALIASES.
  ENDLOOP.

* NO USE DETECTED
*EXPLORE_INHERITANCE  TYPE  SEOK_CLS_TYPEINFOS
*EXPLORE_IMPLEMENTINGS  TYPE  SEOK_INT_TYPEINFOS
*ENHANCEMENT_MEETHODS  TYPE  ENHMETH_TABHEADER
*ENHANCEMENT_ATTTRIBUTES TYPE  ENHCLASSTABATTRIB
*ENHANCEMENT_EXVENTS TYPE  ENHCLASSTABEVENT
*ENHANCEMENT_IMPLEMENTINGS  TYPE  ENHCLASSTABIMPLEMENTING
ENDMETHOD.
METHOD GET_INCLUDES.
INCLUDES-CLASSPOOL = CL_OO_CLASSNAME_SERVICE=&gt;GET_CLASSPOOL_NAME( CLSNAME ).
  INCLUDES-PUBSEC    = CL_OO_CLASSNAME_SERVICE=&gt;GET_PUBSEC_NAME( CLSNAME ).
  INCLUDES-PROSEC    = CL_OO_CLASSNAME_SERVICE=&gt;GET_PROSEC_NAME( CLSNAME ).
  INCLUDES-PRISEC    = CL_OO_CLASSNAME_SERVICE=&gt;GET_PRISEC_NAME( CLSNAME ).
  INCLUDES-CL        = CL_OO_CLASSNAME_SERVICE=&gt;GET_CL_NAME( CLSNAME ).
  INCLUDES-CCDEF     = CL_OO_CLASSNAME_SERVICE=&gt;GET_CCDEF_NAME( CLSNAME ).
  INCLUDES-CCIMP     = CL_OO_CLASSNAME_SERVICE=&gt;GET_CCIMP_NAME( CLSNAME ).
  INCLUDES-CCMAC     = CL_OO_CLASSNAME_SERVICE=&gt;GET_CCMAC_NAME( CLSNAME ).
  CALL METHOD CL_OO_CLASSNAME_SERVICE=&gt;GET_ALL_METHOD_INCLUDES
    EXPORTING
      CLSNAME            = CLSNAME
    RECEIVING
      RESULT             = INCLUDES-METHODS
    EXCEPTIONS
      CLASS_NOT_EXISTING = 0
      OTHERS             = 0.   &quot; IGNORE EXCEPTION : CLASS MAY NOT EXITS
          .
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_OBJECT_DATA IMPLEMENTATION

CLASS ZAPLINK_CLAS_DATA IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD GET_SOURCE.
DATA CODE TYPE ZAPLINK_OBJECT=&gt;TT_ABAPRAWSOURCE.
  DATA LINECOUNT TYPE I.
  FIELD-SYMBOLS:
    &lt;L&gt; LIKE LINE OF CODE.

  CODE = ZAPLINK_OBJECT=&gt;GET_PROG_RAWSOURCE( PROGRAM ).

  IF NOT CODE IS INITIAL.
    LINECOUNT = LINES( CODE ).
    IF LINECOUNT &gt; 1.
      READ TABLE CODE ASSIGNING &lt;L&gt; INDEX LINECOUNT.
      TRANSLATE &lt;L&gt; TO UPPER CASE.  &quot;#EC SYNTCHAR
      IF &lt;L&gt; CP &apos;ENDMETHOD.*&apos;.
        DELETE CODE INDEX LINECOUNT.
      ENDIF.
    ENDIF.
    READ TABLE CODE ASSIGNING &lt;L&gt; INDEX 1.
    TRANSLATE &lt;L&gt; TO UPPER CASE.
    IF &lt;L&gt; CP &apos;METHOD *&apos;. &quot;#EC SYNTCHAR
      DELETE CODE INDEX 1.
    ENDIF.
  ENDIF.

  SOURCE = ZAPLINK_OBJECT=&gt;CONV_ABAP_RAW2SOURCE( CODE ).
ENDMETHOD.
METHOD FROM_DATA.
  DATA _IN  LIKE LINE OF INTERFACES.
  DATA _IA  LIKE LINE OF _IN-ATTRIBUTES_REDEFINITION.
  DATA _T   LIKE LINE OF A0_MAINDATA-TEXTS.
  DATA _FR  LIKE LINE OF FRIENDS.
  DATA _RE  LIKE LINE OF ME-&gt;REDEFINITIONS.
  DATA _ME  LIKE LINE OF METHODS.
  DATA _MK  TYPE SEOCPDKEY.
  DATA _SOURCE TYPE ZAPLINK_PROGRAM=&gt;TS_SOURCE.
  FIELD-SYMBOLS:
    &lt;M_&gt;  LIKE LINE OF FM_DATA-INCLUDES-METHODS,
    &lt;IM&gt;  LIKE LINE OF FM_DATA-IMPLEMENTINGS,
    &lt;RD&gt;  LIKE LINE OF FM_DATA-IMPL_DETAILS,
    &lt;ME&gt;  LIKE LINE OF METHODS,
    &lt;FR&gt;  LIKE LINE OF FM_DATA-FRIENDSHIPS,
    &lt;RE&gt;  LIKE LINE OF FM_DATA-REDEFINITIONS.

* ADDED FOR EXCEPTION CLASSES
  FIELD-SYMBOLS:
    &lt;CX&gt; LIKE LINE OF FM_DATA-EXCEPTIONS_TEXTS,
    &lt;AT&gt; LIKE LINE OF FM_DATA-ATTRIBUTES.
  DATA _CX_TEXT  LIKE LINE OF EXCEPTIONS_TEXTS.
  DATA _SOTR_KEY TYPE SOTR_CONC.
  DATA _TEXT     LIKE LINE OF _CX_TEXT-LONGTEXTS.
  DATA _FM_DATA  TYPE T_FM_DATA.

  A0_MAINDATA-HDR = FM_DATA-CLASS.
  OBJ_NAME = A0_MAINDATA-CLSNAME.
  OBJ_VERSION = A0_MAINDATA-VERSION.
  OBJ_LANGU = A0_MAINDATA-LANGU.

*CLASS_DESC  TYPE TT_SEOCLASSTX,
  A0_MAINDATA-TEXTS = FM_DATA-CLASS_DESC.
  MODIFY A0_MAINDATA-TEXTS FROM _T TRANSPORTING CLSNAME WHERE CLSNAME &lt;&gt; _T-CLSNAME.
  CLEAR A0_MAINDATA-DESCRIPT.
  A0_MAINDATA-INHERITANCE = FM_DATA-INHERITANCE.
  CLEAR A0_MAINDATA-INHERITANCE-CLSNAME.

* ATTRIBUTE TO EXCEPTION_TEXT FOR EXCEPTION CLASS, MUST STAND BEFORE CALLING SUPER
  _FM_DATA = FM_DATA.
  IF FM_DATA-CLASS-CATEGORY = &apos;40&apos;.  &quot; 40 EXCEPTION CLASS
    LOOP AT _FM_DATA-ATTRIBUTES ASSIGNING &lt;AT&gt;
         WHERE ATTDECLTYP = &apos;2&apos;   &quot; CONSTANT
           AND LOCKED = ABAP_TRUE
           AND TYPE = &apos;SOTR_CONC&apos;
           AND NOT ATTVALUE IS INITIAL.
      _SOTR_KEY = VALUE2SOTR( &lt;AT&gt;-ATTVALUE ).
      READ TABLE FM_DATA-EXCEPTIONS_TEXTS ASSIGNING &lt;CX&gt;
           WITH TABLE KEY CONCEPT = _SOTR_KEY.
      IF SY-SUBRC &lt;&gt; 0.
        CONTINUE.
      ENDIF.
      _CX_TEXT-ATTR = &lt;AT&gt;.
      _CX_TEXT-CX = &lt;CX&gt;-HDR.
      _CX_TEXT-LONGTEXTS = &lt;CX&gt;-TEXTS.
      _CX_TEXT-TEXTS = FD_COMP_DESC( DESCRIPTIONS = FM_DATA-COMPONENT_DESC
                                        COMPONENT = &lt;AT&gt;-CMPNAME ).
      CLEAR: _CX_TEXT-ATTVALUE, _CX_TEXT-CLSNAME, _CX_TEXT-LANGU, _CX_TEXT-DESCRIPT.    &quot; ATTRIBUT
* KEEP OLD OTR IN CASE SOTR CREATION FAILED
*      CLEAR: _CX_TEXT-CONCEPT.                                                           &quot; SOTR
      MODIFY _CX_TEXT-LONGTEXTS FROM _TEXT TRANSPORTING CONCEPT WHERE CONCEPT &lt;&gt; _TEXT-CONCEPT.    &quot; SOTR
      INSERT _CX_TEXT INTO TABLE EXCEPTIONS_TEXTS.
      DELETE _FM_DATA-ATTRIBUTES.                 &quot; EXCEPTION TEXT NO LOGNER AN ATTRIBUTE
    ENDLOOP.
  ENDIF.

  CALL METHOD SUPER-&gt;FROM_DATA
    EXPORTING
      FM_DATA = _FM_DATA.

*LOCAL DEFINITIONS
  LOCAL-TYPES-_ = GET_SOURCE( FM_DATA-INCLUDES-CCDEF ).
  LOCAL-IMPLEMENTATIONS-_ = GET_SOURCE( FM_DATA-INCLUDES-CCIMP ).
  LOCAL-MACROS-_ = GET_SOURCE( FM_DATA-INCLUDES-CCMAC ).

*IMPLEMENTINGS  TYPE  SEOR_IMPLEMENTINGS_R
  LOOP AT FM_DATA-IMPLEMENTINGS ASSIGNING &lt;IM&gt;
          WHERE CLSNAME = A0_MAINDATA-CLSNAME.
    CLEAR _IN.
    _IN-HDR = &lt;IM&gt;.

    LOOP AT FM_DATA-IMPL_DETAILS ASSIGNING &lt;RD&gt;
         WHERE CLSNAME = &lt;IM&gt;-CLSNAME
           AND REFCLSNAME = &lt;IM&gt;-REFCLSNAME.
*           AND VERSION = &lt;IM&gt;-VERSION   &quot; NEEDED ?
      _IA = &lt;RD&gt;.
      CLEAR: _IA-CLSNAME, _IA-REFCLSNAME.
      APPEND _IA  TO _IN-ATTRIBUTES_REDEFINITION.
    ENDLOOP.

    CLEAR _IN-CLSNAME.
    INSERT _IN INTO TABLE INTERFACES.
  ENDLOOP.

*METHODES SOURCE
  LOOP AT FM_DATA-INCLUDES-METHODS ASSIGNING &lt;M_&gt;.
    _SOURCE = GET_SOURCE( &lt;M_&gt;-INCNAME ).
    CHECK NOT _SOURCE IS INITIAL.
    _MK = &lt;M_&gt;-CPDKEY.
    CHECK _MK-CLSNAME = A0_MAINDATA-CLSNAME.
    READ TABLE METHODS ASSIGNING &lt;ME&gt;
         WITH TABLE KEY CMPNAME = _MK-CPDNAME.
    IF SY-SUBRC = 0.
      &lt;ME&gt;-SOURCE-_ = _SOURCE.
    ELSE.
      _ME-CMPNAME = _MK-CPDNAME.
      _ME-SOURCE-_ = _SOURCE.
      INSERT _ME INTO TABLE METHODS.
    ENDIF.
  ENDLOOP.

*FRIENDSHIPS  TYPE  SEOF_FRIENDSHIPS_R
  LOOP AT FM_DATA-FRIENDSHIPS ASSIGNING &lt;FR&gt;
    WHERE CLSNAME = A0_MAINDATA-CLSNAME.
    CLEAR _FR.
    _FR = &lt;FR&gt;.
    CLEAR _FR-CLSNAME.
    INSERT _FR INTO TABLE FRIENDS.
  ENDLOOP.

*REDEFINITIONS  TYPE  SEOR_REDEFINITIONS_R
*IMPL_DETAILS TYPE  SEOR_REDEFINITIONS_R
  LOOP AT FM_DATA-REDEFINITIONS ASSIGNING &lt;RE&gt;
       WHERE CLSNAME = A0_MAINDATA-CLSNAME.
    CLEAR: _RE.
    _RE-HDR = &lt;RE&gt;.

    _MK-CLSNAME = &lt;RE&gt;-CLSNAME.
    _MK-CPDNAME = &lt;RE&gt;-MTDNAME.
    READ TABLE FM_DATA-INCLUDES-METHODS ASSIGNING &lt;M_&gt;
         WITH KEY CPDKEY = _MK.
    IF SY-SUBRC = 0.
      _RE-SOURCE-_ = GET_SOURCE( &lt;M_&gt;-INCNAME ).
    ENDIF.

    CLEAR _RE-CLSNAME.
    INSERT _RE INTO TABLE REDEFINITIONS.
  ENDLOOP.

ENDMETHOD.
METHOD TO_DATA.
  DATA _T   LIKE LINE OF A0_MAINDATA-TEXTS.
  DATA _IN  LIKE LINE OF FM_DATA-IMPLEMENTINGS.
  DATA _FR  LIKE LINE OF FM_DATA-FRIENDSHIPS.
  DATA _ID  LIKE LINE OF FM_DATA-IMPL_DETAILS.
  DATA _MS  LIKE LINE OF FM_DATA-METHOD_SOURCES.
  DATA _AT  LIKE LINE OF FM_DATA-ATTRIBUTES.
  DATA _CX  LIKE LINE OF FM_DATA-EXCEPTIONS_TEXTS.
  FIELD-SYMBOLS:
    &lt;CX&gt;  LIKE LINE OF EXCEPTIONS_TEXTS,
    &lt;RE&gt;  LIKE LINE OF REDEFINITIONS,
    &lt;IN&gt;  LIKE LINE OF INTERFACES,
    &lt;IA&gt;  LIKE LINE OF &lt;IN&gt;-ATTRIBUTES_REDEFINITION,
    &lt;CT&gt;  LIKE LINE OF &lt;CX&gt;-TEXTS,
    &lt;FR&gt;  LIKE LINE OF FRIENDS.
  DATA _TEXT LIKE LINE OF _CX-TEXTS.

  OBJ_NAME = A0_MAINDATA-CLSNAME.
  OBJ_VERSION = A0_MAINDATA-VERSION.
  OBJ_LANGU = A0_MAINDATA-LANGU.

* WARNING RECIEVING (WILL RESET FM_DATA)
  CALL METHOD SUPER-&gt;TO_DATA
    RECEIVING
      FM_DATA = FM_DATA.

  FM_DATA-CLASS = A0_MAINDATA-HDR.
  READ TABLE A0_MAINDATA-TEXTS INTO _T
       WITH TABLE KEY LANGU = A0_MAINDATA-LANGU.
  IF SY-SUBRC = 0.
    FM_DATA-CLASS-DESCRIPT = _T-DESCRIPT.
  ENDIF.

*LOCAL DEFINITIONS
  FM_DATA-LOCALS_DEF = ZAPLINK_OBJECT=&gt;CONV_ABAP_SOURCE2RAW( LOCAL-TYPES-_ ).
  FM_DATA-LOCALS_IMP = ZAPLINK_OBJECT=&gt;CONV_ABAP_SOURCE2RAW( LOCAL-IMPLEMENTATIONS-_ ).
  FM_DATA-LOCALS_MAC = ZAPLINK_OBJECT=&gt;CONV_ABAP_SOURCE2RAW( LOCAL-MACROS-_ ).

*CLASS_DESC  TYPE TT_SEOCLASSTX,
  FM_DATA-CLASS_DESC = A0_MAINDATA-TEXTS.
  _T-CLSNAME = A0_MAINDATA-CLSNAME.
  MODIFY FM_DATA-CLASS_DESC FROM _T TRANSPORTING CLSNAME WHERE CLSNAME &lt;&gt; _T-CLSNAME.

  FM_DATA-INHERITANCE = A0_MAINDATA-INHERITANCE.
  FM_DATA-INHERITANCE-CLSNAME = A0_MAINDATA-CLSNAME.

*IMPLEMENTINGS  TYPE  SEOR_IMPLEMENTINGS_R
  LOOP AT INTERFACES ASSIGNING &lt;IN&gt;.
    CLEAR _IN.
    _IN = &lt;IN&gt;-HDR.
    _IN-CLSNAME = A0_MAINDATA-CLSNAME.
    INSERT _IN INTO TABLE FM_DATA-IMPLEMENTINGS.

    LOOP AT &lt;IN&gt;-ATTRIBUTES_REDEFINITION ASSIGNING &lt;IA&gt;.
      _ID = &lt;IA&gt;.
      _ID-CLSNAME = _IN-CLSNAME.
      _ID-REFCLSNAME = _IN-REFCLSNAME .
      APPEND _ID TO FM_DATA-IMPL_DETAILS.
    ENDLOOP.

  ENDLOOP.

*FRIENDS
*REDEFINITIONS
*FRIENDSHIPS  TYPE  SEOF_FRIENDSHIPS_R
  LOOP AT FRIENDS ASSIGNING &lt;FR&gt;.
    CLEAR _FR.
    _FR = &lt;FR&gt;.
    _FR-CLSNAME = A0_MAINDATA-CLSNAME.
    INSERT _FR INTO TABLE FM_DATA-FRIENDSHIPS.
  ENDLOOP.

*REDEFINITIONS  TYPE  SEOR_REDEFINITIONS_R
*IMPL_DETAILS TYPE  SEOR_REDEFINITIONS_R
  LOOP AT REDEFINITIONS ASSIGNING &lt;RE&gt;.
    CLEAR: _MS.
    &lt;RE&gt;-CLSNAME = A0_MAINDATA-CLSNAME.

    APPEND &lt;RE&gt;-HDR TO FM_DATA-REDEFINITIONS.

    _MS-CPDNAME = &lt;RE&gt;-MTDNAME.
    _MS-REDEFINE = ABAP_TRUE.
    _MS-SOURCE = ZAPLINK_OBJECT=&gt;CONV_ABAP_SOURCE2RAW( &lt;RE&gt;-SOURCE-_ ).
    APPEND _MS TO FM_DATA-METHOD_SOURCES.
  ENDLOOP.

* FOR EXCEPTION CLASSES
  LOOP AT EXCEPTIONS_TEXTS ASSIGNING &lt;CX&gt;.
    CLEAR _AT.
    _AT = &lt;CX&gt;-ATTR.
    _AT-CLSNAME = A0_MAINDATA-CLSNAME.
    _AT-ATTVALUE = SOTR2VALUE( &lt;CX&gt;-CONCEPT ).

    CALL METHOD TD_COMP_DESC
      EXPORTING
        COMPONENT    = &lt;CX&gt;-CMPNAME
        TEXTS        = &lt;CX&gt;-TEXTS
      CHANGING
        DESCRIPTIONS = FM_DATA-COMPONENT_DESC.

    _AT-LANGU = A0_MAINDATA-LANGU.
    READ TABLE &lt;CX&gt;-TEXTS ASSIGNING &lt;CT&gt;
         WITH TABLE KEY LANGU = _AT-LANGU.
    IF SY-SUBRC = 0.
      _AT-DESCRIPT = &lt;CT&gt;-DESCRIPT.
    ENDIF.
    INSERT _AT INTO TABLE FM_DATA-ATTRIBUTES.

    CLEAR _CX.
    _CX-HDR = &lt;CX&gt;-CX.
    _CX-TEXTS = &lt;CX&gt;-LONGTEXTS.
    _TEXT-CONCEPT = &lt;CX&gt;-CONCEPT.
    MODIFY _CX-TEXTS FROM _TEXT TRANSPORTING CONCEPT WHERE CONCEPT &lt;&gt; _TEXT-CONCEPT.    &quot; SOTR
    INSERT _CX INTO TABLE FM_DATA-EXCEPTIONS_TEXTS.
  ENDLOOP.

ENDMETHOD.
METHOD COMPLETE_DATA.
  DATA _VAL TYPE SEOVALUE.
  DATA _SOTR LIKE LINE OF FM_DATA-EXCEPTIONS_TEXTS.
  DATA _TEXT TYPE STANDARD TABLE OF SOTR_TEXT.
  DATA _ATTR_TEXT LIKE LINE OF FM_DATA-COMPONENT_DESC.
  FIELD-SYMBOLS:
    &lt;PT&gt; LIKE LINE OF FM_DATA-COMPONENT_DESC,
    &lt;ST&gt; LIKE LINE OF _SOTR-TEXTS,
    &lt;A&gt; LIKE LINE OF FM_DATA-ATTRIBUTES.

  CALL METHOD SUPER-&gt;COMPLETE_DATA
    CHANGING
      FM_DATA = FM_DATA.

  IF FM_DATA-CLASS-CATEGORY = &apos;40&apos;.  &quot; 40 EXCEPTION CLASS
    LOOP AT FM_DATA-ATTRIBUTES ASSIGNING &lt;A&gt;
         WHERE ATTDECLTYP = &apos;2&apos;   &quot; CONSTANT
           AND LOCKED = ABAP_TRUE
           AND TYPE = &apos;SOTR_CONC&apos;
           AND NOT ATTVALUE IS INITIAL.
      CLEAR _SOTR.
      _SOTR-CONCEPT = VALUE2SOTR( &lt;A&gt;-ATTVALUE ).
      CALL FUNCTION &apos;SOTR_GET_CONCEPT&apos;
        EXPORTING
          CONCEPT        = _SOTR-CONCEPT
        IMPORTING
          HEADER         = _SOTR-HDR
        TABLES
          ENTRIES        = _TEXT
        EXCEPTIONS
          NO_ENTRY_FOUND = 1
          OTHERS         = 2.
      IF SY-SUBRC &lt;&gt; 0.
        CLEAR: _SOTR, _VAL, _TEXT.
        CONTINUE.
      ENDIF.

      _SOTR-TEXTS = _TEXT.
      _SOTR-CMPNAME = &lt;A&gt;-CMPNAME.
      INSERT _SOTR INTO TABLE FM_DATA-EXCEPTIONS_TEXTS.
      LOOP AT _SOTR-TEXTS ASSIGNING &lt;ST&gt;
           WHERE NOT TEXT IS INITIAL.
        READ TABLE FM_DATA-COMPONENT_DESC ASSIGNING &lt;PT&gt;
             WITH KEY CMPNAME = &lt;A&gt;-CMPNAME
                        LANGU = &lt;ST&gt;-LANGU.
        IF SY-SUBRC = 0.
          IF &lt;PT&gt;-DESCRIPT IS INITIAL.
            &lt;PT&gt;-DESCRIPT = &lt;ST&gt;-TEXT.
          ENDIF.
        ELSE.
          MOVE-CORRESPONDING &lt;A&gt; TO _ATTR_TEXT.
          _ATTR_TEXT-LANGU = &lt;ST&gt;-LANGU.
          _ATTR_TEXT-DESCRIPT = &lt;ST&gt;-TEXT.
          INSERT _ATTR_TEXT INTO TABLE FM_DATA-COMPONENT_DESC.
        ENDIF.
      ENDLOOP.

    ENDLOOP.
  ENDIF.

ENDMETHOD.
METHOD VALUE2SOTR.
  DATA _VAL TYPE SEOVALUE.

  _VAL = DATA.
  REPLACE ALL OCCURRENCES OF &apos;&apos;&apos;&apos; IN _VAL WITH SPACE.
  CONDENSE _VAL.
  RESULT = _VAL.

ENDMETHOD.
METHOD SOTR2VALUE.
  CONCATENATE &apos;&apos;&apos;&apos; DATA &apos;&apos;&apos;&apos; INTO RESULT.
ENDMETHOD.
METHOD UPDATE_CONCEPT.
  DATA LT_TYPES TYPE SOTR_OBJECTS.
  DATA _TYPE    LIKE LINE OF LT_TYPES.
  DATA _CX      TYPE REF TO ZAPLINK_CX.
  DATA _PAKET   TYPE SOTR_PACK.
  DATA _ENTRIES TYPE SOTR_TEXT_TT.
  DATA _ENTRY   LIKE LINE OF _ENTRIES.
  DATA LT_CX    TYPE TT_CX_TEXTS.
  DATA LS_CX    LIKE LINE OF FM_DATA-EXCEPTIONS_TEXTS.
  FIELD-SYMBOLS:
    &lt;AT&gt; LIKE LINE OF FM_DATA-ATTRIBUTES,
    &lt;CX&gt; LIKE LINE OF FM_DATA-EXCEPTIONS_TEXTS.

  LOOP AT FM_DATA-EXCEPTIONS_TEXTS ASSIGNING &lt;CX&gt;.

    CALL FUNCTION &apos;SOTR_OBJECT_GET_OBJECTS&apos;
      EXPORTING
        OBJECT_VECTOR    = &lt;CX&gt;-OBJID_VEC
      IMPORTING
        OBJECTS          = LT_TYPES
      EXCEPTIONS
        OBJECT_NOT_FOUND = 1
        OTHERS           = 2.
    IF SY-SUBRC &lt;&gt; 0 OR LT_TYPES IS INITIAL.
      CALL METHOD MSG_COL-&gt;ADD_SYMSG( ).
      CONTINUE.
    ENDIF.
    READ TABLE LT_TYPES INTO _TYPE INDEX 1.

    _PAKET-PAKET = &lt;CX&gt;-PAKET.
    _ENTRIES = &lt;CX&gt;-TEXTS.
    MODIFY _ENTRIES FROM _ENTRY TRANSPORTING CONCEPT WHERE CONCEPT &lt;&gt; _ENTRY-CONCEPT.
    LS_CX = &lt;CX&gt;.

    CALL FUNCTION &apos;SOTR_GET_CONCEPT&apos;
      EXPORTING
        CONCEPT              = &lt;CX&gt;-CONCEPT
*       IMPORTING
*         HEADER               =
*       TABLES
*         ENTRIES              =
     EXCEPTIONS
       NO_ENTRY_FOUND       = 1
       OTHERS               = 2.
    IF SY-SUBRC = 0.
      CALL FUNCTION &apos;SOTR_DELETE_CONCEPT&apos;
        EXPORTING
          CONCEPT                     = &lt;CX&gt;-CONCEPT
*           IN_UPDATE_TASK              =
*           FLAG_CHECK_USAGE            =
*           FLAG_CHECK_AUTHORITY        =
*           FLAG_CHECK_MASTER           =
*           LANGU                       = SY-LANGU
*           FLAG_CORRECTION_ENTRY       =
*         IMPORTING
*           FLAG_CANCELLED              =
        EXCEPTIONS
          NO_AUTHORIZATION            = 1
          NO_ENTRY_FOUND              = 2
          CONCEPT_USED                = 3
          NO_MASTER_LANGUAGE          = 4
          NO_SOURCE_SYSTEM            = 5
          NO_TADIR_ENTRY              = 6
          ERROR_IN_CORRECTION         = 7
          USER_CANCELLED              = 8
          TEXT_NOT_FOUND              = 9
          INVALID_PACKAGE             = 10
          TEXT_NOT_CHANGEABLE         = 11
          TEXT_ENQUEUED               = 12
          NO_CORRECTION               = 13
          PARAMETER_ERROR             = 14
          OTHERS                      = 15.
      IF SY-SUBRC &lt;&gt; 0.
      _CX = ZAPLINK_CX=&gt;CREATE_FROM_MF_CX( SUBRC = SY-SUBRC
                                        FUNCNAME = &apos;SOTR_DELETE_CONCEPT&apos; ).
      IF NOT MSG_COL IS BOUND.
        RAISE EXCEPTION _CX.
      ELSE.
        CALL METHOD MSG_COL-&gt;ADD_EXCEPTION
          EXPORTING
            EXCEPTION    = _CX
*            ID_DETLEVEL  =
*            ID_PROBCLASS =
            .
      ENDIF.
      ENDIF.
    ENDIF.

    TRY.
        CALL FUNCTION &apos;SOTR_CREATE_CONCEPT&apos;
          EXPORTING
            PAKET                               = _PAKET
            CREA_LAN                            = &lt;CX&gt;-CREA_LAN
            ALIAS_NAME                          = &lt;CX&gt;-ALIAS_NAME
*       CATEGORY                            =
            OBJECT                              = _TYPE
            ENTRIES                             = _ENTRIES
*       FLAG_CORRECTION_ENTRY               =
*       IN_UPDATE_TASK                      =
            CONCEPT_DEFAULT                     = &lt;CX&gt;-CONCEPT
*       FLAG_COPY_TEXT                      =
          IMPORTING
            CONCEPT                             = LS_CX-CONCEPT
*       NEW_ENTRIES                         =
          EXCEPTIONS
            PACKAGE_MISSING                     = 1
            CREA_LAN_MISSING                    = 2
            OBJECT_MISSING                      = 3
            PAKET_DOES_NOT_EXIST                = 4
            ALIAS_ALREADY_EXIST                 = 5
            OBJECT_TYPE_NOT_FOUND               = 6
            LANGU_MISSING                       = 7
            IDENTICAL_CONTEXT_NOT_ALLOWED       = 8
            TEXT_TOO_LONG                       = 9
            ERROR_IN_UPDATE                     = 10
            NO_MASTER_LANGU                     = 11
            ERROR_IN_CONCEPT_ID                 = 12
            ALIAS_NOT_ALLOWED                   = 13
            TADIR_ENTRY_CREATION_FAILED         = 14
            INTERNAL_ERROR                      = 15
            ERROR_IN_CORRECTION                 = 16
            USER_CANCELLED                      = 17
            NO_ENTRY_FOUND                      = 18
            OTHERS                              = 19.
      CATCH CX_ROOT.
*        CALL METHOD MSG_COL-&gt;ADD_WARNING

* CONCEPT CAN&apos;T BE CREATED TRY BUILD NEW ONE
        CALL FUNCTION &apos;SOTR_CREATE_CONCEPT&apos;
          EXPORTING
            PAKET                               = _PAKET
            CREA_LAN                            = &lt;CX&gt;-CREA_LAN
            ALIAS_NAME                          = &lt;CX&gt;-ALIAS_NAME
*       CATEGORY                            =
            OBJECT                              = _TYPE
            ENTRIES                             = _ENTRIES
*       FLAG_CORRECTION_ENTRY               =
*       IN_UPDATE_TASK                      =
*       CONCEPT_DEFAULT                     =
*       FLAG_COPY_TEXT                      =
          IMPORTING
            CONCEPT                             = LS_CX-CONCEPT
*       NEW_ENTRIES                         =
          EXCEPTIONS
            PACKAGE_MISSING                     = 1
            CREA_LAN_MISSING                    = 2
            OBJECT_MISSING                      = 3
            PAKET_DOES_NOT_EXIST                = 4
            ALIAS_ALREADY_EXIST                 = 5
            OBJECT_TYPE_NOT_FOUND               = 6
            LANGU_MISSING                       = 7
            IDENTICAL_CONTEXT_NOT_ALLOWED       = 8
            TEXT_TOO_LONG                       = 9
            ERROR_IN_UPDATE                     = 10
            NO_MASTER_LANGU                     = 11
            ERROR_IN_CONCEPT_ID                 = 12
            ALIAS_NOT_ALLOWED                   = 13
            TADIR_ENTRY_CREATION_FAILED         = 14
            INTERNAL_ERROR                      = 15
            ERROR_IN_CORRECTION                 = 16
            USER_CANCELLED                      = 17
            NO_ENTRY_FOUND                      = 18
            OTHERS                              = 19.
    ENDTRY.
    IF SY-SUBRC &lt;&gt; 0.
      _CX = ZAPLINK_CX=&gt;CREATE_FROM_MF_CX( SUBRC = SY-SUBRC
                                        FUNCNAME = &apos;SOTR_CREATE_CONCEPT&apos; ).
      IF NOT MSG_COL IS BOUND.
        RAISE EXCEPTION _CX.
      ELSE.
        CALL METHOD MSG_COL-&gt;ADD_EXCEPTION
          EXPORTING
            EXCEPTION    = _CX
*            ID_DETLEVEL  =
*            ID_PROBCLASS =
            .
      ENDIF.
      CONTINUE.
    ENDIF.

    CHECK LS_CX-CONCEPT &lt;&gt; &lt;CX&gt;-CONCEPT.

    INSERT LS_CX INTO TABLE LT_CX.
    DELETE FM_DATA-EXCEPTIONS_TEXTS.

    READ TABLE FM_DATA-ATTRIBUTES ASSIGNING &lt;AT&gt;
         WITH KEY CMPNAME = LS_CX-CMPNAME.
    IF SY-SUBRC = 0.
      &lt;AT&gt;-ATTVALUE = SOTR2VALUE( LS_CX-CONCEPT ).
    ELSE.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.
  ENDLOOP.

  INSERT LINES OF FM_DATA-EXCEPTIONS_TEXTS INTO TABLE LT_CX.
  FM_DATA-EXCEPTIONS_TEXTS = LT_CX.

ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_CLAS_DATA IMPLEMENTATION

CLASS ZAPLINK_INTF_DATA IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD FROM_DATA.
DATA _T   LIKE LINE OF A0_MAINDATA-TEXTS.
  DATA _IN  LIKE LINE OF INTERFACES.
  FIELD-SYMBOLS:
    &lt;CO&gt;  LIKE LINE OF FM_DATA-COMPRISINGS,
    &lt;EC&gt;  LIKE LINE OF FM_DATA-EXPLORE_COMPRISINGS.

  A0_MAINDATA-HDR = FM_DATA-INTERFACE.
  OBJ_NAME = A0_MAINDATA-CLSNAME.
  OBJ_VERSION = A0_MAINDATA-VERSION.
  OBJ_LANGU = A0_MAINDATA-LANGU.

*CLASS_DESC  TYPE TT_SEOCLASSTX,
  A0_MAINDATA-TEXTS = FM_DATA-CLASS_DESC.
  MODIFY A0_MAINDATA-TEXTS FROM _T TRANSPORTING CLSNAME WHERE CLSNAME &lt;&gt; _T-CLSNAME.
  CLEAR A0_MAINDATA-DESCRIPT.

* GET ALL COMMON ATTRIBUTES BETWEEN CLASS AND INTERFACE
  CALL METHOD SUPER-&gt;FROM_DATA
    EXPORTING
      FM_DATA = FM_DATA.

*COMPRISINGS TYPE  SEOR_COMPRISINGS_R
  LOOP AT FM_DATA-COMPRISINGS ASSIGNING &lt;CO&gt;
    WHERE CLSNAME = A0_MAINDATA-CLSNAME.
    CLEAR _IN.
    MOVE-CORRESPONDING &lt;CO&gt; TO _IN.

    CLEAR _IN-CLSNAME.
    INSERT _IN INTO TABLE INTERFACES.
  ENDLOOP.
ENDMETHOD.
METHOD TO_DATA.
DATA _T   LIKE LINE OF A0_MAINDATA-TEXTS.
  DATA _CO  LIKE LINE OF FM_DATA-COMPRISINGS.
  DATA _EC  LIKE LINE OF FM_DATA-EXPLORE_COMPRISINGS.
  FIELD-SYMBOLS:
    &lt;IN&gt;  LIKE LINE OF INTERFACES.

  OBJ_NAME = A0_MAINDATA-CLSNAME.
  OBJ_VERSION = A0_MAINDATA-VERSION.
  OBJ_LANGU = A0_MAINDATA-LANGU.

* WARNING RECIEVING (WILL RESET FM_DATA)
  CALL METHOD SUPER-&gt;TO_DATA
    RECEIVING
      FM_DATA = FM_DATA.

  FM_DATA-INTERFACE = A0_MAINDATA-HDR.
  READ TABLE A0_MAINDATA-TEXTS INTO _T
       WITH TABLE KEY LANGU = A0_MAINDATA-LANGU.
  IF SY-SUBRC = 0.
    FM_DATA-INTERFACE-DESCRIPT = _T-DESCRIPT.
  ENDIF.

*CLASS_DESC  TYPE TT_SEOCLASSTX,
  FM_DATA-CLASS_DESC = A0_MAINDATA-TEXTS.
  _T-CLSNAME = A0_MAINDATA-CLSNAME.
  MODIFY FM_DATA-CLASS_DESC FROM _T TRANSPORTING CLSNAME WHERE CLSNAME &lt;&gt; _T-CLSNAME.

*COMPRISINGS TYPE  SEOR_COMPRISINGS_R
  LOOP AT INTERFACES ASSIGNING &lt;IN&gt;.
    CLEAR: _CO.
    MOVE-CORRESPONDING &lt;IN&gt; TO _CO.
    _CO-CLSNAME = A0_MAINDATA-CLSNAME.
    INSERT _CO INTO TABLE FM_DATA-COMPRISINGS.
  ENDLOOP.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_INTF_DATA IMPLEMENTATION

CLASS ZAPLINK_OBJECT IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CLASS_CONSTRUCTOR.
*TABLE TDCLT
*DOKCLASS DOKTITEL
*CA       CLASS ATTRIBUTE
*CE       CLASS EVENT
*CL       CLASS
*CO       CLASS METHOD
*CT       CLASS TYPE
  DATA _ID LIKE LINE OF R_DOC_ID_CLASS.

  _ID-SIGN = &apos;I&apos;.
  _ID-OPTION = &apos;EQ&apos;.
  _ID-LOW = &apos;CA&apos;. APPEND _ID TO R_DOC_ID_CLASS.
  _ID-LOW = &apos;CE&apos;. APPEND _ID TO R_DOC_ID_CLASS.
  _ID-LOW = &apos;CL&apos;. APPEND _ID TO R_DOC_ID_CLASS.
  _ID-LOW = &apos;CO&apos;. APPEND _ID TO R_DOC_ID_CLASS.
  _ID-LOW = &apos;CT&apos;. APPEND _ID TO R_DOC_ID_CLASS.

  _ID-LOW = &apos;IA&apos;. APPEND _ID TO R_DOC_ID_INTERFACE.
  _ID-LOW = &apos;IE&apos;. APPEND _ID TO R_DOC_ID_INTERFACE.
  _ID-LOW = &apos;IF&apos;. APPEND _ID TO R_DOC_ID_INTERFACE.
  _ID-LOW = &apos;IO&apos;. APPEND _ID TO R_DOC_ID_INTERFACE.
ENDMETHOD.
METHOD CONSTRUCTOR.
  DATA TYPE LIKE LINE OF SUPPORTED_TYPES.

  CALL METHOD SUPER-&gt;CONSTRUCTOR.

  TYPE-TYPE = ST_CLASS. INSERT TYPE INTO TABLE SUPPORTED_TYPES.
  TYPE-TYPE = ST_INTERFACE. INSERT TYPE INTO TABLE SUPPORTED_TYPES.

  UUID = _UUID.
  VERSION = _VER.

  CALL METHOD APPLICATION_LOG-&gt;INIT
    EXPORTING
      ID_OBJECT      = BALLOG_OBJECT
      ID_SUBOBJECT   = BALLOG_SUBOBJECT
*      ID_EXTNUMBER   =
      AUTO_UPD_CUSTO = ABAP_TRUE
*      ID_ACTIVITY    = ACT_CREATE
    EXCEPTIONS
      ERROR          = 1
      OTHERS         = 2.
  IF SY-SUBRC &lt;&gt; 0.
   MESSAGE ID SY-MSGID TYPE &apos;I&apos; NUMBER SY-MSGNO
              WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.
ENDMETHOD.
METHOD EXPORT_FROM_SAP_CLASS.
  DATA OBJ_MASK   TYPE DOKU_OBJ.
  DATA DOCU_KEY   TYPE TS_DOC_KEY.
  DATA CLASSKEY   TYPE SEOCLSKEY.
  DATA _D         TYPE T_FM_DATA.

  CHECK COMPONENT-&gt;GET_TYPE( ) = ST_CLASS.

*  _OBJTYPE = COMPONENT-TYPE.
  CLASSKEY-CLSNAME = COMPONENT-&gt;GET_NAME( ).
  CALL FUNCTION &apos;SEO_CLASS_TYPEINFO_GET&apos;
    EXPORTING
      CLSKEY                              = CLASSKEY
*     VERSION                             = SEOC_VERSION_INACTIVE
*     STATE                               = &apos;1&apos;
*     WITH_DESCRIPTIONS                   = SEOX_TRUE
      RESOLVE_EVENTHANDLER_TYPEINFO       = SEOX_TRUE
      WITH_MASTER_LANGUAGE                = SEOX_TRUE
      WITH_ENHANCEMENTS                   = SEOX_TRUE
*     READ_ACTIVE_ENHA                    = SEOX_FALSE
    IMPORTING
      CLASS                               = _D-CLASS
      ATTRIBUTES                          = _D-ATTRIBUTES
      METHODS                             = _D-METHODS
      EVENTS                              = _D-EVENTS
      TYPES                               = _D-TYPES
      PARAMETERS                          = _D-PARAMETERS
      EXCEPS                              = _D-EXCEPS
      IMPLEMENTINGS                       = _D-IMPLEMENTINGS
      INHERITANCE                         = _D-INHERITANCE
      REDEFINITIONS                       = _D-REDEFINITIONS
      IMPL_DETAILS                        = _D-IMPL_DETAILS
      FRIENDSHIPS                         = _D-FRIENDSHIPS
      TYPEPUSAGES                         = _D-TYPEUSAGES
      CLSDEFERRDS                         = _D-CLSDEFERRDS
      INTDEFERRDS                         = _D-INTDEFERRDS
      EXPLORE_INHERITANCE                 = _D-EXPLORE_INHERITANCE
      EXPLORE_IMPLEMENTINGS               = _D-EXPLORE_IMPLEMENTINGS
      ALIASES                             = _D-ALIASES
      ENHANCEMENT_METHODS                 = _D-ENHANCEMENT_METHODS
      ENHANCEMENT_ATTRIBUTES              = _D-ENHANCEMENT_ATTRIBUTES
      ENHANCEMENT_EVENTS                  = _D-ENHANCEMENT_EVENTS
      ENHANCEMENT_IMPLEMENTINGS           = _D-ENHANCEMENT_IMPLEMENTINGS
    EXCEPTIONS
      NOT_EXISTING                        = 1
      IS_INTERFACE                        = 2
      MODEL_ONLY                          = 3
      OTHERS                              = 4
            .
  IF SY-SUBRC &lt;&gt; 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

  CREATE OBJECT OBJECT.
  OBJECT-&gt;COMPLETE_DATA( CHANGING FM_DATA = _D ).
  OBJECT-&gt;FROM_DATA( _D ).

* DOCUMENTATIONS
  DOCU_KEY-NAME = COMPONENT-&gt;GET_NAME( ).
  DOCU_KEY-OTHER = &apos;*&apos;.
  OBJ_MASK = DOCU_KEY.

  OBJECT-&gt;DOCUMENTATION = ZAPLINK_DOCUMENTATION=&gt;GET( IDS = R_DOC_ID_CLASS
                                                   OBJECT = OBJ_MASK ).
ENDMETHOD.
METHOD EXPORT_FROM_SAP_INTERFACE.
DATA OBJ_MASK       TYPE DOKU_OBJ.
  DATA DOCU_KEY       TYPE TS_DOC_KEY.
  DATA CLASSKEY TYPE SEOCLSKEY.
  DATA _D       TYPE T_FM_DATA.

  CHECK COMPONENT-&gt;GET_TYPE( ) = ST_INTERFACE.

  CLASSKEY-CLSNAME = COMPONENT-&gt;GET_NAME( ).
  CALL FUNCTION &apos;SEO_INTERFACE_TYPEINFO_GET&apos;
    EXPORTING
      INTKEY                        = CLASSKEY
*     VERSION                       = SEOC_VERSION_INACTIVE
*     STATE                         = &apos;1&apos;
      WITH_MASTER_LANGUAGE          = SEOX_TRUE
      WITH_ENHANCEMENTS             = SEOX_TRUE
*     READ_ACTIVE_ENHA              = SEOX_FALSE
    IMPORTING
      INTERFACE                     = _D-INTERFACE
      ATTRIBUTES                    = _D-ATTRIBUTES
      METHODS                       = _D-METHODS
      EVENTS                        = _D-EVENTS
      PARAMETERS                    = _D-PARAMETERS
      EXCEPS                        = _D-EXCEPS
      COMPRISINGS                   = _D-COMPRISINGS
      TYPEPUSAGES                   = _D-TYPEUSAGES
      CLSDEFERRDS                   = _D-CLSDEFERRDS
      INTDEFERRDS                   = _D-INTDEFERRDS
      EXPLORE_COMPRISINGS           = _D-EXPLORE_COMPRISINGS
      ALIASES                       = _D-ALIASES
      TYPES                         = _D-TYPES
      ENHANCEMENT_METHODS           = _D-ENHANCEMENT_METHODS
      ENHANCEMENT_ATTRIBUTES        = _D-ENHANCEMENT_ATTRIBUTES
      ENHANCEMENT_EVENTS            = _D-ENHANCEMENT_EVENTS
      ENHANCEMENT_COMPRISINGS       = _D-ENHANCEMENT_COMPRISINGS
    EXCEPTIONS
      NOT_EXISTING                  = 1
      IS_CLASS                      = 2
      MODEL_ONLY                    = 3
      OTHERS                        = 4.
  IF SY-SUBRC &lt;&gt; 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

  CREATE OBJECT OBJECT.
  OBJECT-&gt;COMPLETE_DATA( CHANGING FM_DATA = _D ).
  OBJECT-&gt;FROM_DATA( _D ).

* DOCUMENTATIONS
  DOCU_KEY-NAME = COMPONENT-&gt;GET_NAME( ).
  DOCU_KEY-OTHER = &apos;*&apos;.
  OBJ_MASK = DOCU_KEY.

  OBJECT-&gt;DOCUMENTATION = ZAPLINK_DOCUMENTATION=&gt;GET( IDS = R_DOC_ID_INTERFACE
                                                   OBJECT = OBJ_MASK ).
ENDMETHOD.
METHOD IMPORT_TO_SAP_CLASS.
  DATA _D               TYPE T_FM_DATA.
  DATA I_KORRNR         TYPE TRKORR.
  DATA _COMPONENT       TYPE TO_COMPONENT.
  DATA _NAME            TYPE TD_COMPNAME.

  _D = O_DATA-&gt;TO_DATA( ).
  ZAPLINK_CLAS_DATA=&gt;UPDATE_CONCEPT( EXPORTING MSG_COL = APPLICATION_LOG
                                     CHANGING  FM_DATA = _D ).

  CALL FUNCTION &apos;SEO_BUFFER_INIT&apos;.
  CALL FUNCTION &apos;SEO_CLASS_CREATE_COMPLETE&apos;
   EXPORTING
*     CORRNR                             = E_CORRNR
*     DEVCLASS                           = &apos;$TMP&apos;                &quot;DEVCLASS
*     VERSION                            = E_VERSION
*     GENFLAG                            = E_GENFLAG
*     AUTHORITY_CHECK                    = E_AUTHORITY_CHECK
     OVERWRITE                          = &apos;X&apos;                   &quot;OVERWRITE
*   SUPPRESS_METHOD_GENERATION         = E_SUPPRESS_METH_GEN
*   SUPPRESS_REFACTORING_SUPPORT       = E_SUPPRESS_REFAC_GEN
     METHOD_SOURCES                     = _D-METHOD_SOURCES    &quot; METHODS SOURCE
     LOCALS_DEF                         = _D-LOCALS_DEF        &quot; LOCAL_TYPES
     LOCALS_IMP                         = _D-LOCALS_IMP        &quot; LOCAL_IMP
     LOCALS_MAC                         = _D-LOCALS_MAC        &quot; MACROS
*   SUPPRESS_INDEX_UPDATE              = E_SUPPRESS_IND_UPDATE
   IMPORTING
     KORRNR                             = I_KORRNR
   TABLES
     CLASS_DESCRIPTIONS                 = _D-CLASS_DESC
     COMPONENT_DESCRIPTIONS             = _D-COMPONENT_DESC
     SUBCOMPONENT_DESCRIPTIONS          = _D-SUBCOMPONENT_DESC
   CHANGING
     CLASS                              = _D-CLASS
     INHERITANCE                        = _D-INHERITANCE
     REDEFINITIONS                      = _D-REDEFINITIONS
     IMPLEMENTINGS                      = _D-IMPLEMENTINGS
     IMPL_DETAILS                       = _D-IMPL_DETAILS
     ATTRIBUTES                         = _D-ATTRIBUTES
     METHODS                            = _D-METHODS
     EVENTS                             = _D-EVENTS
     TYPES                              = _D-TYPES
*   TYPE_SOURCE                        = CH_TYPE_SOURCE &quot;???
     PARAMETERS                         = _D-PARAMETERS
     EXCEPS                             = _D-EXCEPS
     ALIASES                            = _D-ALIASES
     TYPEPUSAGES                        = _D-TYPEUSAGES
     CLSDEFERRDS                        = _D-CLSDEFERRDS
     INTDEFERRDS                        = _D-INTDEFERRDS
     FRIENDSHIPS                        = _D-FRIENDSHIPS
   EXCEPTIONS
     EXISTING                           = 1
     IS_INTERFACE                       = 2
     DB_ERROR                           = 3
     COMPONENT_ERROR                    = 4
     NO_ACCESS                          = 5
     OTHER                              = 6
     OTHERS                             = 7.
  CASE SY-SUBRC.
    WHEN 0.
** I GUESS IF WE MADE IT THIS FAR, WE WILL ASSUME SUCCESS
** SUCCESSFUL INSTALL
    WHEN OTHERS.
      RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
        EXPORTING TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
  ENDCASE.

  ZAPLINK_DOCUMENTATION=&gt;SET( O_DATA-&gt;DOCUMENTATION ).

  CREATE OBJECT _COMPONENT.
  _COMPONENT-&gt;SET_TYPE( ST_CLASS ).
  _NAME = _D-CLASS-CLSNAME.
  _COMPONENT-&gt;SET_NAME( _NAME ).
  CREATE OBJECT COMPONENTS.
  COMPONENTS-&gt;ADD( _COMPONENT ).
ENDMETHOD.
METHOD IMPORT_TO_SAP_INTERFACE.
  DATA _D           TYPE T_FM_DATA.
  DATA I_KORRNR     TYPE TRKORR.
  DATA _COMPONENT   TYPE TO_COMPONENT.
  DATA _NAME        TYPE TD_COMPNAME.

  _D = O_DATA-&gt;TO_DATA( ).
*  _D-INCLUDES = ZAPLINK_CLASS_DATA=&gt;GET_INCLUDES( _D-CLASS-CLSNAME ).

  CALL FUNCTION &apos;SEO_BUFFER_INIT&apos;.
  CALL FUNCTION &apos;SEO_INTERFACE_CREATE_COMPLETE&apos;
    EXPORTING
*     CORRNR                             =
*     DEVCLASS                           = &apos;$TMP&apos;
*     VERSION                            = SEOC_VERSION_INACTIVE
*     GENFLAG                            = &apos; &apos;
*     AUTHORITY_CHECK                    = SEOX_TRUE
      OVERWRITE                          = SEOX_TRUE
*     SUPPRESS_REFACTORING_SUPPORT       = SEOX_TRUE
    IMPORTING
      KORRNR                             = I_KORRNR
    TABLES
      CLASS_DESCRIPTIONS                 = _D-CLASS_DESC
      COMPONENT_DESCRIPTIONS             = _D-COMPONENT_DESC
      SUBCOMPONENT_DESCRIPTIONS          = _D-SUBCOMPONENT_DESC
    CHANGING
      INTERFACE                          = _D-INTERFACE
      COMPRISINGS                        = _D-COMPRISINGS
      ATTRIBUTES                         = _D-ATTRIBUTES
      METHODS                            = _D-METHODS
      EVENTS                             = _D-EVENTS
      PARAMETERS                         = _D-PARAMETERS
      EXCEPS                             = _D-EXCEPS
      ALIASES                            = _D-ALIASES
      TYPEPUSAGES                        = _D-TYPEUSAGES
      CLSDEFERRDS                        = _D-CLSDEFERRDS
      INTDEFERRDS                        = _D-INTDEFERRDS
      TYPES                              = _D-TYPES
    EXCEPTIONS
      EXISTING                           = 1
      IS_CLASS                           = 2
      DB_ERROR                           = 3
      COMPONENT_ERROR                    = 4
      NO_ACCESS                          = 5
      OTHER                              = 6
      OTHERS                             = 7.
  CASE SY-SUBRC.
    WHEN &apos;0&apos;.
** I GUESS IF WE MADE IT THIS FAR, WE WILL ASSUME SUCCESS
** SUCCESSFUL INSTALL
    WHEN OTHERS.
      RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
        EXPORTING TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
  ENDCASE.

* PATCH SAP DO NOT CREATE TYPE ALIAS.
  DATA  INTKEY TYPE SEOCLSKEY.
  DATA  TYPE   TYPE VSEOTYPE.
  FIELD-SYMBOLS &lt;ALIAS&gt; LIKE LINE OF _D-ALIASES.

  LOOP AT _D-ALIASES ASSIGNING &lt;ALIAS&gt;
          WHERE CMPTYPE = SEOO_CMPTYPE_TYPE.
    MOVE-CORRESPONDING &lt;ALIAS&gt; TO TYPE.
    TYPE-ALIAS = SEOX_TRUE.
    TYPE-STATE = SEOC_STATE_IMPLEMENTED.
    CALL FUNCTION &apos;SEO_TYPE_CREATE_F_DATA&apos;
      EXPORTING
        SAVE   = SEOX_FALSE
      CHANGING
        TYPE   = TYPE
      EXCEPTIONS
        OTHERS = 1.
  ENDLOOP.
  MOVE-CORRESPONDING _D-INTERFACE TO INTKEY.
  CALL FUNCTION &apos;SEO_CLIF_SAVE_ALL&apos;
    EXPORTING
      CIFKEY                        = INTKEY
      SUPPRESS_REFACTORING_ENTRIES  = SEOX_TRUE
      SUPPRESS_MODIFICATION_SUPPORT = SEOX_TRUE
*    CHANGING
*      CORRNR                        = CORRNR
*      DEVCLASS                      = DEVCLASS
*      GENFLAG                       = GENFLAG
    EXCEPTIONS
      DB_ERROR                      = 1
      OTHERS                        = 2.

  ZAPLINK_DOCUMENTATION=&gt;SET( O_DATA-&gt;DOCUMENTATION ).

  CREATE OBJECT _COMPONENT.
  _COMPONENT-&gt;SET_TYPE( ST_INTERFACE ).
  _NAME = _D-INTERFACE-CLSNAME.
  _COMPONENT-&gt;SET_NAME( _NAME ).
  CREATE OBJECT COMPONENTS.
  COMPONENTS-&gt;ADD( _COMPONENT ).
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~CREATE_NEW_RAW.
  DATA O_CLAS TYPE TO_CLASS.
  DATA O_INTF TYPE TO_INTERFACE.

  CREATE OBJECT OBJECT.
  CASE TYPE.
    WHEN ST_CLASS.
      CREATE OBJECT O_CLAS.
      OBJECT-&gt;RAW ?= O_CLAS.
*      CREATE OBJECT OBJECT TYPE TO_CLASS.
    WHEN ST_INTERFACE.
      CREATE OBJECT O_INTF.
      OBJECT-&gt;RAW ?= O_INTF.
*      CREATE OBJECT OBJECT TYPE TO_CLASS.
    WHEN OTHERS.
      CLEAR OBJECT.
      RAISE EXCEPTION TYPE ZAPLINK_CX.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~DELETE_FROM_SAP.
DATA CLSKEY TYPE SEOCLSKEY.

  CASE COMPONENT-&gt;GET_TYPE( ).
    WHEN ST_CLASS.
      CLSKEY-CLSNAME = COMPONENT-&gt;GET_NAME( ).
      CALL FUNCTION &apos;SEO_CLASS_DELETE_W_DEPS&apos;
        EXPORTING
          CLSKEY       = CLSKEY
        EXCEPTIONS
          NOT_EXISTING = 1
          IS_INTERFACE = 2
          NOT_DELETED  = 3
          DB_ERROR     = 4
          OTHERS       = 5.
      IF SY-SUBRC &lt;&gt; 0.
        CASE SY-SUBRC.
          WHEN 1.
            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
              EXPORTING TEXTID = ZAPLINK_CX_CONNECTOR=&gt;NOT_FOUND.
*          WHEN 2.
*            RAISE EXCEPTION TYPE ZCX_SAPLINK
*              EXPORTING
*                TEXTID = ZCX_SAPLINK=&gt;ERROR_MESSAGE
*                MSG = &apos;INTERFACES NOT SUPPORTED&apos;.
*          WHEN 3.
*            RAISE EXCEPTION TYPE ZCX_SAPLINK
*              EXPORTING
*                TEXTID = ZCX_SAPLINK=&gt;ERROR_MESSAGE
*                MSG = &apos;CLASS NOT DELETED&apos;.
          WHEN OTHERS.
            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
              EXPORTING TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
        ENDCASE.
      ENDIF.
    WHEN ST_INTERFACE.
      CLSKEY-CLSNAME = COMPONENT-&gt;GET_NAME( ).
* NOT WORKING
*      CALL FUNCTION &apos;SEO_INTERFACE_DELETE_W_DEPS&apos;
*        EXPORTING
*          INTKEY       = CLSKEY
*          SAVE         = SEOX_TRUE
*        EXCEPTIONS
*          NOT_EXISTING = 1
*          IS_CLASS     = 2
*          NOT_DELETED  = 3
*          DB_ERROR     = 4
*          OTHERS       = 5.
      CALL FUNCTION &apos;SEO_INTERFACE_DELETE_COMPLETE&apos;
        EXPORTING
          INTKEY                     = CLSKEY
*         GENFLAG                    = &apos; &apos;
          AUTHORITY_CHECK            = SEOX_TRUE
          SUPPRESS_DOCU_DELETE       = SEOX_TRUE
*         SUPPRESS_COMMIT            = SEOX_FALSE
*       CHANGING
*         CORRNR                     =
        EXCEPTIONS
          NOT_EXISTING               = 1
          IS_CLASS                   = 2
          DB_ERROR                   = 3
          NO_ACCESS                  = 4
          OTHER                      = 5
          OTHERS                     = 6
                .
      IF SY-SUBRC &lt;&gt; 0.
        CASE SY-SUBRC.
          WHEN 1.
            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
              EXPORTING TEXTID = ZAPLINK_CX_CONNECTOR=&gt;NOT_FOUND.
*          WHEN 2.
*            RAISE EXCEPTION TYPE ZCX_SAPLINK
*              EXPORTING
*                TEXTID = ZCX_SAPLINK=&gt;ERROR_MESSAGE
*                MSG = &apos;INTERFACES NOT SUPPORTED&apos;.
*          WHEN 3.
*            RAISE EXCEPTION TYPE ZCX_SAPLINK
*              EXPORTING
*                TEXTID = ZCX_SAPLINK=&gt;ERROR_MESSAGE
*                MSG = &apos;CLASS NOT DELETED&apos;.
          WHEN OTHERS.
            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
              EXPORTING TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
        ENDCASE.
      ENDIF.
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~DO_EXISTS.
DATA CLSKEY TYPE SEOCLSKEY.
*  DATA NOT_ACTIVE TYPE  SEOX_BOOLEAN.

  CASE COMPONENT-&gt;GET_TYPE( ).
    WHEN ST_CLASS.
      CLSKEY-CLSNAME = COMPONENT-&gt;GET_NAME( ).

      CALL FUNCTION &apos;SEO_CLASS_EXISTENCE_CHECK&apos;
        EXPORTING
          CLSKEY        = CLSKEY
*        IMPORTING
*          NOT_ACTIVE    = NOT_ACTIVE
        EXCEPTIONS
          NOT_SPECIFIED = 1
          NOT_EXISTING  = 2
          IS_INTERFACE  = 3
          NO_TEXT       = 4
          INCONSISTENT  = 5
          OTHERS        = 6.

      IF SY-SUBRC = 0.
        EXISTS = &apos;X&apos;.
      ENDIF.
    WHEN ST_INTERFACE.
      CLSKEY-CLSNAME = COMPONENT-&gt;GET_NAME( ).

      CALL FUNCTION &apos;SEO_INTERFACE_EXISTENCE_CHECK&apos;
        EXPORTING
          INTKEY              = CLSKEY
*       IMPORTING
*         NOT_ACTIVE          =
       EXCEPTIONS
         NOT_SPECIFIED       = 1
         NOT_EXISTING        = 2
         IS_CLASS            = 3
         NO_TEXT             = 4
         INCONSISTENT        = 5
         OTHERS              = 6.

      IF SY-SUBRC = 0.
        EXISTS = &apos;X&apos;.
      ENDIF.
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~READ_FROM_SAP.
  DATA O_CLAS TYPE TO_CLASS.
  DATA O_INTF TYPE TO_INTERFACE.

  CREATE OBJECT OBJECT.
  OBJECT-&gt;SET_COMPONENT( COMPONENT ).

  CASE COMPONENT-&gt;GET_TYPE( ).
    WHEN ST_CLASS.
      O_CLAS = EXPORT_FROM_SAP_CLASS( COMPONENT ).
      CLEAR O_CLAS-&gt;A0_MAINDATA-CLSNAME.
      OBJECT-&gt;RAW ?= O_CLAS.
    WHEN ST_INTERFACE.
      O_INTF = EXPORT_FROM_SAP_INTERFACE( COMPONENT ).
      CLEAR O_INTF-&gt;A0_MAINDATA-CLSNAME.
      OBJECT-&gt;RAW ?= O_INTF.
    WHEN OTHERS.
      CLEAR OBJECT.
      RAISE EXCEPTION TYPE ZAPLINK_CX.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~WRITE_TO_SAP.
  DATA _O_CLASS       TYPE TO_CLASS.
  DATA _O_INTERFACE   TYPE TO_INTERFACE.

  CASE OBJECT-&gt;TYPE.
    WHEN ST_CLASS.
      _O_CLASS ?= OBJECT-&gt;RAW.
      _O_CLASS-&gt;A0_MAINDATA-CLSNAME = OBJECT-&gt;NAME.
      COMPONENTS = IMPORT_TO_SAP_CLASS( _O_CLASS ).
    WHEN ST_INTERFACE.
      _O_INTERFACE ?= OBJECT-&gt;RAW.
      _O_INTERFACE-&gt;A0_MAINDATA-CLSNAME = OBJECT-&gt;NAME.
      COMPONENTS = IMPORT_TO_SAP_INTERFACE( _O_INTERFACE ).
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
  RESULT = ABAP_FALSE.
  IF VERSION = _VER.
    RESULT = ABAP_TRUE.
  ENDIF.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_OBJECT IMPLEMENTATION

CLASS ZAPLINK_PINF_DATA IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
ENDCLASS. &quot;ZAPLINK_PINF_DATA IMPLEMENTATION

CLASS ZAPLINK_PINF_RAW IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS

*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES


*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONSTRUCTOR.
  DATA O_RAW TYPE REF TO ZAPLINK_PINF_DATA.
  CALL METHOD SUPER-&gt;CONSTRUCTOR
    EXPORTING
      O_COMP = O_COMP.
  CREATE OBJECT O_RAW.
  RAW ?= O_RAW.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_PINF_RAW IMPLEMENTATION

CLASS ZAPLINK_DEVC_RAW IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS

*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES


*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CONSTRUCTOR.
  DATA O_RAW TYPE REF TO ZAPLINK_DEVC_DATA.
  CALL METHOD SUPER-&gt;CONSTRUCTOR
    EXPORTING
      O_COMP = O_COMP.
  CREATE OBJECT O_RAW.
  RAW ?= O_RAW.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_DEVC_RAW IMPLEMENTATION

CLASS ZAPLINK_DEVC_DATA IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
ENDCLASS. &quot;ZAPLINK_DEVC_DATA IMPLEMENTATION

CLASS ZAPLINK_PACKAGE IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD ADD_ELEMENTS_LIST.
DATA _ERR       TYPE SCOMELDATA.
  DATA _ERR_LST   TYPE SCOMELDATA.
  DATA ALV_DATA   TYPE TT_ELE.
  DATA A_DATA     LIKE LINE OF ALV_DATA.
  DATA EXCEPTION  TYPE REF TO ZAPLINK_CX_CONNECTOR.
  DATA TITLE      TYPE LVC_TITLE.
  DATA ERRORMSG   TYPE STRING.
*  DATA _ITF_E     LIKE LINE OF ITF_ELEMENTS.
  FIELD-SYMBOLS &lt;E&gt; LIKE LINE OF _ERR.
  FIELD-SYMBOLS &lt;L&gt; LIKE LINE OF INTERFACE-&gt;ELEMENTS.

  CALL METHOD INTERFACE-&gt;IF-&gt;ADD_ELEMENTS
    EXPORTING
      I_ELEMENTS_DATA        = INTERFACE-&gt;ELEMENTS
    IMPORTING
*        E_NEW_ELEMENTS         =
*        E_EXISTING_ELEM_DATA   =
      E_MISMATCHED_ELEM_DATA = _ERR &quot; SHOULD BE EMPTY IF ALL OK
    EXCEPTIONS
      OBJECT_INVALID         = 1
      INTERN_ERR             = 2
      OTHERS                 = 3
          .
  IF SY-SUBRC &lt;&gt; 0 OR NOT _ERR IS INITIAL.
    IF _ERR IS INITIAL.
      ERRORMSG = &apos;PACKAGE INTERFACE ELEMENTS CREATION FAILED !&apos;(E91).
*    ELSEIF NOT ADD_REMAIN IS INITIAL.
*      _ITF_E-INTERFACE = INTERFACE-&gt;IF.
*      _ITF_E-ELEMENTS = _ERR.
*      APPEND _ITF_E TO ITF_ELEMENTS.
*      EXIT.
    ELSEIF SY-BATCH = &apos;X&apos; OR ASK_USER IS INITIAL.
      ERRORMSG = BUILD_ERROR_MSG( _ERR ).

      CONCATENATE &apos;PACKAGE INTERFACE ELEMENTS FAILED TO ADD : &apos;(E92) ERRORMSG INTO ERRORMSG.
    ELSE. &quot; ASK USER
      LOOP AT _ERR ASSIGNING &lt;E&gt;.
        READ TABLE INTERFACE-&gt;ELEMENTS ASSIGNING &lt;L&gt;
             WITH KEY INTF_NAME = &lt;E&gt;-INTF_NAME
                      ELEM_TYPE = &lt;E&gt;-ELEM_TYPE
                       ELEM_KEY = &lt;E&gt;-ELEM_KEY.
        IF SY-SUBRC &lt;&gt; 0.
          RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
            EXPORTING
              TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
        ENDIF.
        &lt;E&gt; = &lt;L&gt;. &quot; BACK TO ORIGINAL VALUE
      ENDLOOP.
      ALV_DATA = ELEMENTS2ALV( _ERR ).
      A_DATA-ELEM_PACK = INTERFACE-&gt;IF-&gt;PUBLISHER_PACKAGE_NAME.
      MODIFY ALV_DATA FROM A_DATA TRANSPORTING ELEM_PACK WHERE ELEM_PACK IS INITIAL.   &quot;UPDATE PACKAGE
      TITLE = &apos;INCOSISTANT TADIR ENTRIES PLEASE SELECT ELEMENTS THAT WILL CHANGE PACKAGE. ALL UNSELECTED ENTRIES WON&apos;&apos;T BE IN THIS INTERFACE&apos;(ALV).
      CALL FUNCTION &apos;REUSE_ALV_GRID_DISPLAY&apos;
        EXPORTING
*           I_INTERFACE_CHECK                 = &apos; &apos;
*           I_BYPASSING_BUFFER                = &apos; &apos;
*           I_BUFFER_ACTIVE                   = &apos; &apos;
*           I_CALLBACK_PROGRAM                = &apos; &apos;
*           I_CALLBACK_PF_STATUS_SET          = &apos; &apos;
*           I_CALLBACK_USER_COMMAND           = &apos; &apos;
*           I_CALLBACK_TOP_OF_PAGE            = &apos; &apos;
*           I_CALLBACK_HTML_TOP_OF_PAGE       = &apos; &apos;
*           I_CALLBACK_HTML_END_OF_LIST       = &apos; &apos;
*           I_STRUCTURE_NAME                  =
*           I_BACKGROUND_ID                   = &apos; &apos;
          I_GRID_TITLE                      = TITLE
*           I_GRID_SETTINGS                   =
          IS_LAYOUT                         = CAT_LAYOUT
          IT_FIELDCAT                       = CAT_ELE
*           IT_EXCLUDING                      =
*           IT_SPECIAL_GROUPS                 =
*           IT_SORT                           =
*           IT_FILTER                         =
*           IS_SEL_HIDE                       =
*           I_DEFAULT                         = &apos;X&apos;
*           I_SAVE                            = &apos; &apos;
*           IS_VARIANT                        =
*           IT_EVENTS                         =
*           IT_EVENT_EXIT                     =
*           IS_PRINT                          =
*           IS_REPREP_ID                      =
*           I_SCREEN_START_COLUMN             = 0
*           I_SCREEN_START_LINE               = 0
*           I_SCREEN_END_COLUMN               = 0
*           I_SCREEN_END_LINE                 = 0
*           I_HTML_HEIGHT_TOP                 = 0
*           I_HTML_HEIGHT_END                 = 0
*           IT_ALV_GRAPHICS                   =
*           IT_HYPERLINK                      =
*           IT_ADD_FIELDCAT                   =
*           IT_EXCEPT_QINFO                   =
*           IR_SALV_FULLSCREEN_ADAPTER        =
*         IMPORTING
*           E_EXIT_CAUSED_BY_CALLER           =
*           ES_EXIT_CAUSED_BY_USER            =
        TABLES
          T_OUTTAB                          = ALV_DATA
        EXCEPTIONS
         PROGRAM_ERROR                     = 1
         OTHERS                            = 2.
      IF SY-SUBRC &lt;&gt; 0.
        ERRORMSG = BUILD_ERROR_MSG( _ERR ).

        CONCATENATE &apos;PACKAGE INTERFACE ELEMENTS FAILED TO ADD : &apos;(E92) ERRORMSG INTO ERRORMSG.
      ELSE.
        CHANGE_TADIR( CHANGING ALV_DATA = ALV_DATA ).
        LOOP AT _ERR ASSIGNING &lt;E&gt;.
          CLEAR A_DATA.
          READ TABLE ALV_DATA INTO A_DATA WITH KEY ELEM_TYPE = &lt;E&gt;-ELEM_TYPE
                                                    ELEM_KEY = &lt;E&gt;-ELEM_KEY.
          IF SY-SUBRC &lt;&gt; 0 OR A_DATA-SELECT IS INITIAL.
            APPEND &lt;E&gt; TO _ERR_LST.
            DELETE _ERR.
          ENDIF.
        ENDLOOP.

        TRY.
            INTERFACE-&gt;ELEMENTS = _ERR.
            CALL METHOD ADD_ELEMENTS_LIST
              EXPORTING
                INTERFACE = INTERFACE
*                LIST      = _ERR
*                ASK_USER =
*                ADD_REMAIN = ADD_REMAIN
                .
          CATCH ZAPLINK_CX_CONNECTOR INTO EXCEPTION.
            RAISE EXCEPTION EXCEPTION.
        ENDTRY.
        IF _ERR_LST IS INITIAL.
          EXIT. &quot; IF EVERY THING IS OK
        ELSE.
          ERRORMSG = BUILD_ERROR_MSG( _ERR_LST ).

          CONCATENATE &apos;PACKAGE INTERFACE ELEMENTS FAILED TO ADD : &apos;(E92) ERRORMSG INTO ERRORMSG.
        ENDIF.
      ENDIF.
    ENDIF.

    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR
           MSG = ERRORMSG.
  ENDIF.

  CALL METHOD INTERFACE-&gt;IF-&gt;SAVE_ELEMENTS
    EXPORTING
      I_TRANSPORT_REQUEST   = TRANSPORT_REQUEST
    IMPORTING
      E_TRANSPORT_REQUEST   = TRANSPORT_REQUEST
    EXCEPTIONS
      OBJECT_NOT_CHANGEABLE = 1
      OBJECT_INVALID        = 2
      CANCELLED_IN_CORR     = 3
      PERMISSION_FAILURE    = 4
      UNEXPECTED_ERROR      = 5
      INTERN_ERR            = 6
      OTHERS                = 7.
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR
           MSG = &apos;PACKAGE INTERFACE SAVE FAILED !&apos;.
  ENDIF.
ENDMETHOD.
METHOD BUILD_ERROR_MSG.
DATA OBJ_KEY    TYPE STRING.
  FIELD-SYMBOLS:
    &lt;E&gt; LIKE LINE OF ELEMENTS.

  LOOP AT ELEMENTS ASSIGNING &lt;E&gt;.
    CONCATENATE &lt;E&gt;-ELEM_KEY &apos;(&apos; &lt;E&gt;-ELEM_TYPE &apos;)&apos; INTO OBJ_KEY.
    IF ERRORMSG IS INITIAL.
      ERRORMSG = OBJ_KEY.
    ELSE.
      CONCATENATE ERRORMSG &apos;, &apos; OBJ_KEY INTO ERRORMSG.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD CHANGE_TADIR.
DATA :
    OBJECT TYPE TADIR-OBJECT,
    OBJ_NAME TYPE TADIR-OBJ_NAME,
    KORRNUM TYPE TADIR-KORRNUM.
  FIELD-SYMBOLS:
    &lt;E&gt; LIKE LINE OF ALV_DATA.

  KORRNUM = TRANSPORT_REQUEST.
  LOOP AT ALV_DATA ASSIGNING &lt;E&gt;
          WHERE NOT SELECT IS INITIAL.
    OBJECT = &lt;E&gt;-ELEM_TYPE.
    OBJ_NAME = &lt;E&gt;-ELEM_KEY.
    CALL FUNCTION &apos;TRINT_TADIR_INTERFACE&apos;
      EXPORTING
*       WI_DELETE_TADIR_ENTRY                = &apos; &apos;
*       WI_REMOVE_REPAIR_FLAG                = &apos; &apos;
*       WI_SET_REPAIR_FLAG                   = &apos; &apos;
        WI_TEST_MODUS                        = &apos; &apos;
        WI_TADIR_PGMID                       = &apos;R3TR&apos;
        WI_TADIR_OBJECT                      = OBJECT
        WI_TADIR_OBJ_NAME                    = OBJ_NAME
        WI_TADIR_KORRNUM                     = KORRNUM
*       WI_TADIR_SRCSYSTEM                   = &apos; &apos;
*       WI_TADIR_AUTHOR                      = &apos; &apos;
        WI_TADIR_DEVCLASS                    = &lt;E&gt;-ELEM_PACK
*       WI_TADIR_MASTERLANG                  = &apos; &apos;
*       WI_TADIR_CPROJECT                    = &apos; &apos;
*       WI_TADIR_VERSID                      = &apos; &apos;
*       WI_REMOVE_GENFLAG                    = &apos; &apos;
*       WI_SET_GENFLAG                       = &apos; &apos;
*       WI_READ_ONLY                         = &apos; &apos;
*       IV_SET_EDTFLAG                       = &apos; &apos;
*       IV_WBO_INTERNAL                      = &apos; &apos;
*       IV_INSERT_MODE                       = &apos; &apos;
*       IV_TRANSL_TECH_TEXT                  = &apos; &apos;
*       IV_DELFLAG                           = &apos; &apos;
*       IV_NO_PAK_CHECK                      = &apos; &apos;
*       IV_OBJ_STABILITY                     = &apos; &apos;
*       IV_TRANSL_TECH_TEXT_SUPP             = &apos; &apos;
*       IV_DELFLAG_SUPP                      = &apos;&apos;
*       IV_NO_PAK_CHECK_SUPP                 = &apos; &apos;
*       IV_OBJ_STABILITY_SUPP                = &apos; &apos;
*     IMPORTING
*       NEW_GTADIR_ENTRY                     =
*       NEW_TADIR_ENTRY                      =
     EXCEPTIONS
        TADIR_ENTRY_NOT_EXISTING             = 1
        TADIR_ENTRY_ILL_TYPE                 = 2
        NO_SYSTEMNAME                        = 3
        NO_SYSTEMTYPE                        = 4
        ORIGINAL_SYSTEM_CONFLICT             = 5
        OBJECT_RESERVED_FOR_DEVCLASS         = 6
        OBJECT_EXISTS_GLOBAL                 = 7
        OBJECT_EXISTS_LOCAL                  = 8
        OBJECT_IS_DISTRIBUTED                = 9
        OBJ_SPECIFICATION_NOT_UNIQUE         = 10
        NO_AUTHORIZATION_TO_DELETE           = 11
        DEVCLASS_NOT_EXISTING                = 12
        SIMULTANIOUS_SET_REMOVE_REPAIR       = 13
        ORDER_MISSING                        = 14
        NO_MODIFICATION_OF_HEAD_SYST         = 15
        PGMID_OBJECT_NOT_ALLOWED             = 16
        MASTERLANGUAGE_NOT_SPECIFIED         = 17
        DEVCLASS_NOT_SPECIFIED               = 18
        SPECIFY_OWNER_UNIQUE                 = 19
        LOC_PRIV_OBJS_NO_REPAIR              = 20
        GTADIR_NOT_REACHED                   = 21
        OBJECT_LOCKED_FOR_ORDER              = 22
        CHANGE_OF_CLASS_NOT_ALLOWED          = 23
        NO_CHANGE_FROM_SAP_TO_TMP            = 24
        OTHERS                               = 25
              .
    IF SY-SUBRC &lt;&gt; 0.
      CLEAR &lt;E&gt;-SELECT.
    ENDIF.
  ENDLOOP.
ENDMETHOD.
METHOD CLASS_CONSTRUCTOR.
* ALV CATALOG
  DATA LS_FIELDCAT  LIKE LINE OF  CAT_ELE.
*** DISPLAY LIST TO SELECT THE OBJECTS FOR DOWNLOADING
  LS_FIELDCAT-FIELDNAME = &apos;ELEM_TYPE&apos;.
  LS_FIELDCAT-SELTEXT_L = &apos;OBJECT TYPE&apos;(C01).
  APPEND LS_FIELDCAT TO CAT_ELE.

  LS_FIELDCAT-FIELDNAME = &apos;ELEM_KEY&apos;.
  LS_FIELDCAT-SELTEXT_L = &apos;OBJECT NAME&apos;(C02).
  APPEND LS_FIELDCAT TO CAT_ELE.

  LS_FIELDCAT-FIELDNAME = &apos;TD_PACK&apos;.
  LS_FIELDCAT-SELTEXT_L = &apos;TADIR PACKAGE&apos;(C03).
  APPEND LS_FIELDCAT TO CAT_ELE.

  LS_FIELDCAT-FIELDNAME = &apos;ELEM_PACK&apos;.
  LS_FIELDCAT-SELTEXT_S = &apos;NEW PACKAGE&apos;(C04).
  LS_FIELDCAT-SELTEXT_L = &apos;NEW PACKAGE WHEN VALIDATED&apos;(L04).
  APPEND LS_FIELDCAT TO CAT_ELE.

  CAT_LAYOUT-BOX_FIELDNAME     = &apos;SELECT&apos;.
*    CAT_LAYOUT-LIGHTS_FIELDNAME  = &apos;TD_PACK&apos;.
  CAT_LAYOUT-COLWIDTH_OPTIMIZE = &apos;X&apos;.
*  LS_LAYOUT-F2CODE            = &apos;MYPICK&apos; .
ENDMETHOD.
METHOD CONSTRUCTOR.
  DATA TYPE LIKE LINE OF SUPPORTED_TYPES.

  CALL METHOD SUPER-&gt;CONSTRUCTOR.

  TYPE-TYPE = ST_PACKAGE. INSERT TYPE INTO TABLE SUPPORTED_TYPES.
  TYPE-TYPE = ST_INTERFACE. INSERT TYPE INTO TABLE SUPPORTED_TYPES.
  CREATE OBJECT APPLICATION_LOG.
  APPLICATION_LOG-&gt;MSGID = &apos;ZAPLINK_PACKAGE&apos;.

  UUID = _UUID.
  VERSION = _VER.
ENDMETHOD.
METHOD CONV_INTERFACE.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DON BY : TARYCK BENSIALI                    |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  DATA ELEMENTS   TYPE TPAK_PACKAGE_INTERF_ELEM_LIST.
  DATA ELEM       LIKE LINE OF O_DATA-&gt;ELEMENTS.
  DATA _ACL       TYPE SCOMACLTAB.
  DATA _COMPONENT  TYPE TO_COMPONENT.
  FIELD-SYMBOLS:
    &lt;A&gt; LIKE LINE OF _ACL,
    &lt;E&gt; LIKE LINE OF ELEMENTS.

  CREATE OBJECT O_DATA.
  CALL METHOD INTERFACE-&gt;GET_ALL_ATTRIBUTES
    IMPORTING
      E_PACKAGE_INTERFACE_DATA = O_DATA-&gt;DATA
    EXCEPTIONS
      OBJECT_INVALID           = 1
      OTHERS                   = 2.
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR
        MSG = &apos;ERROR IN INTERFACE-&gt;GET_ALL_ATTRIBUTES&apos;.
  ENDIF.

  CREATE OBJECT _COMPONENT.
  _COMPONENT-&gt;SET_TYPE( ST_INTERFACE ).
  _COMPONENT-&gt;SET_NAME( O_DATA-&gt;DATA-INTF_NAME ).
  SUBCOMPONENTS-&gt;ADD( _COMPONENT ).

* ELEMENTS
  CALL METHOD INTERFACE-&gt;GET_ELEMENTS
    EXPORTING
      I_WITH_DELETED_ELEMENTS = &apos;X&apos;
    IMPORTING
      E_ELEMENTS              = ELEMENTS
    EXCEPTIONS
      OBJECT_INVALID          = 1
      INTERN_ERR              = 2
      OTHERS                  = 3.
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR
        MSG = &apos;INTERFACE-&gt;GET_ELEMENTS&apos;.
  ELSEIF NOT ELEMENTS IS INITIAL.
    LOOP AT ELEMENTS ASSIGNING &lt;E&gt;.
      CALL METHOD &lt;E&gt;-&gt;GET_ALL_ATTRIBUTES
        IMPORTING
          E_ELEMENT_DATA = ELEM
        EXCEPTIONS
          OBJECT_INVALID = 1
          OTHERS         = 2.
      IF SY-SUBRC &lt;&gt; 0.
        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
          EXPORTING
            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR
            MSG = &apos;ERROR IN INTERFACE-&gt;GET_ALL_ATTRIBUTES&apos;.
      ENDIF.
      APPEND ELEM TO O_DATA-&gt;ELEMENTS.
    ENDLOOP.
  ENDIF.

* ACLS
  IF NOT O_DATA-&gt;DATA-ACL_FLAG IS INITIAL.
    CALL METHOD INTERFACE-&gt;GET_ACCESS_CONTROL_LIST
      IMPORTING
        E_USER_LIST    = O_DATA-&gt;ACLS
      EXCEPTIONS
        OBJECT_INVALID = 1
        NO_ACL         = 0
        INTERN_ERR     = 3
        OTHERS         = 4.
    IF SY-SUBRC &lt;&gt; 0.
      RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
        EXPORTING
          TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR
          MSG = &apos;INTERFACE-&gt;GET_ACCESS_CONTROL_LIST&apos;.
    ENDIF.
  ENDIF.
ENDMETHOD.
METHOD CONV_PACKAGE.
  DATA _DEVC_DATA  TYPE SCOMPKDTLN.
  DATA PERM_DATA   LIKE LINE OF O_DATA-&gt;ACLS.
  DATA PERMISSIONS TYPE TPAK_PERMISSION_TO_USE_LIST.
  DATA INTERFACES  TYPE TPAK_PACKAGE_INTERFACE_LIST.
  DATA INTF        LIKE LINE OF O_DATA-&gt;INTERFACES.
  DATA PACKAGES    TYPE SCOMPAKLIS.
  DATA PACK        LIKE LINE OF O_DATA-&gt;PACKAGES.
  DATA _COMPONENT  TYPE TO_COMPONENT.
  FIELD-SYMBOLS:
    &lt;PACK&gt; LIKE LINE OF PACKAGES,
    &lt;ITF&gt; LIKE LINE OF INTERFACES,
    &lt;P&gt; LIKE LINE OF PERMISSIONS.

  CLEAR O_MYCX.
  CREATE OBJECT O_DATA.
  CALL METHOD PACKAGE-&gt;GET_ALL_ATTRIBUTES
    IMPORTING
      E_PACKAGE_DATA  = O_DATA-&gt;DATA
    EXCEPTIONS
      OBJECT_INVALID  = 1
      PACKAGE_DELETED = 2
      INTERN_ERR      = 3
      OTHERS          = 4.
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR
        MSG = &apos;ERROR IN PACKAGE-&gt;GET_ALL_ATTRIBUTES&apos;.
  ENDIF.

  CREATE OBJECT _COMPONENT.
  _COMPONENT-&gt;SET_TYPE( ST_PACKAGE ).
  _COMPONENT-&gt;SET_NAME( O_DATA-&gt;DATA-DEVCLASS ).
  SUBCOMPONENTS-&gt;ADD( _COMPONENT ).

* ACLS
  CALL METHOD PACKAGE-&gt;GET_PERMISSIONS_TO_USE
    IMPORTING
      E_PERMISSIONS    = PERMISSIONS
    EXCEPTIONS
      OBJECT_INVALID   = 1
      UNEXPECTED_ERROR = 2
      OTHERS           = 3.
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR
        MSG = &apos;PACKAGE-&gt;GET_PERMISSIONS_TO_USE&apos;.
  ELSEIF NOT PERMISSIONS IS INITIAL.
    LOOP AT PERMISSIONS ASSIGNING &lt;P&gt;.
      CHECK &lt;P&gt;-&gt;DELETED_IN_MEMORY IS INITIAL.
      PERM_DATA-INTF_NAME = &lt;P&gt;-&gt;PACKAGE_INTERFACE_NAME.
      PERM_DATA-ERR_SEVER = &lt;P&gt;-&gt;ERROR_SEVERITY.
      APPEND PERM_DATA TO O_DATA-&gt;ACLS.
    ENDLOOP.
  ENDIF.

* INTERFACES
  CALL METHOD PACKAGE-&gt;GET_INTERFACES
    IMPORTING
      E_PACKAGE_INTERFACES = INTERFACES
    EXCEPTIONS
      OBJECT_INVALID       = 1
      UNEXPECTED_ERROR     = 2
      INTERN_ERR           = 3
      OTHERS               = 4.
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
  ELSEIF NOT INTERFACES IS INITIAL.
    LOOP AT INTERFACES ASSIGNING &lt;ITF&gt;.
      TRY.
          INTF-ZL_OBJECT = CONV_INTERFACE_RAW( INTERFACE = &lt;ITF&gt;
                                           SUBCOMPONENTS = SUBCOMPONENTS ).
        CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
          APPLICATION_LOG-&gt;ADD_EXCEPTION( O_MYCX ).
      ENDTRY.
      APPEND INTF TO O_DATA-&gt;INTERFACES.
    ENDLOOP.
  ENDIF.

* PACKAGES
  CALL METHOD PACKAGE-&gt;GET_SUB_PACKAGES
    IMPORTING
      E_SUB_PACKAGES   = PACKAGES
    EXCEPTIONS
      OBJECT_INVALID   = 1
      LEAF_PACKAGE     = 0   &quot; 053(PAK) : PACKAGE &amp;1 DOES NOT CONTAIN ANY SUB-PACKAGES
      UNEXPECTED_ERROR = 3
      OTHERS           = 4.
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
  ELSEIF NOT PACKAGES IS INITIAL.
    LOOP AT PACKAGES ASSIGNING &lt;PACK&gt;.
      TRY.
          PACK-ZL_OBJECT = CONV_PACKAGE_RAW( PACKAGE = &lt;PACK&gt;
                                       SUBCOMPONENTS = SUBCOMPONENTS ).
        CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
          APPLICATION_LOG-&gt;ADD_EXCEPTION( O_MYCX ).
      ENDTRY.
      APPEND PACK TO O_DATA-&gt;PACKAGES.
    ENDLOOP.
  ENDIF.

  IF O_MYCX IS BOUND.
    RAISE EXCEPTION O_MYCX.
  ENDIF.
ENDMETHOD.
METHOD CREATE_INTERFACE.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DON BY : TARYCK BENSIALI                    |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  DATA _COMPONENT      TYPE TO_COMPONENT.
  DATA _DATA      TYPE SCOMPIDTLN.
  DATA EXISTS     TYPE FLAG.
  DATA NAME       TYPE TD_INTERFACE.
  DATA TRANSPORT_REQUEST  TYPE  E070-TRKORR.

  NAME = INTERFACE-&gt;DATA-INTF_NAME.
* PROCESSING INTERFACE &amp;1
  IF 1 = 2. MESSAGE E013. ENDIF.
  APPLICATION_LOG-&gt;ADD_INFO( ID_MSGNO = 013
                             ID_MSGV1 = NAME ).

* DONE IN METHOD S_LOCK_DB DE CL_PACKAGE_INTERFACE
*  CALL FUNCTION &apos;RS_ACCESS_PERMISSION&apos;
*  CALL FUNCTION &apos;RS_CORR_INSERT&apos;

  TRY.
      CALL METHOD UPDATE_INTERFACE
        EXPORTING
          DATA      = INTERFACE-&gt;DATA
        CHANGING
          INTERFACE = INTERFACE-&gt;IF.
    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

  IF NOT INTERFACE-&gt;IF IS BOUND.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR
           MSG = &apos;FAILED TO CREATE PACKAGE INTERFACE&apos;.
  ENDIF.

  CALL METHOD INTERFACE-&gt;IF-&gt;SAVE
    EXPORTING
      I_TRANSPORT_REQUEST   = TRANSPORT_REQUEST
    IMPORTING
      E_TRANSPORT_REQUEST   = TRANSPORT_REQUEST
    EXCEPTIONS
      OBJECT_INVALID        = 1
      OBJECT_NOT_CHANGEABLE = 2
      CANCELLED_IN_CORR     = 3
      PERMISSION_FAILURE    = 4
      UNEXPECTED_ERROR      = 5
      INTERN_ERR            = 6
      OTHERS                = 7.
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR
        MSG = &apos;PACKAGE INTERFACE SAVE FAILED !&apos;.
  ELSE.
    CREATE OBJECT _COMPONENT.
    _COMPONENT-&gt;SET_TYPE( ST_INTERFACE ).
    _COMPONENT-&gt;SET_NAME( NAME ).
    COMPONENTS-&gt;ADD( _COMPONENT ).
  ENDIF.
ENDMETHOD.
METHOD CREATE_PACKAGE.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DON BY : TARYCK BENSIALI                    |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  FIELD-SYMBOLS:
    &lt;P&gt; LIKE LINE OF PACKAGE-&gt;PACKAGES,
    &lt;I&gt; LIKE LINE OF PACKAGE-&gt;INTERFACES.
*  DATA EXISTS     TYPE FLAG.
  DATA _DATA              TYPE SCOMPKDTLN.
  DATA NAME               TYPE TD_PACKAGE.
  DATA TRANSPORT_REQUEST  TYPE  E070-TRKORR.
  DATA _COMPONENT         TYPE TO_COMPONENT.
  DATA O_INTF             TYPE TO_INTERFACE.
  DATA O_PACKAGE          TYPE TO_PACKAGE.

  NAME = PACKAGE-&gt;DATA-DEVCLASS.
* PROCESSING PACKAGE &amp;1
  IF 1 = 2. MESSAGE E003. ENDIF.
  APPLICATION_LOG-&gt;ADD_INFO( ID_MSGNO = 003
                             ID_MSGV1 = NAME ).

* DONE IN METHOD S_LOCK_DB DE CL_PACKAGE
*  CALL FUNCTION &apos;RS_ACCESS_PERMISSION&apos;
*  CALL FUNCTION &apos;RS_CORR_INSERT&apos;

  TRY.
      CALL METHOD UPDATE_PACKAGE
        EXPORTING
          DATA    = PACKAGE-&gt;DATA
        CHANGING
          PACKAGE = PACKAGE-&gt;IF.
    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

  IF NOT PACKAGE-&gt;IF IS BOUND.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR
           MSG = &apos;FAILED TO CREATE PACKAGE&apos;.
  ENDIF.

  CALL METHOD PACKAGE-&gt;IF-&gt;SAVE
    EXPORTING
      I_TRANSPORT_REQUEST   = TRANSPORT_REQUEST
    IMPORTING
      E_TRANSPORT_REQUEST   = TRANSPORT_REQUEST
    EXCEPTIONS
      OBJECT_INVALID        = 1
      OBJECT_NOT_CHANGEABLE = 2
      CANCELLED_IN_CORR     = 3
      PERMISSION_FAILURE    = 4
      UNEXPECTED_ERROR      = 5
      INTERN_ERR            = 6
      OTHERS                = 7.
  IF SY-SUBRC &lt;&gt; 0.
    IF 1 = 2. MESSAGE E009. ENDIF.
* CAN&apos;T SAVE PACKAGE &amp;1
    APPLICATION_LOG-&gt;ADD_ERROR( ID_MSGNO = 009
                                ID_MSGV1 = NAME ).
    APPLICATION_LOG-&gt;ADD_SYMSG( ).
*    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*      EXPORTING
*        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;ERROR_MESSAGE
*        MSG = &apos;DEV CLASS CREATION FAILED !&apos;.
  ELSE.
    CREATE OBJECT _COMPONENT.
    _COMPONENT-&gt;SET_TYPE( ST_PACKAGE ).
    _COMPONENT-&gt;SET_NAME( NAME ).
    COMPONENTS-&gt;ADD( _COMPONENT ).
  ENDIF.

  LOOP AT PACKAGE-&gt;INTERFACES ASSIGNING &lt;I&gt;.
    TRY.
        O_INTF ?= &lt;I&gt;-ZL_OBJECT-&gt;RAW.
        CALL METHOD CREATE_INTERFACE
          EXPORTING
            INTERFACE  = O_INTF
            OVERWRITE  = OVERWRITE
            COMPONENTS = COMPONENTS.
      CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
        RAISE EXCEPTION O_MYCX.
    ENDTRY.
  ENDLOOP.

  LOOP AT PACKAGE-&gt;PACKAGES ASSIGNING &lt;P&gt;.
    TRY.
        O_PACKAGE ?= &lt;P&gt;-ZL_OBJECT-&gt;RAW.
        CALL METHOD CREATE_PACKAGE
          EXPORTING
            PACKAGE    = O_PACKAGE
            OVERWRITE  = OVERWRITE
            COMPONENTS = COMPONENTS.
      CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
        RAISE EXCEPTION O_MYCX.
    ENDTRY.
  ENDLOOP.
ENDMETHOD.
METHOD ELEMENTS2ALV.
DATA _WA LIKE LINE OF ALV_DATA.
  FIELD-SYMBOLS:
    &lt;E&gt; LIKE LINE OF ELEMENTS.

  LOOP AT ELEMENTS ASSIGNING &lt;E&gt;.
    MOVE-CORRESPONDING &lt;E&gt; TO _WA.
    SELECT SINGLE DEVCLASS
      INTO _WA-TD_PACK
      FROM TADIR
      WHERE PGMID = &apos;R3TR&apos;
        AND OBJECT = _WA-ELEM_TYPE
        AND OBJ_NAME = _WA-ELEM_KEY.
    IF SY-SUBRC &lt;&gt; 0.
      CONTINUE.
    ENDIF.
    IF _WA-TD_PACK = _WA-ELEM_PACK. CONTINUE. ENDIF.
    IF _WA-TD_PACK = &apos;$TMP&apos;. _WA-SELECT = ABAP_TRUE. ENDIF.
    APPEND _WA TO ALV_DATA.
  ENDLOOP.
ENDMETHOD.
METHOD EXPORT_FROM_SAP_INTERFACE.
DATA SAP_OBJ   TYPE REF TO IF_PACKAGE_INTERFACE.
  DATA NAME       TYPE TD_INTERFACE.
  DATA O_LIST     TYPE TO_LIST.

  CHECK COMPONENT-&gt;GET_TYPE( ) = ST_INTERFACE.

  NAME = COMPONENT-&gt;GET_NAME( ).
  CREATE OBJECT O_LIST.
  COMPONENT-&gt;SET_SUBCOMPONENTS( O_LIST ).

  TRY.
      SAP_OBJ = LOAD_INTF( NAME ).
    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

  TRY.
      OBJECT = CONV_INTERFACE( INTERFACE = SAP_OBJ
                           SUBCOMPONENTS = O_LIST ).
    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

  O_LIST-&gt;REMOVE( COMPONENT ).

** DOCUMENTATIONS
*  DOCU_KEY-NAME = COMPONENT-NAME.
*  DOCU_KEY-OTHER = &apos;*&apos;.
*  OBJ_MASK = DOCU_KEY.
*
*  CREATE OBJECT OBJECT.
*  OBJECT-&gt;FROM_DATA( _D ).
*
*  OBJECT-&gt;DOCUMENTATION = ZAPLINK_DOCUMENTATION=&gt;GET( IDS = R_DOC_ID_CLASS
*                                                   OBJECT = OBJ_MASK ).
ENDMETHOD.
METHOD EXPORT_FROM_SAP_PACKAGE.
DATA SAP_OBJ    TYPE REF TO IF_PACKAGE.
  DATA DEVCLASS   TYPE DEVCLASS.
  DATA O_LIST     TYPE TO_LIST.

  CHECK COMPONENT-&gt;GET_TYPE( ) = ST_PACKAGE.

  DEVCLASS = COMPONENT-&gt;GET_NAME( ).

  CREATE OBJECT O_LIST.
  COMPONENT-&gt;SET_SUBCOMPONENTS( O_LIST ).

  TRY.
      SAP_OBJ = LOAD_DEVC( DEVCLASS ).
    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

  TRY.
      OBJECT = CONV_PACKAGE( PACKAGE = SAP_OBJ
                       SUBCOMPONENTS = O_LIST ).
    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

  O_LIST-&gt;REMOVE( COMPONENT ).

* NO DOCUMENTATIONS
*  DOCU_KEY-NAME = COMPONENT-NAME.
*  DOCU_KEY-OTHER = &apos;*&apos;.
*  OBJ_MASK = DOCU_KEY.
*
*  OBJECT-&gt;DOCUMENTATION = ZAPLINK_DOCUMENTATION=&gt;GET( IDS = R_DOC_ID_CLASS
*                                                   OBJECT = OBJ_MASK ).
ENDMETHOD.
METHOD IMPORT_TO_SAP_INTERFACE.
*  DATA _COMPONENT      TYPE TO_COMPONENT.
  DATA _EXCEPTION      TYPE REF TO ZAPLINK_CX.

  CREATE OBJECT COMPONENTS.
* CREATE BULK PACKAGE
  TRY.
      CREATE_INTERFACE( OVERWRITE = &apos;X&apos;
                        INTERFACE = O_DATA
                       COMPONENTS = COMPONENTS ).
    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

  TRY.
      SET_INTERFACE_ATTRIB( INTERFACE = O_DATA ).
    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

  TRY.
      APPLICATION_LOG-&gt;RAISE_ON_ERROR( ).
    CATCH ZAPLINK_CX INTO _EXCEPTION.
      RAISE EXCEPTION _EXCEPTION.
  ENDTRY.

*  ZAPLINK_DOCUMENTATION=&gt;SET( O_DATA-&gt;DOCUMENTATION ).

*  CREATE OBJECT _COMPONENT.
*  _COMPONENT-&gt;SET_TYPE( ST_INTERFACE ).
*  _COMPONENT-&gt;SET_NAME( O_DATA-&gt;DATA-INTF_NAME ).
*  COMPONENTS-&gt;ADD( _COMPONENT ).
ENDMETHOD.
METHOD IMPORT_TO_SAP_PACKAGE.
*  DATA _COMPONENT      TYPE TO_COMPONENT.
  DATA _EXCEPTION      TYPE REF TO ZAPLINK_CX.

  CREATE OBJECT COMPONENTS.
* CREATE BULK PACKAGE
  TRY.
      CREATE_PACKAGE( OVERWRITE = &apos;X&apos;
                        PACKAGE = O_DATA
                     COMPONENTS = COMPONENTS ).
    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

  TRY.
      SET_PACKAGE_ATTRIB( PACKAGE = O_DATA ).
    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

  TRY.
      APPLICATION_LOG-&gt;RAISE_ON_ERROR( ).
    CATCH ZAPLINK_CX INTO _EXCEPTION.
      RAISE EXCEPTION _EXCEPTION.
  ENDTRY.

*  ZAPLINK_DOCUMENTATION=&gt;SET( O_DATA-&gt;DOCUMENTATION ).

*  CREATE OBJECT _COMPONENT.
*  _COMPONENT-&gt;SET_TYPE( ST_PACKAGE ).
*  _COMPONENT-&gt;SET_NAME( O_DATA-&gt;DATA-DEVCLASS ).
*  COMPONENTS-&gt;ADD( _COMPONENT ).
ENDMETHOD.
METHOD LOAD_DEVC.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DON BY : TARYCK BENSIALI                    |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  CALL METHOD CL_PACKAGE=&gt;IF_PACKAGE~LOAD_PACKAGE
    EXPORTING
      I_PACKAGE_NAME             = KEY
      I_FORCE_RELOAD             = &apos;X&apos;
    IMPORTING
      E_PACKAGE                  = OBJ
    EXCEPTIONS
      OBJECT_NOT_EXISTING        = 1
      UNEXPECTED_ERROR           = 2
      INTERN_ERR                 = 3
      OBJECT_LOCKED_AND_MODIFIED = 4
      OTHERS                     = 5.
  IF SY-SUBRC &lt;&gt; 0.
    CLEAR OBJ.
    CASE SY-SUBRC.
*      WHEN 1.
** PACKAGE &amp;1 NOT FOUND
*        IF 1 = 2. MESSAGE ID &apos;ZAPLINK_PACKAGE&apos; TYPE &apos;E&apos; NUMBER 006. ENDIF.
*        APPLICATION_LOG-&gt;ADD_WARNING( ID_MSGNO = 006
*                     ID_MSGV1 = KEY ).
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;NOT_FOUND.
*      WHEN 4.
** PACKAGE &amp;1 IS LOCKED
*        IF 1 = 2. MESSAGE ID &apos;ZAPLINK_PACKAGE&apos; TYPE &apos;E&apos; NUMBER 007. ENDIF.
*        APPLICATION_LOG-&gt;ADD_WARNING( ID_MSGNO = 007
*                     ID_MSGV1 = KEY ).
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;ERROR_MESSAGE
*            MSG = &apos;OBJECT LOCKED&apos;.
      WHEN OTHERS.
* UNEXPECTED ERROR ON &amp;1-&gt;&amp;2
        IF 1 = 2. MESSAGE E008. ENDIF.
        APPLICATION_LOG-&gt;ADD_WARNING( ID_MSGNO = 008
                     ID_MSGV1 = &apos;ZAPLINK_PACKAGE&apos;
                     ID_MSGV2 = &apos;LOAD_DEVC&apos; ).
        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
          EXPORTING
            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
    ENDCASE.
  ENDIF.
ENDMETHOD.
METHOD LOAD_INTF.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DON BY : TARYCK BENSIALI                    |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  CALL METHOD CL_PACKAGE_INTERFACE=&gt;IF_PACKAGE_INTERFACE~LOAD_PACKAGE_INTERFACE
    EXPORTING
      I_PACKAGE_INTERFACE_NAME   = KEY
      I_FORCE_RELOAD             = &apos;X&apos;
    IMPORTING
      E_PACKAGE_INTERFACE        = OBJ
    EXCEPTIONS
      DB_READ_ERROR              = 1
      UNEXPECTED_ERROR           = 2
      OBJECT_NOT_EXISTING        = 3
      SHORTTEXT_NOT_EXISTING     = 4
      OBJECT_LOCKED_AND_MODIFIED = 5
      OTHERS                     = 6.
  IF SY-SUBRC &lt;&gt; 0.
    CLEAR OBJ.
    CASE SY-SUBRC.
*      WHEN 3.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;ERROR_MESSAGE
*            MSG = &apos;OBJECT NOT FOUND&apos;.
*      WHEN 5.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;ERROR_MESSAGE
*            MSG = &apos;OBJECT LOCKED&apos;.
      WHEN OTHERS.
        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
          EXPORTING
            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
    ENDCASE.
  ENDIF.
ENDMETHOD.
METHOD SET_INTERFACE_ATTRIB.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DON BY : TARYCK BENSIALI                    |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  DATA _DATA      TYPE SCOMPIDTLN.
  DATA EXCEPTION  TYPE REF TO ZAPLINK_CX_CONNECTOR.
  DATA EXISTS     TYPE FLAG.
  DATA NAME       TYPE SCOMIFNAM.
  DATA CSUBRC     TYPE STRING.
  DATA TRANSPORT_REQUEST  TYPE  E070-TRKORR.

  NAME = INTERFACE-&gt;DATA-INTF_NAME.
* PROCESSING INTERFACE &amp;1 ATTRIBUTS (ACLS, ELEMENTS, ...)
  IF 1 = 2. MESSAGE ID &apos;ZAPLINK_PACKAGE&apos; TYPE &apos;E&apos; NUMBER 014. ENDIF.
  APPLICATION_LOG-&gt;ADD_INFO( ID_MSGNO = 014
                             ID_MSGV1 = NAME ).

  IF NOT INTERFACE-&gt;IF IS BOUND.
* SYSTEM ERROR : OBJECT &apos;&amp;3&apos; IS NOT BOUND IN METHOD &amp;1-&gt;&amp;2
    IF 1 = 2. MESSAGE ID &apos;ZAPLINK_PACKAGE&apos; TYPE &apos;E&apos; NUMBER 016. ENDIF.
    APPLICATION_LOG-&gt;ADD_ABEND( ID_MSGNO = 016
                                ID_MSGV1 = &apos;ZAPLINK_PACKAGE&apos;
                                ID_MSGV2 = &apos;SET_INTERFACE_ATTRIB&apos;
                                ID_MSGV3 = &apos;INTERFACE-&gt;IF&apos;
*                               ID_MSGV4 =
*                           ID_DETLEVEL  =
                            ID_PROBCLASS = &apos;1&apos; ).
    EXIT.
  ENDIF.

  IF NOT INTERFACE-&gt;ACLS IS INITIAL.
    CALL METHOD INTERFACE-&gt;IF-&gt;ADD_ACCESS_CONTROL_ELEMENTS
      EXPORTING
        I_USER_LIST            = INTERFACE-&gt;ACLS
      EXCEPTIONS
        NO_ACL                 = 1
        ENTRY_ALREADY_EXISTING = 2
        OBJECT_NOT_CHANGEABLE  = 3
        OBJECT_INVALID         = 4
        LOCAL_PACKAGE          = 5
        INTERN_ERR             = 6
        OTHERS                 = 7.
    IF SY-SUBRC &lt;&gt; 0.
      CSUBRC = SY-SUBRC.
      IF 1 = 2. MESSAGE ID &apos;ZAPLINK_PACKAGE&apos; TYPE &apos;E&apos; NUMBER 017. ENDIF.
      APPLICATION_LOG-&gt;ADD_ERROR( ID_MSGNO = 017
                                  ID_MSGV1 = &apos;ZAPLINK_PACKAGE&apos;
                                  ID_MSGV2 = &apos;SET_INTERFACE_ATTRIB&apos;
                                  ID_MSGV3 = &apos;ADD_ACCESS_CONTROL_ELEMENTS&apos;
                                  ID_MSGV4 = CSUBRC ).
    ENDIF.
  ENDIF.

  TRY.
      CALL METHOD ADD_ELEMENTS_LIST
        EXPORTING
          INTERFACE  = INTERFACE
*          LIST       = INTERFACE-&gt;ELEMENTS
          ASK_USER   = ABAP_TRUE
          ADD_REMAIN = ABAP_TRUE.
    CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
      RAISE EXCEPTION O_MYCX.
  ENDTRY.

  CALL METHOD INTERFACE-&gt;IF-&gt;SAVE
    EXPORTING
      I_TRANSPORT_REQUEST   = TRANSPORT_REQUEST
    IMPORTING
      E_TRANSPORT_REQUEST   = TRANSPORT_REQUEST
    EXCEPTIONS
      OBJECT_INVALID        = 1
      OBJECT_NOT_CHANGEABLE = 2
      CANCELLED_IN_CORR     = 3
      PERMISSION_FAILURE    = 4
      UNEXPECTED_ERROR      = 5
      INTERN_ERR            = 6
      OTHERS                = 7.
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR
        MSG = &apos;PACKAGE INTERFACE SAVE FAILED !&apos;.
  ENDIF.
ENDMETHOD.
METHOD SET_PACKAGE_ATTRIB.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DON BY : TARYCK BENSIALI                    |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  DATA _DATA      TYPE SCOMPIDTLN.
  DATA EXCEPTION  TYPE REF TO ZAPLINK_CX_CONNECTOR.
*  DATA NODE       TYPE REF TO IF_IXML_ELEMENT.
*  DATA INTERFACE  TYPE REF TO IF_PACKAGE_INTERFACE.
  DATA EXISTS     TYPE FLAG.
  DATA NAME       TYPE SCOMIFNAM.
  DATA CSUBRC     TYPE STRING.
  DATA O_INTF     TYPE TO_INTERFACE.
  DATA O_PACKAGE  TYPE TO_PACKAGE.
  FIELD-SYMBOLS:
    &lt;A&gt; LIKE LINE OF PACKAGE-&gt;ACLS,
    &lt;P&gt; LIKE LINE OF PACKAGE-&gt;PACKAGES,
    &lt;I&gt; LIKE LINE OF PACKAGE-&gt;INTERFACES.

  NAME = PACKAGE-&gt;DATA-DEVCLASS.
* PROCESSING PACKAGE &amp;1 ATTRIBUTS
  IF 1 = 2. MESSAGE E015. ENDIF.
  APPLICATION_LOG-&gt;ADD_INFO( ID_MSGNO = 015
                             ID_MSGV1 = NAME ).

  IF NOT PACKAGE-&gt;IF IS BOUND.
* SYSTEM ERROR : OBJECT &apos;&amp;3&apos; IS NOT BOUND IN METHOD &amp;1-&gt;&amp;2
    IF 1 = 2. MESSAGE E016. ENDIF.
    APPLICATION_LOG-&gt;ADD_ABEND( ID_MSGNO = 016
                                ID_MSGV1 = &apos;ZAPLINK_PACKAGE&apos;
                                ID_MSGV2 = &apos;SET_PACKAGE_ATTRIB&apos;
                                ID_MSGV3 = &apos;PACKAGE-&gt;IF&apos;
*                                ID_MSGV4 =
*                             ID_DETLEVEL =
                                ID_PROBCLASS = &apos;1&apos; ).
    EXIT.
  ENDIF.

  LOOP AT PACKAGE-&gt;ACLS ASSIGNING &lt;A&gt;.
    CALL METHOD PACKAGE-&gt;IF-&gt;ADD_PERMISSION_TO_USE
      EXPORTING
        I_PKG_PERMISSION_DATA   = &lt;A&gt;
*      IMPORTING
*        E_PKG_PERMISSION        =
      EXCEPTIONS
        OBJECT_NOT_CHANGEABLE   = 1
        OBJECT_ACCESS_ERROR     = 2
        OBJECT_ALREADY_EXISTING = 3
        OBJECT_INVALID          = 4
        UNEXPECTED_ERROR        = 5
        OTHERS                  = 6
            .
    IF SY-SUBRC &lt;&gt; 0.
      CSUBRC = SY-SUBRC.
      IF 1 = 2. MESSAGE ID &apos;ZAPLINK_PACKAGE&apos; TYPE &apos;E&apos; NUMBER 017. ENDIF.
      APPLICATION_LOG-&gt;ADD_ERROR( ID_MSGNO = 017
                                  ID_MSGV1 = &apos;ZAPLINK_PACKAGE&apos;
                                  ID_MSGV2 = &apos;SET_PACKAGE_ATTRIB&apos;
                                  ID_MSGV3 = &apos;ADD_PERMISSION_TO_USE&apos;
                                  ID_MSGV4 = CSUBRC ).
    ENDIF.
  ENDLOOP.

  LOOP AT PACKAGE-&gt;INTERFACES ASSIGNING &lt;I&gt;.
    TRY.
        O_INTF ?= &lt;I&gt;-ZL_OBJECT-&gt;RAW.
        CALL METHOD SET_INTERFACE_ATTRIB
          EXPORTING
            INTERFACE = O_INTF.
      CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
        RAISE EXCEPTION O_MYCX.
    ENDTRY.
  ENDLOOP.

  LOOP AT PACKAGE-&gt;PACKAGES ASSIGNING &lt;P&gt;.
    TRY.
        O_PACKAGE ?= &lt;P&gt;-ZL_OBJECT-&gt;RAW.
        CALL METHOD SET_PACKAGE_ATTRIB
          EXPORTING
            PACKAGE = O_PACKAGE.
      CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
        RAISE EXCEPTION O_MYCX.
    ENDTRY.
  ENDLOOP.
ENDMETHOD.
METHOD UPDATE_INTERFACE.
DATA _DATA      TYPE SCOMPIDTLN.
  DATA _DATA_F    TYPE SCOMPISIGN.

* DONE IN METHOD S_LOCK_DB DE CL_PACKAGE
*  CALL FUNCTION &apos;RS_ACCESS_PERMISSION&apos;
*  CALL FUNCTION &apos;RS_CORR_INSERT&apos;

  _DATA = DATA.
  IF INTERFACE IS BOUND.
    _DATA_F = SY-ULINE.
    CALL METHOD INTERFACE-&gt;SET_CHANGEABLE
      EXPORTING
        I_CHANGEABLE                = &apos;X&apos;
      EXCEPTIONS
        OBJECT_LOCKED_BY_OTHER_USER = 1
        PERMISSION_FAILURE          = 2
        OBJECT_ALREADY_CHANGEABLE   = 0
        OBJECT_ALREADY_UNLOCKED     = 0
        OBJECT_JUST_CREATED         = 5
        OBJECT_DELETED              = 6
        OBJECT_MODIFIED             = 7
        OBJECT_NOT_EXISTING         = 8
        OBJECT_INVALID              = 9
        UNEXPECTED_ERROR            = 10
        OTHERS                      = 11.
    IF SY-SUBRC &lt;&gt; 0.
      CASE SY-SUBRC.
*      WHEN 1.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;LOCK_ERROR.
*        WHEN 2.
*          RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*            EXPORTING
*              TEXTID = ZAPLINK_CX_CONNECTOR=&gt;NOT_AUTHORIZED.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
            EXPORTING
              TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
      ENDCASE.
    ENDIF.
    CALL METHOD INTERFACE-&gt;SET_ALL_ATTRIBUTES
      EXPORTING
        I_PACKAGE_INTERFACE_DATA = _DATA
        I_DATA_SIGN              = _DATA_F
      EXCEPTIONS
        OBJECT_DELETED           = 1
        OBJECT_NOT_CHANGEABLE    = 2
        INTERFACE_NOT_EMPTY      = 3
        ACL_NOT_EMPTY            = 4
        AUTHOR_NOT_EXISTING      = 5
        OBJECT_TYPE_MISMATCH     = 6
        OBJECT_INVALID           = 7
        OTHERS                   = 8.
  ELSE.
    CALL METHOD CL_PACKAGE_INTERFACE=&gt;IF_PACKAGE_INTERFACE~CREATE_NEW_PACKAGE_INTERFACE
      EXPORTING
*        I_REUSE_DELETED_OBJECT  = &apos;X&apos;
        I_PKG_INTERFACE_NAME    = _DATA-INTF_NAME
        I_PUBLISHER_PKG_NAME    = _DATA-PACK_NAME
        I_PKG_INTERFACE_DATA    = _DATA
      IMPORTING
        E_PACKAGE_INTERFACE     = INTERFACE
      EXCEPTIONS
        OBJECT_ALREADY_EXISTING = 101
        OBJECT_JUST_CREATED     = 102
        INTERFACE_NAME_INVALID  = 103
        UNEXPECTED_ERROR        = 104
        NO_CHANGES_ALLOWED      = 2
        OTHERS                  = 8
            .
  ENDIF.

  IF SY-SUBRC &lt;&gt; 0.
    CASE SY-SUBRC.
*      WHEN 2.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;NOT_AUTHORIZED.
*      WHEN 103.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;ERROR_MESSAGE
*            MSG = &apos;PROBLEM WITH PACKAGE INTERFACE NAME&apos;.
      WHEN OTHERS.
        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
          EXPORTING
            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
    ENDCASE.
  ENDIF.
ENDMETHOD.
METHOD UPDATE_PACKAGE.
DATA EXCEPTION  TYPE REF TO ZAPLINK_CX_CONNECTOR.
  DATA _DATA      TYPE SCOMPKDTLN.
  DATA _DATA_F    TYPE SCOMPKSIGN.

* DONE IN METHOD S_LOCK_DB DE CL_PACKAGE
*  CALL FUNCTION &apos;RS_ACCESS_PERMISSION&apos;
*  CALL FUNCTION &apos;RS_CORR_INSERT&apos;

  _DATA = DATA.
  IF PACKAGE IS BOUND.
    _DATA_F = SY-ULINE.
    CALL METHOD PACKAGE-&gt;SET_CHANGEABLE
      EXPORTING
        I_CHANGEABLE                = &apos;X&apos;
      EXCEPTIONS
        OBJECT_LOCKED_BY_OTHER_USER = 1
        PERMISSION_FAILURE          = 2
        OBJECT_ALREADY_CHANGEABLE   = 0
        OBJECT_ALREADY_UNLOCKED     = 0
        OBJECT_JUST_CREATED         = 5
        OBJECT_DELETED              = 6
        OBJECT_MODIFIED             = 7
        OBJECT_NOT_EXISTING         = 8
        OBJECT_INVALID              = 9
        UNEXPECTED_ERROR            = 10
        OTHERS                      = 11.
    IF SY-SUBRC &lt;&gt; 0.
      CASE SY-SUBRC.
*      WHEN 1.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;LOCK_ERROR.
*        WHEN 2.
*          RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*            EXPORTING
*              TEXTID = ZAPLINK_CX_CONNECTOR=&gt;NOT_AUTHORIZED.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
            EXPORTING
              TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
      ENDCASE.
    ENDIF.

    CALL METHOD PACKAGE-&gt;SET_ALL_ATTRIBUTES
      EXPORTING
        I_PACKAGE_DATA             = _DATA
        I_DATA_SIGN                = _DATA_F
      EXCEPTIONS
        OBJECT_NOT_CHANGEABLE      = 101
        OBJECT_DELETED             = 102
        OBJECT_INVALID             = 103
        SHORT_TEXT_MISSING         = 8
        AUTHOR_NOT_EXISTING        = 11
        LOCAL_PACKAGE              = 6
        SOFTWARE_COMPONENT_INVALID = 9
        LAYER_INVALID              = 10
        KORRFLAG_INVALID           = 109
        COMPONENT_NOT_EXISTING     = 12
        COMPONENT_MISSING          = 13
        AUTHORIZE_FAILURE          = 3
        PREFIX_IN_USE              = 4
        UNEXPECTED_ERROR           = 15
        INTERN_ERR                 = 16
        OTHERS                     = 17.
  ELSE.
    CALL METHOD CL_PACKAGE=&gt;IF_PACKAGE~CREATE_NEW_PACKAGE
*    EXPORTING
*      I_REUSE_DELETED_OBJECT     = &apos;X&apos;
      IMPORTING
        E_PACKAGE                  = PACKAGE
      CHANGING
        C_PACKAGE_DATA             = _DATA
      EXCEPTIONS
        OBJECT_ALREADY_EXISTING    = 1
        OBJECT_JUST_CREATED        = 2
        NOT_AUTHORIZED             = 3
        WRONG_NAME_PREFIX          = 4
        UNDEFINED_NAME             = 5
        RESERVED_LOCAL_NAME        = 6
        INVALID_PACKAGE_NAME       = 7
        SHORT_TEXT_MISSING         = 8
        SOFTWARE_COMPONENT_INVALID = 9
        LAYER_INVALID              = 10
        AUTHOR_NOT_EXISTING        = 11
        COMPONENT_NOT_EXISTING     = 12
        COMPONENT_MISSING          = 13
        PREFIX_IN_USE              = 14
        UNEXPECTED_ERROR           = 15
        INTERN_ERR                 = 16
        OTHERS                     = 17
            .
  ENDIF.

  IF SY-SUBRC = 11 AND _DATA-AS4USER &lt;&gt; SY-UNAME.           &quot;#EC *
    _DATA-AS4USER = SY-UNAME.
    TRY.
        CALL METHOD UPDATE_PACKAGE
          EXPORTING
            DATA    = _DATA
          CHANGING
            PACKAGE = PACKAGE.
      CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
        RAISE EXCEPTION O_MYCX.
    ENDTRY.
  ELSEIF SY-SUBRC &lt;&gt; 0.
    CASE SY-SUBRC.
*      WHEN 3.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;NOT_AUTHORIZED.
*      WHEN 4 OR 5 OR 6 OR 7.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;ERROR_MESSAGE
*            MSG = &apos;PROBLEM WITH DEV CLASS NAME&apos;.
*      WHEN 8.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;ERROR_MESSAGE
*            MSG = &apos;PROBLEM WITH SHORT TEXT&apos;.
*      WHEN 9.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;ERROR_MESSAGE
*            MSG = &apos;PROBLEM WITH SOFTWARECOMPONENT&apos;.
*      WHEN 10.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;ERROR_MESSAGE
*            MSG = &apos;PROBLEM WITH LAYER&apos;.
*      WHEN 12 OR 13.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;ERROR_MESSAGE
*            MSG = &apos;PROBLEM WITH COMPONENT&apos;.
      WHEN OTHERS.
        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
          EXPORTING
            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
    ENDCASE.
  ENDIF.
ENDMETHOD.
METHOD _DELETE_DEVC.
DATA INTERFACES  TYPE TPAK_PACKAGE_INTERFACE_LIST.
  DATA PACKAGES    TYPE SCOMPAKLIS.
  DATA _COMPONENT  TYPE TO_COMPONENT.
  FIELD-SYMBOLS:
    &lt;PACK&gt; LIKE LINE OF PACKAGES,
    &lt;ITF&gt; LIKE LINE OF INTERFACES.

  CALL METHOD PACKAGE-&gt;SET_CHANGEABLE
    EXPORTING
      I_CHANGEABLE                = &apos;X&apos;
    EXCEPTIONS
      OBJECT_LOCKED_BY_OTHER_USER = 1
      PERMISSION_FAILURE          = 2
      OBJECT_ALREADY_CHANGEABLE   = 0
      OBJECT_ALREADY_UNLOCKED     = 0
      OBJECT_JUST_CREATED         = 5
      OBJECT_DELETED              = 6
      OBJECT_MODIFIED             = 7
      OBJECT_NOT_EXISTING         = 8
      OBJECT_INVALID              = 9
      UNEXPECTED_ERROR            = 10
      OTHERS                      = 11.
  IF SY-SUBRC &lt;&gt; 0.
    CASE SY-SUBRC.
*      WHEN 1.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;LOCK_ERROR.
*      WHEN 2.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;NOT_AUTHORIZED.
      WHEN OTHERS.
        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
          EXPORTING
            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
    ENDCASE.
  ENDIF.

* INTERFACES
  CALL METHOD PACKAGE-&gt;GET_INTERFACES
    IMPORTING
      E_PACKAGE_INTERFACES = INTERFACES
    EXCEPTIONS
      OBJECT_INVALID       = 1
      UNEXPECTED_ERROR     = 2
      INTERN_ERR           = 3
      OTHERS               = 4.
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
  ELSEIF NOT INTERFACES IS INITIAL.
    LOOP AT INTERFACES ASSIGNING &lt;ITF&gt;.
      TRY.
          _DELETE_INTF( &lt;ITF&gt; ).
        CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
          APPLICATION_LOG-&gt;ADD_EXCEPTION( O_MYCX ).
      ENDTRY.
    ENDLOOP.
  ENDIF.

* PACKAGES
  IF NOT PACKAGE-&gt;MAIN_PACKAGE IS INITIAL.
    CALL METHOD PACKAGE-&gt;GET_SUB_PACKAGES
      IMPORTING
        E_SUB_PACKAGES   = PACKAGES
      EXCEPTIONS
        OBJECT_INVALID   = 1
        LEAF_PACKAGE     = 2
        UNEXPECTED_ERROR = 3
        OTHERS           = 4.
    IF SY-SUBRC &lt;&gt; 0.
      RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
        EXPORTING
          TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
    ELSEIF NOT PACKAGES IS INITIAL.
      LOOP AT PACKAGES ASSIGNING &lt;PACK&gt;.
        TRY.
            _DELETE_DEVC( &lt;PACK&gt; ).
          CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
            APPLICATION_LOG-&gt;ADD_EXCEPTION( O_MYCX ).
        ENDTRY.
      ENDLOOP.
    ENDIF.
  ENDIF.

  CALL METHOD PACKAGE-&gt;DELETE
    EXCEPTIONS
      OBJECT_NOT_EMPTY      = 1
      OBJECT_NOT_CHANGEABLE = 2
      OBJECT_INVALID        = 3
      INTERN_ERR            = 4
      OTHERS                = 5.
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
  ENDIF.

  CALL METHOD PACKAGE-&gt;SAVE
    EXPORTING
      I_TRANSPORT_REQUEST   = SPACE
*   IMPORTING
*     E_TRANSPORT_REQUEST   =
    EXCEPTIONS
      OBJECT_INVALID        = 1
      OBJECT_NOT_CHANGEABLE = 2
      CANCELLED_IN_CORR     = 3
      PERMISSION_FAILURE    = 4
      UNEXPECTED_ERROR      = 5
      INTERN_ERR            = 6
      OTHERS                = 7.
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
  ENDIF.
ENDMETHOD.
METHOD _DELETE_INTF.
DATA EXCEPTION  TYPE REF TO ZAPLINK_CX_CONNECTOR.

  CALL METHOD INTERFACE-&gt;SET_CHANGEABLE
    EXPORTING
      I_CHANGEABLE                = &apos;X&apos;
    EXCEPTIONS
      OBJECT_LOCKED_BY_OTHER_USER = 1
      PERMISSION_FAILURE          = 2
      OBJECT_ALREADY_CHANGEABLE   = 0
      OBJECT_ALREADY_UNLOCKED     = 0
      OBJECT_JUST_CREATED         = 5
      OBJECT_DELETED              = 6
      OBJECT_MODIFIED             = 7
      OBJECT_NOT_EXISTING         = 8
      OBJECT_INVALID              = 9
      UNEXPECTED_ERROR            = 10
      OTHERS                      = 11.
  IF SY-SUBRC &lt;&gt; 0.
    CASE SY-SUBRC.
*      WHEN 1.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;LOCK_ERROR.
*      WHEN 2.
*        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*          EXPORTING
*            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;NOT_AUTHORIZED.
      WHEN OTHERS.
        RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
          EXPORTING
            TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
    ENDCASE.
  ENDIF.

  CALL METHOD INTERFACE-&gt;DELETE
    EXCEPTIONS
      OBJECT_NOT_EMPTY      = 1
      OBJECT_NOT_CHANGEABLE = 2
      OBJECT_INVALID        = 3
      INTERN_ERR            = 4
      OTHERS                = 5.
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
  ENDIF.

  CALL METHOD INTERFACE-&gt;SAVE
    EXPORTING
      I_TRANSPORT_REQUEST   = SPACE
*   IMPORTING
*     E_TRANSPORT_REQUEST   =
    EXCEPTIONS
      OBJECT_INVALID        = 1
      OBJECT_NOT_CHANGEABLE = 2
      CANCELLED_IN_CORR     = 3
      PERMISSION_FAILURE    = 4
      UNEXPECTED_ERROR      = 5
      INTERN_ERR            = 6
      OTHERS                = 7
          .
  IF SY-SUBRC &lt;&gt; 0.
    RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
      EXPORTING
        TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
  ENDIF.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~CREATE_NEW_RAW.
  DATA O_DEVC TYPE TO_PACKAGE.
  DATA O_PINF TYPE TO_INTERFACE.

  CREATE OBJECT OBJECT.
  CASE TYPE.
    WHEN ST_PACKAGE.
      CREATE OBJECT O_DEVC.
      OBJECT-&gt;RAW ?= O_DEVC.
*      CREATE OBJECT OBJECT TYPE TO_CLASS.
    WHEN ST_INTERFACE.
      CREATE OBJECT O_PINF.
      OBJECT-&gt;RAW ?= O_PINF.
*      CREATE OBJECT OBJECT TYPE TO_CLASS.
    WHEN OTHERS.
      CLEAR OBJECT.
      RAISE EXCEPTION TYPE ZAPLINK_CX.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~DELETE_FROM_SAP.
DATA KEY_DEVC TYPE DEVCLASS.
  DATA KEY_INTF TYPE SCOMIFNAM.
  DATA PACKAGE  TYPE REF TO IF_PACKAGE.
  DATA INTERFACE  TYPE REF TO IF_PACKAGE_INTERFACE.

  CASE COMPONENT-&gt;GET_TYPE( ).
    WHEN ST_PACKAGE.
      KEY_DEVC = COMPONENT-&gt;GET_NAME( ).
      TRY.
          PACKAGE = LOAD_DEVC( KEY_DEVC ).
          _DELETE_DEVC( PACKAGE ).
        CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
          RAISE EXCEPTION O_MYCX.
      ENDTRY.
    WHEN ST_INTERFACE.
      KEY_INTF = COMPONENT-&gt;GET_NAME( ).
      TRY.
          INTERFACE = LOAD_INTF( KEY_INTF ).
          _DELETE_INTF( INTERFACE ).
        CATCH ZAPLINK_CX_CONNECTOR INTO O_MYCX.
          RAISE EXCEPTION O_MYCX.
      ENDTRY.
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~DO_EXISTS.
DATA KEY   TYPE SCOMIFNAM.
  DATA _DEVC TYPE REF TO IF_PACKAGE.              &quot;#EC NEEDED FOR DEBUG
  DATA _PINF TYPE REF TO IF_PACKAGE_INTERFACE.    &quot;#EC NEEDED FOR DEBUG

  KEY = COMPONENT-&gt;GET_NAME( ).
  CASE COMPONENT-&gt;GET_TYPE( ).
    WHEN ST_PACKAGE.
      CALL METHOD CL_PACKAGE=&gt;IF_PACKAGE~LOAD_PACKAGE
        EXPORTING
          I_PACKAGE_NAME             = KEY
          I_FORCE_RELOAD             = &apos;X&apos;
        IMPORTING
          E_PACKAGE                  = _DEVC
        EXCEPTIONS
          OBJECT_NOT_EXISTING        = 1
*      UNEXPECTED_ERROR           = 2  =&gt; DUMP
*      INTERN_ERR                 = 3  =&gt; DUMP
          OBJECT_LOCKED_AND_MODIFIED = 0
*      OTHERS                     = 5  =&gt; DUMP
              .
      IF SY-SUBRC = 0.
        EXISTS = &apos;X&apos;.
      ENDIF.
    WHEN ST_INTERFACE.
      CALL METHOD CL_PACKAGE_INTERFACE=&gt;IF_PACKAGE_INTERFACE~LOAD_PACKAGE_INTERFACE
        EXPORTING
          I_PACKAGE_INTERFACE_NAME   = KEY
          I_FORCE_RELOAD             = &apos;X&apos;
        IMPORTING
          E_PACKAGE_INTERFACE        = _PINF
        EXCEPTIONS
*      DB_READ_ERROR              = 1 =&gt; DUMP
*      UNEXPECTED_ERROR           = 2 =&gt; DUMP
          OBJECT_NOT_EXISTING        = 3
          SHORTTEXT_NOT_EXISTING     = 0
          OBJECT_LOCKED_AND_MODIFIED = 0
*      OTHERS                     = 6 =&gt; DUMP
              .
      IF SY-SUBRC = 0.
        EXISTS = &apos;X&apos;.
      ENDIF.
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~READ_FROM_SAP.
  CREATE OBJECT OBJECT.
  OBJECT-&gt;SET_COMPONENT( COMPONENT ).
  CASE COMPONENT-&gt;GET_TYPE( ).
    WHEN ST_PACKAGE.
      OBJECT-&gt;RAW ?= EXPORT_FROM_SAP_PACKAGE( COMPONENT ).
    WHEN ST_INTERFACE.
      OBJECT-&gt;RAW ?= EXPORT_FROM_SAP_INTERFACE( COMPONENT ).
    WHEN OTHERS.
      CLEAR OBJECT.
      RAISE EXCEPTION TYPE ZAPLINK_CX.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~WRITE_TO_SAP.
  DATA _O_CLASS       TYPE TO_PACKAGE.
  DATA _O_INTERFACE   TYPE TO_INTERFACE.

  CASE OBJECT-&gt;TYPE.
    WHEN ST_PACKAGE.
      _O_CLASS ?= OBJECT-&gt;RAW.
      _O_CLASS-&gt;DATA-DEVCLASS = OBJECT-&gt;NAME.
      COMPONENTS = IMPORT_TO_SAP_PACKAGE( _O_CLASS ).
    WHEN ST_INTERFACE.
      _O_INTERFACE ?= OBJECT-&gt;RAW.
      _O_INTERFACE-&gt;DATA-INTF_NAME = OBJECT-&gt;NAME.
      COMPONENTS = IMPORT_TO_SAP_INTERFACE( _O_INTERFACE ).
    WHEN OTHERS.
      RAISE EXCEPTION TYPE ZAPLINK_CX.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
  RESULT = ABAP_FALSE.
  IF VERSION = _VER.
    RESULT = ABAP_TRUE.
  ENDIF.
ENDMETHOD.
METHOD CONV_INTERFACE_RAW.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DON BY : TARYCK BENSIALI                    |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  DATA O_COMP     TYPE TO_COMPONENT.
  DATA _DATA      TYPE TO_INTERFACE.
  DATA _CX        TYPE REF TO ZAPLINK_CX.

  TRY.
      _DATA = CONV_INTERFACE( INTERFACE = INTERFACE
                          SUBCOMPONENTS = SUBCOMPONENTS ).
      CREATE OBJECT O_COMP.
      O_COMP-&gt;SET_TYPE( ST_INTERFACE ).
      O_COMP-&gt;SET_NAME( _DATA-&gt;DATA-INTF_NAME ).
      CREATE OBJECT O_DATA
        EXPORTING
          O_COMP = O_COMP.
      O_DATA-&gt;RAW ?= _DATA.
    CATCH ZAPLINK_CX INTO _CX.
      CREATE OBJECT O_MYCX EXPORTING
             TEXTID = ZAPLINK_CX=&gt;SYSTEM_ERROR
            PREV_CX = _CX.
      O_MYCX-&gt;UPDATE( ).
      RAISE EXCEPTION O_MYCX.
  ENDTRY.
ENDMETHOD.
METHOD CONV_PACKAGE_RAW.
*/---------------------------------------------------------------------\
*|   THIS PLUGIN HAVE BEEN DON BY : TARYCK BENSIALI                    |
*|                                                                     |
*|   E-MAIL : TARYCK@BENSIALI.NET                                      |
*|                                                                     |
*|   THIS PLUGIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,    |
*|   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF    |
*|   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE     |
*|   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.                      |
*|                                                                     |
*\---------------------------------------------------------------------/

  DATA O_COMP     TYPE TO_COMPONENT.
  DATA _DATA      TYPE TO_PACKAGE.
  DATA _CX        TYPE REF TO ZAPLINK_CX.

  TRY.
      _DATA = CONV_PACKAGE( PACKAGE = PACKAGE
                      SUBCOMPONENTS = SUBCOMPONENTS ).
      CREATE OBJECT O_COMP.
      O_COMP-&gt;SET_TYPE( ST_PACKAGE ).
      O_COMP-&gt;SET_NAME( _DATA-&gt;DATA-DEVCLASS ).
      CREATE OBJECT O_DATA
        EXPORTING
          O_COMP = O_COMP.
      O_DATA-&gt;RAW ?= _DATA.
    CATCH ZAPLINK_CX INTO _CX.
      CREATE OBJECT O_MYCX
        EXPORTING
          TEXTID  = ZAPLINK_CX=&gt;SYSTEM_ERROR
          PREV_CX = _CX.
      O_MYCX-&gt;UPDATE( ).
      RAISE EXCEPTION O_MYCX.
  ENDTRY.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_PACKAGE IMPLEMENTATION

CLASS ZAPLINK_MSAG_DATA IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
ENDCLASS. &quot;ZAPLINK_MSAG_DATA IMPLEMENTATION

CLASS ZAPLINK_MESSAGE IMPLEMENTATION.

*&quot;* MACRO DEFINITIONS
*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS
*&quot;* LOCAL CLASS IMPLEMENTATION
*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* USE THIS SOURCE FILE FOR THE IMPLEMENTATION PART OF
*&quot;* LOCAL HELPER CLASSES

*&quot;* METHOD&apos;S IMPLEMENTATIONS
METHOD CLASS_CONSTRUCTOR.
*TABLE TDCLT
*DOKCLASS DOKTITEL
*NA       MESSAGE
  DATA _ID LIKE LINE OF R_DOC_ID.

  _ID-SIGN = &apos;I&apos;. _ID-OPTION = &apos;EQ&apos;.
  _ID-LOW = C_MSG_ID. APPEND _ID TO R_DOC_ID.
ENDMETHOD.
METHOD CONSTRUCTOR.
  DATA TYPE LIKE LINE OF SUPPORTED_TYPES.

  CALL METHOD SUPER-&gt;CONSTRUCTOR.

  TYPE-TYPE = ST_MSGCLASS. INSERT TYPE INTO TABLE SUPPORTED_TYPES.

  UUID = _UUID.
  VERSION = _VER.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~CREATE_NEW_RAW.
  DATA O_DATA TYPE TO_DATA.

  CREATE OBJECT OBJECT.
  CASE TYPE.
    WHEN ST_MSGCLASS.
      CREATE OBJECT O_DATA.
      OBJECT-&gt;RAW ?= O_DATA.
    WHEN OTHERS.
      CLEAR OBJECT.
      RAISE EXCEPTION TYPE ZAPLINK_CX.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~DELETE_FROM_SAP.
DATA _NAME TYPE T100A-ARBGB.
  DATA _OBJ  TYPE KO200.

  CASE COMPONENT-&gt;GET_TYPE( ).
    WHEN ST_MSGCLASS.
      _NAME = COMPONENT-&gt;GET_NAME( ).
      CALL FUNCTION &apos;RS_DELETE_MESSAGE_ID&apos;
        EXPORTING
          NACHRICHTENKLASSE = _NAME
        EXCEPTIONS
          NOT_EXECUTED      = 1
          NOT_FOUND         = 2
          NO_PERMISSION     = 3
          OTHERS            = 4.
      IF SY-SUBRC &lt;&gt; 0. &quot; SAP NAMESPACE
        CASE SY-SUBRC.
          WHEN 2.
            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
              EXPORTING TEXTID = ZAPLINK_CX_CONNECTOR=&gt;NOT_FOUND.
          WHEN OTHERS.
            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
              EXPORTING TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
        ENDCASE.
      ENDIF.
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~DO_EXISTS.
DATA _NAME TYPE T100A-ARBGB.

  EXISTS = ME-&gt;EXISTS-NOT_EXISTS.
  CASE COMPONENT-&gt;GET_TYPE( ).
    WHEN ST_MSGCLASS.
      _NAME = COMPONENT-&gt;GET_NAME( ).
      SELECT SINGLE ARBGB INTO _NAME
        FROM T100A
        WHERE ARBGB = _NAME.
      IF SY-SUBRC = 0.
        EXISTS = ME-&gt;EXISTS-EXISTS.
      ENDIF.
    WHEN OTHERS.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~READ_FROM_SAP.
  DATA _DATA  TYPE TO_DATA.
  DATA _OBJ   TYPE DOKU_OBJ.
  DATA T_T100 TYPE SORTED TABLE OF T100 WITH UNIQUE KEY MSGNR SPRSL.
  DATA _NAME  TYPE ARBGB.
  DATA T_DOCS TYPE ZAPLINK_DOCUMENTATION=&gt;TT_DOCS.
  FIELD-SYMBOLS:
    &lt;L&gt; LIKE LINE OF T_DOCS,
    &lt;LT&gt; LIKE LINE OF &lt;L&gt;-TEXTS,
    &lt;T&gt; LIKE LINE OF T_T100,
    &lt;M&gt; LIKE LINE OF _DATA-&gt;MESSAGES,
    &lt;MT&gt; LIKE LINE OF &lt;M&gt;-TEXTS.

  DATA _TEXT LIKE LINE OF &lt;M&gt;-TEXTS.
  DATA _HTXT LIKE LINE OF _DATA-&gt;TEXTS.
  DATA _KEY  TYPE DOKU_OBJ.

  CREATE OBJECT OBJECT.
  CASE COMPONENT-&gt;GET_TYPE( ).
    WHEN ST_MSGCLASS.
      _NAME = COMPONENT-&gt;GET_NAME( ).
* DOCUMENTATION
* EXAMPLE : ZAPLINK_EASYXML000
      CONCATENATE _NAME &apos;+++&apos; INTO _OBJ.  &quot; +++ STAND FOR MESSAGE NUMBER
      T_DOCS = ZAPLINK_DOCUMENTATION=&gt;GET( IDS = R_DOC_ID
                                        OBJECT = _OBJ ).
      DELETE T_DOCS WHERE TEXTS IS INITIAL.

      CREATE OBJECT _DATA.
* MAIN DATA
      SELECT SINGLE *
        INTO CORRESPONDING FIELDS OF _DATA-&gt;A0_MAIN
        FROM T100A
        WHERE ARBGB = _NAME.
      CLEAR _DATA-&gt;A0_MAIN-ARBGB.

* DESCRIPTIONS
      SELECT SPRSL STEXT
        INTO TABLE _DATA-&gt;TEXTS
        FROM T100T
        WHERE ARBGB = _NAME.

      READ TABLE _DATA-&gt;TEXTS TRANSPORTING NO FIELDS
           WITH TABLE KEY LANGU = _DATA-&gt;A0_MAIN-MASTERLANG.
      IF SY-SUBRC &lt;&gt; 0.
        _HTXT-LANGU = _DATA-&gt;A0_MAIN-MASTERLANG.
        _HTXT-SHORT_TXT = _DATA-&gt;A0_MAIN-STEXT.
        INSERT _HTXT INTO TABLE _DATA-&gt;TEXTS.
      ENDIF.
      CLEAR _DATA-&gt;A0_MAIN-STEXT.

* MESSAGES
      SELECT *
        INTO CORRESPONDING FIELDS OF TABLE _DATA-&gt;MESSAGES
        FROM T100U
        WHERE ARBGB = _NAME.
* MESSAGES TEXTS
      SELECT * INTO TABLE T_T100
        FROM T100
        WHERE ARBGB = _NAME.

      LOOP AT _DATA-&gt;MESSAGES ASSIGNING &lt;M&gt;.
        LOOP AT T_T100 ASSIGNING &lt;T&gt;
                WHERE MSGNR = &lt;M&gt;-MSGNR.
          CLEAR _TEXT.
          _TEXT-LANGU = &lt;T&gt;-SPRSL.
          _TEXT-SHORT_TXT = &lt;T&gt;-TEXT.
          INSERT _TEXT INTO TABLE &lt;M&gt;-TEXTS.
        ENDLOOP.

        CONCATENATE _NAME &lt;M&gt;-MSGNR INTO _KEY.
        LOOP AT T_DOCS ASSIGNING &lt;L&gt;
                WHERE OBJECT = _KEY.

          IF &lt;M&gt;-APPLICATION IS INITIAL.
            &lt;M&gt;-APPLICATION = &lt;L&gt;-APPLICATION.
          ELSEIF &lt;M&gt;-APPLICATION &lt;&gt; &lt;L&gt;-APPLICATION.
            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR.
          ENDIF.

          IF &lt;M&gt;-TYP IS INITIAL.
            &lt;M&gt;-TYP = &lt;L&gt;-TYP.
          ELSEIF &lt;M&gt;-TYP &lt;&gt; &lt;L&gt;-TYP.
            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR.
          ENDIF.

          IF &lt;M&gt;-DOKFORM IS INITIAL.
            &lt;M&gt;-DOKFORM = &lt;L&gt;-DOKFORM.
          ELSEIF &lt;M&gt;-DOKFORM &lt;&gt; &lt;L&gt;-DOKFORM.
            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR.
          ENDIF.

          IF &lt;M&gt;-DOKSTYLE IS INITIAL.
            &lt;M&gt;-DOKSTYLE = &lt;L&gt;-DOKSTYLE.
          ELSEIF &lt;M&gt;-DOKSTYLE &lt;&gt; &lt;L&gt;-DOKSTYLE.
            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR.
          ENDIF.

          LOOP AT &lt;L&gt;-TEXTS ASSIGNING &lt;LT&gt;.

            READ TABLE &lt;M&gt;-TEXTS ASSIGNING &lt;MT&gt;
                 WITH TABLE KEY LANGU = &lt;LT&gt;-TDSPRAS.
            IF SY-SUBRC = 0.
              &lt;MT&gt;-LONG_TXT = &lt;LT&gt;.
              CLEAR &lt;MT&gt;-LONG_TXT-TDSPRAS.
            ELSE.
              CLEAR _TEXT.
              _TEXT-LONG_TXT = &lt;LT&gt;.
              CLEAR _TEXT-LONG_TXT-TDSPRAS.
              INSERT _TEXT INTO TABLE &lt;M&gt;-TEXTS.
            ENDIF.
          ENDLOOP.

        ENDLOOP.
      ENDLOOP.

      OBJECT-&gt;SET_COMPONENT( COMPONENT ).
      OBJECT-&gt;RAW ?= _DATA.
    WHEN OTHERS.
      CLEAR OBJECT.
      RAISE EXCEPTION TYPE ZAPLINK_CX.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~WRITE_TO_SAP.
  DATA _DATA TYPE TO_DATA.
  DATA _PROG TYPE PROGRAMM.
  DATA _ONAME TYPE E071-OBJ_NAME.
  DATA _OBJ  TYPE DOKU_OBJ.
  DATA _COMP TYPE TO_COMPONENT.
  DATA _NAME TYPE TD_COMPNAME.
  DATA T_DOCS TYPE ZAPLINK_DOCUMENTATION=&gt;TT_DOCS.
  DATA LS_DOC LIKE LINE OF T_DOCS.
  DATA: LT_T100  TYPE STANDARD TABLE OF T100,
        LS_T100  LIKE LINE OF LT_T100,
        LT_T100T TYPE STANDARD TABLE OF T100T,
        LS_T100T LIKE LINE OF LT_T100T,
        LT_T100U TYPE STANDARD TABLE OF T100U,
        LS_T100U LIKE LINE OF LT_T100U,
        LS_T100A TYPE T100A.
  FIELD-SYMBOLS:
    &lt;M&gt; LIKE LINE OF _DATA-&gt;MESSAGES,
    &lt;L&gt; LIKE LINE OF &lt;M&gt;-TEXTS,
    &lt;T&gt; LIKE LINE OF _DATA-&gt;TEXTS.

  CASE OBJECT-&gt;TYPE.
    WHEN ST_MSGCLASS.
      _DATA ?= OBJECT-&gt;RAW.
* MAIN DATA
      _DATA-&gt;A0_MAIN-ARBGB = OBJECT-&gt;NAME.
      MOVE-CORRESPONDING _DATA-&gt;A0_MAIN TO LS_T100A.
* DESCRIPTION
      LOOP AT _DATA-&gt;TEXTS ASSIGNING &lt;T&gt;.
        CLEAR LS_T100T.
        LS_T100T-ARBGB = _DATA-&gt;A0_MAIN-ARBGB.
        LS_T100T-SPRSL = &lt;T&gt;-LANGU.
        LS_T100T-STEXT = &lt;T&gt;-SHORT_TXT.
        APPEND LS_T100T TO LT_T100T.
        IF &lt;T&gt;-LANGU = _DATA-&gt;A0_MAIN-MASTERLANG.
* RESTORE TEXT
          LS_T100A-STEXT = &lt;T&gt;-SHORT_TXT.
        ENDIF.
      ENDLOOP.

* MESSAGES
      LOOP AT _DATA-&gt;MESSAGES ASSIGNING &lt;M&gt;.
        CLEAR LS_T100U.
        MOVE-CORRESPONDING &lt;M&gt; TO LS_T100U.
        LS_T100U-ARBGB = _DATA-&gt;A0_MAIN-ARBGB.
        APPEND LS_T100U TO LT_T100U.

        CLEAR LS_DOC.
        LS_DOC-APPLICATION = &lt;M&gt;-APPLICATION.
        LS_DOC-ID = C_MSG_ID.
        CONCATENATE _DATA-&gt;A0_MAIN-ARBGB &lt;M&gt;-MSGNR INTO LS_DOC-OBJECT.
*        LS_DOC-LANGU = &lt;M&gt;-LANGU.
*        LS_DOC-MASTERLANG = &lt;M&gt;-MASTERLANG.
        LS_DOC-TYP = &lt;M&gt;-TYP.
        LS_DOC-DOKFORM = &lt;M&gt;-DOKFORM.
        LS_DOC-DOKSTYLE = &lt;M&gt;-DOKSTYLE.
        LS_DOC-SELFDEF = &lt;M&gt;-SELFDEF.

        CLEAR LS_T100.
        MOVE-CORRESPONDING &lt;M&gt; TO LS_T100.
        MOVE-CORRESPONDING LS_T100U TO LS_T100.
        LOOP AT &lt;M&gt;-TEXTS ASSIGNING &lt;L&gt;.
          IF NOT &lt;L&gt;-SHORT_TXT IS INITIAL.
            LS_T100-SPRSL = &lt;L&gt;-LANGU.
            LS_T100-TEXT = &lt;L&gt;-SHORT_TXT.
            MOVE-CORRESPONDING &lt;L&gt; TO LS_T100.
            APPEND LS_T100 TO LT_T100.
          ENDIF.
* LONG TEXTS
          IF NOT &lt;L&gt;-LONG_TXT IS INITIAL.
            &lt;L&gt;-LONG_TXT-TDSPRAS = &lt;L&gt;-LANGU.
            INSERT &lt;L&gt;-LONG_TXT INTO TABLE LS_DOC-TEXTS .
          ENDIF.
        ENDLOOP.
        IF NOT LS_DOC-TEXTS IS INITIAL.
          INSERT LS_DOC INTO TABLE T_DOCS.
        ENDIF.
      ENDLOOP.

*      CALL FUNCTION &apos;RS_ACCESS_PERMISSION&apos;
*        EXPORTING
**         AUTHORITY_CHECK                      = &apos;X&apos;
**         GLOBAL_LOCK                          = &apos; &apos;
**         LANGUAGE_UPD_EXIT                    = &apos; &apos;
**         MASTER_LANGUAGE                      = &apos; &apos;
**         MODE                                 = &apos;MODIFY&apos;
*          OBJECT                               =
*          OBJECT_CLASS                         =
**         TRDIR_INF                            =
**         REQUEST_LANGUAGE                     = &apos; &apos;
**         SUPPRESS_CORR_CHECK                  = &apos; &apos;
**         SUPPRESS_CORR_CHECK_ALTOGETHER       = &apos; &apos;
**         SUPPRESS_LANGUAGE_CHECK              = &apos;X&apos;
**         SUPPRESS_EDITOR_LOCK_CHECK           = &apos; &apos;
**         SUPPRESS_LANGUAGE_DIALOG             = &apos; &apos;
**         SUPPRESS_EXTEND_DIALOG               = &apos;X&apos;
**         SUPPRESS_UPGRADE_CHECK               = &apos; &apos;
**         GENFLAG                              = &apos; &apos;
**         DEVCLASS_GEN                         = &apos; &apos;
**       IMPORTING
**         DEVCLASS                             =
**         ERROR_INFO                           =
**         NEW_MASTER_LANGUAGE                  =
**         KORRNUM                              =
**         ORDERNUM                             =
**         TRANSPORT_KEY                        =
**         MODIFICATION_LANGUAGE                =
**         EXTEND                               =
**         TADIRE                               =
**         FROZEN                               =
**         FROZEN_OBJECTS                       =
**       EXCEPTIONS
**         CANCELED_IN_CORR                     = 1
**         ENQUEUED_BY_USER                     = 2
**         ENQUEUE_SYSTEM_FAILURE               = 3
**         ILLEGAL_PARAMETER_VALUES             = 4
**         LOCKED_BY_AUTHOR                     = 5
**         NO_MODIFY_PERMISSION                 = 6
**         NO_SHOW_PERMISSION                   = 7
**         PERMISSION_FAILURE                   = 8
**         REQUEST_LANGUAGE_DENIED              = 9
**         OTHERS                               = 10
*                .
*      IF SY-SUBRC &lt;&gt; 0.
** MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
**         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
*      ENDIF.

      CALL FUNCTION &apos;RS_ACCESS_PERMISSION&apos;
        EXPORTING
          MODE         = &apos;FREE&apos;
          OBJECT       = LS_T100A-ARBGB
          OBJECT_CLASS = &apos;T100&apos;.

*--- CHECK PERMISSION
      CALL FUNCTION &apos;RS_ACCESS_PERMISSION&apos;
        EXPORTING
          AUTHORITY_CHECK          = &apos;X&apos;
          GLOBAL_LOCK              = &apos;X&apos;
          MODE                     = &apos;INSERT&apos;
          LANGUAGE_UPD_EXIT        = &apos;UPDATE_MASTER&apos;
          MASTER_LANGUAGE          = LS_T100A-MASTERLANG
          OBJECT                   = LS_T100A-ARBGB
          OBJECT_CLASS             = &apos;T100&apos;
          SUPPRESS_LANGUAGE_CHECK  = &apos; &apos;
        EXCEPTIONS
          CANCELED_IN_CORR         = 01
          ENQUEUED_BY_USER         = 02
          ENQUEUE_SYSTEM_FAILURE   = 03
          ILLEGAL_PARAMETER_VALUES = 04
          LOCKED_BY_AUTHOR         = 05
          NO_MODIFY_PERMISSION     = 06
          NO_SHOW_PERMISSION       = 07
          PERMISSION_FAILURE       = 08.
      CASE SY-SUBRC.
        WHEN 0.
        WHEN 2 OR 5.
          RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
                EXPORTING
                    NAME = _NAME
                    TYPE = OBJECT-&gt;TYPE
                  TEXTID = ZAPLINK_CX_CONNECTOR=&gt;OBJECT_LOCKED.
        WHEN 6 OR 7 OR 8 OR 9.
          RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
                EXPORTING
                    NAME = _NAME
                    TYPE = OBJECT-&gt;TYPE
                  TEXTID = ZAPLINK_CX_CONNECTOR=&gt;NOT_AUTHORIZED.
        WHEN OTHERS.
          RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
                EXPORTING
                    NAME = _NAME
                    TYPE = OBJECT-&gt;TYPE
                  TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
      ENDCASE.

*      CALL FUNCTION &apos;RS_CORR_INSERT&apos;
*           EXPORTING
*                AUTHOR              = SY-UNAME
*                GLOBAL_LOCK         = &apos;X&apos;
*                OBJECT              = LS_T100A-ARBGB
*                OBJECT_CLASS        = &apos;T100&apos;
*                DEVCLASS            = &apos;$TMP&apos;
*                MASTER_LANGUAGE     = SY-LANGU
*                MODE                = &apos;INSERT&apos;
**       IMPORTING
**            AUTHOR              = UNAME
**            KORRNUM             = CORRNUMBER_LOCAL
**            DEVCLASS            = DEVCLASS_LOCAL
*           EXCEPTIONS
*                CANCELLED           = 1
*                PERMISSION_FAILURE  = 2
*                UNKNOWN_OBJECTCLASS = 3.
*
*      IF SY-SUBRC &lt;&gt; 0.
*        CASE SY-SUBRC.
*          WHEN 2.
*            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*                  EXPORTING
*                      NAME = _NAME
*                      TYPE = OBJECT-&gt;TYPE
*                  DEVCLASS = &apos;$TMP&apos;
*                    TEXTID = ZAPLINK_CX_CONNECTOR=&gt;NOT_AUTHORIZED.
*          WHEN OTHERS.
*            RAISE EXCEPTION TYPE ZAPLINK_CX_CONNECTOR
*                  EXPORTING
*                      NAME = _NAME
*                      TYPE = OBJECT-&gt;TYPE
*                    TEXTID = ZAPLINK_CX_CONNECTOR=&gt;SYSTEM_ERROR.
*        ENDCASE.
*      ENDIF.

      MODIFY T100A FROM LS_T100A.
      MODIFY T100T FROM TABLE LT_T100T.
      MODIFY T100U FROM TABLE LT_T100U.
      MODIFY T100 FROM TABLE LT_T100.

* DOCUMENTATION
      CALL METHOD ZAPLINK_DOCUMENTATION=&gt;SET
        EXPORTING
          T_DOCS = T_DOCS.

      CREATE OBJECT _COMP.
      _COMP-&gt;SET_TYPE( ST_MSGCLASS ).
      _NAME = _DATA-&gt;A0_MAIN-ARBGB.
      _COMP-&gt;SET_NAME( _NAME ).
      CREATE OBJECT COMPONENTS.
      COMPONENTS-&gt;ADD( _COMP ).
    WHEN OTHERS.
      RAISE EXCEPTION TYPE ZAPLINK_CX.
  ENDCASE.
ENDMETHOD.
METHOD ZAPLINK_CONNECTOR~IS_SUPPORTED_VERSION.
  RESULT = ABAP_FALSE.
  IF VERSION = _VER.
    RESULT = ABAP_TRUE.
  ENDIF.
ENDMETHOD.
ENDCLASS. &quot;ZAPLINK_MESSAGE IMPLEMENTATION


PARAMETERS p_file TYPE zaplink_file=&gt;t_filename.
PARAMETERS uninst TYPE flag AS CHECKBOX.

DATA o_file     TYPE REF TO zaplink_file.
DATA cx_file    TYPE REF TO zaplink_cx_file.

INITIALIZATION.
DATA _cx_90335e5d44316adf4805a732f type ref to ZAPLINK_CX_COMPONENT.
TRY.
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_OBJECT&apos;).
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_PACKAGE&apos;).
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_MESSAGE&apos;).
ZAPLINK_CONNECTORS=&gt;ADD_LOCAL_CONNECTOR(&apos;ZAPLINK_PROGRAM&apos;).
CATCH ZAPLINK_CX_COMPONENT INTO _cx_90335e5d44316adf4805a732f.
_cx_90335e5d44316adf4805a732f-&gt;write( ).
BREAK-POINT.
RAISE EXCEPTION _cx_90335e5d44316adf4805a732f.
ENDTRY.
  TRY.
      CREATE OBJECT o_file.
      o_file-&gt;set_filetype( zaplink_file=&gt;filetypes-local ).
    CATCH zaplink_cx_file INTO cx_file.
      cx_file-&gt;write( ).
  ENDTRY.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR p_file.
  TRY.
      o_file-&gt;load_dialog( p_file ).
      p_file = o_file-&gt;get_filename( ).
    CATCH zaplink_cx_file INTO cx_file.
      IF cx_file-&gt;textid &lt;&gt; zaplink_cx_file=&gt;dialog_canceled.
        cx_file-&gt;write( ).
      ENDIF.
  ENDTRY.

START-OF-SELECTION.
  DATA o_list     TYPE zaplink_container_4inst=&gt;to_list.
  DATA cx_list    TYPE REF TO zaplink_cx_list.
  DATA o_xml     	TYPE REF TO zaplink_container_4inst.
  DATA cx_xml     TYPE REF TO zaplink_cx_container.

  TRY.
      o_file-&gt;set_filename( p_file ).
    CATCH zaplink_cx_file INTO cx_file.
      cx_file-&gt;write( ).
  ENDTRY.
  TRY.
      CREATE OBJECT o_xml
        EXPORTING
          o_file = o_file.
      o_xml-&gt;load_from_file( ).
      TRY.
          o_list = o_xml-&gt;get_content( ).
          IF uninst IS INITIAL.
            o_list-&gt;select_default( zaplink_list=&gt;sel_actions-import ).
          ELSE.
            o_list-&gt;select_default( zaplink_list=&gt;sel_actions-uninstall ).
          ENDIF.
          o_list-&gt;change_selection( ).
        CATCH zaplink_cx_list INTO cx_list.
          cx_list-&gt;write( ).
      ENDTRY.
      IF uninst IS INITIAL.
        o_xml-&gt;transport_to_sap( o_list ).
      ELSE.
        o_xml-&gt;uninstall_from_sap( o_list ).
      ENDIF.
      o_xml-&gt;log-&gt;write( ).
    CATCH zaplink_cx_container INTO cx_xml.
      cx_xml-&gt;write( ).
  ENDTRY.

END-OF-SELECTION.">
  <A0_MAIN NAME="ZAPLINK_INSTALLER" VARCL="X" SUBC="1" CNAM="BCUSER" CDAT="20091129" UNAM="BCUSER" UDAT="20091129" VERN="000002" RSTAT="K" RMAND="001" RLOAD="E" FIXPT="X" SDATE="20091129" STIME="181307" IDATE="20091129" ITIME="181307" UCCHECK="X"/>
  <TEXTSPOOL>
   <ITEM ID="R">
    <TEXTS>
     <ITEM LANGU="E" ENTRY="Zap Link Installe" LENGTH="17 "/>
    </TEXTS>
   </ITEM>
  </TEXTSPOOL>
 </RAW>
</ZL_EXTRACT>
