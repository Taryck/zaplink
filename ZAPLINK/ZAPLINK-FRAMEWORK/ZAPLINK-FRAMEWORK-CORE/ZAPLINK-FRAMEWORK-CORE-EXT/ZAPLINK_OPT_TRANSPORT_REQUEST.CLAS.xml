<?xml version="1.0" encoding="utf-16"?>
<ZL_EXTRACT CONNECTOR="39AC0A4B07A5A05AE1000000AC120173" NAME="ZAPLINK_OPT_TRANSPORT_REQUEST" TYPE="CLAS">
 <DIRECTORY SRCSYSTEM="NSP" AUTHOR="TARYCK" DEVCLASS="ZAPLINK-FRAMEWORK-CORE-EXT" MASTERLANG="E"/>
 <RAW>
  <A0_MAINDATA VERSION="1" LANGU="E" UUID="DEFBB809454092F1BEA4000C293C7343" EXPOSURE="2" STATE="1" AUTHOR="TBENSIAL" CREATEDON="20091126" CLSCCINCL="X" FIXPT="X" UNICODE="X" R3RELEASE="701">
   <TEXTS>
    <ITEM LANGU="E" DESCRIPT="Zap Link Transport Request options"/>
   </TEXTS>
  </A0_MAINDATA>
  <ALIASES>
   <ITEM CMPNAME="TD_DEVCLASS" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_DEVCLASS">
    <TEXTS>
     <ITEM LANGU="E"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TD_SUBSTITUTIONKIND" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_SUBSTITUTIONKIND">
    <TEXTS>
     <ITEM LANGU="E"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TD_TRANSPORT_REQUEST" VERSION="1" EXPOSURE="2" CMPTYPE="3" REFCLSNAME="ZAPLINK_DATATYPES" REFCMPNAME="TD_TRANSPORT_REQUEST">
    <TEXTS>
     <ITEM LANGU="E"/>
    </TEXTS>
   </ITEM>
  </ALIASES>
  <ATTRIBUTS>
   <ITEM CMPNAME="SUBSTITUTIONKINDS" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107" CHANGEDBY="TARYCK" CHANGEDON="20100107" ATTDECLTYP="2" TYPTYPE="4" SRCROW1="21 " SRCCOLUMN1="4 " SRCROW2="27 " SRCCOLUMN2="29 " R3RELEASE="701" TYPESRC_LENG="602 " TYPESRC="BEGIN OF substitutionkinds,
        fixed             TYPE td_substitutionkind VALUE &apos;F&apos;,    &quot; Assign allways the same specified devclass
        same_as_container TYPE td_substitutionkind VALUE &apos;K&apos;,    &quot; Keep the same scheme as in container
        user              TYPE td_substitutionkind VALUE &apos;U&apos;,    &quot; let user select a transport request for all component
        input             TYPE td_substitutionkind VALUE &apos;I&apos;,    &quot; let user select a transport request for each component
        custom            TYPE td_substitutionkind VALUE &apos;X&apos;,    &quot; user define
      END OF substitutionkinds
">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="All possible transport request substitution Kinds"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="_SUBSTITUTION" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107" TYPTYPE="1" TYPE="TD_SUBSTITUTIONKIND" R3RELEASE="701">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Transport Request substitution Kind"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="_TRANSPORT_REQUEST" VERSION="1" EXPOSURE="1" STATE="1" EDITORDER="2 " AUTHOR="TARYCK" CREATEDON="20100107" TYPTYPE="1" TYPE="TD_TRANSPORT_REQUEST" R3RELEASE="701">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Transport Request provided by user"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="_TR_MAPPING" VERSION="1" STATE="1" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107" TYPTYPE="1" TYPE="TT_TR_SUBSTITS" R3RELEASE="701">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Substitution table"/>
    </TEXTS>
   </ITEM>
  </ATTRIBUTS>
  <INTERFACES>
   <ITEM REFCLSNAME="ZAPLINK_DATATYPES" VERSION="1" EXPOSURE="2" STATE="1" AUTHOR="TARYCK" CREATEDON="20100107" RELTYPE="1"/>
  </INTERFACES>
  <LOCAL>
   <TYPES>*&quot;* USE THIS SOURCE FILE FOR ANY TYPE DECLARATIONS (CLASS
*&quot;* definitions, interfaces or data types) you need for method
*&quot;* IMPLEMENTATION OR PRIVATE METHOD&apos;S SIGNATURE</TYPES>
   <IMPLEMENTATIONS>*&quot;* LOCAL CLASS IMPLEMENTATION FOR PUBLIC CLASS
*&quot;* use this source file for the implementation part of
*&quot;* LOCAL HELPER CLASSES</IMPLEMENTATIONS>
   <MACROS>*&quot;* USE THIS SOURCE FILE FOR ANY MACRO DEFINITIONS YOU NEED
*&quot;* IN THE IMPLEMENTATION PART OF THE CLASS</MACROS>
  </LOCAL>
  <METHODS>
   <ITEM CMPNAME="CONSTRUCTOR" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107" MTDTYPE="2" R3RELEASE="701">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="CONSTRUCTOR"/>
    </TEXTS>
    <SOURCE>_substitution = substitutionkinds-input.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_SUBSTITUTIONKIND" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="2 " AUTHOR="TARYCK" CREATEDON="20100107" MTDNEWEXC="X" R3RELEASE="701">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Substitution Kind : Getter"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107" PARDECLTYP="3" TYPTYPE="1" TYPE="TD_SUBSTITUTIONKIND">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Devclass substitution Kind"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_OPT_DEVCLASS" VERSION="1" LANGU="E" DESCRIPT="ZAPlink Exception for Options" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for Options"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>result = _substitution.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="GET_TRANSPORT_REQUEST" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="4 " AUTHOR="TARYCK" CREATEDON="20100107" MTDNEWEXC="X" R3RELEASE="701">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Transport Request value : Getter"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107" PARDECLTYP="3" TYPTYPE="1" TYPE="TD_TRANSPORT_REQUEST">
      <TEXTS>
       <ITEM LANGU="E"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_OPT_DEVCLASS" VERSION="1" LANGU="E" DESCRIPT="ZAPlink Exception for Options" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for Options"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>result = _transport_request.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="SET_SUBSTITUTIONKIND" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="3 " AUTHOR="TARYCK" CREATEDON="20100107" MTDNEWEXC="X" R3RELEASE="701">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Substitution Kind : Setter"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="DATA" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_SUBSTITUTIONKIND">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Devclass substitution Kind"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_OPT_DEVCLASS" VERSION="1" LANGU="E" DESCRIPT="ZAPlink Exception for Options" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for Options"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>CHECK data &lt;&gt; _substitution.

  CASE data.
    WHEN substitutionkinds-same_as_container OR
         substitutionkinds-user OR
         substitutionkinds-custom OR
         substitutionkinds-input.
    WHEN substitutionkinds-fixed.
      IF _transport_request IS INITIAL.
        RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
              EXPORTING textid = zaplink_cx_opt_devclass=&gt;missing_devclass
                     substkind = data.
      ENDIF.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
            EXPORTING textid = zaplink_cx_opt_devclass=&gt;invalid_substitutionkind
                   substkind = data.
  ENDCASE.
  _substitution = data.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="SET_TRANSPORT_REQUEST" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="5 " AUTHOR="TARYCK" CREATEDON="20100107" MTDNEWEXC="X" R3RELEASE="701">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Transport Request value : Setter"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="DATA" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107" PARPASSTYP="1" TYPTYPE="1" TYPE="TD_TRANSPORT_REQUEST">
      <TEXTS>
       <ITEM LANGU="E"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_OPT_DEVCLASS" VERSION="1" LANGU="E" DESCRIPT="ZAPlink Exception for Options" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for Options"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>CHECK data &lt;&gt; _transport_request.

  IF _transport_request IS INITIAL AND _substitution = substitutionkinds-fixed.
    RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
          EXPORTING textid = zaplink_cx_opt_devclass=&gt;missing_devclass
                 substkind = _substitution.
  ENDIF.
  _transport_request = data.</SOURCE>
   </ITEM>
   <ITEM CMPNAME="SUBSTITUTE" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="6 " AUTHOR="TARYCK" CREATEDON="20100107" MTDNEWEXC="X" R3RELEASE="701">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Get substitute Transport Request"/>
    </TEXTS>
    <PARAMETERS>
     <ITEM SCONAME="COMPONENT" VERSION="1" CMPTYPE="1" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107" PARPASSTYP="1" TYPTYPE="1" TYPE="TO_COMPONENT">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="Component in progress"/>
      </TEXTS>
     </ITEM>
     <ITEM SCONAME="RESULT" VERSION="1" CMPTYPE="1" EDITORDER="2 " AUTHOR="TARYCK" CREATEDON="20100107" PARDECLTYP="3" TYPTYPE="1" TYPE="TD_TRANSPORT_REQUEST">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="DevClass used for object"/>
      </TEXTS>
     </ITEM>
    </PARAMETERS>
    <EXCEPTIONS>
     <ITEM SCONAME="ZAPLINK_CX_OPT_DEVCLASS" VERSION="1" LANGU="E" DESCRIPT="ZAPlink Exception for Options" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107">
      <TEXTS>
       <ITEM LANGU="E" DESCRIPT="ZAPlink Exception for Options"/>
      </TEXTS>
     </ITEM>
    </EXCEPTIONS>
    <SOURCE>FIELD-SYMBOLS:
    &lt;s&gt; LIKE LINE OF _tr_mapping.

  check component is bound.
  CASE _substitution.
    WHEN substitutionkinds-input.
      clear result.
      EXIT. &quot; all ways empty to let use choose the right transport request
    WHEN substitutionkinds-fixed.
      result = _transport_request.
    WHEN substitutionkinds-user.
* to develop using MF TRINT_ORDER_CHOICE
    WHEN substitutionkinds-custom.
* to develop using event ?
    WHEN substitutionkinds-same_as_container.
      READ TABLE _tr_mapping ASSIGNING &lt;s&gt;
           WITH TABLE KEY xml_tr = component-&gt;directory-trkorr.
      IF sy-subrc = 0.
        result = &lt;s&gt;-sap_tr.
      ELSEIF NOT component-&gt;directory-trkorr IS INITIAL.
* to develop using MF TRINT_ORDER_CHOICE
      ENDIF.
    WHEN OTHERS.
      RAISE EXCEPTION TYPE zaplink_cx_opt_devclass
            EXPORTING textid = zaplink_cx_opt_devclass=&gt;invalid_substitutionkind
                   substkind = _substitution.
  ENDCASE.</SOURCE>
   </ITEM>
  </METHODS>
  <TYPES>
   <ITEM CMPNAME="TO_COMPONENT" VERSION="1" EXPOSURE="2" STATE="1" EDITORDER="3 " AUTHOR="TARYCK" CREATEDON="20100107" TYPTYPE="3" TYPE="ZAPLINK_RAW" R3RELEASE="701">
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Zap Link Component"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TS_TR_SUBSTIT" VERSION="1" STATE="1" EDITORDER="1 " AUTHOR="TARYCK" CREATEDON="20100107" CHANGEDBY="TARYCK" CHANGEDON="20100107" TYPTYPE="4" SRCROW1="6 " SRCCOLUMN1="4 " SRCROW2="9 " SRCCOLUMN2="22 " R3RELEASE="701" TYPESRC_LENG="128 ">
    BEGIN OF ts_tr_substit,
     xml_tr TYPE td_transport_request,
     sap_tr TYPE td_transport_request,
   END OF ts_tr_substit
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Transport Resquest substitution"/>
    </TEXTS>
   </ITEM>
   <ITEM CMPNAME="TT_TR_SUBSTITS" VERSION="1" STATE="1" EDITORDER="2 " AUTHOR="TARYCK" CREATEDON="20100107" CHANGEDBY="TARYCK" CHANGEDON="20100107" TYPTYPE="4" SRCROW1="11 " SRCCOLUMN1="4 " SRCROW2="11 " SRCCOLUMN2="75 " R3RELEASE="701" TYPESRC_LENG="72 ">
    tt_tr_substits TYPE SORTED TABLE OF ts_tr_substit WITH UNIQUE KEY xml_tr
    <TEXTS>
     <ITEM LANGU="E" DESCRIPT="Transport Resquest substitutions list"/>
    </TEXTS>
   </ITEM>
  </TYPES>
 </RAW>
</ZL_EXTRACT>
